ARM GAS  /tmp/cc1G6faT.s 			page 1


   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"bluetooth_rxtx.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.msleep,"ax",%progbits
  19              		.align	1
  20              		.thumb
  21              		.thumb_func
  23              	msleep:
  24              	.LFB5:
  25              		.file 1 "bluetooth_rxtx.c"
   1:bluetooth_rxtx.c **** /*
   2:bluetooth_rxtx.c ****  * Copyright 2010-2013 Michael Ossmann
   3:bluetooth_rxtx.c ****  * Copyright 2011-2013 Dominic Spill
   4:bluetooth_rxtx.c ****  *
   5:bluetooth_rxtx.c ****  * This file is part of Project Ubertooth.
   6:bluetooth_rxtx.c ****  *
   7:bluetooth_rxtx.c ****  * This program is free software; you can redistribute it and/or modify
   8:bluetooth_rxtx.c ****  * it under the terms of the GNU General Public License as published by
   9:bluetooth_rxtx.c ****  * the Free Software Foundation; either version 2, or (at your option)
  10:bluetooth_rxtx.c ****  * any later version.
  11:bluetooth_rxtx.c ****  *
  12:bluetooth_rxtx.c ****  * This program is distributed in the hope that it will be useful,
  13:bluetooth_rxtx.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  14:bluetooth_rxtx.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  15:bluetooth_rxtx.c ****  * GNU General Public License for more details.
  16:bluetooth_rxtx.c ****  *
  17:bluetooth_rxtx.c ****  * You should have received a copy of the GNU General Public License
  18:bluetooth_rxtx.c ****  * along with this program; see the file COPYING.  If not, write to
  19:bluetooth_rxtx.c ****  * the Free Software Foundation, Inc., 51 Franklin Street,
  20:bluetooth_rxtx.c ****  * Boston, MA 02110-1301, USA.
  21:bluetooth_rxtx.c ****  */
  22:bluetooth_rxtx.c **** 
  23:bluetooth_rxtx.c **** #include <string.h>
  24:bluetooth_rxtx.c **** #include <stdlib.h>
  25:bluetooth_rxtx.c **** 
  26:bluetooth_rxtx.c **** #include "ubertooth.h"
  27:bluetooth_rxtx.c **** #include "ubertooth_usb.h"
  28:bluetooth_rxtx.c **** #include "ubertooth_interface.h"
  29:bluetooth_rxtx.c **** #include "ubertooth_rssi.h"
  30:bluetooth_rxtx.c **** #include "ubertooth_cs.h"
  31:bluetooth_rxtx.c **** #include "ubertooth_dma.h"
  32:bluetooth_rxtx.c **** #include "ubertooth_clock.h"
  33:bluetooth_rxtx.c **** #include "bluetooth.h"
ARM GAS  /tmp/cc1G6faT.s 			page 2


  34:bluetooth_rxtx.c **** #include "bluetooth_le.h"
  35:bluetooth_rxtx.c **** #include "cc2400_rangetest.h"
  36:bluetooth_rxtx.c **** #include "ego.h"
  37:bluetooth_rxtx.c **** 
  38:bluetooth_rxtx.c **** #define MIN(x,y)	((x)<(y)?(x):(y))
  39:bluetooth_rxtx.c **** #define MAX(x,y)	((x)>(y)?(x):(y))
  40:bluetooth_rxtx.c **** 
  41:bluetooth_rxtx.c **** /* build info */
  42:bluetooth_rxtx.c **** const char compile_info[] =
  43:bluetooth_rxtx.c **** 	"ubertooth " GIT_REVISION " (" COMPILE_BY "@" COMPILE_HOST ") " TIMESTAMP;
  44:bluetooth_rxtx.c **** 
  45:bluetooth_rxtx.c **** /* hopping stuff */
  46:bluetooth_rxtx.c **** volatile uint8_t  hop_mode = HOP_NONE;
  47:bluetooth_rxtx.c **** volatile uint8_t  do_hop = 0;                  // set by timer interrupt
  48:bluetooth_rxtx.c **** volatile uint16_t channel = 2441;
  49:bluetooth_rxtx.c **** volatile uint16_t hop_direct_channel = 0;      // for hopping directly to a channel
  50:bluetooth_rxtx.c **** volatile uint16_t hop_timeout = 158;
  51:bluetooth_rxtx.c **** volatile uint16_t requested_channel = 0;
  52:bluetooth_rxtx.c **** volatile uint16_t le_adv_channel = 2402;
  53:bluetooth_rxtx.c **** 
  54:bluetooth_rxtx.c **** /* bulk USB stuff */
  55:bluetooth_rxtx.c **** volatile uint8_t  idle_buf_clkn_high = 0;
  56:bluetooth_rxtx.c **** volatile uint32_t idle_buf_clk100ns = 0;
  57:bluetooth_rxtx.c **** volatile uint16_t idle_buf_channel = 0;
  58:bluetooth_rxtx.c **** volatile uint8_t  dma_discard = 0;
  59:bluetooth_rxtx.c **** volatile uint8_t  status = 0;
  60:bluetooth_rxtx.c **** 
  61:bluetooth_rxtx.c **** /* operation mode */
  62:bluetooth_rxtx.c **** volatile uint8_t mode = MODE_IDLE;
  63:bluetooth_rxtx.c **** volatile uint8_t requested_mode = MODE_IDLE;
  64:bluetooth_rxtx.c **** volatile uint8_t jam_mode = JAM_NONE;
  65:bluetooth_rxtx.c **** volatile uint8_t ego_mode = EGO_FOLLOW;
  66:bluetooth_rxtx.c **** 
  67:bluetooth_rxtx.c **** volatile uint8_t modulation = MOD_BT_BASIC_RATE;
  68:bluetooth_rxtx.c **** 
  69:bluetooth_rxtx.c **** /* specan stuff */
  70:bluetooth_rxtx.c **** volatile uint16_t low_freq = 2400;
  71:bluetooth_rxtx.c **** volatile uint16_t high_freq = 2483;
  72:bluetooth_rxtx.c **** volatile int8_t rssi_threshold = -30;  // -54dBm - 30 = -84dBm
  73:bluetooth_rxtx.c **** 
  74:bluetooth_rxtx.c **** /* Generic TX stuff */
  75:bluetooth_rxtx.c **** generic_tx_packet tx_pkt;
  76:bluetooth_rxtx.c **** 
  77:bluetooth_rxtx.c **** /* le stuff */
  78:bluetooth_rxtx.c **** int dlen = 0;
  79:bluetooth_rxtx.c **** uint8_t *slave_mac_address_data;
  80:bluetooth_rxtx.c **** uint8_t slave_mac_address[6] = { 0, };
  81:bluetooth_rxtx.c **** 
  82:bluetooth_rxtx.c **** le_state_t le = {
  83:bluetooth_rxtx.c **** 	.access_address = 0x8e89bed6,           // advertising channel access address
  84:bluetooth_rxtx.c **** 	.synch = 0x6b7d,                        // bit-reversed adv channel AA
  85:bluetooth_rxtx.c **** 	.syncl = 0x9171,
  86:bluetooth_rxtx.c **** 	.crc_init  = 0x555555,                  // advertising channel CRCInit
  87:bluetooth_rxtx.c **** 	.crc_init_reversed = 0xAAAAAA,
  88:bluetooth_rxtx.c **** 	.crc_verify = 0,
  89:bluetooth_rxtx.c **** 
  90:bluetooth_rxtx.c **** 	.link_state = LINK_INACTIVE,
ARM GAS  /tmp/cc1G6faT.s 			page 3


  91:bluetooth_rxtx.c **** 	.conn_epoch = 0,
  92:bluetooth_rxtx.c **** 	.target_set = 0,
  93:bluetooth_rxtx.c **** 	.last_packet = 0,
  94:bluetooth_rxtx.c **** };
  95:bluetooth_rxtx.c **** 
  96:bluetooth_rxtx.c **** typedef struct _le_promisc_active_aa_t {
  97:bluetooth_rxtx.c **** 	u32 aa;
  98:bluetooth_rxtx.c **** 	int count;
  99:bluetooth_rxtx.c **** } le_promisc_active_aa_t;
 100:bluetooth_rxtx.c **** 
 101:bluetooth_rxtx.c **** typedef struct _le_promisc_state_t {
 102:bluetooth_rxtx.c **** 	// LFU cache of recently seen AA's
 103:bluetooth_rxtx.c **** 	le_promisc_active_aa_t active_aa[32];
 104:bluetooth_rxtx.c **** 
 105:bluetooth_rxtx.c **** 	// recovering hop interval
 106:bluetooth_rxtx.c **** 	u32 smallest_hop_interval;
 107:bluetooth_rxtx.c **** 	int consec_intervals;
 108:bluetooth_rxtx.c **** } le_promisc_state_t;
 109:bluetooth_rxtx.c **** le_promisc_state_t le_promisc;
 110:bluetooth_rxtx.c **** #define AA_LIST_SIZE (int)(sizeof(le_promisc.active_aa) / sizeof(le_promisc_active_aa_t))
 111:bluetooth_rxtx.c **** 
 112:bluetooth_rxtx.c **** /* LE jamming */
 113:bluetooth_rxtx.c **** #define JAM_COUNT_DEFAULT 40
 114:bluetooth_rxtx.c **** int le_jam_count = 0;
 115:bluetooth_rxtx.c **** 
 116:bluetooth_rxtx.c **** /* set LE access address */
 117:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa);
 118:bluetooth_rxtx.c **** 
 119:bluetooth_rxtx.c **** typedef int (*data_cb_t)(char *);
 120:bluetooth_rxtx.c **** data_cb_t data_cb = NULL;
 121:bluetooth_rxtx.c **** 
 122:bluetooth_rxtx.c **** typedef void (*packet_cb_t)(u8 *);
 123:bluetooth_rxtx.c **** packet_cb_t packet_cb = NULL;
 124:bluetooth_rxtx.c **** 
 125:bluetooth_rxtx.c **** /* Unpacked symbol buffers (two rxbufs) */
 126:bluetooth_rxtx.c **** char unpacked[DMA_SIZE*8*2];
 127:bluetooth_rxtx.c **** 
 128:bluetooth_rxtx.c **** static int enqueue(uint8_t type, uint8_t* buf)
 129:bluetooth_rxtx.c **** {
 130:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 131:bluetooth_rxtx.c **** 
 132:bluetooth_rxtx.c **** 	/* fail if queue is full */
 133:bluetooth_rxtx.c **** 	if (f == NULL) {
 134:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 135:bluetooth_rxtx.c **** 		return 0;
 136:bluetooth_rxtx.c **** 	}
 137:bluetooth_rxtx.c **** 
 138:bluetooth_rxtx.c **** 	f->pkt_type = type;
 139:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 140:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 141:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 142:bluetooth_rxtx.c **** 	} else {
 143:bluetooth_rxtx.c **** 		f->clkn_high = idle_buf_clkn_high;
 144:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 145:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
 146:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 147:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
ARM GAS  /tmp/cc1G6faT.s 			page 4


 148:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 149:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 150:bluetooth_rxtx.c **** 	}
 151:bluetooth_rxtx.c **** 
 152:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
 153:bluetooth_rxtx.c **** 
 154:bluetooth_rxtx.c **** 	f->status = status;
 155:bluetooth_rxtx.c **** 	status = 0;
 156:bluetooth_rxtx.c **** 
 157:bluetooth_rxtx.c **** 	return 1;
 158:bluetooth_rxtx.c **** }
 159:bluetooth_rxtx.c **** 
 160:bluetooth_rxtx.c **** int enqueue_with_ts(uint8_t type, uint8_t* buf, uint32_t ts)
 161:bluetooth_rxtx.c **** {
 162:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 163:bluetooth_rxtx.c **** 
 164:bluetooth_rxtx.c **** 	/* fail if queue is full */
 165:bluetooth_rxtx.c **** 	if (f == NULL) {
 166:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 167:bluetooth_rxtx.c **** 		return 0;
 168:bluetooth_rxtx.c **** 	}
 169:bluetooth_rxtx.c **** 
 170:bluetooth_rxtx.c **** 	f->pkt_type = type;
 171:bluetooth_rxtx.c **** 
 172:bluetooth_rxtx.c **** 	f->clkn_high = 0;
 173:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 174:bluetooth_rxtx.c **** 
 175:bluetooth_rxtx.c **** 	f->channel = (uint8_t)((channel - 2402) & 0xff);
 176:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 177:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 178:bluetooth_rxtx.c **** 
 179:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
 180:bluetooth_rxtx.c **** 
 181:bluetooth_rxtx.c **** 	f->status = status;
 182:bluetooth_rxtx.c **** 	status = 0;
 183:bluetooth_rxtx.c **** 
 184:bluetooth_rxtx.c **** 	return 1;
 185:bluetooth_rxtx.c **** }
 186:bluetooth_rxtx.c **** 
 187:bluetooth_rxtx.c **** static int vendor_request_handler(uint8_t request, uint16_t* request_params, uint8_t* data, int* da
 188:bluetooth_rxtx.c **** {
 189:bluetooth_rxtx.c **** 	uint32_t clock;
 190:bluetooth_rxtx.c **** 	size_t length; // string length
 191:bluetooth_rxtx.c **** 	usb_pkt_rx* p = NULL;
 192:bluetooth_rxtx.c **** 	uint16_t reg_val;
 193:bluetooth_rxtx.c **** 	uint8_t i;
 194:bluetooth_rxtx.c **** 	dlen = *data_len;
 195:bluetooth_rxtx.c **** 
 196:bluetooth_rxtx.c **** 	switch (request) {
 197:bluetooth_rxtx.c **** 
 198:bluetooth_rxtx.c **** 	case UBERTOOTH_PING:
 199:bluetooth_rxtx.c **** 		*data_len = 0;
 200:bluetooth_rxtx.c **** 		break;
 201:bluetooth_rxtx.c **** 
 202:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_SYMBOLS:
 203:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_SYMBOLS;
 204:bluetooth_rxtx.c **** 		*data_len = 0;
ARM GAS  /tmp/cc1G6faT.s 			page 5


 205:bluetooth_rxtx.c **** 		break;
 206:bluetooth_rxtx.c **** 
 207:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_SYMBOLS:
 208:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
 209:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 210:bluetooth_rxtx.c **** 		*data_len = 0;
 211:bluetooth_rxtx.c **** 		break;
 212:bluetooth_rxtx.c **** 
 213:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_USRLED:
 214:bluetooth_rxtx.c **** 		data[0] = (USRLED) ? 1 : 0;
 215:bluetooth_rxtx.c **** 		*data_len = 1;
 216:bluetooth_rxtx.c **** 		break;
 217:bluetooth_rxtx.c **** 
 218:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_USRLED:
 219:bluetooth_rxtx.c **** 		if (request_params[0])
 220:bluetooth_rxtx.c **** 			USRLED_SET;
 221:bluetooth_rxtx.c **** 		else
 222:bluetooth_rxtx.c **** 			USRLED_CLR;
 223:bluetooth_rxtx.c **** 		break;
 224:bluetooth_rxtx.c **** 
 225:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_RXLED:
 226:bluetooth_rxtx.c **** 		data[0] = (RXLED) ? 1 : 0;
 227:bluetooth_rxtx.c **** 		*data_len = 1;
 228:bluetooth_rxtx.c **** 		break;
 229:bluetooth_rxtx.c **** 
 230:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_RXLED:
 231:bluetooth_rxtx.c **** 		if (request_params[0])
 232:bluetooth_rxtx.c **** 			RXLED_SET;
 233:bluetooth_rxtx.c **** 		else
 234:bluetooth_rxtx.c **** 			RXLED_CLR;
 235:bluetooth_rxtx.c **** 		break;
 236:bluetooth_rxtx.c **** 
 237:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_TXLED:
 238:bluetooth_rxtx.c **** 		data[0] = (TXLED) ? 1 : 0;
 239:bluetooth_rxtx.c **** 		*data_len = 1;
 240:bluetooth_rxtx.c **** 		break;
 241:bluetooth_rxtx.c **** 
 242:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_TXLED:
 243:bluetooth_rxtx.c **** 		if (request_params[0])
 244:bluetooth_rxtx.c **** 			TXLED_SET;
 245:bluetooth_rxtx.c **** 		else
 246:bluetooth_rxtx.c **** 			TXLED_CLR;
 247:bluetooth_rxtx.c **** 		break;
 248:bluetooth_rxtx.c **** 
 249:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_1V8:
 250:bluetooth_rxtx.c **** 		data[0] = (CC1V8) ? 1 : 0;
 251:bluetooth_rxtx.c **** 		*data_len = 1;
 252:bluetooth_rxtx.c **** 		break;
 253:bluetooth_rxtx.c **** 
 254:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_1V8:
 255:bluetooth_rxtx.c **** 		if (request_params[0])
 256:bluetooth_rxtx.c **** 			CC1V8_SET;
 257:bluetooth_rxtx.c **** 		else
 258:bluetooth_rxtx.c **** 			CC1V8_CLR;
 259:bluetooth_rxtx.c **** 		break;
 260:bluetooth_rxtx.c **** 
 261:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PARTNUM:
ARM GAS  /tmp/cc1G6faT.s 			page 6


 262:bluetooth_rxtx.c **** 		get_part_num(data, data_len);
 263:bluetooth_rxtx.c **** 		break;
 264:bluetooth_rxtx.c **** 
 265:bluetooth_rxtx.c **** 	case UBERTOOTH_RESET:
 266:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 267:bluetooth_rxtx.c **** 		break;
 268:bluetooth_rxtx.c **** 
 269:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SERIAL:
 270:bluetooth_rxtx.c **** 		get_device_serial(data, data_len);
 271:bluetooth_rxtx.c **** 		break;
 272:bluetooth_rxtx.c **** 
 273:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 274:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PAEN:
 275:bluetooth_rxtx.c **** 		data[0] = (PAEN) ? 1 : 0;
 276:bluetooth_rxtx.c **** 		*data_len = 1;
 277:bluetooth_rxtx.c **** 		break;
 278:bluetooth_rxtx.c **** 
 279:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PAEN:
 280:bluetooth_rxtx.c **** 		if (request_params[0])
 281:bluetooth_rxtx.c **** 			PAEN_SET;
 282:bluetooth_rxtx.c **** 		else
 283:bluetooth_rxtx.c **** 			PAEN_CLR;
 284:bluetooth_rxtx.c **** 		break;
 285:bluetooth_rxtx.c **** 
 286:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_HGM:
 287:bluetooth_rxtx.c **** 		data[0] = (HGM) ? 1 : 0;
 288:bluetooth_rxtx.c **** 		*data_len = 1;
 289:bluetooth_rxtx.c **** 		break;
 290:bluetooth_rxtx.c **** 
 291:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_HGM:
 292:bluetooth_rxtx.c **** 		if (request_params[0])
 293:bluetooth_rxtx.c **** 			HGM_SET;
 294:bluetooth_rxtx.c **** 		else
 295:bluetooth_rxtx.c **** 			HGM_CLR;
 296:bluetooth_rxtx.c **** 		break;
 297:bluetooth_rxtx.c **** #endif
 298:bluetooth_rxtx.c **** 
 299:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 300:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_TEST:
 301:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_TEST;
 302:bluetooth_rxtx.c **** 		break;
 303:bluetooth_rxtx.c **** 
 304:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PALEVEL:
 305:bluetooth_rxtx.c **** 		data[0] = cc2400_get(FREND) & 0x7;
 306:bluetooth_rxtx.c **** 		*data_len = 1;
 307:bluetooth_rxtx.c **** 		break;
 308:bluetooth_rxtx.c **** 
 309:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PALEVEL:
 310:bluetooth_rxtx.c **** 		if( request_params[0] < 8 ) {
 311:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 312:bluetooth_rxtx.c **** 		} else {
 313:bluetooth_rxtx.c **** 			return 0;
 314:bluetooth_rxtx.c **** 		}
 315:bluetooth_rxtx.c **** 		break;
 316:bluetooth_rxtx.c **** 
 317:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_TEST:
 318:bluetooth_rxtx.c **** 		requested_mode = MODE_RANGE_TEST;
ARM GAS  /tmp/cc1G6faT.s 			page 7


 319:bluetooth_rxtx.c **** 		break;
 320:bluetooth_rxtx.c **** 
 321:bluetooth_rxtx.c **** 	case UBERTOOTH_REPEATER:
 322:bluetooth_rxtx.c **** 		requested_mode = MODE_REPEATER;
 323:bluetooth_rxtx.c **** 		break;
 324:bluetooth_rxtx.c **** #endif
 325:bluetooth_rxtx.c **** 
 326:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_CHECK:
 327:bluetooth_rxtx.c **** 		data[0] = rr.valid;
 328:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 329:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 330:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 331:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 332:bluetooth_rxtx.c **** 		*data_len = 5;
 333:bluetooth_rxtx.c **** 		break;
 334:bluetooth_rxtx.c **** 
 335:bluetooth_rxtx.c **** 	case UBERTOOTH_STOP:
 336:bluetooth_rxtx.c **** 		requested_mode = MODE_IDLE;
 337:bluetooth_rxtx.c **** 		break;
 338:bluetooth_rxtx.c **** 
 339:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_MOD:
 340:bluetooth_rxtx.c **** 		data[0] = modulation;
 341:bluetooth_rxtx.c **** 		*data_len = 1;
 342:bluetooth_rxtx.c **** 		break;
 343:bluetooth_rxtx.c **** 
 344:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_MOD:
 345:bluetooth_rxtx.c **** 		modulation = request_params[0];
 346:bluetooth_rxtx.c **** 		break;
 347:bluetooth_rxtx.c **** 
 348:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CHANNEL:
 349:bluetooth_rxtx.c **** 		data[0] = channel & 0xFF;
 350:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
 351:bluetooth_rxtx.c **** 		*data_len = 2;
 352:bluetooth_rxtx.c **** 		break;
 353:bluetooth_rxtx.c **** 
 354:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CHANNEL:
 355:bluetooth_rxtx.c **** 		requested_channel = request_params[0];
 356:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 357:bluetooth_rxtx.c **** 		if (requested_channel > MAX_FREQ) {
 358:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 359:bluetooth_rxtx.c **** 			requested_channel = 2402;
 360:bluetooth_rxtx.c **** 		}
 361:bluetooth_rxtx.c **** 		/* fixed channel mode, can be outside bluetooth band */
 362:bluetooth_rxtx.c **** 		else {
 363:bluetooth_rxtx.c **** 			hop_mode = HOP_NONE;
 364:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 365:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 366:bluetooth_rxtx.c **** 		}
 367:bluetooth_rxtx.c **** 
 368:bluetooth_rxtx.c **** 		le_adv_channel = requested_channel;
 369:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 370:bluetooth_rxtx.c **** 			channel = requested_channel;
 371:bluetooth_rxtx.c **** 			requested_channel = 0;
 372:bluetooth_rxtx.c **** 
 373:bluetooth_rxtx.c **** 			/* CS threshold is mode-dependent. Update it after
 374:bluetooth_rxtx.c **** 			 * possible mode change. TODO - kludgy. */
 375:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
ARM GAS  /tmp/cc1G6faT.s 			page 8


 376:bluetooth_rxtx.c **** 		}
 377:bluetooth_rxtx.c **** 		break;
 378:bluetooth_rxtx.c **** 
 379:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ISP:
 380:bluetooth_rxtx.c **** 		set_isp();
 381:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 382:bluetooth_rxtx.c **** 		break;
 383:bluetooth_rxtx.c **** 
 384:bluetooth_rxtx.c **** 	case UBERTOOTH_FLASH:
 385:bluetooth_rxtx.c **** 		bootloader_ctrl = DFU_MODE;
 386:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 387:bluetooth_rxtx.c **** 		break;
 388:bluetooth_rxtx.c **** 
 389:bluetooth_rxtx.c **** 	case UBERTOOTH_SPECAN:
 390:bluetooth_rxtx.c **** 		if (request_params[0] < 2049 || request_params[0] > 3072 ||
 391:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 392:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 393:bluetooth_rxtx.c **** 			return 0;
 394:bluetooth_rxtx.c **** 		low_freq = request_params[0];
 395:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 396:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 397:bluetooth_rxtx.c **** 		*data_len = 0;
 398:bluetooth_rxtx.c **** 		break;
 399:bluetooth_rxtx.c **** 
 400:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_GENERIC:
 401:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_GENERIC;
 402:bluetooth_rxtx.c **** 		*data_len = 0;
 403:bluetooth_rxtx.c **** 		break;
 404:bluetooth_rxtx.c **** 
 405:bluetooth_rxtx.c **** 	case UBERTOOTH_LED_SPECAN:
 406:bluetooth_rxtx.c **** 		if (request_params[0] > 256)
 407:bluetooth_rxtx.c **** 			return 0;
 408:bluetooth_rxtx.c **** 		rssi_threshold = 54 - request_params[0];
 409:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 410:bluetooth_rxtx.c **** 		*data_len = 0;
 411:bluetooth_rxtx.c **** 		break;
 412:bluetooth_rxtx.c **** 
 413:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_REV_NUM:
 414:bluetooth_rxtx.c **** 		data[0] = 0x00;
 415:bluetooth_rxtx.c **** 		data[1] = 0x00;
 416:bluetooth_rxtx.c **** 
 417:bluetooth_rxtx.c **** 		length = (u8)strlen(GIT_REVISION);
 418:bluetooth_rxtx.c **** 		data[2] = length;
 419:bluetooth_rxtx.c **** 
 420:bluetooth_rxtx.c **** 		memcpy(&data[3], GIT_REVISION, length);
 421:bluetooth_rxtx.c **** 
 422:bluetooth_rxtx.c **** 		*data_len = 2 + 1 + length;
 423:bluetooth_rxtx.c **** 		break;
 424:bluetooth_rxtx.c **** 
 425:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_COMPILE_INFO:
 426:bluetooth_rxtx.c **** 		length = (u8)strlen(compile_info);
 427:bluetooth_rxtx.c **** 		data[0] = length;
 428:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 429:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 430:bluetooth_rxtx.c **** 		break;
 431:bluetooth_rxtx.c **** 
 432:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_BOARD_ID:
ARM GAS  /tmp/cc1G6faT.s 			page 9


 433:bluetooth_rxtx.c **** 		data[0] = BOARD_ID;
 434:bluetooth_rxtx.c **** 		*data_len = 1;
 435:bluetooth_rxtx.c **** 		break;
 436:bluetooth_rxtx.c **** 
 437:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_SQUELCH:
 438:bluetooth_rxtx.c **** 		cs_threshold_req = (int8_t)request_params[0];
 439:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 440:bluetooth_rxtx.c **** 		break;
 441:bluetooth_rxtx.c **** 
 442:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SQUELCH:
 443:bluetooth_rxtx.c **** 		data[0] = cs_threshold_req;
 444:bluetooth_rxtx.c **** 		*data_len = 1;
 445:bluetooth_rxtx.c **** 		break;
 446:bluetooth_rxtx.c **** 
 447:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_BDADDR:
 448:bluetooth_rxtx.c **** 		target.address = 0;
 449:bluetooth_rxtx.c **** 		target.syncword = 0;
 450:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 451:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 452:bluetooth_rxtx.c **** 		}
 453:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 454:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 455:bluetooth_rxtx.c **** 		}
 456:bluetooth_rxtx.c **** 		precalc();
 457:bluetooth_rxtx.c **** 		break;
 458:bluetooth_rxtx.c **** 
 459:bluetooth_rxtx.c **** 	case UBERTOOTH_START_HOPPING:
 460:bluetooth_rxtx.c **** 		clkn_offset = 0;
 461:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 462:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 463:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
 464:bluetooth_rxtx.c **** 		}
 465:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
 466:bluetooth_rxtx.c **** 		dma_discard = 1;
 467:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 468:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 469:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 470:bluetooth_rxtx.c **** 		break;
 471:bluetooth_rxtx.c **** 
 472:bluetooth_rxtx.c **** 	case UBERTOOTH_AFH:
 473:bluetooth_rxtx.c **** 		hop_mode = HOP_AFH;
 474:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 475:bluetooth_rxtx.c **** 
 476:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 477:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 478:bluetooth_rxtx.c **** 		}
 479:bluetooth_rxtx.c **** 		used_channels = 0;
 480:bluetooth_rxtx.c **** 		afh_enabled = 1;
 481:bluetooth_rxtx.c **** 		break;
 482:bluetooth_rxtx.c **** 
 483:bluetooth_rxtx.c **** 	case UBERTOOTH_HOP:
 484:bluetooth_rxtx.c **** 		do_hop = 1;
 485:bluetooth_rxtx.c **** 		break;
 486:bluetooth_rxtx.c **** 
 487:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CLOCK:
 488:bluetooth_rxtx.c **** 		clock = data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24;
 489:bluetooth_rxtx.c **** 		clkn = clock;
ARM GAS  /tmp/cc1G6faT.s 			page 10


 490:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 491:bluetooth_rxtx.c **** 		break;
 492:bluetooth_rxtx.c **** 
 493:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_AFHMAP:
 494:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 495:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 496:bluetooth_rxtx.c **** 		}
 497:bluetooth_rxtx.c **** 		afh_enabled = 1;
 498:bluetooth_rxtx.c **** 		*data_len = 10;
 499:bluetooth_rxtx.c **** 		break;
 500:bluetooth_rxtx.c **** 
 501:bluetooth_rxtx.c **** 	case UBERTOOTH_CLEAR_AFHMAP:
 502:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 503:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 504:bluetooth_rxtx.c **** 		}
 505:bluetooth_rxtx.c **** 		afh_enabled = 0;
 506:bluetooth_rxtx.c **** 		*data_len = 10;
 507:bluetooth_rxtx.c **** 		break;
 508:bluetooth_rxtx.c **** 
 509:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CLOCK:
 510:bluetooth_rxtx.c **** 		clock = clkn;
 511:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 512:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 513:bluetooth_rxtx.c **** 		}
 514:bluetooth_rxtx.c **** 		*data_len = 4;
 515:bluetooth_rxtx.c **** 		break;
 516:bluetooth_rxtx.c **** 
 517:bluetooth_rxtx.c **** 	case UBERTOOTH_TRIM_CLOCK:
 518:bluetooth_rxtx.c **** 		clk100ns_offset = (data[0] << 8) | (data[1] << 0);
 519:bluetooth_rxtx.c **** 		break;
 520:bluetooth_rxtx.c **** 
 521:bluetooth_rxtx.c **** 	case UBERTOOTH_FIX_CLOCK_DRIFT:
 522:bluetooth_rxtx.c **** 		clk_drift_ppm += (int16_t)(data[0] << 8) | (data[1] << 0);
 523:bluetooth_rxtx.c **** 
 524:bluetooth_rxtx.c **** 		// Too slow
 525:bluetooth_rxtx.c **** 		if (clk_drift_ppm < 0) {
 526:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 527:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 528:bluetooth_rxtx.c **** 		}
 529:bluetooth_rxtx.c **** 		// Too fast
 530:bluetooth_rxtx.c **** 		else if (clk_drift_ppm > 0) {
 531:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
 532:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 533:bluetooth_rxtx.c **** 		}
 534:bluetooth_rxtx.c **** 		// Don't trim
 535:bluetooth_rxtx.c **** 		else {
 536:bluetooth_rxtx.c **** 			clk_drift_correction = 0;
 537:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
 538:bluetooth_rxtx.c **** 		}
 539:bluetooth_rxtx.c **** 
 540:bluetooth_rxtx.c **** 		break;
 541:bluetooth_rxtx.c **** 
 542:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SNIFFING:
 543:bluetooth_rxtx.c **** 		*data_len = 0;
 544:bluetooth_rxtx.c **** 
 545:bluetooth_rxtx.c **** 		do_hop = 0;
 546:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
ARM GAS  /tmp/cc1G6faT.s 			page 11


 547:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 548:bluetooth_rxtx.c **** 
 549:bluetooth_rxtx.c **** 		queue_init();
 550:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 551:bluetooth_rxtx.c **** 		break;
 552:bluetooth_rxtx.c **** 
 553:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_ACCESS_ADDRESS:
 554:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 555:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 556:bluetooth_rxtx.c **** 		}
 557:bluetooth_rxtx.c **** 		*data_len = 4;
 558:bluetooth_rxtx.c **** 		break;
 559:bluetooth_rxtx.c **** 
 560:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ACCESS_ADDRESS:
 561:bluetooth_rxtx.c **** 		le_set_access_address(data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24);
 562:bluetooth_rxtx.c **** 		le.target_set = 1;
 563:bluetooth_rxtx.c **** 		break;
 564:bluetooth_rxtx.c **** 
 565:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING:
 566:bluetooth_rxtx.c **** 		// do something! just don't commit anything here
 567:bluetooth_rxtx.c **** 		break;
 568:bluetooth_rxtx.c **** 
 569:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING_REPLY:
 570:bluetooth_rxtx.c **** 		// after you do something, tell me what you did!
 571:bluetooth_rxtx.c **** 		// don't commit here please
 572:bluetooth_rxtx.c **** 		data[0] = 0x13;
 573:bluetooth_rxtx.c **** 		data[1] = 0x37;
 574:bluetooth_rxtx.c **** 		*data_len = 2;
 575:bluetooth_rxtx.c **** 		break;
 576:bluetooth_rxtx.c **** 
 577:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CRC_VERIFY:
 578:bluetooth_rxtx.c **** 		data[0] = le.crc_verify ? 1 : 0;
 579:bluetooth_rxtx.c **** 		*data_len = 1;
 580:bluetooth_rxtx.c **** 		break;
 581:bluetooth_rxtx.c **** 
 582:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CRC_VERIFY:
 583:bluetooth_rxtx.c **** 		le.crc_verify = request_params[0] ? 1 : 0;
 584:bluetooth_rxtx.c **** 		break;
 585:bluetooth_rxtx.c **** 
 586:bluetooth_rxtx.c **** 	case UBERTOOTH_POLL:
 587:bluetooth_rxtx.c **** 		p = dequeue();
 588:bluetooth_rxtx.c **** 		if (p != NULL) {
 589:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 590:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 591:bluetooth_rxtx.c **** 		} else {
 592:bluetooth_rxtx.c **** 			data[0] = 0;
 593:bluetooth_rxtx.c **** 			*data_len = 1;
 594:bluetooth_rxtx.c **** 		}
 595:bluetooth_rxtx.c **** 		break;
 596:bluetooth_rxtx.c **** 
 597:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_PROMISC:
 598:bluetooth_rxtx.c **** 		*data_len = 0;
 599:bluetooth_rxtx.c **** 
 600:bluetooth_rxtx.c **** 		hop_mode = HOP_NONE;
 601:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 602:bluetooth_rxtx.c **** 
 603:bluetooth_rxtx.c **** 		queue_init();
ARM GAS  /tmp/cc1G6faT.s 			page 12


 604:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 605:bluetooth_rxtx.c **** 		break;
 606:bluetooth_rxtx.c **** 
 607:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_REGISTER:
 608:bluetooth_rxtx.c **** 		reg_val = cc2400_get(request_params[0]);
 609:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 610:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 611:bluetooth_rxtx.c **** 		*data_len = 2;
 612:bluetooth_rxtx.c **** 		break;
 613:bluetooth_rxtx.c **** 
 614:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTER:
 615:bluetooth_rxtx.c **** 		cc2400_set(request_params[0] & 0xff, request_params[1]);
 616:bluetooth_rxtx.c **** 		break;
 617:bluetooth_rxtx.c **** 
 618:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTERS:
 619:bluetooth_rxtx.c **** 		for(i=0; i<request_params[0]; i++) {
 620:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 621:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
 622:bluetooth_rxtx.c **** 		}
 623:bluetooth_rxtx.c **** 		break;
 624:bluetooth_rxtx.c **** 
 625:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_ALL_REGISTERS:
 626:bluetooth_rxtx.c **** 		#define MAX_READ_REG 0x2d
 627:bluetooth_rxtx.c **** 		for(i=0; i<=MAX_READ_REG; i++) {
 628:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 629:bluetooth_rxtx.c **** 			data[i*3] = i;
 630:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
 631:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 632:bluetooth_rxtx.c **** 		}
 633:bluetooth_rxtx.c **** 		*data_len = MAX_READ_REG*3;
 634:bluetooth_rxtx.c **** 		break;
 635:bluetooth_rxtx.c **** 
 636:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_GENERIC_PACKET:
 637:bluetooth_rxtx.c **** 		i = 7 + data[6];
 638:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 639:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 640:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_GENERIC;
 641:bluetooth_rxtx.c **** 		*data_len = 0;
 642:bluetooth_rxtx.c **** 		break;
 643:bluetooth_rxtx.c **** 
 644:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE:
 645:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 646:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 647:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 648:bluetooth_rxtx.c **** 		break;
 649:bluetooth_rxtx.c **** 	
 650:bluetooth_rxtx.c **** 	// WJHUR Power control
 651:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P0:
 652:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 653:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 654:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P0;
 655:bluetooth_rxtx.c **** 		break;
 656:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P1:
 657:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 658:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, dlen);
 659:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P1;
 660:bluetooth_rxtx.c **** 		break;
ARM GAS  /tmp/cc1G6faT.s 			page 13


 661:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P2:
 662:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 663:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 664:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P2;
 665:bluetooth_rxtx.c **** 		break;
 666:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P3:
 667:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 668:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 669:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P3;
 670:bluetooth_rxtx.c **** 		break;
 671:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P4:
 672:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 673:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 674:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P4;
 675:bluetooth_rxtx.c **** 		break;
 676:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P5:
 677:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 678:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 679:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P5;
 680:bluetooth_rxtx.c **** 		break;
 681:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P6:
 682:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 683:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 684:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P6;
 685:bluetooth_rxtx.c **** 		break;
 686:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P7:
 687:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 688:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 689:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P7;
 690:bluetooth_rxtx.c **** 		break;
 691:bluetooth_rxtx.c **** 
 692:bluetooth_rxtx.c **** 
 693:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SET_TARGET:
 694:bluetooth_rxtx.c **** 		// Addresses appear in packets in reverse-octet order.
 695:bluetooth_rxtx.c **** 		// Store the target address in reverse order so that we can do a simple memcmp later
 696:bluetooth_rxtx.c **** 		le.target[0] = data[5];
 697:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 698:bluetooth_rxtx.c **** 		le.target[2] = data[3];
 699:bluetooth_rxtx.c **** 		le.target[3] = data[2];
 700:bluetooth_rxtx.c **** 		le.target[4] = data[1];
 701:bluetooth_rxtx.c **** 		le.target[5] = data[0];
 702:bluetooth_rxtx.c **** 		le.target_set = 1;
 703:bluetooth_rxtx.c **** 		break;
 704:bluetooth_rxtx.c **** 
 705:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 706:bluetooth_rxtx.c **** 	case UBERTOOTH_JAM_MODE:
 707:bluetooth_rxtx.c **** 		jam_mode = request_params[0];
 708:bluetooth_rxtx.c **** 		break;
 709:bluetooth_rxtx.c **** #endif
 710:bluetooth_rxtx.c **** 
 711:bluetooth_rxtx.c **** 	case UBERTOOTH_EGO:
 712:bluetooth_rxtx.c **** #ifndef TX_ENABLE
 713:bluetooth_rxtx.c **** 		if (ego_mode == EGO_JAM)
 714:bluetooth_rxtx.c **** 			return 0;
 715:bluetooth_rxtx.c **** #endif
 716:bluetooth_rxtx.c **** 		requested_mode = MODE_EGO;
 717:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
ARM GAS  /tmp/cc1G6faT.s 			page 14


 718:bluetooth_rxtx.c **** 		break;
 719:bluetooth_rxtx.c **** 
 720:bluetooth_rxtx.c **** 	default:
 721:bluetooth_rxtx.c **** 		return 0;
 722:bluetooth_rxtx.c **** 	}
 723:bluetooth_rxtx.c **** 	return 1;
 724:bluetooth_rxtx.c **** }
 725:bluetooth_rxtx.c **** 
 726:bluetooth_rxtx.c **** /* Update CLKN. */
 727:bluetooth_rxtx.c **** void TIMER0_IRQHandler()
 728:bluetooth_rxtx.c **** {
 729:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 730:bluetooth_rxtx.c **** 
 731:bluetooth_rxtx.c **** 		clkn += clkn_offset + 1;
 732:bluetooth_rxtx.c **** 		clkn_offset = 0;
 733:bluetooth_rxtx.c **** 
 734:bluetooth_rxtx.c **** 		uint32_t le_clk = (clkn - le.conn_epoch) & 0x03;
 735:bluetooth_rxtx.c **** 
 736:bluetooth_rxtx.c **** 		/* Trigger hop based on mode */
 737:bluetooth_rxtx.c **** 
 738:bluetooth_rxtx.c **** 		/* NONE or SWEEP -> 25 Hz */
 739:bluetooth_rxtx.c **** 		if (hop_mode == HOP_NONE || hop_mode == HOP_SWEEP) {
 740:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 741:bluetooth_rxtx.c **** 				do_hop = 1;
 742:bluetooth_rxtx.c **** 		}
 743:bluetooth_rxtx.c **** 		/* BLUETOOTH -> 1600 Hz */
 744:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BLUETOOTH) {
 745:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 746:bluetooth_rxtx.c **** 				do_hop = 1;
 747:bluetooth_rxtx.c **** 		}
 748:bluetooth_rxtx.c **** 		/* BLUETOOTH Low Energy -> 7.5ms - 4.0s in multiples of 1.25 ms */
 749:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BTLE) {
 750:bluetooth_rxtx.c **** 			// Only hop if connected
 751:bluetooth_rxtx.c **** 			if (le.link_state == LINK_CONNECTED && le_clk == 0) {
 752:bluetooth_rxtx.c **** 				--le.interval_timer;
 753:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 754:bluetooth_rxtx.c **** 					do_hop = 1;
 755:bluetooth_rxtx.c **** 					++le.conn_count;
 756:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 757:bluetooth_rxtx.c **** 				} else {
 758:bluetooth_rxtx.c **** 					TXLED_CLR; // hack!
 759:bluetooth_rxtx.c **** 				}
 760:bluetooth_rxtx.c **** 			}
 761:bluetooth_rxtx.c **** 		}
 762:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_AFH) {
 763:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
 764:bluetooth_rxtx.c **** 				do_hop = 1;
 765:bluetooth_rxtx.c **** 			}
 766:bluetooth_rxtx.c **** 		}
 767:bluetooth_rxtx.c **** 
 768:bluetooth_rxtx.c **** 		// Fix linear clock drift deviation
 769:bluetooth_rxtx.c **** 		if(clkn_next_drift_fix != 0 && clk100ns_offset == 0) {
 770:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 771:bluetooth_rxtx.c **** 
 772:bluetooth_rxtx.c **** 				// Too fast
 773:bluetooth_rxtx.c **** 				if(clk_drift_ppm >= 0) {
 774:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
ARM GAS  /tmp/cc1G6faT.s 			page 15


 775:bluetooth_rxtx.c **** 				}
 776:bluetooth_rxtx.c **** 
 777:bluetooth_rxtx.c **** 				// Too slow
 778:bluetooth_rxtx.c **** 				else {
 779:bluetooth_rxtx.c **** 					clk100ns_offset = 6249;
 780:bluetooth_rxtx.c **** 				}
 781:bluetooth_rxtx.c **** 				clkn_last_drift_fix = clkn;
 782:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 783:bluetooth_rxtx.c **** 			}
 784:bluetooth_rxtx.c **** 		}
 785:bluetooth_rxtx.c **** 
 786:bluetooth_rxtx.c **** 		// Negative clock correction
 787:bluetooth_rxtx.c **** 		if(clk100ns_offset > 3124)
 788:bluetooth_rxtx.c **** 			clkn += 2;
 789:bluetooth_rxtx.c **** 
 790:bluetooth_rxtx.c **** 		T0MR0 = 3124 + clk100ns_offset;
 791:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
 792:bluetooth_rxtx.c **** 
 793:bluetooth_rxtx.c **** 		/* Ack interrupt */
 794:bluetooth_rxtx.c **** 		T0IR = TIR_MR0_Interrupt;
 795:bluetooth_rxtx.c **** 	}
 796:bluetooth_rxtx.c **** }
 797:bluetooth_rxtx.c **** 
 798:bluetooth_rxtx.c **** /* EINT3 handler is also defined in ubertooth.c for TC13BADGE. */
 799:bluetooth_rxtx.c **** #ifndef TC13BADGE
 800:bluetooth_rxtx.c **** void EINT3_IRQHandler()
 801:bluetooth_rxtx.c **** {
 802:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 803:bluetooth_rxtx.c **** 	IO2IntClr   = PIN_GIO6; // clear interrupt
 804:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 805:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 806:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 807:bluetooth_rxtx.c **** 		dma_discard = 0;
 808:bluetooth_rxtx.c **** 
 809:bluetooth_rxtx.c **** }
 810:bluetooth_rxtx.c **** #endif // TC13BADGE
 811:bluetooth_rxtx.c **** 
 812:bluetooth_rxtx.c **** /*
 813:bluetooth_rxtx.c ****  * Sleep (busy wait) for 'millis' milliseconds
 814:bluetooth_rxtx.c ****  * Needs clkn. Be sure to call clkn_init() before using it.
 815:bluetooth_rxtx.c ****  */
 816:bluetooth_rxtx.c **** static void msleep(uint32_t millis)
 817:bluetooth_rxtx.c **** {
  26              		.loc 1 817 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 0
  29              		@ frame_needed = 0, uses_anonymous_args = 0
  30              	.LVL0:
  31 0000 10B5     		push	{r4, lr}
  32              		.cfi_def_cfa_offset 8
  33              		.cfi_offset 4, -8
  34              		.cfi_offset 14, -4
 818:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
 819:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
  35              		.loc 1 819 0
  36 0002 42F21071 		movw	r1, #10000
 818:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
ARM GAS  /tmp/cc1G6faT.s 			page 16


  37              		.loc 1 818 0
  38 0006 084B     		ldr	r3, .L5
  39              		.loc 1 819 0
  40 0008 4843     		muls	r0, r1, r0
  41              	.LVL1:
 818:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
  42              		.loc 1 818 0
  43 000a 1A68     		ldr	r2, [r3]
  44              	.LVL2:
  45              		.loc 1 819 0
  46 000c 40F63544 		movw	r4, #3125
  47 0010 B0FBF4F1 		udiv	r1, r0, r4
 818:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
  48              		.loc 1 818 0
  49 0014 22F07F42 		bic	r2, r2, #-16777216
  50              	.LVL3:
  51              		.loc 1 819 0
  52 0018 0A44     		add	r2, r2, r1
  53              	.LVL4:
  54              	.L3:
 820:bluetooth_rxtx.c **** 
 821:bluetooth_rxtx.c **** 	// handle clkn overflow
 822:bluetooth_rxtx.c **** 	if (stop_at >= ((uint32_t)1<<28)) {
 823:bluetooth_rxtx.c **** 		stop_at -= ((uint32_t)1<<28);
 824:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) >= now || (clkn & 0xffffff) < stop_at);
 825:bluetooth_rxtx.c **** 	} else {
 826:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) < stop_at);
  55              		.loc 1 826 0 discriminator 1
  56 001a 1968     		ldr	r1, [r3]
  57 001c 21F07F41 		bic	r1, r1, #-16777216
  58 0020 9142     		cmp	r1, r2
  59 0022 FAD3     		bcc	.L3
 827:bluetooth_rxtx.c **** 	}
 828:bluetooth_rxtx.c **** }
  60              		.loc 1 828 0
  61 0024 10BD     		pop	{r4, pc}
  62              	.L6:
  63 0026 00BF     		.align	2
  64              	.L5:
  65 0028 00000000 		.word	clkn
  66              		.cfi_endproc
  67              	.LFE5:
  69              		.section	.text.reverse8,"ax",%progbits
  70              		.align	1
  71              		.thumb
  72              		.thumb_func
  74              	reverse8:
  75              	.LFB15:
 829:bluetooth_rxtx.c **** 
 830:bluetooth_rxtx.c **** void DMA_IRQHandler()
 831:bluetooth_rxtx.c **** {
 832:bluetooth_rxtx.c **** 	if ( mode == MODE_RX_SYMBOLS
 833:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
 834:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 835:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 836:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 837:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
ARM GAS  /tmp/cc1G6faT.s 			page 17


 838:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P0
 839:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P1
 840:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P2
 841:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P3
 842:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P4
 843:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P5
 844:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P6
 845:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P7
 846:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 847:bluetooth_rxtx.c **** 	{
 848:bluetooth_rxtx.c **** 		/* interrupt on channel 0 */
 849:bluetooth_rxtx.c **** 		if (DMACIntStat & (1 << 0)) {
 850:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 851:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 852:bluetooth_rxtx.c **** 
 853:bluetooth_rxtx.c **** 				if (hop_mode == HOP_BLUETOOTH)
 854:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 855:bluetooth_rxtx.c **** 
 856:bluetooth_rxtx.c **** 				idle_buf_clk100ns  = CLK100NS;
 857:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 858:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 859:bluetooth_rxtx.c **** 
 860:bluetooth_rxtx.c **** 				/* Keep buffer swapping in sync with DMA. */
 861:bluetooth_rxtx.c **** 				volatile uint8_t* tmp = active_rxbuf;
 862:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 863:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 864:bluetooth_rxtx.c **** 
 865:bluetooth_rxtx.c **** 				++rx_tc;
 866:bluetooth_rxtx.c **** 			}
 867:bluetooth_rxtx.c **** 			if (DMACIntErrStat & (1 << 0)) {
 868:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 869:bluetooth_rxtx.c **** 				++rx_err;
 870:bluetooth_rxtx.c **** 			}
 871:bluetooth_rxtx.c **** 		}
 872:bluetooth_rxtx.c **** 	}
 873:bluetooth_rxtx.c **** }
 874:bluetooth_rxtx.c **** 
 875:bluetooth_rxtx.c **** static void cc2400_idle()
 876:bluetooth_rxtx.c **** {
 877:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 878:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 879:bluetooth_rxtx.c **** 
 880:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 881:bluetooth_rxtx.c **** 	PAEN_CLR;
 882:bluetooth_rxtx.c **** 	HGM_CLR;
 883:bluetooth_rxtx.c **** #endif
 884:bluetooth_rxtx.c **** 
 885:bluetooth_rxtx.c **** 	RXLED_CLR;
 886:bluetooth_rxtx.c **** 	TXLED_CLR;
 887:bluetooth_rxtx.c **** 	USRLED_CLR;
 888:bluetooth_rxtx.c **** 
 889:bluetooth_rxtx.c **** 	clkn_stop();
 890:bluetooth_rxtx.c **** 	dio_ssp_stop();
 891:bluetooth_rxtx.c **** 	cs_reset();
 892:bluetooth_rxtx.c **** 	rssi_reset();
 893:bluetooth_rxtx.c **** 
 894:bluetooth_rxtx.c **** 	/* hopping stuff */
ARM GAS  /tmp/cc1G6faT.s 			page 18


 895:bluetooth_rxtx.c **** 	hop_mode = HOP_NONE;
 896:bluetooth_rxtx.c **** 	do_hop = 0;
 897:bluetooth_rxtx.c **** 	channel = 2441;
 898:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 899:bluetooth_rxtx.c **** 	hop_timeout = 158;
 900:bluetooth_rxtx.c **** 	requested_channel = 0;
 901:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
 902:bluetooth_rxtx.c **** 
 903:bluetooth_rxtx.c **** 
 904:bluetooth_rxtx.c **** 	/* bulk USB stuff */
 905:bluetooth_rxtx.c **** 	idle_buf_clkn_high = 0;
 906:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 907:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 908:bluetooth_rxtx.c **** 	dma_discard = 0;
 909:bluetooth_rxtx.c **** 	status = 0;
 910:bluetooth_rxtx.c **** 
 911:bluetooth_rxtx.c **** 	/* operation mode */
 912:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 913:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 914:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 915:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 916:bluetooth_rxtx.c **** 
 917:bluetooth_rxtx.c **** 	modulation = MOD_BT_BASIC_RATE;
 918:bluetooth_rxtx.c **** 
 919:bluetooth_rxtx.c **** 	/* specan stuff */
 920:bluetooth_rxtx.c **** 	low_freq = 2400;
 921:bluetooth_rxtx.c **** 	high_freq = 2483;
 922:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 923:bluetooth_rxtx.c **** 
 924:bluetooth_rxtx.c **** 	target.address = 0;
 925:bluetooth_rxtx.c **** 	target.syncword = 0;
 926:bluetooth_rxtx.c **** }
 927:bluetooth_rxtx.c **** 
 928:bluetooth_rxtx.c **** /* start un-buffered rx */
 929:bluetooth_rxtx.c **** static void cc2400_rx()
 930:bluetooth_rxtx.c **** {
 931:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
 932:bluetooth_rxtx.c **** 
 933:bluetooth_rxtx.c **** 	if((modulation == MOD_BT_BASIC_RATE) || (modulation == MOD_BT_LOW_ENERGY)) {
 934:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
 935:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
 936:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
 937:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
 938:bluetooth_rxtx.c **** 		}
 939:bluetooth_rxtx.c **** 		cc2400_set(MANAND,  0x7fff);
 940:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
 941:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG
 942:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 943:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
 944:bluetooth_rxtx.c **** 		//      |  | |   |  +--------> CRC off
 945:bluetooth_rxtx.c **** 		//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
 946:bluetooth_rxtx.c **** 		//      |  | +---------------> 2 preamble bytes of 01010101
 947:bluetooth_rxtx.c **** 		//      |  +-----------------> not packet mode
 948:bluetooth_rxtx.c **** 			//      +--------------------> un-buffered mode
 949:bluetooth_rxtx.c **** 		cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
 950:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
 951:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/cc1G6faT.s 			page 19


 952:bluetooth_rxtx.c **** 
 953:bluetooth_rxtx.c **** 	// Set up CS register
 954:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
 955:bluetooth_rxtx.c **** 
 956:bluetooth_rxtx.c **** 	clkn_start();
 957:bluetooth_rxtx.c **** 
 958:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 959:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 960:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 961:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 962:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 963:bluetooth_rxtx.c **** 	PAEN_SET;
 964:bluetooth_rxtx.c **** 	HGM_SET;
 965:bluetooth_rxtx.c **** #endif
 966:bluetooth_rxtx.c **** }
 967:bluetooth_rxtx.c **** 
 968:bluetooth_rxtx.c **** /* start un-buffered rx */
 969:bluetooth_rxtx.c **** static void cc2400_rx_sync(u32 sync)
 970:bluetooth_rxtx.c **** {
 971:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 972:bluetooth_rxtx.c **** 
 973:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
 974:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 975:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
 976:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
 977:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
 978:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
 979:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 0 preamble bytes of 01010101
 980:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
 981:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
 982:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
 983:bluetooth_rxtx.c **** 
 984:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 985:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 986:bluetooth_rxtx.c **** 		grmdm = 0x0561; // un-buffered mode, packet w/ sync word detection
 987:bluetooth_rxtx.c **** 		// 0 00 00 1 010 11 0 00 0 1
 988:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
 989:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
 990:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 2 preamble bytes of 01010101
 991:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
 992:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
 993:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
 994:bluetooth_rxtx.c **** 
 995:bluetooth_rxtx.c **** 	} else {
 996:bluetooth_rxtx.c **** 		/* oops */
 997:bluetooth_rxtx.c **** 		return;
 998:bluetooth_rxtx.c **** 	}
 999:bluetooth_rxtx.c **** 
1000:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1001:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
1002:bluetooth_rxtx.c **** 
1003:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x124b);
1004:bluetooth_rxtx.c **** 	// 1      2      4b
1005:bluetooth_rxtx.c **** 	// 00 0 1 0 0 10 01001011
1006:bluetooth_rxtx.c **** 	//    | | | | |  +---------> AFC_DELTA = ??
1007:bluetooth_rxtx.c **** 	//    | | | | +------------> AFC settling = 4 pairs (8 bit preamble)
1008:bluetooth_rxtx.c **** 	//    | | | +--------------> no AFC adjust on packet
ARM GAS  /tmp/cc1G6faT.s 			page 20


1009:bluetooth_rxtx.c **** 	//    | | +----------------> do not invert data
1010:bluetooth_rxtx.c **** 	//    | +------------------> TX IF freq 1 0Hz
1011:bluetooth_rxtx.c **** 	//    +--------------------> PRNG off
1012:bluetooth_rxtx.c **** 	//
1013:bluetooth_rxtx.c **** 	// ref: CC2400 datasheet page 67
1014:bluetooth_rxtx.c **** 	// AFC settling explained page 41/42
1015:bluetooth_rxtx.c **** 
1016:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   grmdm);
1017:bluetooth_rxtx.c **** 
1018:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1019:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1020:bluetooth_rxtx.c **** 
1021:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
1022:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
1023:bluetooth_rxtx.c **** 
1024:bluetooth_rxtx.c **** 	// Set up CS register
1025:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
1026:bluetooth_rxtx.c **** 
1027:bluetooth_rxtx.c **** 	clkn_start();
1028:bluetooth_rxtx.c **** 
1029:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1030:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1031:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1032:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
1033:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1034:bluetooth_rxtx.c **** 	PAEN_SET;
1035:bluetooth_rxtx.c **** 	HGM_SET;
1036:bluetooth_rxtx.c **** #endif
1037:bluetooth_rxtx.c **** }
1038:bluetooth_rxtx.c **** 
1039:bluetooth_rxtx.c **** /* start buffered tx */
1040:bluetooth_rxtx.c **** static void cc2400_tx_sync(uint32_t sync)
1041:bluetooth_rxtx.c **** {
1042:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1043:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1044:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1045:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1046:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
1047:bluetooth_rxtx.c **** 
1048:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1049:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1050:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1051:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1052:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1053:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1054:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1055:bluetooth_rxtx.c **** 
1056:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1057:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1058:bluetooth_rxtx.c **** 
1059:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel);
1060:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1061:bluetooth_rxtx.c **** 
1062:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
1063:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
1064:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
1065:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
ARM GAS  /tmp/cc1G6faT.s 			page 21


1066:bluetooth_rxtx.c **** 	} else {
1067:bluetooth_rxtx.c **** 		/* oops */
1068:bluetooth_rxtx.c **** 		return;
1069:bluetooth_rxtx.c **** 	}
1070:bluetooth_rxtx.c **** 
1071:bluetooth_rxtx.c **** 	clkn_start();
1072:bluetooth_rxtx.c **** 
1073:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1074:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1075:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1076:bluetooth_rxtx.c **** 
1077:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1078:bluetooth_rxtx.c **** 	PAEN_SET;
1079:bluetooth_rxtx.c **** #endif
1080:bluetooth_rxtx.c **** 
1081:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1082:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1083:bluetooth_rxtx.c **** 
1084:bluetooth_rxtx.c **** #endif
1085:bluetooth_rxtx.c **** }
1086:bluetooth_rxtx.c **** 
1087:bluetooth_rxtx.c **** /*
1088:bluetooth_rxtx.c ****  * Transmit a BTLE packet with the specified access address.
1089:bluetooth_rxtx.c ****  *
1090:bluetooth_rxtx.c ****  * All modulation parameters are set within this function. The data
1091:bluetooth_rxtx.c ****  * should not be pre-whitened, but the CRC should be calculated and
1092:bluetooth_rxtx.c ****  * included in the data length.
1093:bluetooth_rxtx.c ****  */
1094:bluetooth_rxtx.c **** void le_transmit(u32 aa, u8 len, u8 *data, u16 tx_pwr, u16 ch)
1095:bluetooth_rxtx.c **** {
1096:bluetooth_rxtx.c **** 	unsigned i, j;
1097:bluetooth_rxtx.c **** 	int bit;
1098:bluetooth_rxtx.c **** 	uint16_t jw_channel = 2402;
1099:bluetooth_rxtx.c **** 	jw_channel = ch;
1100:bluetooth_rxtx.c **** 	u8 txbuf[64];
1101:bluetooth_rxtx.c **** 	u8 tx_len;
1102:bluetooth_rxtx.c **** 	u8 byte;
1103:bluetooth_rxtx.c **** 	u16 gio_save;
1104:bluetooth_rxtx.c **** 	//JWHUR tx power control
1105:bluetooth_rxtx.c **** 	tx_pwr = (tx_pwr & 0x000f);
1106:bluetooth_rxtx.c **** 
1107:bluetooth_rxtx.c **** 	// first four bytes: AA
1108:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
1109:bluetooth_rxtx.c **** 		byte = aa & 0xff;
1110:bluetooth_rxtx.c **** 		aa >>= 8;
1111:bluetooth_rxtx.c **** 		txbuf[i] = 0;
1112:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
1113:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
1114:bluetooth_rxtx.c **** 			byte >>= 1;
1115:bluetooth_rxtx.c **** 		}
1116:bluetooth_rxtx.c **** 	}
1117:bluetooth_rxtx.c **** 
1118:bluetooth_rxtx.c **** 	// whiten the data and copy it into the txbuf
1119:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(jw_channel-2402)];
1120:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
1121:bluetooth_rxtx.c **** 		byte = data[i];
1122:bluetooth_rxtx.c **** 		txbuf[i+4] = 0;
ARM GAS  /tmp/cc1G6faT.s 			page 22


1123:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
1124:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
1125:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
1126:bluetooth_rxtx.c **** 			byte >>= 1;
1127:bluetooth_rxtx.c **** 			txbuf[i+4] |= bit << (7 - j);
1128:bluetooth_rxtx.c **** 		}
1129:bluetooth_rxtx.c **** 	}
1130:bluetooth_rxtx.c **** 
1131:bluetooth_rxtx.c **** 	len += 4; // include the AA in len
1132:bluetooth_rxtx.c **** 
1133:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1134:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1135:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1136:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
1137:bluetooth_rxtx.c **** 
1138:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1139:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1140:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1141:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1142:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1143:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1144:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1145:bluetooth_rxtx.c **** 
1146:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   jw_channel);
1147:bluetooth_rxtx.c **** 	// JWHUR cc2400 data sheet about power control
1148:bluetooth_rxtx.c **** 	// lsb 3 bit : dbm
1149:bluetooth_rxtx.c **** 	// 000 : -25
1150:bluetooth_rxtx.c **** 	// 001 : -15
1151:bluetooth_rxtx.c **** 	// 010 : -10
1152:bluetooth_rxtx.c **** 	// 011 : -7
1153:bluetooth_rxtx.c **** 	// 100 : -4.6
1154:bluetooth_rxtx.c **** 	// 101 : -2.8
1155:bluetooth_rxtx.c **** 	// 110 : -1.3
1156:bluetooth_rxtx.c **** 	// 111 : 0
1157:bluetooth_rxtx.c **** 	cc2400_set(FREND, tx_pwr);
1158:bluetooth_rxtx.c **** 	//cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1159:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1160:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1161:bluetooth_rxtx.c **** 
1162:bluetooth_rxtx.c **** 	// sync byte depends on the first transmitted bit of the AA
1163:bluetooth_rxtx.c **** 	if (aa & 1)
1164:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0xaaaa);
1165:bluetooth_rxtx.c **** 	else
1166:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0x5555);
1167:bluetooth_rxtx.c **** 
1168:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1169:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
1170:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
1171:bluetooth_rxtx.c **** 
1172:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1173:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1174:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1175:bluetooth_rxtx.c **** 	TXLED_SET;
1176:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1177:bluetooth_rxtx.c **** 	PAEN_SET;
1178:bluetooth_rxtx.c **** #endif
1179:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
ARM GAS  /tmp/cc1G6faT.s 			page 23


1180:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1181:bluetooth_rxtx.c **** 
1182:bluetooth_rxtx.c **** 	// put the packet into the FIFO
1183:bluetooth_rxtx.c **** 	/*
1184:bluetooth_rxtx.c **** 	for (i = 0; i < len; i += 16) {
1185:bluetooth_rxtx.c **** 		while (GIO6) ; // wait for the FIFO to drain (FIFO_FULL false)
1186:bluetooth_rxtx.c **** 		tx_len = len - i;
1187:bluetooth_rxtx.c **** 		if (tx_len >16)
1188:bluetooth_rxtx.c **** 			tx_len = 16;
1189:bluetooth_rxtx.c **** 		cc2400_fifo_write(tx_len, txbuf + i);
1190:bluetooth_rxtx.c **** 	}*/
1191:bluetooth_rxtx.c **** 
1192:bluetooth_rxtx.c **** 	//JWHUR cc2400 fifo write
1193:bluetooth_rxtx.c **** 	while (GIO6) ;
1194:bluetooth_rxtx.c **** 	cc2400_fifo_write(len, txbuf);
1195:bluetooth_rxtx.c **** 
1196:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1197:bluetooth_rxtx.c **** 	TXLED_CLR;
1198:bluetooth_rxtx.c **** 
1199:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1200:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
1201:bluetooth_rxtx.c **** 
1202:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1203:bluetooth_rxtx.c **** 	PAEN_CLR;
1204:bluetooth_rxtx.c **** #endif
1205:bluetooth_rxtx.c **** 
1206:bluetooth_rxtx.c **** 	// reset GIO
1207:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
1208:bluetooth_rxtx.c **** }
1209:bluetooth_rxtx.c **** 
1210:bluetooth_rxtx.c **** void le_jam(void) {
1211:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1212:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1213:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1214:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
1215:bluetooth_rxtx.c **** 
1216:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1217:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1218:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1219:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1220:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1221:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1222:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1223:bluetooth_rxtx.c **** 
1224:bluetooth_rxtx.c **** 	// cc2400_set(FSDIV,   channel);
1225:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1226:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1227:bluetooth_rxtx.c **** 
1228:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1229:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1230:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1231:bluetooth_rxtx.c **** 	TXLED_SET;
1232:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1233:bluetooth_rxtx.c **** 	PAEN_SET;
1234:bluetooth_rxtx.c **** #endif
1235:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1236:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
ARM GAS  /tmp/cc1G6faT.s 			page 24


1237:bluetooth_rxtx.c **** #endif
1238:bluetooth_rxtx.c **** }
1239:bluetooth_rxtx.c **** 
1240:bluetooth_rxtx.c **** /* TODO - return whether hop happened, or should caller have to keep
1241:bluetooth_rxtx.c ****  * track of this? */
1242:bluetooth_rxtx.c **** void hop(void)
1243:bluetooth_rxtx.c **** {
1244:bluetooth_rxtx.c **** 	do_hop = 0;
1245:bluetooth_rxtx.c **** 	last_hop = clkn;
1246:bluetooth_rxtx.c **** 
1247:bluetooth_rxtx.c **** 	// No hopping, if channel is set correctly, do nothing
1248:bluetooth_rxtx.c **** 	if (hop_mode == HOP_NONE) {
1249:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
1250:bluetooth_rxtx.c **** 			return;
1251:bluetooth_rxtx.c **** 	}
1252:bluetooth_rxtx.c **** 	/* Slow sweep (100 hops/sec)
1253:bluetooth_rxtx.c **** 	 * only hop to currently used channels if AFH is enabled
1254:bluetooth_rxtx.c **** 	 */
1255:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_SWEEP) {
1256:bluetooth_rxtx.c **** 		do {
1257:bluetooth_rxtx.c **** 			channel += 32;
1258:bluetooth_rxtx.c **** 			if (channel > 2480)
1259:bluetooth_rxtx.c **** 				channel -= 79;
1260:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
1261:bluetooth_rxtx.c **** 	}
1262:bluetooth_rxtx.c **** 
1263:bluetooth_rxtx.c **** 	/* AFH detection
1264:bluetooth_rxtx.c **** 	 * only hop to currently unused channesl
1265:bluetooth_rxtx.c **** 	 */
1266:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_AFH) {
1267:bluetooth_rxtx.c **** 		do {
1268:bluetooth_rxtx.c **** 			channel += 32;
1269:bluetooth_rxtx.c **** 			if (channel > 2480)
1270:bluetooth_rxtx.c **** 				channel -= 79;
1271:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
1272:bluetooth_rxtx.c **** 	}
1273:bluetooth_rxtx.c **** 
1274:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BLUETOOTH) {
1275:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
1276:bluetooth_rxtx.c **** 	}
1277:bluetooth_rxtx.c **** 
1278:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BTLE) {
1279:bluetooth_rxtx.c **** 		channel = btle_next_hop(&le);
1280:bluetooth_rxtx.c **** 	}
1281:bluetooth_rxtx.c **** 
1282:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_DIRECT) {
1283:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
1284:bluetooth_rxtx.c **** 	}
1285:bluetooth_rxtx.c **** 	/* IDLE mode, but leave amp on, so don't call cc2400_idle(). */
1286:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1287:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1288:bluetooth_rxtx.c **** 
1289:bluetooth_rxtx.c **** 	/* Retune */
1290:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1291:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
1292:bluetooth_rxtx.c **** 	else
1293:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel - 1);
ARM GAS  /tmp/cc1G6faT.s 			page 25


1294:bluetooth_rxtx.c **** 
1295:bluetooth_rxtx.c **** 	/* Update CS register if hopping.  */
1296:bluetooth_rxtx.c **** 	if (hop_mode > 0) {
1297:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
1298:bluetooth_rxtx.c **** 	}
1299:bluetooth_rxtx.c **** 
1300:bluetooth_rxtx.c **** 	/* Wait for lock */
1301:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1302:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1303:bluetooth_rxtx.c **** 
1304:bluetooth_rxtx.c **** 	dma_discard = 1;
1305:bluetooth_rxtx.c **** 
1306:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1307:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1308:bluetooth_rxtx.c **** 	else
1309:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
1310:bluetooth_rxtx.c **** }
1311:bluetooth_rxtx.c **** 
1312:bluetooth_rxtx.c **** /* Bluetooth packet monitoring */
1313:bluetooth_rxtx.c **** void bt_stream_rx()
1314:bluetooth_rxtx.c **** {
1315:bluetooth_rxtx.c **** 	int8_t rssi;
1316:bluetooth_rxtx.c **** 	int8_t rssi_at_trigger;
1317:bluetooth_rxtx.c **** 
1318:bluetooth_rxtx.c **** 	RXLED_CLR;
1319:bluetooth_rxtx.c **** 
1320:bluetooth_rxtx.c **** 	queue_init();
1321:bluetooth_rxtx.c **** 	dio_ssp_init();
1322:bluetooth_rxtx.c **** 	dma_init();
1323:bluetooth_rxtx.c **** 	dio_ssp_start();
1324:bluetooth_rxtx.c **** 
1325:bluetooth_rxtx.c **** 	cc2400_rx();
1326:bluetooth_rxtx.c **** 
1327:bluetooth_rxtx.c **** 	cs_trigger_enable();
1328:bluetooth_rxtx.c **** 
1329:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_RX_SYMBOLS || requested_mode == MODE_BT_FOLLOW )
1330:bluetooth_rxtx.c **** 	{
1331:bluetooth_rxtx.c **** 
1332:bluetooth_rxtx.c **** 		RXLED_CLR;
1333:bluetooth_rxtx.c **** 
1334:bluetooth_rxtx.c **** 		/* Wait for DMA transfer. TODO - need more work on
1335:bluetooth_rxtx.c **** 		 * RSSI. Should send RSSI indications to host even
1336:bluetooth_rxtx.c **** 		 * when not transferring data. That would also keep
1337:bluetooth_rxtx.c **** 		 * the USB stream going. This loop runs 50-80 times
1338:bluetooth_rxtx.c **** 		 * while waiting for DMA, but RSSI sampling does not
1339:bluetooth_rxtx.c **** 		 * cover all the symbols in a DMA transfer. Can not do
1340:bluetooth_rxtx.c **** 		 * RSSI sampling in CS interrupt, but could log time
1341:bluetooth_rxtx.c **** 		 * at multiple trigger points there. The MAX() below
1342:bluetooth_rxtx.c **** 		 * helps with statistics in the case that cs_trigger
1343:bluetooth_rxtx.c **** 		 * happened before the loop started. */
1344:bluetooth_rxtx.c **** 		rssi_reset();
1345:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
1346:bluetooth_rxtx.c **** 		while (!rx_tc) {
1347:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1348:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1349:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1350:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
ARM GAS  /tmp/cc1G6faT.s 			page 26


1351:bluetooth_rxtx.c **** 			}
1352:bluetooth_rxtx.c **** 			rssi_add(rssi);
1353:bluetooth_rxtx.c **** 
1354:bluetooth_rxtx.c **** 			handle_usb(clkn);
1355:bluetooth_rxtx.c **** 
1356:bluetooth_rxtx.c **** 			/* If timer says time to hop, do it. */
1357:bluetooth_rxtx.c **** 			if (do_hop) {
1358:bluetooth_rxtx.c **** 				hop();
1359:bluetooth_rxtx.c **** 			} else {
1360:bluetooth_rxtx.c **** 				TXLED_CLR;
1361:bluetooth_rxtx.c **** 			}
1362:bluetooth_rxtx.c **** 			/* TODO - set per-channel carrier sense threshold.
1363:bluetooth_rxtx.c **** 			 * Set by firmware or host. */
1364:bluetooth_rxtx.c **** 		}
1365:bluetooth_rxtx.c **** 
1366:bluetooth_rxtx.c **** 		RXLED_SET;
1367:bluetooth_rxtx.c **** 
1368:bluetooth_rxtx.c **** 		if (rx_err) {
1369:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1370:bluetooth_rxtx.c **** 		}
1371:bluetooth_rxtx.c **** 
1372:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1373:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1374:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1375:bluetooth_rxtx.c **** 
1376:bluetooth_rxtx.c **** 		if (dma_discard) {
1377:bluetooth_rxtx.c **** 			status |= DISCARD;
1378:bluetooth_rxtx.c **** 			dma_discard = 0;
1379:bluetooth_rxtx.c **** 		}
1380:bluetooth_rxtx.c **** 
1381:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1382:bluetooth_rxtx.c **** 
1383:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1384:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1385:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1386:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1387:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1388:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1389:bluetooth_rxtx.c **** 			cs_trigger = 0;
1390:bluetooth_rxtx.c **** 		}
1391:bluetooth_rxtx.c **** 
1392:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1393:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1394:bluetooth_rxtx.c **** 		}
1395:bluetooth_rxtx.c **** 
1396:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, (uint8_t*)idle_rxbuf);
1397:bluetooth_rxtx.c **** 
1398:bluetooth_rxtx.c **** 		handle_usb(clkn);
1399:bluetooth_rxtx.c **** 		rx_tc = 0;
1400:bluetooth_rxtx.c **** 		rx_err = 0;
1401:bluetooth_rxtx.c **** 	}
1402:bluetooth_rxtx.c **** 
1403:bluetooth_rxtx.c **** 	/* This call is a nop so far. Since bt_rx_stream() starts the
1404:bluetooth_rxtx.c **** 	 * stream, it makes sense that it would stop it. TODO - how
1405:bluetooth_rxtx.c **** 	 * should setup/teardown be handled? Should every new mode be
1406:bluetooth_rxtx.c **** 	 * starting from scratch? */
1407:bluetooth_rxtx.c **** 	dio_ssp_stop();
ARM GAS  /tmp/cc1G6faT.s 			page 27


1408:bluetooth_rxtx.c **** 	cs_trigger_disable();
1409:bluetooth_rxtx.c **** }
1410:bluetooth_rxtx.c **** 
1411:bluetooth_rxtx.c **** static uint8_t reverse8(uint8_t data)
1412:bluetooth_rxtx.c **** {
  76              		.loc 1 1412 0
  77              		.cfi_startproc
  78              		@ args = 0, pretend = 0, frame = 0
  79              		@ frame_needed = 0, uses_anonymous_args = 0
  80              	.LVL5:
  81 0000 10B5     		push	{r4, lr}
  82              		.cfi_def_cfa_offset 8
  83              		.cfi_offset 4, -8
  84              		.cfi_offset 14, -4
  85              	.LVL6:
  86              	.LBB4:
1413:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
1414:bluetooth_rxtx.c **** 
1415:bluetooth_rxtx.c **** 	for(size_t i=0; i<8; i++)
  87              		.loc 1 1415 0
  88 0002 0023     		movs	r3, #0
  89              	.LBE4:
1413:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
  90              		.loc 1 1413 0
  91 0004 1A46     		mov	r2, r3
  92              	.LVL7:
  93              	.L9:
  94              	.LBB5:
1416:bluetooth_rxtx.c **** 	{
1417:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (7-i);
  95              		.loc 1 1417 0 discriminator 2
  96 0006 40FA03F1 		asr	r1, r0, r3
  97 000a C3F10704 		rsb	r4, r3, #7
  98 000e 01F00101 		and	r1, r1, #1
  99 0012 A140     		lsls	r1, r1, r4
1415:bluetooth_rxtx.c **** 	{
 100              		.loc 1 1415 0 discriminator 2
 101 0014 0133     		adds	r3, r3, #1
 102              	.LVL8:
 103              		.loc 1 1417 0 discriminator 2
 104 0016 0A43     		orrs	r2, r2, r1
 105              	.LVL9:
1415:bluetooth_rxtx.c **** 	{
 106              		.loc 1 1415 0 discriminator 2
 107 0018 082B     		cmp	r3, #8
 108              		.loc 1 1417 0 discriminator 2
 109 001a D2B2     		uxtb	r2, r2
 110              	.LVL10:
1415:bluetooth_rxtx.c **** 	{
 111              		.loc 1 1415 0 discriminator 2
 112 001c F3D1     		bne	.L9
 113              	.LBE5:
1418:bluetooth_rxtx.c **** 	}
1419:bluetooth_rxtx.c **** 
1420:bluetooth_rxtx.c **** 	return reversed;
1421:bluetooth_rxtx.c **** }
 114              		.loc 1 1421 0
ARM GAS  /tmp/cc1G6faT.s 			page 28


 115 001e 1046     		mov	r0, r2
 116              	.LVL11:
 117 0020 10BD     		pop	{r4, pc}
 118              		.cfi_endproc
 119              	.LFE15:
 121              		.section	.text.cc2400_rx,"ax",%progbits
 122              		.align	1
 123              		.thumb
 124              		.thumb_func
 126              	cc2400_rx:
 127              	.LFB8:
 930:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
 128              		.loc 1 930 0
 129              		.cfi_startproc
 130              		@ args = 0, pretend = 0, frame = 0
 131              		@ frame_needed = 0, uses_anonymous_args = 0
 132 0000 38B5     		push	{r3, r4, r5, lr}
 133              		.cfi_def_cfa_offset 16
 134              		.cfi_offset 3, -16
 135              		.cfi_offset 4, -12
 136              		.cfi_offset 5, -8
 137              		.cfi_offset 14, -4
 138              	.LVL12:
 933:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
 139              		.loc 1 933 0
 140 0002 254B     		ldr	r3, .L24
 141 0004 254C     		ldr	r4, .L24+4
 142 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 143 0008 12B1     		cbz	r2, .L12
 933:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
 144              		.loc 1 933 0 is_stmt 0 discriminator 1
 145 000a 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 146 000c 012A     		cmp	r2, #1
 147 000e 28D1     		bne	.L13
 148              	.L12:
 934:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
 149              		.loc 1 934 0 is_stmt 1
 150 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 151 0012 33B1     		cbz	r3, .L19
 936:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
 152              		.loc 1 936 0
 153 0014 204B     		ldr	r3, .L24
 154 0016 1D78     		ldrb	r5, [r3]	@ zero_extendqisi2
 931:bluetooth_rxtx.c **** 
 155              		.loc 1 931 0
 156 0018 012D     		cmp	r5, #1
 157 001a 0CBF     		ite	eq
 158 001c 4025     		moveq	r5, #64
 159 001e 0025     		movne	r5, #0
 160 0020 00E0     		b	.L14
 161              	.L19:
 935:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
 162              		.loc 1 935 0
 163 0022 2925     		movs	r5, #41
 164              	.L14:
 165              	.LVL13:
 939:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
ARM GAS  /tmp/cc1G6faT.s 			page 29


 166              		.loc 1 939 0
 167 0024 0D20     		movs	r0, #13
 168 0026 47F6FF71 		movw	r1, #32767
 169 002a FFF7FEFF 		bl	cc2400_set
 170              	.LVL14:
 940:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG
 171              		.loc 1 940 0
 172 002e 1220     		movs	r0, #18
 173 0030 42F62231 		movw	r1, #11042
 174 0034 FFF7FEFF 		bl	cc2400_set
 175              	.LVL15:
 941:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 176              		.loc 1 941 0
 177 0038 1420     		movs	r0, #20
 178 003a 41F24B31 		movw	r1, #4939
 179 003e FFF7FEFF 		bl	cc2400_set
 180              	.LVL16:
 942:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
 181              		.loc 1 942 0
 182 0042 2020     		movs	r0, #32
 183 0044 40F20111 		movw	r1, #257
 184 0048 FFF7FEFF 		bl	cc2400_set
 185              	.LVL17:
 949:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
 186              		.loc 1 949 0
 187 004c 2188     		ldrh	r1, [r4]
 188 004e 0220     		movs	r0, #2
 189 0050 89B2     		uxth	r1, r1
 190 0052 0139     		subs	r1, r1, #1
 191 0054 89B2     		uxth	r1, r1
 192 0056 FFF7FEFF 		bl	cc2400_set
 193              	.LVL18:
 950:bluetooth_rxtx.c **** 	}
 194              		.loc 1 950 0
 195 005a 0320     		movs	r0, #3
 196 005c 2946     		mov	r1, r5
 197 005e FFF7FEFF 		bl	cc2400_set
 198              	.LVL19:
 199              	.L13:
 954:bluetooth_rxtx.c **** 
 200              		.loc 1 954 0
 201 0062 2088     		ldrh	r0, [r4]
 202 0064 80B2     		uxth	r0, r0
 203 0066 FFF7FEFF 		bl	cs_threshold_calc_and_set
 204              	.LVL20:
 956:bluetooth_rxtx.c **** 
 205              		.loc 1 956 0
 206 006a FFF7FEFF 		bl	clkn_start
 207              	.LVL21:
 208              	.L16:
 958:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 209              		.loc 1 958 0 discriminator 1
 210 006e FFF7FEFF 		bl	cc2400_status
 211              	.LVL22:
 212 0072 4206     		lsls	r2, r0, #25
 213 0074 FBD5     		bpl	.L16
 959:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
ARM GAS  /tmp/cc1G6faT.s 			page 30


 214              		.loc 1 959 0
 215 0076 6120     		movs	r0, #97
 216 0078 FFF7FEFF 		bl	cc2400_strobe
 217              	.LVL23:
 218              	.L18:
 960:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 219              		.loc 1 960 0 discriminator 1
 220 007c FFF7FEFF 		bl	cc2400_status
 221              	.LVL24:
 222 0080 4307     		lsls	r3, r0, #29
 223 0082 FBD5     		bpl	.L18
 961:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 224              		.loc 1 961 0
 225 0084 6220     		movs	r0, #98
 226 0086 FFF7FEFF 		bl	cc2400_strobe
 227              	.LVL25:
 963:bluetooth_rxtx.c **** 	HGM_SET;
 228              		.loc 1 963 0
 229 008a 054B     		ldr	r3, .L24+8
 230 008c 8022     		movs	r2, #128
 231 008e 1A60     		str	r2, [r3]
 964:bluetooth_rxtx.c **** #endif
 232              		.loc 1 964 0
 233 0090 4FF48072 		mov	r2, #256
 234 0094 1A60     		str	r2, [r3]
 235 0096 38BD     		pop	{r3, r4, r5, pc}
 236              	.L25:
 237              		.align	2
 238              	.L24:
 239 0098 00000000 		.word	.LANCHOR0
 240 009c 00000000 		.word	.LANCHOR1
 241 00a0 58C00920 		.word	537509976
 242              		.cfi_endproc
 243              	.LFE8:
 245              		.section	.text.cc2400_rx_sync,"ax",%progbits
 246              		.align	1
 247              		.thumb
 248              		.thumb_func
 250              	cc2400_rx_sync:
 251              	.LFB9:
 970:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 252              		.loc 1 970 0
 253              		.cfi_startproc
 254              		@ args = 0, pretend = 0, frame = 0
 255              		@ frame_needed = 0, uses_anonymous_args = 0
 256              	.LVL26:
 257 0000 70B5     		push	{r4, r5, r6, lr}
 258              		.cfi_def_cfa_offset 16
 259              		.cfi_offset 4, -16
 260              		.cfi_offset 5, -12
 261              		.cfi_offset 6, -8
 262              		.cfi_offset 14, -4
 973:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 263              		.loc 1 973 0
 264 0002 284B     		ldr	r3, .L34
 970:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 265              		.loc 1 970 0
ARM GAS  /tmp/cc1G6faT.s 			page 31


 266 0004 0446     		mov	r4, r0
 973:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 267              		.loc 1 973 0
 268 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 269 0008 32B1     		cbz	r2, .L33
 984:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 270              		.loc 1 984 0
 271 000a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 272 000c 012B     		cmp	r3, #1
 273 000e 47D1     		bne	.L26
 985:bluetooth_rxtx.c **** 		grmdm = 0x0561; // un-buffered mode, packet w/ sync word detection
 274              		.loc 1 985 0
 275 0010 4025     		movs	r5, #64
 986:bluetooth_rxtx.c **** 		// 0 00 00 1 010 11 0 00 0 1
 276              		.loc 1 986 0
 277 0012 40F26156 		movw	r6, #1377
 278 0016 02E0     		b	.L27
 279              	.L33:
 974:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
 280              		.loc 1 974 0
 281 0018 2925     		movs	r5, #41
 975:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
 282              		.loc 1 975 0
 283 001a 40F26146 		movw	r6, #1121
 284              	.L27:
 285              	.LVL27:
1000:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 286              		.loc 1 1000 0
 287 001e 0D20     		movs	r0, #13
 288              	.LVL28:
 289 0020 47F6FF71 		movw	r1, #32767
 290 0024 FFF7FEFF 		bl	cc2400_set
 291              	.LVL29:
1001:bluetooth_rxtx.c **** 
 292              		.loc 1 1001 0
 293 0028 1220     		movs	r0, #18
 294 002a 42F62231 		movw	r1, #11042
 295 002e FFF7FEFF 		bl	cc2400_set
 296              	.LVL30:
1003:bluetooth_rxtx.c **** 	// 1      2      4b
 297              		.loc 1 1003 0
 298 0032 1420     		movs	r0, #20
 299 0034 41F24B21 		movw	r1, #4683
 300 0038 FFF7FEFF 		bl	cc2400_set
 301              	.LVL31:
1016:bluetooth_rxtx.c **** 
 302              		.loc 1 1016 0
 303 003c 2020     		movs	r0, #32
 304 003e 3146     		mov	r1, r6
 305 0040 FFF7FEFF 		bl	cc2400_set
 306              	.LVL32:
1018:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 307              		.loc 1 1018 0
 308 0044 A1B2     		uxth	r1, r4
 309 0046 2C20     		movs	r0, #44
 310 0048 FFF7FEFF 		bl	cc2400_set
 311              	.LVL33:
ARM GAS  /tmp/cc1G6faT.s 			page 32


1019:bluetooth_rxtx.c **** 
 312              		.loc 1 1019 0
 313 004c 210C     		lsrs	r1, r4, #16
1021:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 314              		.loc 1 1021 0
 315 004e 164C     		ldr	r4, .L34+4
 316              	.LVL34:
1019:bluetooth_rxtx.c **** 
 317              		.loc 1 1019 0
 318 0050 2D20     		movs	r0, #45
 319 0052 FFF7FEFF 		bl	cc2400_set
 320              	.LVL35:
1021:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 321              		.loc 1 1021 0
 322 0056 2188     		ldrh	r1, [r4]
 323 0058 0220     		movs	r0, #2
 324 005a 89B2     		uxth	r1, r1
 325 005c 0139     		subs	r1, r1, #1
 326 005e 89B2     		uxth	r1, r1
 327 0060 FFF7FEFF 		bl	cc2400_set
 328              	.LVL36:
1022:bluetooth_rxtx.c **** 
 329              		.loc 1 1022 0
 330 0064 0320     		movs	r0, #3
 331 0066 2946     		mov	r1, r5
 332 0068 FFF7FEFF 		bl	cc2400_set
 333              	.LVL37:
1025:bluetooth_rxtx.c **** 
 334              		.loc 1 1025 0
 335 006c 2088     		ldrh	r0, [r4]
 336 006e 80B2     		uxth	r0, r0
 337 0070 FFF7FEFF 		bl	cs_threshold_calc_and_set
 338              	.LVL38:
1027:bluetooth_rxtx.c **** 
 339              		.loc 1 1027 0
 340 0074 FFF7FEFF 		bl	clkn_start
 341              	.LVL39:
 342              	.L30:
1029:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 343              		.loc 1 1029 0 discriminator 1
 344 0078 FFF7FEFF 		bl	cc2400_status
 345              	.LVL40:
 346 007c 4006     		lsls	r0, r0, #25
 347 007e FBD5     		bpl	.L30
1030:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 348              		.loc 1 1030 0
 349 0080 6120     		movs	r0, #97
 350 0082 FFF7FEFF 		bl	cc2400_strobe
 351              	.LVL41:
 352              	.L32:
1031:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 353              		.loc 1 1031 0 discriminator 1
 354 0086 FFF7FEFF 		bl	cc2400_status
 355              	.LVL42:
 356 008a 4107     		lsls	r1, r0, #29
 357 008c FBD5     		bpl	.L32
1032:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
ARM GAS  /tmp/cc1G6faT.s 			page 33


 358              		.loc 1 1032 0
 359 008e 6220     		movs	r0, #98
 360 0090 FFF7FEFF 		bl	cc2400_strobe
 361              	.LVL43:
1034:bluetooth_rxtx.c **** 	HGM_SET;
 362              		.loc 1 1034 0
 363 0094 054B     		ldr	r3, .L34+8
 364 0096 8022     		movs	r2, #128
 365 0098 1A60     		str	r2, [r3]
1035:bluetooth_rxtx.c **** #endif
 366              		.loc 1 1035 0
 367 009a 4FF48072 		mov	r2, #256
 368 009e 1A60     		str	r2, [r3]
 369              	.LVL44:
 370              	.L26:
 371 00a0 70BD     		pop	{r4, r5, r6, pc}
 372              	.L35:
 373 00a2 00BF     		.align	2
 374              	.L34:
 375 00a4 00000000 		.word	.LANCHOR0
 376 00a8 00000000 		.word	.LANCHOR1
 377 00ac 58C00920 		.word	537509976
 378              		.cfi_endproc
 379              	.LFE9:
 381              		.section	.text.enqueue,"ax",%progbits
 382              		.align	1
 383              		.thumb
 384              		.thumb_func
 386              	enqueue:
 387              	.LFB0:
 129:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 388              		.loc 1 129 0
 389              		.cfi_startproc
 390              		@ args = 0, pretend = 0, frame = 0
 391              		@ frame_needed = 0, uses_anonymous_args = 0
 392              	.LVL45:
 393 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 394              		.cfi_def_cfa_offset 24
 395              		.cfi_offset 3, -24
 396              		.cfi_offset 4, -20
 397              		.cfi_offset 5, -16
 398              		.cfi_offset 6, -12
 399              		.cfi_offset 7, -8
 400              		.cfi_offset 14, -4
 129:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 401              		.loc 1 129 0
 402 0002 0646     		mov	r6, r0
 403 0004 0F46     		mov	r7, r1
 130:bluetooth_rxtx.c **** 
 404              		.loc 1 130 0
 405 0006 FFF7FEFF 		bl	usb_enqueue
 406              	.LVL46:
 407 000a 1E4D     		ldr	r5, .L41
 133:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 408              		.loc 1 133 0
 409 000c 0446     		mov	r4, r0
 410 000e 20B9     		cbnz	r0, .L37
ARM GAS  /tmp/cc1G6faT.s 			page 34


 134:bluetooth_rxtx.c **** 		return 0;
 411              		.loc 1 134 0
 412 0010 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 413 0012 43F00403 		orr	r3, r3, #4
 414 0016 6B70     		strb	r3, [r5, #1]
 135:bluetooth_rxtx.c **** 	}
 415              		.loc 1 135 0
 416 0018 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 417              	.LVL47:
 418              	.L37:
 139:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 419              		.loc 1 139 0
 420 001a 042E     		cmp	r6, #4
 138:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 421              		.loc 1 138 0
 422 001c 0670     		strb	r6, [r0]
 139:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 423              		.loc 1 139 0
 424 001e 0ED1     		bne	.L39
 140:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 425              		.loc 1 140 0
 426 0020 194B     		ldr	r3, .L41+4
 141:bluetooth_rxtx.c **** 	} else {
 427              		.loc 1 141 0
 428 0022 40F63541 		movw	r1, #3125
 140:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 429              		.loc 1 140 0
 430 0026 1A68     		ldr	r2, [r3]
 431 0028 120D     		lsrs	r2, r2, #20
 432 002a C270     		strb	r2, [r0, #3]
 141:bluetooth_rxtx.c **** 	} else {
 433              		.loc 1 141 0
 434 002c 174A     		ldr	r2, .L41+8
 435 002e 1B68     		ldr	r3, [r3]
 436 0030 1268     		ldr	r2, [r2]
 437 0032 C3F31303 		ubfx	r3, r3, #0, #20
 438 0036 01FB0323 		mla	r3, r1, r3, r2
 439 003a 4360     		str	r3, [r0, #4]
 440 003c 15E0     		b	.L40
 441              	.L39:
 143:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 442              		.loc 1 143 0
 443 003e AB78     		ldrb	r3, [r5, #2]	@ zero_extendqisi2
 444 0040 C370     		strb	r3, [r0, #3]
 144:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
 445              		.loc 1 144 0
 446 0042 6B68     		ldr	r3, [r5, #4]
 447 0044 4360     		str	r3, [r0, #4]
 145:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 448              		.loc 1 145 0
 449 0046 2B89     		ldrh	r3, [r5, #8]
 450 0048 9BB2     		uxth	r3, r3
 451 004a 623B     		subs	r3, r3, #98
 452 004c 8370     		strb	r3, [r0, #2]
 146:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
 453              		.loc 1 146 0
 454 004e 104B     		ldr	r3, .L41+12
ARM GAS  /tmp/cc1G6faT.s 			page 35


 455 0050 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 456 0052 4372     		strb	r3, [r0, #9]
 147:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 457              		.loc 1 147 0
 458 0054 0F4B     		ldr	r3, .L41+16
 459 0056 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 460 0058 0372     		strb	r3, [r0, #8]
 148:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 461              		.loc 1 148 0
 462 005a 2889     		ldrh	r0, [r5, #8]
 463              	.LVL48:
 464 005c 80B2     		uxth	r0, r0
 465 005e FFF7FEFF 		bl	rssi_get_avg
 466              	.LVL49:
 149:bluetooth_rxtx.c **** 	}
 467              		.loc 1 149 0
 468 0062 0D4B     		ldr	r3, .L41+20
 148:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 469              		.loc 1 148 0
 470 0064 A072     		strb	r0, [r4, #10]
 149:bluetooth_rxtx.c **** 	}
 471              		.loc 1 149 0
 472 0066 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 473 0068 E372     		strb	r3, [r4, #11]
 474              	.L40:
 152:bluetooth_rxtx.c **** 
 475              		.loc 1 152 0
 476 006a 04F10E00 		add	r0, r4, #14
 477 006e 3946     		mov	r1, r7
 478 0070 3222     		movs	r2, #50
 479 0072 FFF7FEFF 		bl	memcpy
 480              	.LVL50:
 154:bluetooth_rxtx.c **** 	status = 0;
 481              		.loc 1 154 0
 482 0076 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 157:bluetooth_rxtx.c **** }
 483              		.loc 1 157 0
 484 0078 0120     		movs	r0, #1
 154:bluetooth_rxtx.c **** 	status = 0;
 485              		.loc 1 154 0
 486 007a 6370     		strb	r3, [r4, #1]
 155:bluetooth_rxtx.c **** 
 487              		.loc 1 155 0
 488 007c 0023     		movs	r3, #0
 489 007e 6B70     		strb	r3, [r5, #1]
 158:bluetooth_rxtx.c **** 
 490              		.loc 1 158 0
 491 0080 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 492              	.LVL51:
 493              	.L42:
 494 0082 00BF     		.align	2
 495              	.L41:
 496 0084 00000000 		.word	.LANCHOR0
 497 0088 00000000 		.word	clkn
 498 008c 08400040 		.word	1073758216
 499 0090 00000000 		.word	rssi_min
 500 0094 00000000 		.word	rssi_max
ARM GAS  /tmp/cc1G6faT.s 			page 36


 501 0098 00000000 		.word	rssi_count
 502              		.cfi_endproc
 503              	.LFE0:
 505              		.section	.text.le_set_access_address,"ax",%progbits
 506              		.align	1
 507              		.thumb
 508              		.thumb_func
 510              	le_set_access_address:
 511              	.LFB18:
1422:bluetooth_rxtx.c **** 
1423:bluetooth_rxtx.c **** static uint16_t reverse16(uint16_t data)
1424:bluetooth_rxtx.c **** {
1425:bluetooth_rxtx.c **** 	uint16_t reversed = 0;
1426:bluetooth_rxtx.c **** 
1427:bluetooth_rxtx.c **** 	for(size_t i=0; i<16; i++)
1428:bluetooth_rxtx.c **** 	{
1429:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (15-i);
1430:bluetooth_rxtx.c **** 	}
1431:bluetooth_rxtx.c **** 
1432:bluetooth_rxtx.c **** 	return reversed;
1433:bluetooth_rxtx.c **** }
1434:bluetooth_rxtx.c **** 
1435:bluetooth_rxtx.c **** /*
1436:bluetooth_rxtx.c ****  * Transmit a BTBR packet with the specified access code.
1437:bluetooth_rxtx.c ****  *
1438:bluetooth_rxtx.c ****  * All modulation parameters are set within this function.
1439:bluetooth_rxtx.c ****  */
1440:bluetooth_rxtx.c **** void br_transmit()
1441:bluetooth_rxtx.c **** {
1442:bluetooth_rxtx.c **** 	uint16_t gio_save;
1443:bluetooth_rxtx.c **** 
1444:bluetooth_rxtx.c **** 	uint32_t clkn_saved = 0;
1445:bluetooth_rxtx.c **** 
1446:bluetooth_rxtx.c **** 	uint16_t preamble = (target.syncword & 1) == 1 ? 0x5555 : 0xaaaa;
1447:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
1448:bluetooth_rxtx.c **** 
1449:bluetooth_rxtx.c **** 	uint8_t data[16] = {
1450:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
1451:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
1452:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
1453:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
1455:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
1456:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
1457:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
1458:bluetooth_rxtx.c **** 		reverse8(trailer),
1459:bluetooth_rxtx.c **** 		reverse8(0x77),
1460:bluetooth_rxtx.c **** 		reverse8(0x66),
1461:bluetooth_rxtx.c **** 		reverse8(0x55),
1462:bluetooth_rxtx.c **** 		reverse8(0x44),
1463:bluetooth_rxtx.c **** 		reverse8(0x33),
1464:bluetooth_rxtx.c **** 		reverse8(0x22),
1465:bluetooth_rxtx.c **** 		reverse8(0x11)
1466:bluetooth_rxtx.c **** 	};
1467:bluetooth_rxtx.c **** 
1468:bluetooth_rxtx.c **** 	cc2400_tx_sync(reverse16(preamble));
1469:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cc1G6faT.s 			page 37


1470:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1471:bluetooth_rxtx.c **** 
1472:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1473:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
1474:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
1475:bluetooth_rxtx.c **** 
1476:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_TX_SYMBOLS )
1477:bluetooth_rxtx.c **** 	{
1478:bluetooth_rxtx.c **** 
1479:bluetooth_rxtx.c **** 		while ((clkn >> 1) == (clkn_saved >> 1) || T0TC < 2250) {
1480:bluetooth_rxtx.c **** 
1481:bluetooth_rxtx.c **** 			// If timer says time to hop, do it.
1482:bluetooth_rxtx.c **** 			if (do_hop) {
1483:bluetooth_rxtx.c **** 				hop();
1484:bluetooth_rxtx.c **** 			}
1485:bluetooth_rxtx.c **** 		}
1486:bluetooth_rxtx.c **** 
1487:bluetooth_rxtx.c **** 		clkn_saved = clkn;
1488:bluetooth_rxtx.c **** 
1489:bluetooth_rxtx.c **** 		TXLED_SET;
1490:bluetooth_rxtx.c **** 
1491:bluetooth_rxtx.c **** 		cc2400_fifo_write(16, data);
1492:bluetooth_rxtx.c **** 
1493:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1494:bluetooth_rxtx.c **** 		TXLED_CLR;
1495:bluetooth_rxtx.c **** 
1496:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
1497:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
1498:bluetooth_rxtx.c **** 
1499:bluetooth_rxtx.c **** 		while (!(cc2400_status() & XOSC16M_STABLE));
1500:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1501:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
1502:bluetooth_rxtx.c **** 
1503:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1504:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1505:bluetooth_rxtx.c **** 
1506:bluetooth_rxtx.c **** 		handle_usb(clkn);
1507:bluetooth_rxtx.c **** 	}
1508:bluetooth_rxtx.c **** 
1509:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1510:bluetooth_rxtx.c **** 	PAEN_CLR;
1511:bluetooth_rxtx.c **** #endif
1512:bluetooth_rxtx.c **** 
1513:bluetooth_rxtx.c **** 	// reset GIO
1514:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
1515:bluetooth_rxtx.c **** }
1516:bluetooth_rxtx.c **** 
1517:bluetooth_rxtx.c **** /* set LE access address */
1518:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa) {
 512              		.loc 1 1518 0
 513              		.cfi_startproc
 514              		@ args = 0, pretend = 0, frame = 0
 515              		@ frame_needed = 0, uses_anonymous_args = 0
 516              	.LVL52:
 517 0000 10B5     		push	{r4, lr}
 518              		.cfi_def_cfa_offset 8
 519              		.cfi_offset 4, -8
ARM GAS  /tmp/cc1G6faT.s 			page 38


 520              		.cfi_offset 14, -4
1519:bluetooth_rxtx.c **** 	u32 aa_rev;
1520:bluetooth_rxtx.c **** 
1521:bluetooth_rxtx.c **** 	le.access_address = aa;
 521              		.loc 1 1521 0
 522 0002 044C     		ldr	r4, .L44
 523 0004 6060     		str	r0, [r4, #4]
1522:bluetooth_rxtx.c **** 	aa_rev = rbit(aa);
 524              		.loc 1 1522 0
 525 0006 FFF7FEFF 		bl	rbit
 526              	.LVL53:
1523:bluetooth_rxtx.c **** 	le.syncl = aa_rev & 0xffff;
 527              		.loc 1 1523 0
 528 000a 6081     		strh	r0, [r4, #10]	@ movhi
1524:bluetooth_rxtx.c **** 	le.synch = aa_rev >> 16;
 529              		.loc 1 1524 0
 530 000c 000C     		lsrs	r0, r0, #16
 531              	.LVL54:
 532 000e 2081     		strh	r0, [r4, #8]	@ movhi
 533 0010 10BD     		pop	{r4, pc}
 534              	.L45:
 535 0012 00BF     		.align	2
 536              	.L44:
 537 0014 00000000 		.word	.LANCHOR1
 538              		.cfi_endproc
 539              	.LFE18:
 541              		.section	.text.cc2400_idle,"ax",%progbits
 542              		.align	1
 543              		.thumb
 544              		.thumb_func
 546              	cc2400_idle:
 547              	.LFB7:
 876:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 548              		.loc 1 876 0
 549              		.cfi_startproc
 550              		@ args = 0, pretend = 0, frame = 0
 551              		@ frame_needed = 0, uses_anonymous_args = 0
 552 0000 10B5     		push	{r4, lr}
 553              		.cfi_def_cfa_offset 8
 554              		.cfi_offset 4, -8
 555              		.cfi_offset 14, -4
 877:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 556              		.loc 1 877 0
 557 0002 6420     		movs	r0, #100
 558 0004 FFF7FEFF 		bl	cc2400_strobe
 559              	.LVL55:
 560              	.L48:
 878:bluetooth_rxtx.c **** 
 561              		.loc 1 878 0 discriminator 1
 562 0008 FFF7FEFF 		bl	cc2400_status
 563              	.LVL56:
 564 000c 00F00400 		and	r0, r0, #4
 565 0010 00F0FF04 		and	r4, r0, #255
 566 0014 0028     		cmp	r0, #0
 567 0016 F7D1     		bne	.L48
 881:bluetooth_rxtx.c **** 	HGM_CLR;
 568              		.loc 1 881 0
ARM GAS  /tmp/cc1G6faT.s 			page 39


 569 0018 204B     		ldr	r3, .L49
 570 001a 8022     		movs	r2, #128
 571 001c 1A60     		str	r2, [r3]
 885:bluetooth_rxtx.c **** 	TXLED_CLR;
 572              		.loc 1 885 0
 573 001e 1021     		movs	r1, #16
 882:bluetooth_rxtx.c **** #endif
 574              		.loc 1 882 0
 575 0020 4FF48072 		mov	r2, #256
 576 0024 1A60     		str	r2, [r3]
 885:bluetooth_rxtx.c **** 	TXLED_CLR;
 577              		.loc 1 885 0
 578 0026 43F8201C 		str	r1, [r3, #-32]
 886:bluetooth_rxtx.c **** 	USRLED_CLR;
 579              		.loc 1 886 0
 580 002a 43F8202C 		str	r2, [r3, #-32]
 887:bluetooth_rxtx.c **** 
 581              		.loc 1 887 0
 582 002e 0222     		movs	r2, #2
 583 0030 43F8202C 		str	r2, [r3, #-32]
 889:bluetooth_rxtx.c **** 	dio_ssp_stop();
 584              		.loc 1 889 0
 585 0034 FFF7FEFF 		bl	clkn_stop
 586              	.LVL57:
 890:bluetooth_rxtx.c **** 	cs_reset();
 587              		.loc 1 890 0
 588 0038 FFF7FEFF 		bl	dio_ssp_stop
 589              	.LVL58:
 891:bluetooth_rxtx.c **** 	rssi_reset();
 590              		.loc 1 891 0
 591 003c FFF7FEFF 		bl	cs_reset
 592              	.LVL59:
 892:bluetooth_rxtx.c **** 
 593              		.loc 1 892 0
 594 0040 FFF7FEFF 		bl	rssi_reset
 595              	.LVL60:
 895:bluetooth_rxtx.c **** 	do_hop = 0;
 596              		.loc 1 895 0
 597 0044 164B     		ldr	r3, .L49+4
 897:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 598              		.loc 1 897 0
 599 0046 174A     		ldr	r2, .L49+8
 600 0048 40F68911 		movw	r1, #2441
 895:bluetooth_rxtx.c **** 	do_hop = 0;
 601              		.loc 1 895 0
 602 004c 9C72     		strb	r4, [r3, #10]
 896:bluetooth_rxtx.c **** 	channel = 2441;
 603              		.loc 1 896 0
 604 004e DC72     		strb	r4, [r3, #11]
 897:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 605              		.loc 1 897 0
 606 0050 1180     		strh	r1, [r2]	@ movhi
 899:bluetooth_rxtx.c **** 	requested_channel = 0;
 607              		.loc 1 899 0
 608 0052 9E21     		movs	r1, #158
 898:bluetooth_rxtx.c **** 	hop_timeout = 158;
 609              		.loc 1 898 0
ARM GAS  /tmp/cc1G6faT.s 			page 40


 610 0054 9C81     		strh	r4, [r3, #12]	@ movhi
 899:bluetooth_rxtx.c **** 	requested_channel = 0;
 611              		.loc 1 899 0
 612 0056 A2F84810 		strh	r1, [r2, #72]	@ movhi
 901:bluetooth_rxtx.c **** 
 613              		.loc 1 901 0
 614 005a 40F66211 		movw	r1, #2402
 900:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
 615              		.loc 1 900 0
 616 005e DC81     		strh	r4, [r3, #14]	@ movhi
 901:bluetooth_rxtx.c **** 
 617              		.loc 1 901 0
 618 0060 A2F84A10 		strh	r1, [r2, #74]	@ movhi
 905:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 619              		.loc 1 905 0
 620 0064 9C70     		strb	r4, [r3, #2]
 906:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 621              		.loc 1 906 0
 622 0066 5C60     		str	r4, [r3, #4]
 907:bluetooth_rxtx.c **** 	dma_discard = 0;
 623              		.loc 1 907 0
 624 0068 1C81     		strh	r4, [r3, #8]	@ movhi
 908:bluetooth_rxtx.c **** 	status = 0;
 625              		.loc 1 908 0
 626 006a 1C74     		strb	r4, [r3, #16]
 909:bluetooth_rxtx.c **** 
 627              		.loc 1 909 0
 628 006c 5C70     		strb	r4, [r3, #1]
 912:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 629              		.loc 1 912 0
 630 006e 5C74     		strb	r4, [r3, #17]
 913:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 631              		.loc 1 913 0
 632 0070 9C74     		strb	r4, [r3, #18]
 914:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 633              		.loc 1 914 0
 634 0072 DC74     		strb	r4, [r3, #19]
 915:bluetooth_rxtx.c **** 
 635              		.loc 1 915 0
 636 0074 1C75     		strb	r4, [r3, #20]
 917:bluetooth_rxtx.c **** 
 637              		.loc 1 917 0
 638 0076 1C70     		strb	r4, [r3]
 920:bluetooth_rxtx.c **** 	high_freq = 2483;
 639              		.loc 1 920 0
 640 0078 4FF41663 		mov	r3, #2400
 641 007c A2F84C30 		strh	r3, [r2, #76]	@ movhi
 921:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 642              		.loc 1 921 0
 643 0080 5333     		adds	r3, r3, #83
 644 0082 A2F84E30 		strh	r3, [r2, #78]	@ movhi
 924:bluetooth_rxtx.c **** 	target.syncword = 0;
 645              		.loc 1 924 0
 646 0086 0849     		ldr	r1, .L49+12
 922:bluetooth_rxtx.c **** 
 647              		.loc 1 922 0
 648 0088 E223     		movs	r3, #226
ARM GAS  /tmp/cc1G6faT.s 			page 41


 649 008a 82F85030 		strb	r3, [r2, #80]
 924:bluetooth_rxtx.c **** 	target.syncword = 0;
 650              		.loc 1 924 0
 651 008e 0022     		movs	r2, #0
 652 0090 0023     		movs	r3, #0
 653 0092 C1E90023 		strd	r2, [r1]
 925:bluetooth_rxtx.c **** }
 654              		.loc 1 925 0
 655 0096 C1E90223 		strd	r2, [r1, #8]
 656 009a 10BD     		pop	{r4, pc}
 657              	.L50:
 658              		.align	2
 659              	.L49:
 660 009c 5CC00920 		.word	537509980
 661 00a0 00000000 		.word	.LANCHOR0
 662 00a4 00000000 		.word	.LANCHOR1
 663 00a8 00000000 		.word	target
 664              		.cfi_endproc
 665              	.LFE7:
 667              		.section	.text.cb_follow_le,"ax",%progbits
 668              		.align	1
 669              		.global	cb_follow_le
 670              		.thumb
 671              		.thumb_func
 673              	cb_follow_le:
 674              	.LFB23:
1525:bluetooth_rxtx.c **** }
1526:bluetooth_rxtx.c **** 
1527:bluetooth_rxtx.c **** /* reset le state, called by bt_generic_le and bt_follow_le() */
1528:bluetooth_rxtx.c **** void reset_le() {
1529:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
1530:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
1531:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
1532:bluetooth_rxtx.c **** 	le.crc_verify = 0;
1533:bluetooth_rxtx.c **** 	le.last_packet = 0;
1534:bluetooth_rxtx.c **** 
1535:bluetooth_rxtx.c **** 	le.link_state = LINK_INACTIVE;
1536:bluetooth_rxtx.c **** 
1537:bluetooth_rxtx.c **** 	le.channel_idx = 0;
1538:bluetooth_rxtx.c **** 	le.channel_increment = 0;
1539:bluetooth_rxtx.c **** 
1540:bluetooth_rxtx.c **** 	le.conn_epoch = 0;
1541:bluetooth_rxtx.c **** 	le.interval_timer = 0;
1542:bluetooth_rxtx.c **** 	le.conn_interval = 0;
1543:bluetooth_rxtx.c **** 	le.conn_interval = 0;
1544:bluetooth_rxtx.c **** 	le.conn_count = 0;
1545:bluetooth_rxtx.c **** 
1546:bluetooth_rxtx.c **** 	le.win_size = 0;
1547:bluetooth_rxtx.c **** 	le.win_offset = 0;
1548:bluetooth_rxtx.c **** 
1549:bluetooth_rxtx.c **** 	le.update_pending = 0;
1550:bluetooth_rxtx.c **** 	le.update_instant = 0;
1551:bluetooth_rxtx.c **** 	le.interval_update = 0;
1552:bluetooth_rxtx.c **** 	le.win_size_update = 0;
1553:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
1554:bluetooth_rxtx.c **** 
1555:bluetooth_rxtx.c **** 	do_hop = 0;
ARM GAS  /tmp/cc1G6faT.s 			page 42


1556:bluetooth_rxtx.c **** }
1557:bluetooth_rxtx.c **** 
1558:bluetooth_rxtx.c **** // reset LE Promisc state
1559:bluetooth_rxtx.c **** void reset_le_promisc(void) {
1560:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
1561:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
1562:bluetooth_rxtx.c **** }
1563:bluetooth_rxtx.c **** 
1564:bluetooth_rxtx.c **** /* generic le mode */
1565:bluetooth_rxtx.c **** void bt_generic_le(u8 active_mode)
1566:bluetooth_rxtx.c **** {
1567:bluetooth_rxtx.c **** 	u8 hold;
1568:bluetooth_rxtx.c **** 	int i, j;
1569:bluetooth_rxtx.c **** 	int8_t rssi, rssi_at_trigger;
1570:bluetooth_rxtx.c **** 
1571:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1572:bluetooth_rxtx.c **** 	mode = active_mode;
1573:bluetooth_rxtx.c **** 
1574:bluetooth_rxtx.c **** 	reset_le();
1575:bluetooth_rxtx.c **** 
1576:bluetooth_rxtx.c **** 	// enable USB interrupts
1577:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1578:bluetooth_rxtx.c **** 
1579:bluetooth_rxtx.c **** 	RXLED_CLR;
1580:bluetooth_rxtx.c **** 
1581:bluetooth_rxtx.c **** 	queue_init();
1582:bluetooth_rxtx.c **** 	dio_ssp_init();
1583:bluetooth_rxtx.c **** 	dma_init();
1584:bluetooth_rxtx.c **** 	dio_ssp_start();
1585:bluetooth_rxtx.c **** 	cc2400_rx();
1586:bluetooth_rxtx.c **** 
1587:bluetooth_rxtx.c **** 	cs_trigger_enable();
1588:bluetooth_rxtx.c **** 
1589:bluetooth_rxtx.c **** 	hold = 0;
1590:bluetooth_rxtx.c **** 
1591:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1592:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1593:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1594:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1595:bluetooth_rxtx.c **** 
1596:bluetooth_rxtx.c **** 			/* Retune */
1597:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1598:bluetooth_rxtx.c **** 
1599:bluetooth_rxtx.c **** 			/* Wait for lock */
1600:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1601:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1602:bluetooth_rxtx.c **** 
1603:bluetooth_rxtx.c **** 			/* RX mode */
1604:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1605:bluetooth_rxtx.c **** 
1606:bluetooth_rxtx.c **** 			requested_channel = 0;
1607:bluetooth_rxtx.c **** 		}
1608:bluetooth_rxtx.c **** 
1609:bluetooth_rxtx.c **** 		if (do_hop) {
1610:bluetooth_rxtx.c **** 			hop();
1611:bluetooth_rxtx.c **** 		} else {
1612:bluetooth_rxtx.c **** 			TXLED_CLR;
ARM GAS  /tmp/cc1G6faT.s 			page 43


1613:bluetooth_rxtx.c **** 		}
1614:bluetooth_rxtx.c **** 
1615:bluetooth_rxtx.c **** 		RXLED_CLR;
1616:bluetooth_rxtx.c **** 
1617:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1618:bluetooth_rxtx.c **** 		rssi_reset();
1619:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
1620:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
1621:bluetooth_rxtx.c **** 		{
1622:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1623:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1624:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1625:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
1626:bluetooth_rxtx.c **** 			}
1627:bluetooth_rxtx.c **** 			rssi_add(rssi);
1628:bluetooth_rxtx.c **** 		}
1629:bluetooth_rxtx.c **** 
1630:bluetooth_rxtx.c **** 		if (rx_err) {
1631:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1632:bluetooth_rxtx.c **** 		}
1633:bluetooth_rxtx.c **** 
1634:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1635:bluetooth_rxtx.c **** 		if (!rx_tc)
1636:bluetooth_rxtx.c **** 			goto rx_continue;
1637:bluetooth_rxtx.c **** 
1638:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1639:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1640:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1641:bluetooth_rxtx.c **** 
1642:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1643:bluetooth_rxtx.c **** 
1644:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1645:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1646:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1647:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1648:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1649:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1650:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1651:bluetooth_rxtx.c **** 			cs_trigger = 0;
1652:bluetooth_rxtx.c **** 		}
1653:bluetooth_rxtx.c **** 
1654:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1655:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1656:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1657:bluetooth_rxtx.c **** 		}
1658:bluetooth_rxtx.c **** 
1659:bluetooth_rxtx.c **** 		/* Hold expired? Ignore data. */
1660:bluetooth_rxtx.c **** 		if (hold == 0) {
1661:bluetooth_rxtx.c **** 			goto rx_continue;
1662:bluetooth_rxtx.c **** 		}
1663:bluetooth_rxtx.c **** 		hold--;
1664:bluetooth_rxtx.c **** 
1665:bluetooth_rxtx.c **** 		// copy the previously unpacked symbols to the front of the buffer
1666:bluetooth_rxtx.c **** 		memcpy(unpacked, unpacked + DMA_SIZE*8, DMA_SIZE*8);
1667:bluetooth_rxtx.c **** 
1668:bluetooth_rxtx.c **** 		// unpack the new packet to the end of the buffer
1669:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; ++i) {
ARM GAS  /tmp/cc1G6faT.s 			page 44


1670:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
1671:bluetooth_rxtx.c **** 			for (j = 0; j < 8; ++j) {
1672:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
1673:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
1674:bluetooth_rxtx.c **** 			}
1675:bluetooth_rxtx.c **** 		}
1676:bluetooth_rxtx.c **** 
1677:bluetooth_rxtx.c **** 		int ret = data_cb(unpacked);
1678:bluetooth_rxtx.c **** 		if (!ret) break;
1679:bluetooth_rxtx.c **** 
1680:bluetooth_rxtx.c **** 	rx_continue:
1681:bluetooth_rxtx.c **** 		rx_tc = 0;
1682:bluetooth_rxtx.c **** 		rx_err = 0;
1683:bluetooth_rxtx.c **** 	}
1684:bluetooth_rxtx.c **** 
1685:bluetooth_rxtx.c **** 	// disable USB interrupts
1686:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1687:bluetooth_rxtx.c **** 
1688:bluetooth_rxtx.c **** 	// reset the radio completely
1689:bluetooth_rxtx.c **** 	cc2400_idle();
1690:bluetooth_rxtx.c **** 	dio_ssp_stop();
1691:bluetooth_rxtx.c **** 	cs_trigger_disable();
1692:bluetooth_rxtx.c **** }
1693:bluetooth_rxtx.c **** 
1694:bluetooth_rxtx.c **** 
1695:bluetooth_rxtx.c **** void bt_le_sync(u8 active_mode)
1696:bluetooth_rxtx.c **** {
1697:bluetooth_rxtx.c **** 	int i;
1698:bluetooth_rxtx.c **** 	int8_t rssi;
1699:bluetooth_rxtx.c **** 	static int restart_jamming = 0;
1700:bluetooth_rxtx.c **** 
1701:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1702:bluetooth_rxtx.c **** 	mode = active_mode;
1703:bluetooth_rxtx.c **** 
1704:bluetooth_rxtx.c **** 	le.link_state = LINK_LISTENING;
1705:bluetooth_rxtx.c **** 
1706:bluetooth_rxtx.c **** 	// enable USB interrupts
1707:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1708:bluetooth_rxtx.c **** 
1709:bluetooth_rxtx.c **** 	RXLED_CLR;
1710:bluetooth_rxtx.c **** 
1711:bluetooth_rxtx.c **** 	queue_init();
1712:bluetooth_rxtx.c **** 	dio_ssp_init();
1713:bluetooth_rxtx.c **** 	dma_init_le();
1714:bluetooth_rxtx.c **** 	dio_ssp_start();
1715:bluetooth_rxtx.c **** 
1716:bluetooth_rxtx.c **** 	cc2400_rx_sync(rbit(le.access_address)); // bit-reversed access address
1717:bluetooth_rxtx.c **** 
1718:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1719:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1720:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1721:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1722:bluetooth_rxtx.c **** 
1723:bluetooth_rxtx.c **** 			/* Retune */
1724:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1725:bluetooth_rxtx.c **** 
1726:bluetooth_rxtx.c **** 			/* Wait for lock */
ARM GAS  /tmp/cc1G6faT.s 			page 45


1727:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1728:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1729:bluetooth_rxtx.c **** 
1730:bluetooth_rxtx.c **** 			/* RX mode */
1731:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1732:bluetooth_rxtx.c **** 
1733:bluetooth_rxtx.c **** 			requested_channel = 0;
1734:bluetooth_rxtx.c **** 		}
1735:bluetooth_rxtx.c **** 
1736:bluetooth_rxtx.c **** 		RXLED_CLR;
1737:bluetooth_rxtx.c **** 
1738:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1739:bluetooth_rxtx.c **** 		rssi_reset();
1740:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)
1741:bluetooth_rxtx.c **** 			;
1742:bluetooth_rxtx.c **** 
1743:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1744:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
1745:bluetooth_rxtx.c **** 
1746:bluetooth_rxtx.c **** 		if (requested_mode != active_mode) {
1747:bluetooth_rxtx.c **** 			goto cleanup;
1748:bluetooth_rxtx.c **** 		}
1749:bluetooth_rxtx.c **** 
1750:bluetooth_rxtx.c **** 		if (rx_err) {
1751:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1752:bluetooth_rxtx.c **** 		}
1753:bluetooth_rxtx.c **** 
1754:bluetooth_rxtx.c **** 		if (do_hop)
1755:bluetooth_rxtx.c **** 			goto rx_flush;
1756:bluetooth_rxtx.c **** 
1757:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1758:bluetooth_rxtx.c **** 		if (!rx_tc)
1759:bluetooth_rxtx.c **** 			continue;
1760:bluetooth_rxtx.c **** 
1761:bluetooth_rxtx.c **** 		/////////////////////
1762:bluetooth_rxtx.c **** 		// process the packet
1763:bluetooth_rxtx.c **** 
1764:bluetooth_rxtx.c **** 		uint32_t packet[48/4+1] = { 0, };
1765:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
1766:bluetooth_rxtx.c **** 		packet[0] = le.access_address;
1767:bluetooth_rxtx.c **** 
1768:bluetooth_rxtx.c **** 		const uint32_t *whit = whitening_word[btle_channel_index(channel-2402)];
1769:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
1770:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
1771:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1772:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1773:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1774:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
1775:bluetooth_rxtx.c **** 		}
1776:bluetooth_rxtx.c **** 
1777:bluetooth_rxtx.c **** 		unsigned len = (p[5] & 0x3f) + 2;
1778:bluetooth_rxtx.c **** 		if (len > 39)
1779:bluetooth_rxtx.c **** 			goto rx_flush;
1780:bluetooth_rxtx.c **** 
1781:bluetooth_rxtx.c **** 		// transfer the minimum number of bytes from the CC2400
1782:bluetooth_rxtx.c **** 		// this allows us enough time to resume RX for subsequent packets on the same channel
1783:bluetooth_rxtx.c **** 		unsigned total_transfers = ((len + 3) + 4 - 1) / 4;
ARM GAS  /tmp/cc1G6faT.s 			page 46


1784:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
1785:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
1786:bluetooth_rxtx.c **** 				;
1787:bluetooth_rxtx.c **** 		} else { // max transfers? just wait till DMA's done
1788:bluetooth_rxtx.c **** 			while (DMACC0Config & DMACCxConfig_E && rx_err == 0)
1789:bluetooth_rxtx.c **** 				;
1790:bluetooth_rxtx.c **** 		}
1791:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1792:bluetooth_rxtx.c **** 
1793:bluetooth_rxtx.c **** 		// strobe SFSON to allow the resync to occur while we process the packet
1794:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1795:bluetooth_rxtx.c **** 
1796:bluetooth_rxtx.c **** 		// unwhiten the rest of the packet
1797:bluetooth_rxtx.c **** 		for (i = 4; i < 44; i += 4) {
1798:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
1799:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1800:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1801:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1802:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
1803:bluetooth_rxtx.c **** 		}
1804:bluetooth_rxtx.c **** 
1805:bluetooth_rxtx.c **** 		if (le.crc_verify) {
1806:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
1807:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
1808:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
1809:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
1810:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
1811:bluetooth_rxtx.c **** 				goto rx_flush;
1812:bluetooth_rxtx.c **** 		}
1813:bluetooth_rxtx.c **** 
1814:bluetooth_rxtx.c **** 
1815:bluetooth_rxtx.c **** 		RXLED_SET;
1816:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
1817:bluetooth_rxtx.c **** 
1818:bluetooth_rxtx.c **** 		// disable USB interrupts while we touch USB data structures
1819:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
1820:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
1821:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
1822:bluetooth_rxtx.c **** 
1823:bluetooth_rxtx.c **** 		le.last_packet = CLK100NS;
1824:bluetooth_rxtx.c **** 
1825:bluetooth_rxtx.c **** 	rx_flush:
1826:bluetooth_rxtx.c **** 		// this might happen twice, but it's safe to do so
1827:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1828:bluetooth_rxtx.c **** 
1829:bluetooth_rxtx.c **** 		// flush any excess bytes from the SSP's buffer
1830:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1831:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
1832:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
1833:bluetooth_rxtx.c **** 		}
1834:bluetooth_rxtx.c **** 
1835:bluetooth_rxtx.c **** 		// timeout - FIXME this is an ugly hack
1836:bluetooth_rxtx.c **** 		u32 now = CLK100NS;
1837:bluetooth_rxtx.c **** 		if (now < le.last_packet)
1838:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
1839:bluetooth_rxtx.c **** 		if  ( // timeout
1840:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
ARM GAS  /tmp/cc1G6faT.s 			page 47


1841:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
1842:bluetooth_rxtx.c **** 			// jam finished
1843:bluetooth_rxtx.c **** 			|| (le_jam_count == 1)
1844:bluetooth_rxtx.c **** 			)
1845:bluetooth_rxtx.c **** 		{
1846:bluetooth_rxtx.c **** 			reset_le();
1847:bluetooth_rxtx.c **** 			le_jam_count = 0;
1848:bluetooth_rxtx.c **** 			TXLED_CLR;
1849:bluetooth_rxtx.c **** 
1850:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
1851:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
1852:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
1853:bluetooth_rxtx.c **** 				goto cleanup;
1854:bluetooth_rxtx.c **** 			}
1855:bluetooth_rxtx.c **** 
1856:bluetooth_rxtx.c **** 			// go back to promisc if the connection dies
1857:bluetooth_rxtx.c **** 			if (active_mode == MODE_BT_PROMISC_LE)
1858:bluetooth_rxtx.c **** 				goto cleanup;
1859:bluetooth_rxtx.c **** 
1860:bluetooth_rxtx.c **** 			le.link_state = LINK_LISTENING;
1861:bluetooth_rxtx.c **** 
1862:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1863:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
1864:bluetooth_rxtx.c **** 
1865:bluetooth_rxtx.c **** 			/* Retune */
1866:bluetooth_rxtx.c **** 			channel = le_adv_channel != 0 ? le_adv_channel : 2402;
1867:bluetooth_rxtx.c **** 			restart_jamming = 1;
1868:bluetooth_rxtx.c **** 		}
1869:bluetooth_rxtx.c **** 
1870:bluetooth_rxtx.c **** 		cc2400_set(SYNCL, le.syncl);
1871:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
1872:bluetooth_rxtx.c **** 
1873:bluetooth_rxtx.c **** 		if (do_hop)
1874:bluetooth_rxtx.c **** 			hop();
1875:bluetooth_rxtx.c **** 
1876:bluetooth_rxtx.c **** 		//  you can jam but you keep turning off the light 
1877:bluetooth_rxtx.c **** 		if (le_jam_count > 0) {
1878:bluetooth_rxtx.c **** 			le_jam();
1879:bluetooth_rxtx.c **** 			--le_jam_count;
1880:bluetooth_rxtx.c **** 		} else {
1881:bluetooth_rxtx.c **** 			/* RX mode */
1882:bluetooth_rxtx.c **** 			dma_init_le();
1883:bluetooth_rxtx.c **** 			dio_ssp_start();
1884:bluetooth_rxtx.c **** 
1885:bluetooth_rxtx.c **** 			if (restart_jamming) {
1886:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
1887:bluetooth_rxtx.c **** 				restart_jamming = 0;
1888:bluetooth_rxtx.c **** 			} else {
1889:bluetooth_rxtx.c **** 				// wait till we're in FSLOCK before strobing RX
1890:bluetooth_rxtx.c **** 				while (!(cc2400_status() & FS_LOCK));
1891:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
1892:bluetooth_rxtx.c **** 			}
1893:bluetooth_rxtx.c **** 		}
1894:bluetooth_rxtx.c **** 
1895:bluetooth_rxtx.c **** 		rx_tc = 0;
1896:bluetooth_rxtx.c **** 		rx_err = 0;
1897:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/cc1G6faT.s 			page 48


1898:bluetooth_rxtx.c **** 
1899:bluetooth_rxtx.c **** cleanup:
1900:bluetooth_rxtx.c **** 
1901:bluetooth_rxtx.c **** 	// disable USB interrupts
1902:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1903:bluetooth_rxtx.c **** 
1904:bluetooth_rxtx.c **** 	// reset the radio completely
1905:bluetooth_rxtx.c **** 	cc2400_idle();
1906:bluetooth_rxtx.c **** 	dio_ssp_stop();
1907:bluetooth_rxtx.c **** 	cs_trigger_disable();
1908:bluetooth_rxtx.c **** }
1909:bluetooth_rxtx.c **** 
1910:bluetooth_rxtx.c **** 
1911:bluetooth_rxtx.c **** 
1912:bluetooth_rxtx.c **** /* low energy connection following
1913:bluetooth_rxtx.c ****  * follows a known AA around */
1914:bluetooth_rxtx.c **** int cb_follow_le() {
 675              		.loc 1 1914 0
 676              		.cfi_startproc
 677              		@ args = 0, pretend = 0, frame = 0
 678              		@ frame_needed = 0, uses_anonymous_args = 0
 679 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 680              		.cfi_def_cfa_offset 32
 681              		.cfi_offset 3, -32
 682              		.cfi_offset 4, -28
 683              		.cfi_offset 5, -24
 684              		.cfi_offset 6, -20
 685              		.cfi_offset 7, -16
 686              		.cfi_offset 8, -12
 687              		.cfi_offset 9, -8
 688              		.cfi_offset 14, -4
1915:bluetooth_rxtx.c **** 	int i, j, k;
1916:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(channel-2402)];
 689              		.loc 1 1916 0
 690 0004 394C     		ldr	r4, .L72
 691 0006 2088     		ldrh	r0, [r4]
 692 0008 2646     		mov	r6, r4
 693 000a 80B2     		uxth	r0, r0
 694 000c 6238     		subs	r0, r0, #98
 695 000e C0B2     		uxtb	r0, r0
 696 0010 FFF7FEFF 		bl	btle_channel_index
 697              	.LVL61:
 698 0014 3649     		ldr	r1, .L72+4
1917:bluetooth_rxtx.c **** 
1918:bluetooth_rxtx.c **** 	u32 access_address = 0;
 699              		.loc 1 1918 0
 700 0016 0022     		movs	r2, #0
1916:bluetooth_rxtx.c **** 
 701              		.loc 1 1916 0
 702 0018 0D5C     		ldrb	r5, [r1, r0]	@ zero_extendqisi2
 703              	.LVL62:
1919:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 704              		.loc 1 1919 0
 705 001a 1346     		mov	r3, r2
 706 001c 8C46     		mov	ip, r1
 707              	.LVL63:
 708              	.L53:
ARM GAS  /tmp/cc1G6faT.s 			page 49


1920:bluetooth_rxtx.c **** 		access_address >>= 1;
1921:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
 709              		.loc 1 1921 0 discriminator 2
 710 001e 354F     		ldr	r7, .L72+8
 711 0020 D95D     		ldrb	r1, [r3, r7]	@ zero_extendqisi2
1919:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 712              		.loc 1 1919 0 discriminator 2
 713 0022 0133     		adds	r3, r3, #1
 714              	.LVL64:
 715              		.loc 1 1921 0 discriminator 2
 716 0024 C907     		lsls	r1, r1, #31
1919:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 717              		.loc 1 1919 0 discriminator 2
 718 0026 1F2B     		cmp	r3, #31
 719              		.loc 1 1921 0 discriminator 2
 720 0028 41EA5202 		orr	r2, r1, r2, lsr #1
 721              	.LVL65:
1919:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 722              		.loc 1 1919 0 discriminator 2
 723 002c F7D1     		bne	.L53
1922:bluetooth_rxtx.c **** 	}
1923:bluetooth_rxtx.c **** 
1924:bluetooth_rxtx.c **** 	for (i = 31; i < DMA_SIZE * 8 + 32; i++) {
1925:bluetooth_rxtx.c **** 		access_address >>= 1;
1926:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
1927:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 724              		.loc 1 1927 0
 725 002e 7168     		ldr	r1, [r6, #4]
 726              	.L65:
 727              	.LVL66:
1926:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 728              		.loc 1 1926 0
 729 0030 F85C     		ldrb	r0, [r7, r3]	@ zero_extendqisi2
 730 0032 C007     		lsls	r0, r0, #31
 731 0034 40EA5202 		orr	r2, r0, r2, lsr #1
 732              	.LVL67:
 733              		.loc 1 1927 0
 734 0038 8A42     		cmp	r2, r1
 735 003a 4FD1     		bne	.L54
 736 003c 0022     		movs	r2, #0
 737              	.LVL68:
 738              	.L55:
 739 003e 07EB0308 		add	r8, r7, r3
1919:bluetooth_rxtx.c **** 		access_address >>= 1;
 740              		.loc 1 1919 0 discriminator 1
 741 0042 0020     		movs	r0, #0
 742 0044 08EBC208 		add	r8, r8, r2, lsl #3
 743 0048 0146     		mov	r1, r0
 744              	.LVL69:
 745              	.L60:
 746 004a 08EB0104 		add	r4, r8, r1
 747              	.LBB6:
 748              	.LBB7:
1928:bluetooth_rxtx.c **** 			for (j = 0; j < 46; ++j) {
1929:bluetooth_rxtx.c **** 				u8 byte = 0;
1930:bluetooth_rxtx.c **** 				for (k = 0; k < 8; k++) {
1931:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
ARM GAS  /tmp/cc1G6faT.s 			page 50


1932:bluetooth_rxtx.c **** 					if (offset >= DMA_SIZE*8*2) break;
1933:bluetooth_rxtx.c **** 					int bit = unpacked[offset];
1934:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 749              		.loc 1 1934 0
 750 004e 032A     		cmp	r2, #3
1933:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 751              		.loc 1 1933 0
 752 0050 14F81F4C 		ldrb	r4, [r4, #-31]	@ zero_extendqisi2
 753              	.LVL70:
 754              		.loc 1 1934 0
 755 0054 0CDD     		ble	.L57
1935:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 756              		.loc 1 1935 0
 757 0056 0CEB050E 		add	lr, ip, r5
 758 005a 9EF828E0 		ldrb	lr, [lr, #40]	@ zero_extendqisi2
1936:bluetooth_rxtx.c **** 						idx = (idx + 1) % sizeof(whitening);
 759              		.loc 1 1936 0
 760 005e 0135     		adds	r5, r5, #1
 761              	.LVL71:
1935:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 762              		.loc 1 1935 0
 763 0060 84EA0E04 		eor	r4, r4, lr
 764              	.LVL72:
 765              		.loc 1 1936 0
 766 0064 4FF07F0E 		mov	lr, #127
 767 0068 B5FBFEF9 		udiv	r9, r5, lr
 768 006c 0EFB1955 		mls	r5, lr, r9, r5
 769              	.LVL73:
 770              	.L57:
1937:bluetooth_rxtx.c **** 					}
1938:bluetooth_rxtx.c **** 					byte |= bit << k;
 771              		.loc 1 1938 0
 772 0070 8C40     		lsls	r4, r4, r1
 773              	.LVL74:
 774              	.LBE7:
1930:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 775              		.loc 1 1930 0
 776 0072 0131     		adds	r1, r1, #1
 777              	.LVL75:
 778              	.LBB8:
 779              		.loc 1 1938 0
 780 0074 2043     		orrs	r0, r0, r4
 781              	.LVL76:
 782              	.LBE8:
1930:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 783              		.loc 1 1930 0
 784 0076 0829     		cmp	r1, #8
 785              	.LBB9:
 786              		.loc 1 1938 0
 787 0078 C0B2     		uxtb	r0, r0
 788              	.LVL77:
 789              	.LBE9:
1930:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 790              		.loc 1 1930 0
 791 007a E6D1     		bne	.L60
1939:bluetooth_rxtx.c **** 				}
1940:bluetooth_rxtx.c **** 				idle_rxbuf[j] = byte;
ARM GAS  /tmp/cc1G6faT.s 			page 51


 792              		.loc 1 1940 0
 793 007c 1E4C     		ldr	r4, .L72+12
 794 007e 2168     		ldr	r1, [r4]
 795              	.LVL78:
 796 0080 8854     		strb	r0, [r1, r2]
 797              	.LBE6:
1928:bluetooth_rxtx.c **** 				u8 byte = 0;
 798              		.loc 1 1928 0
 799 0082 0132     		adds	r2, r2, #1
 800              	.LVL79:
 801 0084 2E2A     		cmp	r2, #46
 802 0086 DAD1     		bne	.L55
1941:bluetooth_rxtx.c **** 			}
1942:bluetooth_rxtx.c **** 
1943:bluetooth_rxtx.c **** 			// verify CRC
1944:bluetooth_rxtx.c **** 			if (le.crc_verify) {
 803              		.loc 1 1944 0
 804 0088 7369     		ldr	r3, [r6, #20]
 805              	.LVL80:
 806 008a 5BB9     		cbnz	r3, .L61
 807              	.LVL81:
 808              	.L63:
1945:bluetooth_rxtx.c **** 				int len		 = (idle_rxbuf[5] & 0x3f) + 2;
1946:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
1947:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
1948:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
1949:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
1950:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
1951:bluetooth_rxtx.c **** 					break;
1952:bluetooth_rxtx.c **** 			}
1953:bluetooth_rxtx.c **** 
1954:bluetooth_rxtx.c **** 			// send to PC
1955:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
 809              		.loc 1 1955 0
 810 008c 2168     		ldr	r1, [r4]
 811 008e 0120     		movs	r0, #1
 812 0090 FFF7FEFF 		bl	enqueue
 813              	.LVL82:
1956:bluetooth_rxtx.c **** 			RXLED_SET;
 814              		.loc 1 1956 0
 815 0094 194B     		ldr	r3, .L72+16
 816 0096 1022     		movs	r2, #16
 817 0098 1A60     		str	r2, [r3]
1957:bluetooth_rxtx.c **** 
1958:bluetooth_rxtx.c **** 			packet_cb((uint8_t*)idle_rxbuf);
 818              		.loc 1 1958 0
 819 009a 194B     		ldr	r3, .L72+20
 820 009c 2068     		ldr	r0, [r4]
 821 009e 9B69     		ldr	r3, [r3, #24]
 822 00a0 9847     		blx	r3
 823              	.LVL83:
1959:bluetooth_rxtx.c **** 
1960:bluetooth_rxtx.c **** 			break;
 824              		.loc 1 1960 0
 825 00a2 1FE0     		b	.L62
 826              	.LVL84:
 827              	.L61:
ARM GAS  /tmp/cc1G6faT.s 			page 52


 828              	.LBB10:
1945:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
 829              		.loc 1 1945 0
 830 00a4 2368     		ldr	r3, [r4]
 831 00a6 5D79     		ldrb	r5, [r3, #5]	@ zero_extendqisi2
 832              	.LVL85:
1946:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 833              		.loc 1 1946 0
 834 00a8 104B     		ldr	r3, .L72
 835 00aa 2168     		ldr	r1, [r4]
1945:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
 836              		.loc 1 1945 0
 837 00ac 05F03F05 		and	r5, r5, #63
 838              	.LVL86:
1946:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 839              		.loc 1 1946 0
 840 00b0 AA1C     		adds	r2, r5, #2
 841              	.LVL87:
 842 00b2 1869     		ldr	r0, [r3, #16]
 843              	.LVL88:
 844 00b4 0431     		adds	r1, r1, #4
 845 00b6 FFF7FEFF 		bl	btle_crcgen_lut
 846              	.LVL89:
1947:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
 847              		.loc 1 1947 0
 848 00ba 2268     		ldr	r2, [r4]
 849 00bc 05F10803 		add	r3, r5, #8
 850 00c0 D15C     		ldrb	r1, [r2, r3]	@ zero_extendqisi2
1948:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 851              		.loc 1 1948 0
 852 00c2 2268     		ldr	r2, [r4]
 853 00c4 EB1D     		adds	r3, r5, #7
 854 00c6 D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
1949:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 855              		.loc 1 1949 0
 856 00c8 2268     		ldr	r2, [r4]
 857 00ca 0635     		adds	r5, r5, #6
 858              	.LVL90:
 859 00cc 525D     		ldrb	r2, [r2, r5]	@ zero_extendqisi2
 860              	.LVL91:
1948:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 861              		.loc 1 1948 0
 862 00ce 1B02     		lsls	r3, r3, #8
 863              	.LVL92:
 864 00d0 43EA0143 		orr	r3, r3, r1, lsl #16
1949:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 865              		.loc 1 1949 0
 866 00d4 1343     		orrs	r3, r3, r2
1950:bluetooth_rxtx.c **** 					break;
 867              		.loc 1 1950 0
 868 00d6 9842     		cmp	r0, r3
 869 00d8 04D1     		bne	.L62
 870 00da D7E7     		b	.L63
 871              	.LVL93:
 872              	.L54:
 873              	.LBE10:
1924:bluetooth_rxtx.c **** 		access_address >>= 1;
ARM GAS  /tmp/cc1G6faT.s 			page 53


 874              		.loc 1 1924 0
 875 00dc 0133     		adds	r3, r3, #1
 876              	.LVL94:
 877 00de B3F5D87F 		cmp	r3, #432
 878 00e2 A5D1     		bne	.L65
 879              	.LVL95:
 880              	.L62:
1961:bluetooth_rxtx.c **** 		}
1962:bluetooth_rxtx.c **** 	}
1963:bluetooth_rxtx.c **** 
1964:bluetooth_rxtx.c **** 	return 1;
1965:bluetooth_rxtx.c **** }
 881              		.loc 1 1965 0
 882 00e4 0120     		movs	r0, #1
 883 00e6 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 884              	.L73:
 885 00ea 00BF     		.align	2
 886              	.L72:
 887 00ec 00000000 		.word	.LANCHOR1
 888 00f0 00000000 		.word	.LANCHOR2
 889 00f4 00000000 		.word	unpacked
 890 00f8 00000000 		.word	idle_rxbuf
 891 00fc 38C00920 		.word	537509944
 892 0100 00000000 		.word	.LANCHOR0
 893              		.cfi_endproc
 894              	.LFE23:
 896              		.section	.text.connection_follow_cb,"ax",%progbits
 897              		.align	1
 898              		.global	connection_follow_cb
 899              		.thumb
 900              		.thumb_func
 902              	connection_follow_cb:
 903              	.LFB24:
1966:bluetooth_rxtx.c **** 
1967:bluetooth_rxtx.c **** /**
1968:bluetooth_rxtx.c ****  * Called when we receive a packet in connection following mode.
1969:bluetooth_rxtx.c ****  */
1970:bluetooth_rxtx.c **** void connection_follow_cb(u8 *packet) {
 904              		.loc 1 1970 0
 905              		.cfi_startproc
 906              		@ args = 0, pretend = 0, frame = 0
 907              		@ frame_needed = 0, uses_anonymous_args = 0
 908              	.LVL96:
 909 0000 38B5     		push	{r3, r4, r5, lr}
 910              		.cfi_def_cfa_offset 16
 911              		.cfi_offset 3, -16
 912              		.cfi_offset 4, -12
 913              		.cfi_offset 5, -8
 914              		.cfi_offset 14, -4
 915              	.LVL97:
1971:bluetooth_rxtx.c **** 	int i;
1972:bluetooth_rxtx.c **** 	u32 aa = 0;
1973:bluetooth_rxtx.c **** 
1974:bluetooth_rxtx.c **** #define ADV_ADDRESS_IDX 0
1975:bluetooth_rxtx.c **** #define HEADER_IDX 4
1976:bluetooth_rxtx.c **** #define DATA_LEN_IDX 5
1977:bluetooth_rxtx.c **** #define DATA_START_IDX 6
ARM GAS  /tmp/cc1G6faT.s 			page 54


1978:bluetooth_rxtx.c **** 
1979:bluetooth_rxtx.c **** 	// u8 *adv_addr = &packet[ADV_ADDRESS_IDX];
1980:bluetooth_rxtx.c **** 	u8 header = packet[HEADER_IDX];
1981:bluetooth_rxtx.c **** 	u8 *data_len = &packet[DATA_LEN_IDX];
1982:bluetooth_rxtx.c **** 	u8 *data = &packet[DATA_START_IDX];
1983:bluetooth_rxtx.c **** 	// u8 *crc = &packet[DATA_START_IDX + *data_len];
1984:bluetooth_rxtx.c **** 
1985:bluetooth_rxtx.c **** 	if (le.link_state == LINK_CONN_PENDING) {
 916              		.loc 1 1985 0
 917 0002 584B     		ldr	r3, .L92
1970:bluetooth_rxtx.c **** 	int i;
 918              		.loc 1 1970 0
 919 0004 0546     		mov	r5, r0
 920              		.loc 1 1985 0
 921 0006 1A7E     		ldrb	r2, [r3, #24]	@ zero_extendqisi2
1980:bluetooth_rxtx.c **** 	u8 *data_len = &packet[DATA_LEN_IDX];
 922              		.loc 1 1980 0
 923 0008 0179     		ldrb	r1, [r0, #4]	@ zero_extendqisi2
 924              	.LVL98:
 925              		.loc 1 1985 0
 926 000a 022A     		cmp	r2, #2
 927 000c 1C46     		mov	r4, r3
 928 000e 13D1     		bne	.L75
1986:bluetooth_rxtx.c **** 		// We received a packet in the connection pending state, so now the device *should* be connected
1987:bluetooth_rxtx.c **** 		le.link_state = LINK_CONNECTED;
 929              		.loc 1 1987 0
 930 0010 0322     		movs	r2, #3
 931 0012 1A76     		strb	r2, [r3, #24]
 932              	.LVL99:
1988:bluetooth_rxtx.c **** 		le.conn_epoch = clkn;
 933              		.loc 1 1988 0
 934 0014 544A     		ldr	r2, .L92+4
 935 0016 1268     		ldr	r2, [r2]
 936 0018 DA61     		str	r2, [r3, #28]
1989:bluetooth_rxtx.c **** 		le.interval_timer = le.conn_interval - 1;
 937              		.loc 1 1989 0
 938 001a 5A8C     		ldrh	r2, [r3, #34]
 939 001c 013A     		subs	r2, r2, #1
 940 001e 92B2     		uxth	r2, r2
 941 0020 1A84     		strh	r2, [r3, #32]	@ movhi
1990:bluetooth_rxtx.c **** 		le.conn_count = 0;
 942              		.loc 1 1990 0
 943 0022 0022     		movs	r2, #0
 944 0024 9A84     		strh	r2, [r3, #36]	@ movhi
1991:bluetooth_rxtx.c **** 		le.update_pending = 0;
 945              		.loc 1 1991 0
 946 0026 DA62     		str	r2, [r3, #44]
1992:bluetooth_rxtx.c **** 
1993:bluetooth_rxtx.c **** 		// hue hue hue
1994:bluetooth_rxtx.c **** 		if (jam_mode != JAM_NONE)
 947              		.loc 1 1994 0
 948 0028 504B     		ldr	r3, .L92+8
 949 002a DA7C     		ldrb	r2, [r3, #19]	@ zero_extendqisi2
 950 002c 002A     		cmp	r2, #0
 951 002e 00F09880 		beq	.L74
1995:bluetooth_rxtx.c **** 			le_jam_count = JAM_COUNT_DEFAULT;
 952              		.loc 1 1995 0
ARM GAS  /tmp/cc1G6faT.s 			page 55


 953 0032 2822     		movs	r2, #40
 954 0034 DA61     		str	r2, [r3, #28]
 955 0036 38BD     		pop	{r3, r4, r5, pc}
 956              	.LVL100:
 957              	.L75:
1996:bluetooth_rxtx.c **** 
1997:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_CONNECTED) {
 958              		.loc 1 1997 0
 959 0038 032A     		cmp	r2, #3
 960 003a 3BD1     		bne	.L78
 961              	.LBB11:
1998:bluetooth_rxtx.c **** 		u8 llid =  header & 0x03;
1999:bluetooth_rxtx.c **** 
2000:bluetooth_rxtx.c **** 		// Apply any connection parameter update if necessary
2001:bluetooth_rxtx.c **** 		if (le.update_pending && le.conn_count == le.update_instant) {
 962              		.loc 1 2001 0
 963 003c DB6A     		ldr	r3, [r3, #44]
1998:bluetooth_rxtx.c **** 		u8 llid =  header & 0x03;
 964              		.loc 1 1998 0
 965 003e 01F00301 		and	r1, r1, #3
 966              	.LVL101:
 967              		.loc 1 2001 0
 968 0042 A3B1     		cbz	r3, .L79
 969              		.loc 1 2001 0 is_stmt 0 discriminator 1
 970 0044 A38C     		ldrh	r3, [r4, #36]
 971 0046 228E     		ldrh	r2, [r4, #48]
 972 0048 9BB2     		uxth	r3, r3
 973 004a 9A42     		cmp	r2, r3
 974 004c 0FD1     		bne	.L79
2002:bluetooth_rxtx.c **** 			// This is the first packet received in the connection interval for which the new parameters app
2003:bluetooth_rxtx.c **** 			le.conn_epoch = clkn;
 975              		.loc 1 2003 0 is_stmt 1
 976 004e 464B     		ldr	r3, .L92+4
 977 0050 1B68     		ldr	r3, [r3]
 978 0052 E361     		str	r3, [r4, #28]
 979              	.LVL102:
2004:bluetooth_rxtx.c **** 			le.conn_interval = le.interval_update;
 980              		.loc 1 2004 0
 981 0054 638E     		ldrh	r3, [r4, #50]
 982 0056 6384     		strh	r3, [r4, #34]	@ movhi
2005:bluetooth_rxtx.c **** 			le.interval_timer = le.interval_update - 1;
 983              		.loc 1 2005 0
 984 0058 013B     		subs	r3, r3, #1
 985 005a 9BB2     		uxth	r3, r3
 986 005c 2384     		strh	r3, [r4, #32]	@ movhi
2006:bluetooth_rxtx.c **** 			le.win_size = le.win_size_update;
 987              		.loc 1 2006 0
 988 005e 94F83430 		ldrb	r3, [r4, #52]	@ zero_extendqisi2
 989 0062 84F82630 		strb	r3, [r4, #38]
2007:bluetooth_rxtx.c **** 			le.win_offset = le.win_offset_update;
 990              		.loc 1 2007 0
 991 0066 E38E     		ldrh	r3, [r4, #54]
 992 0068 2385     		strh	r3, [r4, #40]	@ movhi
2008:bluetooth_rxtx.c **** 			le.update_pending = 0;
 993              		.loc 1 2008 0
 994 006a 0023     		movs	r3, #0
 995 006c E362     		str	r3, [r4, #44]
ARM GAS  /tmp/cc1G6faT.s 			page 56


 996              	.L79:
2009:bluetooth_rxtx.c **** 		}
2010:bluetooth_rxtx.c **** 
2011:bluetooth_rxtx.c **** 		if (llid == 0x03 && data[0] == 0x00) {
 997              		.loc 1 2011 0
 998 006e 0329     		cmp	r1, #3
 999 0070 77D1     		bne	.L74
 1000              		.loc 1 2011 0 is_stmt 0 discriminator 1
 1001 0072 AB79     		ldrb	r3, [r5, #6]	@ zero_extendqisi2
 1002 0074 002B     		cmp	r3, #0
 1003 0076 74D1     		bne	.L74
2012:bluetooth_rxtx.c **** 			// This is a CONNECTION_UPDATE_REQ.
2013:bluetooth_rxtx.c **** 			// The host is changing the connection parameters.
2014:bluetooth_rxtx.c **** 			le.win_size_update = packet[7];
 1004              		.loc 1 2014 0 is_stmt 1
 1005 0078 EB79     		ldrb	r3, [r5, #7]	@ zero_extendqisi2
 1006 007a 84F83430 		strb	r3, [r4, #52]
2015:bluetooth_rxtx.c **** 			le.win_offset_update = packet[8] + ((u16)packet[9] << 8);
 1007              		.loc 1 2015 0
 1008 007e 6A7A     		ldrb	r2, [r5, #9]	@ zero_extendqisi2
 1009 0080 2B7A     		ldrb	r3, [r5, #8]	@ zero_extendqisi2
 1010 0082 03EB0223 		add	r3, r3, r2, lsl #8
 1011 0086 E386     		strh	r3, [r4, #54]	@ movhi
2016:bluetooth_rxtx.c **** 			le.interval_update = packet[10] + ((u16)packet[11] << 8);
 1012              		.loc 1 2016 0
 1013 0088 EA7A     		ldrb	r2, [r5, #11]	@ zero_extendqisi2
 1014 008a AB7A     		ldrb	r3, [r5, #10]	@ zero_extendqisi2
 1015 008c 03EB0223 		add	r3, r3, r2, lsl #8
 1016 0090 6386     		strh	r3, [r4, #50]	@ movhi
2017:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 1017              		.loc 1 2017 0
 1018 0092 6A7C     		ldrb	r2, [r5, #17]	@ zero_extendqisi2
 1019 0094 2B7C     		ldrb	r3, [r5, #16]	@ zero_extendqisi2
 1020 0096 03EB0223 		add	r3, r3, r2, lsl #8
2018:bluetooth_rxtx.c **** 			if (le.update_instant - le.conn_count < 32767)
 1021              		.loc 1 2018 0
 1022 009a A28C     		ldrh	r2, [r4, #36]
2017:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 1023              		.loc 1 2017 0
 1024 009c 9BB2     		uxth	r3, r3
 1025              		.loc 1 2018 0
 1026 009e 92B2     		uxth	r2, r2
2017:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 1027              		.loc 1 2017 0
 1028 00a0 2386     		strh	r3, [r4, #48]	@ movhi
 1029              		.loc 1 2018 0
 1030 00a2 9B1A     		subs	r3, r3, r2
 1031 00a4 47F6FE72 		movw	r2, #32766
 1032 00a8 9342     		cmp	r3, r2
 1033 00aa 5ADC     		bgt	.L74
2019:bluetooth_rxtx.c **** 				le.update_pending = 1;
 1034              		.loc 1 2019 0
 1035 00ac 2D4B     		ldr	r3, .L92
 1036 00ae 0122     		movs	r2, #1
 1037 00b0 DA62     		str	r2, [r3, #44]
 1038 00b2 38BD     		pop	{r3, r4, r5, pc}
 1039              	.LVL103:
ARM GAS  /tmp/cc1G6faT.s 			page 57


 1040              	.L78:
 1041              	.LBE11:
2020:bluetooth_rxtx.c **** 		}
2021:bluetooth_rxtx.c **** 
2022:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_LISTENING) {
 1042              		.loc 1 2022 0
 1043 00b4 012A     		cmp	r2, #1
 1044 00b6 54D1     		bne	.L74
 1045              	.LVL104:
 1046              	.LBB12:
2023:bluetooth_rxtx.c **** 		u8 pkt_type = packet[4] & 0x0F;
2024:bluetooth_rxtx.c **** 		if (pkt_type == 0x05) {
 1047              		.loc 1 2024 0
 1048 00b8 01F00F01 		and	r1, r1, #15
 1049              	.LVL105:
 1050 00bc 0529     		cmp	r1, #5
 1051 00be 50D1     		bne	.L74
 1052              	.LBB13:
2025:bluetooth_rxtx.c **** 			uint16_t conn_interval;
2026:bluetooth_rxtx.c **** 
2027:bluetooth_rxtx.c **** 			// ignore packets with incorrect length
2028:bluetooth_rxtx.c **** 			if (*data_len != 34)
 1053              		.loc 1 2028 0
 1054 00c0 4379     		ldrb	r3, [r0, #5]	@ zero_extendqisi2
 1055 00c2 222B     		cmp	r3, #34
 1056 00c4 4DD1     		bne	.L74
 1057              	.LVL106:
2029:bluetooth_rxtx.c **** 				return;
2030:bluetooth_rxtx.c **** 
2031:bluetooth_rxtx.c **** 			// conn interval must be [7.5 ms, 4.0s] in units of 1.25 ms
2032:bluetooth_rxtx.c **** 			conn_interval = (packet[29] << 8) | packet[28];
 1058              		.loc 1 2032 0
 1059 00c6 037F     		ldrb	r3, [r0, #28]	@ zero_extendqisi2
 1060 00c8 427F     		ldrb	r2, [r0, #29]	@ zero_extendqisi2
 1061 00ca 43EA0222 		orr	r2, r3, r2, lsl #8
2033:bluetooth_rxtx.c **** 			if (conn_interval < 6 || conn_interval > 3200)
 1062              		.loc 1 2033 0
 1063 00ce 063A     		subs	r2, r2, #6
 1064 00d0 92B2     		uxth	r2, r2
 1065 00d2 40F67A43 		movw	r3, #3194
 1066 00d6 9A42     		cmp	r2, r3
 1067 00d8 43D8     		bhi	.L74
2034:bluetooth_rxtx.c **** 				return;
2035:bluetooth_rxtx.c **** 
2036:bluetooth_rxtx.c **** 			// This is a connect packet
2037:bluetooth_rxtx.c **** 			// if we have a target, see if InitA or AdvA matches
2038:bluetooth_rxtx.c **** 			if (le.target_set &&
 1068              		.loc 1 2038 0
 1069 00da 236C     		ldr	r3, [r4, #64]
 1070 00dc 2BB9     		cbnz	r3, .L81
 1071              	.LVL107:
 1072              	.L83:
2039:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
2040:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
2041:bluetooth_rxtx.c **** 				return;
2042:bluetooth_rxtx.c **** 			}
2043:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cc1G6faT.s 			page 58


2044:bluetooth_rxtx.c **** 			le.link_state = LINK_CONN_PENDING;
 1073              		.loc 1 2044 0
 1074 00de 0223     		movs	r3, #2
2045:bluetooth_rxtx.c **** 			le.crc_verify = 0; // we will drop many packets if we attempt to filter by CRC
 1075              		.loc 1 2045 0
 1076 00e0 0020     		movs	r0, #0
2044:bluetooth_rxtx.c **** 			le.crc_verify = 0; // we will drop many packets if we attempt to filter by CRC
 1077              		.loc 1 2044 0
 1078 00e2 2376     		strb	r3, [r4, #24]
 1079              		.loc 1 2045 0
 1080 00e4 6061     		str	r0, [r4, #20]
 1081              	.LVL108:
2046:bluetooth_rxtx.c **** 
2047:bluetooth_rxtx.c **** 			for (i = 0; i < 4; ++i)
 1082              		.loc 1 2047 0
 1083 00e6 0346     		mov	r3, r0
 1084 00e8 11E0     		b	.L82
 1085              	.LVL109:
 1086              	.L81:
2039:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
 1087              		.loc 1 2039 0 discriminator 1
 1088 00ea 04F13800 		add	r0, r4, #56
 1089              	.LVL110:
 1090 00ee A91D     		adds	r1, r5, #6
 1091 00f0 0622     		movs	r2, #6
 1092 00f2 FFF7FEFF 		bl	memcmp
 1093              	.LVL111:
2038:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
 1094              		.loc 1 2038 0 discriminator 1
 1095 00f6 0028     		cmp	r0, #0
 1096 00f8 F1D0     		beq	.L83
2040:bluetooth_rxtx.c **** 				return;
 1097              		.loc 1 2040 0
 1098 00fa 04F13800 		add	r0, r4, #56
 1099 00fe 05F10C01 		add	r1, r5, #12
 1100 0102 0622     		movs	r2, #6
 1101 0104 FFF7FEFF 		bl	memcmp
 1102              	.LVL112:
2039:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
 1103              		.loc 1 2039 0
 1104 0108 0028     		cmp	r0, #0
 1105 010a E8D0     		beq	.L83
 1106 010c 38BD     		pop	{r3, r4, r5, pc}
 1107              	.LVL113:
 1108              	.L82:
 1109 010e EA18     		adds	r2, r5, r3
2048:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1110              		.loc 1 2048 0 discriminator 2
 1111 0110 917C     		ldrb	r1, [r2, #18]	@ zero_extendqisi2
 1112 0112 DA00     		lsls	r2, r3, #3
 1113 0114 01FA02F2 		lsl	r2, r1, r2
2047:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1114              		.loc 1 2047 0 discriminator 2
 1115 0118 0133     		adds	r3, r3, #1
 1116              	.LVL114:
 1117 011a 042B     		cmp	r3, #4
 1118              		.loc 1 2048 0 discriminator 2
ARM GAS  /tmp/cc1G6faT.s 			page 59


 1119 011c 40EA0200 		orr	r0, r0, r2
 1120              	.LVL115:
2047:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1121              		.loc 1 2047 0 discriminator 2
 1122 0120 F5D1     		bne	.L82
2049:bluetooth_rxtx.c **** 			le_set_access_address(aa);
 1123              		.loc 1 2049 0
 1124 0122 FFF7FEFF 		bl	le_set_access_address
 1125              	.LVL116:
2050:bluetooth_rxtx.c **** 
2051:bluetooth_rxtx.c **** #define CRC_INIT (2+4+6+6+4)
2052:bluetooth_rxtx.c **** 			le.crc_init = (packet[CRC_INIT+2] << 16)
2053:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1126              		.loc 1 2053 0
 1127 0126 E87D     		ldrb	r0, [r5, #23]	@ zero_extendqisi2
2052:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1128              		.loc 1 2052 0
 1129 0128 2B7E     		ldrb	r3, [r5, #24]	@ zero_extendqisi2
 1130              		.loc 1 2053 0
 1131 012a 0002     		lsls	r0, r0, #8
 1132 012c 40EA0340 		orr	r0, r0, r3, lsl #16
2054:bluetooth_rxtx.c **** 						|  packet[CRC_INIT+0];
 1133              		.loc 1 2054 0
 1134 0130 AB7D     		ldrb	r3, [r5, #22]	@ zero_extendqisi2
 1135 0132 1843     		orrs	r0, r0, r3
2052:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1136              		.loc 1 2052 0
 1137 0134 E060     		str	r0, [r4, #12]
2055:bluetooth_rxtx.c **** 			le.crc_init_reversed = rbit(le.crc_init);
 1138              		.loc 1 2055 0
 1139 0136 FFF7FEFF 		bl	rbit
 1140              	.LVL117:
2056:bluetooth_rxtx.c **** 
2057:bluetooth_rxtx.c **** #define WIN_SIZE (2+4+6+6+4+3)
2058:bluetooth_rxtx.c **** 			le.win_size = packet[WIN_SIZE];
 1141              		.loc 1 2058 0
 1142 013a 6B7E     		ldrb	r3, [r5, #25]	@ zero_extendqisi2
2055:bluetooth_rxtx.c **** 			le.crc_init_reversed = rbit(le.crc_init);
 1143              		.loc 1 2055 0
 1144 013c 2061     		str	r0, [r4, #16]
 1145              		.loc 1 2058 0
 1146 013e 84F82630 		strb	r3, [r4, #38]
2059:bluetooth_rxtx.c **** 
2060:bluetooth_rxtx.c **** #define WIN_OFFSET (2+4+6+6+4+3+1)
2061:bluetooth_rxtx.c **** 			le.win_offset = packet[WIN_OFFSET];
 1147              		.loc 1 2061 0
 1148 0142 AB7E     		ldrb	r3, [r5, #26]	@ zero_extendqisi2
 1149 0144 2385     		strh	r3, [r4, #40]	@ movhi
2062:bluetooth_rxtx.c **** 
2063:bluetooth_rxtx.c **** #define CONN_INTERVAL (2+4+6+6+4+3+1+2)
2064:bluetooth_rxtx.c **** 			le.conn_interval = (packet[CONN_INTERVAL+1] << 8)
 1150              		.loc 1 2064 0
 1151 0146 6A7F     		ldrb	r2, [r5, #29]	@ zero_extendqisi2
 1152 0148 2B7F     		ldrb	r3, [r5, #28]	@ zero_extendqisi2
 1153 014a 43EA0223 		orr	r3, r3, r2, lsl #8
 1154 014e 6384     		strh	r3, [r4, #34]	@ movhi
2065:bluetooth_rxtx.c **** 							 |  packet[CONN_INTERVAL+0];
ARM GAS  /tmp/cc1G6faT.s 			page 60


2066:bluetooth_rxtx.c **** 
2067:bluetooth_rxtx.c **** #define CHANNEL_INC (2+4+6+6+4+3+1+2+2+2+2+5)
2068:bluetooth_rxtx.c **** 			le.channel_increment = packet[CHANNEL_INC] & 0x1f;
 1155              		.loc 1 2068 0
 1156 0150 95F82730 		ldrb	r3, [r5, #39]	@ zero_extendqisi2
2069:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
2070:bluetooth_rxtx.c **** 
2071:bluetooth_rxtx.c **** 			// Hop to the initial channel immediately
2072:bluetooth_rxtx.c **** 			do_hop = 1;
 1157              		.loc 1 2072 0
 1158 0154 0122     		movs	r2, #1
2068:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
 1159              		.loc 1 2068 0
 1160 0156 03F01F03 		and	r3, r3, #31
 1161 015a A376     		strb	r3, [r4, #26]
2069:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
 1162              		.loc 1 2069 0
 1163 015c 6376     		strb	r3, [r4, #25]
 1164              		.loc 1 2072 0
 1165 015e 034B     		ldr	r3, .L92+8
 1166 0160 DA72     		strb	r2, [r3, #11]
 1167              	.L74:
 1168 0162 38BD     		pop	{r3, r4, r5, pc}
 1169              	.LVL118:
 1170              	.L93:
 1171              		.align	2
 1172              	.L92:
 1173 0164 00000000 		.word	.LANCHOR1
 1174 0168 00000000 		.word	clkn
 1175 016c 00000000 		.word	.LANCHOR0
 1176              	.LBE13:
 1177              	.LBE12:
 1178              		.cfi_endproc
 1179              	.LFE24:
 1181              		.global	__aeabi_llsl
 1182              		.section	.text.vendor_request_handler,"ax",%progbits
 1183              		.align	1
 1184              		.thumb
 1185              		.thumb_func
 1187              	vendor_request_handler:
 1188              	.LFB2:
 188:bluetooth_rxtx.c **** 	uint32_t clock;
 1189              		.loc 1 188 0
 1190              		.cfi_startproc
 1191              		@ args = 0, pretend = 0, frame = 0
 1192              		@ frame_needed = 0, uses_anonymous_args = 0
 1193              	.LVL119:
 1194 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1195              		.cfi_def_cfa_offset 24
 1196              		.cfi_offset 4, -24
 1197              		.cfi_offset 5, -20
 1198              		.cfi_offset 6, -16
 1199              		.cfi_offset 7, -12
 1200              		.cfi_offset 8, -8
 1201              		.cfi_offset 14, -4
 1202              	.LVL120:
 194:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cc1G6faT.s 			page 61


 1203              		.loc 1 194 0
 1204 0004 8A4C     		ldr	r4, .L254
 188:bluetooth_rxtx.c **** 	uint32_t clock;
 1205              		.loc 1 188 0
 1206 0006 1D46     		mov	r5, r3
 194:bluetooth_rxtx.c **** 
 1207              		.loc 1 194 0
 1208 0008 1B68     		ldr	r3, [r3]
 1209              	.LVL121:
 188:bluetooth_rxtx.c **** 	uint32_t clock;
 1210              		.loc 1 188 0
 1211 000a 0F46     		mov	r7, r1
 1212 000c 1646     		mov	r6, r2
 194:bluetooth_rxtx.c **** 
 1213              		.loc 1 194 0
 1214 000e 2362     		str	r3, [r4, #32]
 196:bluetooth_rxtx.c **** 
 1215              		.loc 1 196 0
 1216 0010 4D28     		cmp	r0, #77
 1217 0012 00F27083 		bhi	.L214
 1218 0016 DFE810F0 		tbh	[pc, r0, lsl #1]
 1219              	.LVL122:
 1220              	.L97:
 1221 001a 0401     		.2byte	(.L231-.L97)/2
 1222 001c 5000     		.2byte	(.L98-.L97)/2
 1223 001e 5400     		.2byte	(.L99-.L97)/2
 1224 0020 5700     		.2byte	(.L100-.L97)/2
 1225 0022 5C00     		.2byte	(.L101-.L97)/2
 1226 0024 5F00     		.2byte	(.L102-.L97)/2
 1227 0026 6400     		.2byte	(.L103-.L97)/2
 1228 0028 6700     		.2byte	(.L104-.L97)/2
 1229 002a 6900     		.2byte	(.L105-.L97)/2
 1230 002c 6D00     		.2byte	(.L106-.L97)/2
 1231 002e 7200     		.2byte	(.L107-.L97)/2
 1232 0030 C400     		.2byte	(.L108-.L97)/2
 1233 0032 CB00     		.2byte	(.L109-.L97)/2
 1234 0034 0901     		.2byte	(.L250-.L97)/2
 1235 0036 8000     		.2byte	(.L111-.L97)/2
 1236 0038 7B00     		.2byte	(.L112-.L97)/2
 1237 003a 8500     		.2byte	(.L113-.L97)/2
 1238 003c 8A00     		.2byte	(.L114-.L97)/2
 1239 003e 8D00     		.2byte	(.L115-.L97)/2
 1240 0040 9200     		.2byte	(.L116-.L97)/2
 1241 0042 9A00     		.2byte	(.L117-.L97)/2
 1242 0044 BD00     		.2byte	(.L118-.L97)/2
 1243 0046 BF00     		.2byte	(.L119-.L97)/2
 1244 0048 C100     		.2byte	(.L120-.L97)/2
 1245 004a 0201     		.2byte	(.L121-.L97)/2
 1246 004c 0601     		.2byte	(.L122-.L97)/2
 1247 004e 6E03     		.2byte	(.L214-.L97)/2
 1248 0050 2101     		.2byte	(.L123-.L97)/2
 1249 0052 9C00     		.2byte	(.L124-.L97)/2
 1250 0054 A300     		.2byte	(.L125-.L97)/2
 1251 0056 AD00     		.2byte	(.L126-.L97)/2
 1252 0058 AB00     		.2byte	(.L127-.L97)/2
 1253 005a AF00     		.2byte	(.L128-.L97)/2
 1254 005c 4E01     		.2byte	(.L129-.L97)/2
ARM GAS  /tmp/cc1G6faT.s 			page 62


 1255 005e 4001     		.2byte	(.L130-.L97)/2
 1256 0060 6B01     		.2byte	(.L131-.L97)/2
 1257 0062 6E01     		.2byte	(.L132-.L97)/2
 1258 0064 7201     		.2byte	(.L133-.L97)/2
 1259 0066 7601     		.2byte	(.L134-.L97)/2
 1260 0068 A901     		.2byte	(.L135-.L97)/2
 1261 006a DE01     		.2byte	(.L136-.L97)/2
 1262 006c 0202     		.2byte	(.L137-.L97)/2
 1263 006e 4202     		.2byte	(.L138-.L97)/2
 1264 0070 4902     		.2byte	(.L139-.L97)/2
 1265 0072 5402     		.2byte	(.L140-.L97)/2
 1266 0074 6B03     		.2byte	(.L207-.L97)/2
 1267 0076 6302     		.2byte	(.L142-.L97)/2
 1268 0078 6802     		.2byte	(.L143-.L97)/2
 1269 007a 6E02     		.2byte	(.L144-.L97)/2
 1270 007c 7502     		.2byte	(.L145-.L97)/2
 1271 007e 8402     		.2byte	(.L146-.L97)/2
 1272 0080 EB01     		.2byte	(.L147-.L97)/2
 1273 0082 F801     		.2byte	(.L148-.L97)/2
 1274 0084 9102     		.2byte	(.L149-.L97)/2
 1275 0086 E802     		.2byte	(.L150-.L97)/2
 1276 0088 5D01     		.2byte	(.L151-.L97)/2
 1277 008a 4D03     		.2byte	(.L152-.L97)/2
 1278 008c 6E03     		.2byte	(.L214-.L97)/2
 1279 008e B902     		.2byte	(.L153-.L97)/2
 1280 0090 6403     		.2byte	(.L154-.L97)/2
 1281 0092 6703     		.2byte	(.L155-.L97)/2
 1282 0094 C801     		.2byte	(.L156-.L97)/2
 1283 0096 DA01     		.2byte	(.L157-.L97)/2
 1284 0098 0D02     		.2byte	(.L158-.L97)/2
 1285 009a 6E03     		.2byte	(.L214-.L97)/2
 1286 009c 4E00     		.2byte	(.L159-.L97)/2
 1287 009e CF02     		.2byte	(.L160-.L97)/2
 1288 00a0 3E01     		.2byte	(.L161-.L97)/2
 1289 00a2 DF02     		.2byte	(.L162-.L97)/2
 1290 00a4 1402     		.2byte	(.L163-.L97)/2
 1291 00a6 F302     		.2byte	(.L164-.L97)/2
 1292 00a8 FE02     		.2byte	(.L165-.L97)/2
 1293 00aa 0A03     		.2byte	(.L166-.L97)/2
 1294 00ac 1503     		.2byte	(.L167-.L97)/2
 1295 00ae 2003     		.2byte	(.L168-.L97)/2
 1296 00b0 2B03     		.2byte	(.L169-.L97)/2
 1297 00b2 3603     		.2byte	(.L170-.L97)/2
 1298 00b4 4103     		.2byte	(.L171-.L97)/2
 1299              	.L159:
 1300 00b6 0024     		movs	r4, #0
 1301 00b8 6DE2     		b	.L172
 1302              	.L98:
 203:bluetooth_rxtx.c **** 		*data_len = 0;
 1303              		.loc 1 203 0
 1304 00ba 0120     		movs	r0, #1
 1305              	.LVL123:
 1306 00bc A074     		strb	r0, [r4, #18]
 204:bluetooth_rxtx.c **** 		break;
 1307              		.loc 1 204 0
 1308 00be 0023     		movs	r3, #0
 1309 00c0 A0E1     		b	.L224
ARM GAS  /tmp/cc1G6faT.s 			page 63


 1310              	.LVL124:
 1311              	.L99:
 208:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 1312              		.loc 1 208 0
 1313 00c2 0223     		movs	r3, #2
 1314 00c4 A372     		strb	r3, [r4, #10]
 1315 00c6 F4E0     		b	.L246
 1316              	.L100:
 214:bluetooth_rxtx.c **** 		*data_len = 1;
 1317              		.loc 1 214 0
 1318 00c8 5A4B     		ldr	r3, .L254+4
 1319 00ca 1B68     		ldr	r3, [r3]
 1320 00cc C3F34003 		ubfx	r3, r3, #1, #1
 1321 00d0 17E1     		b	.L225
 1322              	.L101:
 219:bluetooth_rxtx.c **** 			USRLED_SET;
 1323              		.loc 1 219 0
 1324 00d2 0A88     		ldrh	r2, [r1]
 1325 00d4 0223     		movs	r3, #2
 1326 00d6 15E0     		b	.L243
 1327              	.L102:
 226:bluetooth_rxtx.c **** 		*data_len = 1;
 1328              		.loc 1 226 0
 1329 00d8 564B     		ldr	r3, .L254+4
 1330 00da 1B68     		ldr	r3, [r3]
 1331 00dc C3F30013 		ubfx	r3, r3, #4, #1
 1332 00e0 0FE1     		b	.L225
 1333              	.L103:
 231:bluetooth_rxtx.c **** 			RXLED_SET;
 1334              		.loc 1 231 0
 1335 00e2 0A88     		ldrh	r2, [r1]
 1336 00e4 1023     		movs	r3, #16
 1337 00e6 0DE0     		b	.L243
 1338              	.L104:
 238:bluetooth_rxtx.c **** 		*data_len = 1;
 1339              		.loc 1 238 0
 1340 00e8 524B     		ldr	r3, .L254+4
 1341 00ea 24E0     		b	.L248
 1342              	.L105:
 243:bluetooth_rxtx.c **** 			TXLED_SET;
 1343              		.loc 1 243 0
 1344 00ec 0A88     		ldrh	r2, [r1]
 1345 00ee 4FF48073 		mov	r3, #256
 1346 00f2 07E0     		b	.L243
 1347              	.L106:
 250:bluetooth_rxtx.c **** 		*data_len = 1;
 1348              		.loc 1 250 0
 1349 00f4 4F4B     		ldr	r3, .L254+4
 1350 00f6 1B68     		ldr	r3, [r3]
 1351 00f8 C3F34023 		ubfx	r3, r3, #9, #1
 1352 00fc 01E1     		b	.L225
 1353              	.L107:
 255:bluetooth_rxtx.c **** 			CC1V8_SET;
 1354              		.loc 1 255 0
 1355 00fe 0A88     		ldrh	r2, [r1]
 1356 0100 4FF40073 		mov	r3, #512
 1357              	.L243:
ARM GAS  /tmp/cc1G6faT.s 			page 64


 1358 0104 12B9     		cbnz	r2, .L253
 246:bluetooth_rxtx.c **** 		break;
 1359              		.loc 1 246 0
 1360 0106 4C4A     		ldr	r2, .L254+8
 1361              	.L227:
 1362 0108 1360     		str	r3, [r2]
 1363 010a F1E2     		b	.L207
 1364              	.L253:
 256:bluetooth_rxtx.c **** 		else
 1365              		.loc 1 256 0
 1366 010c 4B4A     		ldr	r2, .L254+12
 1367 010e FBE7     		b	.L227
 1368              	.L112:
 262:bluetooth_rxtx.c **** 		break;
 1369              		.loc 1 262 0
 1370 0110 3046     		mov	r0, r6
 1371              	.LVL125:
 1372 0112 2946     		mov	r1, r5
 1373              	.LVL126:
 1374 0114 FFF7FEFF 		bl	get_part_num
 1375              	.LVL127:
 1376 0118 EAE2     		b	.L207
 1377              	.LVL128:
 1378              	.L111:
 270:bluetooth_rxtx.c **** 		break;
 1379              		.loc 1 270 0
 1380 011a 3046     		mov	r0, r6
 1381              	.LVL129:
 1382 011c 2946     		mov	r1, r5
 1383              	.LVL130:
 1384 011e FFF7FEFF 		bl	get_device_serial
 1385              	.LVL131:
 1386 0122 E5E2     		b	.L207
 1387              	.LVL132:
 1388              	.L113:
 275:bluetooth_rxtx.c **** 		*data_len = 1;
 1389              		.loc 1 275 0
 1390 0124 464B     		ldr	r3, .L254+16
 1391 0126 1B68     		ldr	r3, [r3]
 1392 0128 C3F3C013 		ubfx	r3, r3, #7, #1
 1393 012c E9E0     		b	.L225
 1394              	.L114:
 280:bluetooth_rxtx.c **** 			PAEN_SET;
 1395              		.loc 1 280 0
 1396 012e 0A88     		ldrh	r2, [r1]
 1397 0130 8023     		movs	r3, #128
 1398 0132 07E0     		b	.L245
 1399              	.L115:
 287:bluetooth_rxtx.c **** 		*data_len = 1;
 1400              		.loc 1 287 0
 1401 0134 424B     		ldr	r3, .L254+16
 1402              	.L248:
 1403 0136 1B68     		ldr	r3, [r3]
 1404 0138 C3F30023 		ubfx	r3, r3, #8, #1
 1405 013c E1E0     		b	.L225
 1406              	.L116:
 292:bluetooth_rxtx.c **** 			HGM_SET;
ARM GAS  /tmp/cc1G6faT.s 			page 65


 1407              		.loc 1 292 0
 1408 013e 0A88     		ldrh	r2, [r1]
 1409 0140 4FF48073 		mov	r3, #256
 1410              	.L245:
 1411 0144 0AB1     		cbz	r2, .L178
 293:bluetooth_rxtx.c **** 		else
 1412              		.loc 1 293 0
 1413 0146 3F4A     		ldr	r2, .L254+20
 1414 0148 DEE7     		b	.L227
 1415              	.L178:
 295:bluetooth_rxtx.c **** 		break;
 1416              		.loc 1 295 0
 1417 014a 3F4A     		ldr	r2, .L254+24
 1418 014c DCE7     		b	.L227
 1419              	.L117:
 301:bluetooth_rxtx.c **** 		break;
 1420              		.loc 1 301 0
 1421 014e 0323     		movs	r3, #3
 1422 0150 AEE2     		b	.L230
 1423              	.L124:
 305:bluetooth_rxtx.c **** 		*data_len = 1;
 1424              		.loc 1 305 0
 1425 0152 0520     		movs	r0, #5
 1426              	.LVL133:
 1427 0154 FFF7FEFF 		bl	cc2400_get
 1428              	.LVL134:
 1429 0158 00F00700 		and	r0, r0, #7
 1430 015c 3070     		strb	r0, [r6]
 1431 015e DCE1     		b	.L221
 1432              	.LVL135:
 1433              	.L125:
 310:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 1434              		.loc 1 310 0
 1435 0160 0988     		ldrh	r1, [r1]
 1436              	.LVL136:
 1437 0162 0729     		cmp	r1, #7
 1438 0164 00F2C782 		bhi	.L214
 311:bluetooth_rxtx.c **** 		} else {
 1439              		.loc 1 311 0
 1440 0168 0520     		movs	r0, #5
 1441              	.LVL137:
 1442 016a 41F00801 		orr	r1, r1, #8
 1443 016e 0FE2     		b	.L235
 1444              	.LVL138:
 1445              	.L127:
 318:bluetooth_rxtx.c **** 		break;
 1446              		.loc 1 318 0
 1447 0170 0523     		movs	r3, #5
 1448 0172 9DE2     		b	.L230
 1449              	.L126:
 322:bluetooth_rxtx.c **** 		break;
 1450              		.loc 1 322 0
 1451 0174 0623     		movs	r3, #6
 1452 0176 9BE2     		b	.L230
 1453              	.L128:
 327:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 1454              		.loc 1 327 0
ARM GAS  /tmp/cc1G6faT.s 			page 66


 1455 0178 344B     		ldr	r3, .L254+28
 1456 017a 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1457 017c 3270     		strb	r2, [r6]
 328:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 1458              		.loc 1 328 0
 1459 017e 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 1460 0180 7270     		strb	r2, [r6, #1]
 329:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 1461              		.loc 1 329 0
 1462 0182 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 1463 0184 B270     		strb	r2, [r6, #2]
 330:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 1464              		.loc 1 330 0
 1465 0186 DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 1466 0188 F270     		strb	r2, [r6, #3]
 331:bluetooth_rxtx.c **** 		*data_len = 5;
 1467              		.loc 1 331 0
 1468 018a 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 1469 018c 3371     		strb	r3, [r6, #4]
 332:bluetooth_rxtx.c **** 		break;
 1470              		.loc 1 332 0
 1471 018e 0523     		movs	r3, #5
 1472              	.LVL139:
 1473              	.L233:
 1474 0190 2B60     		str	r3, [r5]
 1475 0192 ADE2     		b	.L207
 1476              	.LVL140:
 1477              	.L118:
 336:bluetooth_rxtx.c **** 		break;
 1478              		.loc 1 336 0
 1479 0194 0023     		movs	r3, #0
 1480 0196 8BE2     		b	.L230
 1481              	.L119:
 340:bluetooth_rxtx.c **** 		*data_len = 1;
 1482              		.loc 1 340 0
 1483 0198 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 1484 019a B2E0     		b	.L225
 1485              	.L120:
 345:bluetooth_rxtx.c **** 		break;
 1486              		.loc 1 345 0
 1487 019c 0B78     		ldrb	r3, [r1]	@ zero_extendqisi2
 1488 019e 2370     		strb	r3, [r4]
 1489 01a0 A6E2     		b	.L207
 1490              	.L108:
 349:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
 1491              		.loc 1 349 0
 1492 01a2 2B4B     		ldr	r3, .L254+32
 1493 01a4 1A88     		ldrh	r2, [r3]
 1494 01a6 3270     		strb	r2, [r6]
 350:bluetooth_rxtx.c **** 		*data_len = 2;
 1495              		.loc 1 350 0
 1496 01a8 1B88     		ldrh	r3, [r3]
 1497 01aa C3F30723 		ubfx	r3, r3, #8, #8
 1498 01ae 9AE1     		b	.L252
 1499              	.L109:
 355:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 1500              		.loc 1 355 0
ARM GAS  /tmp/cc1G6faT.s 			page 67


 1501 01b0 0A88     		ldrh	r2, [r1]
 1502 01b2 1F4B     		ldr	r3, .L254
 1503 01b4 E281     		strh	r2, [r4, #14]	@ movhi
 357:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 1504              		.loc 1 357 0
 1505 01b6 E189     		ldrh	r1, [r4, #14]
 1506              	.LVL141:
 1507 01b8 40F6EA22 		movw	r2, #2794
 1508 01bc 89B2     		uxth	r1, r1
 1509 01be 9142     		cmp	r1, r2
 1510 01c0 05D9     		bls	.L179
 358:bluetooth_rxtx.c **** 			requested_channel = 2402;
 1511              		.loc 1 358 0
 1512 01c2 0122     		movs	r2, #1
 1513 01c4 9A72     		strb	r2, [r3, #10]
 359:bluetooth_rxtx.c **** 		}
 1514              		.loc 1 359 0
 1515 01c6 40F66212 		movw	r2, #2402
 1516 01ca DA81     		strh	r2, [r3, #14]	@ movhi
 1517 01cc 17E0     		b	.L180
 1518              	.L179:
 363:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 1519              		.loc 1 363 0
 1520 01ce 0022     		movs	r2, #0
 1521 01d0 9A72     		strb	r2, [r3, #10]
 364:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 1522              		.loc 1 364 0
 1523 01d2 D989     		ldrh	r1, [r3, #14]
 1524 01d4 40F6DC02 		movw	r2, #2268
 1525 01d8 89B2     		uxth	r1, r1
 1526 01da 9142     		cmp	r1, r2
 1527 01dc 8ABF     		itet	hi
 1528 01de DB89     		ldrhhi	r3, [r3, #14]
 1529 01e0 1346     		movls	r3, r2
 1530 01e2 9BB2     		uxthhi	r3, r3
 1531 01e4 E381     		strh	r3, [r4, #14]	@ movhi
 365:bluetooth_rxtx.c **** 		}
 1532              		.loc 1 365 0
 1533 01e6 E289     		ldrh	r2, [r4, #14]
 1534 01e8 40F6E923 		movw	r3, #2793
 1535 01ec 92B2     		uxth	r2, r2
 1536 01ee 9A42     		cmp	r2, r3
 1537 01f0 97BF     		itett	ls
 1538 01f2 0F4B     		ldrls	r3, .L254
 1539 01f4 40F6EA23 		movwhi	r3, #2794
 1540 01f8 DB89     		ldrhls	r3, [r3, #14]
 1541 01fa 9BB2     		uxthls	r3, r3
 1542 01fc E381     		strh	r3, [r4, #14]	@ movhi
 1543              	.L180:
 368:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 1544              		.loc 1 368 0
 1545 01fe E189     		ldrh	r1, [r4, #14]
 1546 0200 134B     		ldr	r3, .L254+32
 1547 0202 89B2     		uxth	r1, r1
 1548 0204 A3F84A10 		strh	r1, [r3, #74]	@ movhi
 369:bluetooth_rxtx.c **** 			channel = requested_channel;
 1549              		.loc 1 369 0
ARM GAS  /tmp/cc1G6faT.s 			page 68


 1550 0208 617C     		ldrb	r1, [r4, #17]	@ zero_extendqisi2
 368:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 1551              		.loc 1 368 0
 1552 020a 094A     		ldr	r2, .L254
 369:bluetooth_rxtx.c **** 			channel = requested_channel;
 1553              		.loc 1 369 0
 1554 020c 0929     		cmp	r1, #9
 1555 020e 00F06F82 		beq	.L207
 370:bluetooth_rxtx.c **** 			requested_channel = 0;
 1556              		.loc 1 370 0
 1557 0212 D189     		ldrh	r1, [r2, #14]
 1558 0214 89B2     		uxth	r1, r1
 1559 0216 1980     		strh	r1, [r3]	@ movhi
 371:bluetooth_rxtx.c **** 
 1560              		.loc 1 371 0
 1561 0218 0021     		movs	r1, #0
 1562 021a D181     		strh	r1, [r2, #14]	@ movhi
 1563 021c 89E1     		b	.L237
 1564              	.LVL142:
 1565              	.L121:
 380:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 1566              		.loc 1 380 0
 1567 021e FFF7FEFF 		bl	set_isp
 1568              	.LVL143:
 1569              	.L231:
 381:bluetooth_rxtx.c **** 		break;
 1570              		.loc 1 381 0
 1571 0222 0023     		movs	r3, #0
 1572 0224 B4E7     		b	.L233
 1573              	.LVL144:
 1574              	.L122:
 385:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 1575              		.loc 1 385 0
 1576 0226 0B4A     		ldr	r2, .L254+36
 1577 0228 0B4B     		ldr	r3, .L254+40
 1578 022a 1A60     		str	r2, [r3]
 1579              	.L250:
 386:bluetooth_rxtx.c **** 		break;
 1580              		.loc 1 386 0
 1581 022c 0B23     		movs	r3, #11
 1582 022e 3FE2     		b	.L230
 1583              	.L255:
 1584              		.align	2
 1585              	.L254:
 1586 0230 00000000 		.word	.LANCHOR0
 1587 0234 34C00920 		.word	537509940
 1588 0238 3CC00920 		.word	537509948
 1589 023c 38C00920 		.word	537509944
 1590 0240 54C00920 		.word	537509972
 1591 0244 58C00920 		.word	537509976
 1592 0248 5CC00920 		.word	537509980
 1593 024c 00000000 		.word	rr
 1594 0250 00000000 		.word	.LANCHOR1
 1595 0254 21BB0543 		.word	1124449057
 1596 0258 00000000 		.word	bootloader_ctrl
 1597              	.L123:
 390:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
ARM GAS  /tmp/cc1G6faT.s 			page 69


 1598              		.loc 1 390 0
 1599 025c 0A88     		ldrh	r2, [r1]
 1600 025e 6FF4006C 		mvn	ip, #2048
 1601 0262 02EB0C03 		add	r3, r2, ip
 1602 0266 40F2FF31 		movw	r1, #1023
 1603              	.LVL145:
 1604 026a 9BB2     		uxth	r3, r3
 1605 026c 8B42     		cmp	r3, r1
 1606 026e 00F24282 		bhi	.L214
 391:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1607              		.loc 1 391 0 discriminator 1
 1608 0272 7B88     		ldrh	r3, [r7, #2]
 390:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 1609              		.loc 1 390 0 discriminator 1
 1610 0274 6FF40066 		mvn	r6, #2048
 1611              	.LVL146:
 1612 0278 9819     		adds	r0, r3, r6
 1613              	.LVL147:
 1614 027a 80B2     		uxth	r0, r0
 1615 027c 8842     		cmp	r0, r1
 1616 027e 00F23A82 		bhi	.L214
 391:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1617              		.loc 1 391 0 discriminator 1
 1618 0282 9342     		cmp	r3, r2
 1619 0284 C0F03782 		bcc	.L214
 394:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 1620              		.loc 1 394 0
 1621 0288 B049     		ldr	r1, .L256
 1622 028a A1F84C20 		strh	r2, [r1, #76]	@ movhi
 395:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 1623              		.loc 1 395 0
 1624 028e A1F84E30 		strh	r3, [r1, #78]	@ movhi
 396:bluetooth_rxtx.c **** 		*data_len = 0;
 1625              		.loc 1 396 0
 1626 0292 0423     		movs	r3, #4
 1627 0294 0DE0     		b	.L246
 1628              	.LVL148:
 1629              	.L161:
 401:bluetooth_rxtx.c **** 		*data_len = 0;
 1630              		.loc 1 401 0
 1631 0296 0F23     		movs	r3, #15
 1632 0298 0BE0     		b	.L246
 1633              	.L130:
 406:bluetooth_rxtx.c **** 			return 0;
 1634              		.loc 1 406 0
 1635 029a 0B88     		ldrh	r3, [r1]
 1636 029c B3F5807F 		cmp	r3, #256
 1637 02a0 00F22982 		bhi	.L214
 408:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 1638              		.loc 1 408 0
 1639 02a4 C3F13603 		rsb	r3, r3, #54
 1640 02a8 A84A     		ldr	r2, .L256
 1641 02aa DBB2     		uxtb	r3, r3
 1642 02ac 82F85030 		strb	r3, [r2, #80]
 409:bluetooth_rxtx.c **** 		*data_len = 0;
 1643              		.loc 1 409 0
 1644 02b0 0723     		movs	r3, #7
ARM GAS  /tmp/cc1G6faT.s 			page 70


 1645              	.LVL149:
 1646              	.L246:
 1647 02b2 A374     		strb	r3, [r4, #18]
 1648 02b4 B5E7     		b	.L231
 1649              	.LVL150:
 1650              	.L129:
 414:bluetooth_rxtx.c **** 		data[1] = 0x00;
 1651              		.loc 1 414 0
 1652 02b6 0023     		movs	r3, #0
 1653 02b8 3370     		strb	r3, [r6]
 415:bluetooth_rxtx.c **** 
 1654              		.loc 1 415 0
 1655 02ba 7370     		strb	r3, [r6, #1]
 417:bluetooth_rxtx.c **** 		data[2] = length;
 1656              		.loc 1 417 0
 1657 02bc A448     		ldr	r0, .L256+4
 1658              	.LVL151:
 1659 02be FFF7FEFF 		bl	strlen
 1660              	.LVL152:
 1661 02c2 C4B2     		uxtb	r4, r0
 1662              	.LVL153:
 418:bluetooth_rxtx.c **** 
 1663              		.loc 1 418 0
 1664 02c4 B470     		strb	r4, [r6, #2]
 420:bluetooth_rxtx.c **** 
 1665              		.loc 1 420 0
 1666 02c6 2246     		mov	r2, r4
 1667 02c8 F01C     		adds	r0, r6, #3
 1668 02ca A149     		ldr	r1, .L256+4
 1669 02cc FFF7FEFF 		bl	memcpy
 1670              	.LVL154:
 422:bluetooth_rxtx.c **** 		break;
 1671              		.loc 1 422 0
 1672 02d0 0334     		adds	r4, r4, #3
 1673              	.LVL155:
 1674 02d2 0BE0     		b	.L236
 1675              	.LVL156:
 1676              	.L151:
 426:bluetooth_rxtx.c **** 		data[0] = length;
 1677              		.loc 1 426 0
 1678 02d4 9F48     		ldr	r0, .L256+8
 1679              	.LVL157:
 1680 02d6 FFF7FEFF 		bl	strlen
 1681              	.LVL158:
 1682 02da C4B2     		uxtb	r4, r0
 1683              	.LVL159:
 427:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 1684              		.loc 1 427 0
 1685 02dc 3046     		mov	r0, r6
 1686 02de 00F8014B 		strb	r4, [r0], #1
 428:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 1687              		.loc 1 428 0
 1688 02e2 2246     		mov	r2, r4
 1689 02e4 9B49     		ldr	r1, .L256+8
 1690 02e6 FFF7FEFF 		bl	memcpy
 1691              	.LVL160:
 429:bluetooth_rxtx.c **** 		break;
ARM GAS  /tmp/cc1G6faT.s 			page 71


 1692              		.loc 1 429 0
 1693 02ea 0134     		adds	r4, r4, #1
 1694              	.LVL161:
 1695              	.L236:
 1696 02ec 2C60     		str	r4, [r5]
 1697 02ee FFE1     		b	.L207
 1698              	.LVL162:
 1699              	.L131:
 433:bluetooth_rxtx.c **** 		*data_len = 1;
 1700              		.loc 1 433 0
 1701 02f0 0120     		movs	r0, #1
 1702              	.LVL163:
 1703 02f2 3070     		strb	r0, [r6]
 1704 02f4 12E1     		b	.L222
 1705              	.LVL164:
 1706              	.L132:
 438:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1707              		.loc 1 438 0
 1708 02f6 0A88     		ldrh	r2, [r1]
 1709 02f8 974B     		ldr	r3, .L256+12
 1710 02fa 1A70     		strb	r2, [r3]
 1711 02fc 18E1     		b	.L234
 1712              	.L133:
 443:bluetooth_rxtx.c **** 		*data_len = 1;
 1713              		.loc 1 443 0
 1714 02fe 964B     		ldr	r3, .L256+12
 1715 0300 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1716              	.L225:
 1717 0302 3370     		strb	r3, [r6]
 1718 0304 09E1     		b	.L221
 1719              	.L134:
 448:bluetooth_rxtx.c **** 		target.syncword = 0;
 1720              		.loc 1 448 0
 1721 0306 954F     		ldr	r7, .L256+16
 1722 0308 0024     		movs	r4, #0
 1723 030a 0025     		movs	r5, #0
 1724              	.LVL165:
 1725 030c C7E90045 		strd	r4, [r7]
 449:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 1726              		.loc 1 449 0
 1727 0310 C7E90245 		strd	r4, [r7, #8]
 1728              	.LVL166:
 1729              	.LBB14:
 450:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1730              		.loc 1 450 0
 1731 0314 4FF00008 		mov	r8, #0
 1732              	.LVL167:
 1733              	.L185:
 451:bluetooth_rxtx.c **** 		}
 1734              		.loc 1 451 0 discriminator 2
 1735 0318 16F80800 		ldrb	r0, [r6, r8]	@ zero_extendqisi2
 1736 031c 4FEAC802 		lsl	r2, r8, #3
 1737 0320 0021     		movs	r1, #0
 1738 0322 FFF7FEFF 		bl	__aeabi_llsl
 1739              	.LVL168:
 1740 0326 D7E90045 		ldrd	r4, [r7]
 450:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
ARM GAS  /tmp/cc1G6faT.s 			page 72


 1741              		.loc 1 450 0 discriminator 2
 1742 032a 08F10108 		add	r8, r8, #1
 1743              	.LVL169:
 451:bluetooth_rxtx.c **** 		}
 1744              		.loc 1 451 0 discriminator 2
 1745 032e 2043     		orrs	r0, r0, r4
 1746 0330 2943     		orrs	r1, r1, r5
 450:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1747              		.loc 1 450 0 discriminator 2
 1748 0332 B8F1080F 		cmp	r8, #8
 451:bluetooth_rxtx.c **** 		}
 1749              		.loc 1 451 0 discriminator 2
 1750 0336 C7E90001 		strd	r0, [r7]
 450:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1751              		.loc 1 450 0 discriminator 2
 1752 033a EDD1     		bne	.L185
 450:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1753              		.loc 1 450 0 is_stmt 0
 1754 033c 4FF00008 		mov	r8, #0
 1755              	.LVL170:
 1756              	.L187:
 1757 0340 06EB0803 		add	r3, r6, r8
 1758              	.LBE14:
 1759              	.LBB15:
 454:bluetooth_rxtx.c **** 		}
 1760              		.loc 1 454 0 is_stmt 1 discriminator 2
 1761 0344 187A     		ldrb	r0, [r3, #8]	@ zero_extendqisi2
 1762 0346 4FEAC802 		lsl	r2, r8, #3
 1763 034a 0021     		movs	r1, #0
 1764 034c FFF7FEFF 		bl	__aeabi_llsl
 1765              	.LVL171:
 1766 0350 D7E90245 		ldrd	r4, [r7, #8]
 453:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1767              		.loc 1 453 0 discriminator 2
 1768 0354 08F10108 		add	r8, r8, #1
 1769              	.LVL172:
 454:bluetooth_rxtx.c **** 		}
 1770              		.loc 1 454 0 discriminator 2
 1771 0358 2043     		orrs	r0, r0, r4
 1772 035a 2943     		orrs	r1, r1, r5
 453:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1773              		.loc 1 453 0 discriminator 2
 1774 035c B8F1080F 		cmp	r8, #8
 454:bluetooth_rxtx.c **** 		}
 1775              		.loc 1 454 0 discriminator 2
 1776 0360 C7E90201 		strd	r0, [r7, #8]
 453:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1777              		.loc 1 453 0 discriminator 2
 1778 0364 ECD1     		bne	.L187
 1779              	.LBE15:
 456:bluetooth_rxtx.c **** 		break;
 1780              		.loc 1 456 0
 1781 0366 FFF7FEFF 		bl	precalc
 1782              	.LVL173:
 1783 036a C1E1     		b	.L207
 1784              	.LVL174:
 1785              	.L135:
ARM GAS  /tmp/cc1G6faT.s 			page 73


 460:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 1786              		.loc 1 460 0
 1787 036c 7C4A     		ldr	r2, .L256+20
 1788 036e 0023     		movs	r3, #0
 1789 0370 1360     		str	r3, [r2]
 1790              	.LVL175:
 1791              	.L189:
 1792              	.LBB16:
 462:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
 1793              		.loc 1 462 0 discriminator 2
 1794 0372 1168     		ldr	r1, [r2]
 1795 0374 0902     		lsls	r1, r1, #8
 1796 0376 1160     		str	r1, [r2]
 463:bluetooth_rxtx.c **** 		}
 1797              		.loc 1 463 0 discriminator 2
 1798 0378 F05C     		ldrb	r0, [r6, r3]	@ zero_extendqisi2
 1799 037a 1168     		ldr	r1, [r2]
 461:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1800              		.loc 1 461 0 discriminator 2
 1801 037c 0133     		adds	r3, r3, #1
 1802              	.LVL176:
 463:bluetooth_rxtx.c **** 		}
 1803              		.loc 1 463 0 discriminator 2
 1804 037e 0143     		orrs	r1, r1, r0
 461:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1805              		.loc 1 461 0 discriminator 2
 1806 0380 042B     		cmp	r3, #4
 463:bluetooth_rxtx.c **** 		}
 1807              		.loc 1 463 0 discriminator 2
 1808 0382 1160     		str	r1, [r2]
 461:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1809              		.loc 1 461 0 discriminator 2
 1810 0384 F5D1     		bne	.L189
 1811              	.LBE16:
 465:bluetooth_rxtx.c **** 		dma_discard = 1;
 1812              		.loc 1 465 0
 1813 0386 0223     		movs	r3, #2
 1814              	.LVL177:
 1815 0388 A372     		strb	r3, [r4, #10]
 467:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1816              		.loc 1 467 0
 1817 038a 764B     		ldr	r3, .L256+24
 466:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1818              		.loc 1 466 0
 1819 038c 0120     		movs	r0, #1
 467:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1820              		.loc 1 467 0
 1821 038e 4FF08052 		mov	r2, #268435456
 466:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1822              		.loc 1 466 0
 1823 0392 2074     		strb	r0, [r4, #16]
 467:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1824              		.loc 1 467 0
 1825 0394 1A60     		str	r2, [r3]
 468:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 1826              		.loc 1 468 0
 1827 0396 7379     		ldrb	r3, [r6, #5]	@ zero_extendqisi2
ARM GAS  /tmp/cc1G6faT.s 			page 74


 1828 0398 3279     		ldrb	r2, [r6, #4]	@ zero_extendqisi2
 1829 039a 43EA0222 		orr	r2, r3, r2, lsl #8
 1830 039e 724B     		ldr	r3, .L256+28
 1831 03a0 1A80     		strh	r2, [r3]	@ movhi
 469:bluetooth_rxtx.c **** 		break;
 1832              		.loc 1 469 0
 1833 03a2 0823     		movs	r3, #8
 1834 03a4 A374     		strb	r3, [r4, #18]
 470:bluetooth_rxtx.c **** 
 1835              		.loc 1 470 0
 1836 03a6 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1837              	.LVL178:
 1838              	.L156:
 473:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 1839              		.loc 1 473 0
 1840 03aa 0523     		movs	r3, #5
 1841 03ac A372     		strb	r3, [r4, #10]
 474:bluetooth_rxtx.c **** 
 1842              		.loc 1 474 0
 1843 03ae 0E23     		movs	r3, #14
 1844 03b0 A374     		strb	r3, [r4, #18]
 1845              	.LVL179:
 1846              	.LBB17:
 476:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1847              		.loc 1 476 0
 1848 03b2 0023     		movs	r3, #0
 1849              	.LVL180:
 1850              	.L191:
 477:bluetooth_rxtx.c **** 		}
 1851              		.loc 1 477 0 discriminator 2
 1852 03b4 6D49     		ldr	r1, .L256+32
 1853 03b6 0022     		movs	r2, #0
 1854 03b8 5A54     		strb	r2, [r3, r1]
 476:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1855              		.loc 1 476 0 discriminator 2
 1856 03ba 0133     		adds	r3, r3, #1
 1857              	.LVL181:
 1858 03bc 0A2B     		cmp	r3, #10
 1859 03be F9D1     		bne	.L191
 1860              	.LBE17:
 479:bluetooth_rxtx.c **** 		afh_enabled = 1;
 1861              		.loc 1 479 0
 1862 03c0 6B4B     		ldr	r3, .L256+36
 1863              	.LVL182:
 480:bluetooth_rxtx.c **** 		break;
 1864              		.loc 1 480 0
 1865 03c2 0120     		movs	r0, #1
 1866              	.LVL183:
 479:bluetooth_rxtx.c **** 		afh_enabled = 1;
 1867              		.loc 1 479 0
 1868 03c4 1A70     		strb	r2, [r3]
 480:bluetooth_rxtx.c **** 		break;
 1869              		.loc 1 480 0
 1870 03c6 6B4B     		ldr	r3, .L256+40
 1871 03c8 1870     		strb	r0, [r3]
 481:bluetooth_rxtx.c **** 
 1872              		.loc 1 481 0
ARM GAS  /tmp/cc1G6faT.s 			page 75


 1873 03ca BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1874              	.LVL184:
 1875              	.L157:
 484:bluetooth_rxtx.c **** 		break;
 1876              		.loc 1 484 0
 1877 03ce 0120     		movs	r0, #1
 1878              	.LVL185:
 1879 03d0 E072     		strb	r0, [r4, #11]
 485:bluetooth_rxtx.c **** 
 1880              		.loc 1 485 0
 1881 03d2 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1882              	.LVL186:
 1883              	.L136:
 488:bluetooth_rxtx.c **** 		clkn = clock;
 1884              		.loc 1 488 0
 1885 03d6 B278     		ldrb	r2, [r6, #2]	@ zero_extendqisi2
 1886 03d8 7378     		ldrb	r3, [r6, #1]	@ zero_extendqisi2
 1887 03da 1204     		lsls	r2, r2, #16
 1888 03dc 42EA0322 		orr	r2, r2, r3, lsl #8
 1889 03e0 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 1890 03e2 1A43     		orrs	r2, r2, r3
 1891 03e4 F378     		ldrb	r3, [r6, #3]	@ zero_extendqisi2
 1892 03e6 42EA0362 		orr	r2, r2, r3, lsl #24
 1893              	.LVL187:
 489:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1894              		.loc 1 489 0
 1895 03ea 634B     		ldr	r3, .L256+44
 1896 03ec 1A60     		str	r2, [r3]
 1897 03ee 9FE0     		b	.L234
 1898              	.LVL188:
 1899              	.L147:
 196:bluetooth_rxtx.c **** 
 1900              		.loc 1 196 0
 1901 03f0 0023     		movs	r3, #0
 1902              	.LVL189:
 1903              	.L193:
 1904              	.LBB18:
 495:bluetooth_rxtx.c **** 		}
 1905              		.loc 1 495 0 discriminator 2
 1906 03f2 F15C     		ldrb	r1, [r6, r3]	@ zero_extendqisi2
 1907 03f4 5D4A     		ldr	r2, .L256+32
 1908 03f6 9954     		strb	r1, [r3, r2]
 494:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 1909              		.loc 1 494 0 discriminator 2
 1910 03f8 0133     		adds	r3, r3, #1
 1911              	.LVL190:
 1912 03fa 0A2B     		cmp	r3, #10
 1913 03fc F9D1     		bne	.L193
 1914              	.LBE18:
 497:bluetooth_rxtx.c **** 		*data_len = 10;
 1915              		.loc 1 497 0
 1916 03fe 5D4A     		ldr	r2, .L256+40
 1917 0400 0120     		movs	r0, #1
 1918              	.LVL191:
 1919 0402 1070     		strb	r0, [r2]
 1920              	.LVL192:
 1921              	.L224:
ARM GAS  /tmp/cc1G6faT.s 			page 76


 498:bluetooth_rxtx.c **** 		break;
 1922              		.loc 1 498 0
 1923 0404 2B60     		str	r3, [r5]
 499:bluetooth_rxtx.c **** 
 1924              		.loc 1 499 0
 1925 0406 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1926              	.LVL193:
 1927              	.L148:
 196:bluetooth_rxtx.c **** 
 1928              		.loc 1 196 0
 1929 040a 0023     		movs	r3, #0
 1930              	.LVL194:
 1931              	.L195:
 1932              	.LBB19:
 503:bluetooth_rxtx.c **** 		}
 1933              		.loc 1 503 0 discriminator 2
 1934 040c 5749     		ldr	r1, .L256+32
 1935 040e 0022     		movs	r2, #0
 1936 0410 5A54     		strb	r2, [r3, r1]
 502:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1937              		.loc 1 502 0 discriminator 2
 1938 0412 0133     		adds	r3, r3, #1
 1939              	.LVL195:
 1940 0414 0A2B     		cmp	r3, #10
 1941 0416 F9D1     		bne	.L195
 1942              	.LBE19:
 505:bluetooth_rxtx.c **** 		*data_len = 10;
 1943              		.loc 1 505 0
 1944 0418 5649     		ldr	r1, .L256+40
 1945 041a 0A70     		strb	r2, [r1]
 1946 041c B8E6     		b	.L233
 1947              	.LVL196:
 1948              	.L137:
 510:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 1949              		.loc 1 510 0
 1950 041e 564B     		ldr	r3, .L256+44
 1951 0420 1968     		ldr	r1, [r3]
 1952              	.LVL197:
 1953              	.LBB20:
 511:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1954              		.loc 1 511 0
 1955 0422 0023     		movs	r3, #0
 1956              	.LVL198:
 1957              	.L197:
 1958 0424 DA00     		lsls	r2, r3, #3
 512:bluetooth_rxtx.c **** 		}
 1959              		.loc 1 512 0 discriminator 2
 1960 0426 21FA02F2 		lsr	r2, r1, r2
 1961 042a F254     		strb	r2, [r6, r3]
 511:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1962              		.loc 1 511 0 discriminator 2
 1963 042c 0133     		adds	r3, r3, #1
 1964              	.LVL199:
 1965 042e 042B     		cmp	r3, #4
 1966 0430 F8D1     		bne	.L197
 1967 0432 ADE6     		b	.L233
 1968              	.LVL200:
ARM GAS  /tmp/cc1G6faT.s 			page 77


 1969              	.L158:
 1970              	.LBE20:
 518:bluetooth_rxtx.c **** 		break;
 1971              		.loc 1 518 0
 1972 0434 7378     		ldrb	r3, [r6, #1]	@ zero_extendqisi2
 1973 0436 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 1974 0438 43EA0222 		orr	r2, r3, r2, lsl #8
 1975 043c 4A4B     		ldr	r3, .L256+28
 1976 043e 1A80     		strh	r2, [r3]	@ movhi
 1977 0440 56E1     		b	.L207
 1978              	.L163:
 522:bluetooth_rxtx.c **** 
 1979              		.loc 1 522 0
 1980 0442 4E4B     		ldr	r3, .L256+48
 1981 0444 3078     		ldrb	r0, [r6]	@ zero_extendqisi2
 1982              	.LVL201:
 1983 0446 1988     		ldrh	r1, [r3]
 1984              	.LVL202:
 1985 0448 7278     		ldrb	r2, [r6, #1]	@ zero_extendqisi2
 1986 044a 89B2     		uxth	r1, r1
 1987 044c 42EA0022 		orr	r2, r2, r0, lsl #8
 1988 0450 0A44     		add	r2, r2, r1
 1989 0452 92B2     		uxth	r2, r2
 1990 0454 1A80     		strh	r2, [r3]	@ movhi
 525:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 1991              		.loc 1 525 0
 1992 0456 1A88     		ldrh	r2, [r3]
 1993 0458 4949     		ldr	r1, .L256+52
 1994 045a 12B2     		sxth	r2, r2
 1995 045c 002A     		cmp	r2, #0
 1996 045e 494A     		ldr	r2, .L256+56
 1997 0460 07DA     		bge	.L198
 526:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 1998              		.loc 1 526 0
 1999 0462 1B88     		ldrh	r3, [r3]
 2000 0464 4FF4A070 		mov	r0, #320
 2001 0468 5B42     		negs	r3, r3
 2002 046a 9BB2     		uxth	r3, r3
 2003 046c 90FBF3F3 		sdiv	r3, r0, r3
 2004 0470 0AE0     		b	.L249
 2005              	.L198:
 530:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
 2006              		.loc 1 530 0
 2007 0472 1888     		ldrh	r0, [r3]
 2008 0474 00B2     		sxth	r0, r0
 2009 0476 0028     		cmp	r0, #0
 2010 0478 0DDD     		ble	.L199
 531:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2011              		.loc 1 531 0
 2012 047a 1B88     		ldrh	r3, [r3]
 2013 047c 4FF4A070 		mov	r0, #320
 2014 0480 1BB2     		sxth	r3, r3
 2015 0482 90FBF3F3 		sdiv	r3, r0, r3
 2016 0486 9BB2     		uxth	r3, r3
 2017              	.L249:
 2018 0488 1380     		strh	r3, [r2]	@ movhi
 532:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/cc1G6faT.s 			page 78


 2019              		.loc 1 532 0
 2020 048a 3F4B     		ldr	r3, .L256+60
 2021 048c 1868     		ldr	r0, [r3]
 2022 048e 1388     		ldrh	r3, [r2]
 2023 0490 9BB2     		uxth	r3, r3
 2024 0492 0344     		add	r3, r3, r0
 2025 0494 01E0     		b	.L228
 2026              	.L199:
 536:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
 2027              		.loc 1 536 0
 2028 0496 0023     		movs	r3, #0
 2029 0498 1380     		strh	r3, [r2]	@ movhi
 2030              	.L228:
 537:bluetooth_rxtx.c **** 		}
 2031              		.loc 1 537 0
 2032 049a 0B60     		str	r3, [r1]
 2033 049c 28E1     		b	.L207
 2034              	.LVL203:
 2035              	.L138:
 543:bluetooth_rxtx.c **** 
 2036              		.loc 1 543 0
 2037 049e 0023     		movs	r3, #0
 2038 04a0 2B60     		str	r3, [r5]
 545:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 2039              		.loc 1 545 0
 2040 04a2 E372     		strb	r3, [r4, #11]
 546:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 2041              		.loc 1 546 0
 2042 04a4 0323     		movs	r3, #3
 2043 04a6 A372     		strb	r3, [r4, #10]
 547:bluetooth_rxtx.c **** 
 2044              		.loc 1 547 0
 2045 04a8 0923     		movs	r3, #9
 2046 04aa 3EE0     		b	.L232
 2047              	.L139:
 196:bluetooth_rxtx.c **** 
 2048              		.loc 1 196 0
 2049 04ac 0023     		movs	r3, #0
 2050              	.LVL204:
 2051              	.L201:
 2052              	.LBB21:
 555:bluetooth_rxtx.c **** 		}
 2053              		.loc 1 555 0 discriminator 2
 2054 04ae 2749     		ldr	r1, .L256
 2055 04b0 DA00     		lsls	r2, r3, #3
 2056 04b2 4968     		ldr	r1, [r1, #4]
 2057 04b4 21FA02F2 		lsr	r2, r1, r2
 2058 04b8 F254     		strb	r2, [r6, r3]
 554:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 2059              		.loc 1 554 0 discriminator 2
 2060 04ba 0133     		adds	r3, r3, #1
 2061              	.LVL205:
 2062 04bc 042B     		cmp	r3, #4
 2063 04be F6D1     		bne	.L201
 2064 04c0 66E6     		b	.L233
 2065              	.LVL206:
 2066              	.L140:
ARM GAS  /tmp/cc1G6faT.s 			page 79


 2067              	.LBE21:
 561:bluetooth_rxtx.c **** 		le.target_set = 1;
 2068              		.loc 1 561 0
 2069 04c2 B378     		ldrb	r3, [r6, #2]	@ zero_extendqisi2
 2070 04c4 7278     		ldrb	r2, [r6, #1]	@ zero_extendqisi2
 2071 04c6 1B04     		lsls	r3, r3, #16
 2072 04c8 43EA0223 		orr	r3, r3, r2, lsl #8
 2073 04cc 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 2074 04ce F078     		ldrb	r0, [r6, #3]	@ zero_extendqisi2
 2075              	.LVL207:
 2076 04d0 1343     		orrs	r3, r3, r2
 2077 04d2 43EA0060 		orr	r0, r3, r0, lsl #24
 2078 04d6 FFF7FEFF 		bl	le_set_access_address
 2079              	.LVL208:
 562:bluetooth_rxtx.c **** 		break;
 2080              		.loc 1 562 0
 2081 04da 0120     		movs	r0, #1
 2082 04dc 1B4B     		ldr	r3, .L256
 2083 04de FDE0     		b	.L223
 2084              	.LVL209:
 2085              	.L142:
 572:bluetooth_rxtx.c **** 		data[1] = 0x37;
 2086              		.loc 1 572 0
 2087 04e0 1323     		movs	r3, #19
 2088 04e2 3370     		strb	r3, [r6]
 573:bluetooth_rxtx.c **** 		*data_len = 2;
 2089              		.loc 1 573 0
 2090 04e4 3723     		movs	r3, #55
 2091              	.L252:
 2092 04e6 7370     		strb	r3, [r6, #1]
 2093 04e8 2EE0     		b	.L247
 2094              	.L143:
 578:bluetooth_rxtx.c **** 		*data_len = 1;
 2095              		.loc 1 578 0
 2096 04ea 184B     		ldr	r3, .L256
 2097 04ec 5B69     		ldr	r3, [r3, #20]
 2098 04ee 0033     		adds	r3, r3, #0
 2099 04f0 18BF     		it	ne
 2100 04f2 0123     		movne	r3, #1
 2101 04f4 05E7     		b	.L225
 2102              	.L144:
 583:bluetooth_rxtx.c **** 		break;
 2103              		.loc 1 583 0
 2104 04f6 0A88     		ldrh	r2, [r1]
 2105 04f8 144B     		ldr	r3, .L256
 2106 04fa 0032     		adds	r2, r2, #0
 2107 04fc 18BF     		it	ne
 2108 04fe 0122     		movne	r2, #1
 2109 0500 5A61     		str	r2, [r3, #20]
 2110 0502 F5E0     		b	.L207
 2111              	.L145:
 587:bluetooth_rxtx.c **** 		if (p != NULL) {
 2112              		.loc 1 587 0
 2113 0504 FFF7FEFF 		bl	dequeue
 2114              	.LVL210:
 588:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 2115              		.loc 1 588 0
ARM GAS  /tmp/cc1G6faT.s 			page 80


 2116 0508 0146     		mov	r1, r0
 2117 050a 28B1     		cbz	r0, .L202
 589:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 2118              		.loc 1 589 0
 2119 050c 3046     		mov	r0, r6
 2120              	.LVL211:
 2121 050e 4022     		movs	r2, #64
 2122 0510 FFF7FEFF 		bl	memcpy
 2123              	.LVL212:
 590:bluetooth_rxtx.c **** 		} else {
 2124              		.loc 1 590 0
 2125 0514 4023     		movs	r3, #64
 2126 0516 3BE6     		b	.L233
 2127              	.LVL213:
 2128              	.L202:
 592:bluetooth_rxtx.c **** 			*data_len = 1;
 2129              		.loc 1 592 0
 2130 0518 3070     		strb	r0, [r6]
 2131              	.LVL214:
 2132              	.L221:
 593:bluetooth_rxtx.c **** 		}
 2133              		.loc 1 593 0
 2134 051a 0120     		movs	r0, #1
 2135              	.L222:
 2136 051c 2860     		str	r0, [r5]
 2137 051e BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2138              	.LVL215:
 2139              	.L146:
 598:bluetooth_rxtx.c **** 
 2140              		.loc 1 598 0
 2141 0522 0023     		movs	r3, #0
 2142 0524 2B60     		str	r3, [r5]
 600:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 2143              		.loc 1 600 0
 2144 0526 A372     		strb	r3, [r4, #10]
 601:bluetooth_rxtx.c **** 
 2145              		.loc 1 601 0
 2146 0528 0A23     		movs	r3, #10
 2147              	.L232:
 2148 052a A374     		strb	r3, [r4, #18]
 603:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 2149              		.loc 1 603 0
 2150 052c FFF7FEFF 		bl	queue_init
 2151              	.LVL216:
 2152              	.L234:
 604:bluetooth_rxtx.c **** 		break;
 2153              		.loc 1 604 0
 2154 0530 064B     		ldr	r3, .L256
 2155              	.L237:
 2156 0532 1888     		ldrh	r0, [r3]
 2157 0534 80B2     		uxth	r0, r0
 2158 0536 FFF7FEFF 		bl	cs_threshold_calc_and_set
 2159              	.LVL217:
 2160 053a D9E0     		b	.L207
 2161              	.LVL218:
 2162              	.L149:
 608:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
ARM GAS  /tmp/cc1G6faT.s 			page 81


 2163              		.loc 1 608 0
 2164 053c 0878     		ldrb	r0, [r1]	@ zero_extendqisi2
 2165              	.LVL219:
 2166 053e FFF7FEFF 		bl	cc2400_get
 2167              	.LVL220:
 609:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 2168              		.loc 1 609 0
 2169 0542 030A     		lsrs	r3, r0, #8
 2170 0544 3370     		strb	r3, [r6]
 610:bluetooth_rxtx.c **** 		*data_len = 2;
 2171              		.loc 1 610 0
 2172 0546 7070     		strb	r0, [r6, #1]
 2173              	.LVL221:
 2174              	.L247:
 611:bluetooth_rxtx.c **** 		break;
 2175              		.loc 1 611 0
 2176 0548 0223     		movs	r3, #2
 2177 054a 21E6     		b	.L233
 2178              	.L257:
 2179              		.align	2
 2180              	.L256:
 2181 054c 00000000 		.word	.LANCHOR1
 2182 0550 00000000 		.word	.LC4
 2183 0554 A7000000 		.word	.LANCHOR2+167
 2184 0558 00000000 		.word	cs_threshold_req
 2185 055c 00000000 		.word	target
 2186 0560 00000000 		.word	clkn_offset
 2187 0564 98C00920 		.word	537510040
 2188 0568 00000000 		.word	clk100ns_offset
 2189 056c 00000000 		.word	afh_map
 2190 0570 00000000 		.word	used_channels
 2191 0574 00000000 		.word	afh_enabled
 2192 0578 00000000 		.word	clkn
 2193 057c 00000000 		.word	clk_drift_ppm
 2194 0580 00000000 		.word	clkn_next_drift_fix
 2195 0584 00000000 		.word	clk_drift_correction
 2196 0588 00000000 		.word	clkn_last_drift_fix
 2197              	.LVL222:
 2198              	.L153:
 615:bluetooth_rxtx.c **** 		break;
 2199              		.loc 1 615 0
 2200 058c 0878     		ldrb	r0, [r1]	@ zero_extendqisi2
 2201              	.LVL223:
 2202 058e 4988     		ldrh	r1, [r1, #2]
 2203              	.LVL224:
 2204              	.L235:
 2205 0590 FFF7FEFF 		bl	cc2400_set
 2206              	.LVL225:
 2207 0594 ACE0     		b	.L207
 2208              	.L172:
 2209              	.LVL226:
 619:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2210              		.loc 1 619 0 discriminator 1
 2211 0596 3B88     		ldrh	r3, [r7]
 2212 0598 A342     		cmp	r3, r4
 2213 059a 40F2A980 		bls	.L207
 620:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
ARM GAS  /tmp/cc1G6faT.s 			page 82


 2214              		.loc 1 620 0 discriminator 2
 2215 059e 0323     		movs	r3, #3
 2216 05a0 6343     		muls	r3, r4, r3
 2217              	.LVL227:
 2218 05a2 F218     		adds	r2, r6, r3
 2219              	.LVL228:
 2220 05a4 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
 2221 05a6 9278     		ldrb	r2, [r2, #2]	@ zero_extendqisi2
 2222              	.LVL229:
 621:bluetooth_rxtx.c **** 		}
 2223              		.loc 1 621 0 discriminator 2
 2224 05a8 F05C     		ldrb	r0, [r6, r3]	@ zero_extendqisi2
 2225 05aa 42EA0121 		orr	r1, r2, r1, lsl #8
 619:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2226              		.loc 1 619 0 discriminator 2
 2227 05ae 0134     		adds	r4, r4, #1
 2228              	.LVL230:
 621:bluetooth_rxtx.c **** 		}
 2229              		.loc 1 621 0 discriminator 2
 2230 05b0 FFF7FEFF 		bl	cc2400_set
 2231              	.LVL231:
 619:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2232              		.loc 1 619 0 discriminator 2
 2233 05b4 E4B2     		uxtb	r4, r4
 2234              	.LVL232:
 2235 05b6 EEE7     		b	.L172
 2236              	.LVL233:
 2237              	.L160:
 196:bluetooth_rxtx.c **** 
 2238              		.loc 1 196 0
 2239 05b8 0024     		movs	r4, #0
 2240              	.LVL234:
 2241              	.L206:
 628:bluetooth_rxtx.c **** 			data[i*3] = i;
 2242              		.loc 1 628 0 discriminator 2
 2243 05ba 2046     		mov	r0, r4
 2244 05bc FFF7FEFF 		bl	cc2400_get
 2245              	.LVL235:
 629:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
 2246              		.loc 1 629 0 discriminator 2
 2247 05c0 3470     		strb	r4, [r6]
 627:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2248              		.loc 1 627 0 discriminator 2
 2249 05c2 0134     		adds	r4, r4, #1
 2250              	.LVL236:
 2251 05c4 E4B2     		uxtb	r4, r4
 2252              	.LVL237:
 630:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2253              		.loc 1 630 0 discriminator 2
 2254 05c6 030A     		lsrs	r3, r0, #8
 627:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2255              		.loc 1 627 0 discriminator 2
 2256 05c8 2E2C     		cmp	r4, #46
 630:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2257              		.loc 1 630 0 discriminator 2
 2258 05ca 7370     		strb	r3, [r6, #1]
 631:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/cc1G6faT.s 			page 83


 2259              		.loc 1 631 0 discriminator 2
 2260 05cc B070     		strb	r0, [r6, #2]
 2261 05ce 06F10306 		add	r6, r6, #3
 627:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2262              		.loc 1 627 0 discriminator 2
 2263 05d2 F2D1     		bne	.L206
 633:bluetooth_rxtx.c **** 		break;
 2264              		.loc 1 633 0
 2265 05d4 8723     		movs	r3, #135
 2266 05d6 DBE5     		b	.L233
 2267              	.LVL238:
 2268              	.L162:
 637:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2269              		.loc 1 637 0
 2270 05d8 B279     		ldrb	r2, [r6, #6]	@ zero_extendqisi2
 638:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2271              		.loc 1 638 0
 2272 05da 4848     		ldr	r0, .L258
 2273              	.LVL239:
 637:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2274              		.loc 1 637 0
 2275 05dc 0732     		adds	r2, r2, #7
 638:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2276              		.loc 1 638 0
 2277 05de 3146     		mov	r1, r6
 2278              	.LVL240:
 2279 05e0 D2B2     		uxtb	r2, r2
 2280 05e2 FFF7FEFF 		bl	memcpy
 2281              	.LVL241:
 640:bluetooth_rxtx.c **** 		*data_len = 0;
 2282              		.loc 1 640 0
 2283 05e6 1023     		movs	r3, #16
 2284 05e8 63E6     		b	.L246
 2285              	.LVL242:
 2286              	.L150:
 645:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2287              		.loc 1 645 0
 2288 05ea 1846     		mov	r0, r3
 2289              	.LVL243:
 2290 05ec FFF7FEFF 		bl	malloc
 2291              	.LVL244:
 2292 05f0 434B     		ldr	r3, .L258+4
 646:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 2293              		.loc 1 646 0
 2294 05f2 3146     		mov	r1, r6
 2295 05f4 226A     		ldr	r2, [r4, #32]
 645:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2296              		.loc 1 645 0
 2297 05f6 1860     		str	r0, [r3]
 646:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 2298              		.loc 1 646 0
 2299 05f8 FFF7FEFF 		bl	memcpy
 2300              	.LVL245:
 647:bluetooth_rxtx.c **** 		break;
 2301              		.loc 1 647 0
 2302 05fc 0C23     		movs	r3, #12
 2303 05fe 57E0     		b	.L230
ARM GAS  /tmp/cc1G6faT.s 			page 84


 2304              	.LVL246:
 2305              	.L164:
 652:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2306              		.loc 1 652 0
 2307 0600 1846     		mov	r0, r3
 2308              	.LVL247:
 2309 0602 FFF7FEFF 		bl	malloc
 2310              	.LVL248:
 2311 0606 3E4B     		ldr	r3, .L258+4
 653:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P0;
 2312              		.loc 1 653 0
 2313 0608 3146     		mov	r1, r6
 2314 060a 226A     		ldr	r2, [r4, #32]
 652:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2315              		.loc 1 652 0
 2316 060c 1860     		str	r0, [r3]
 653:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P0;
 2317              		.loc 1 653 0
 2318 060e FFF7FEFF 		bl	memcpy
 2319              	.LVL249:
 654:bluetooth_rxtx.c **** 		break;
 2320              		.loc 1 654 0
 2321 0612 1123     		movs	r3, #17
 2322 0614 4CE0     		b	.L230
 2323              	.LVL250:
 2324              	.L165:
 657:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, dlen);
 2325              		.loc 1 657 0
 2326 0616 1846     		mov	r0, r3
 2327              	.LVL251:
 2328 0618 FFF7FEFF 		bl	malloc
 2329              	.LVL252:
 2330 061c 384B     		ldr	r3, .L258+4
 658:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P1;
 2331              		.loc 1 658 0
 2332 061e 3146     		mov	r1, r6
 657:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, dlen);
 2333              		.loc 1 657 0
 2334 0620 1860     		str	r0, [r3]
 658:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P1;
 2335              		.loc 1 658 0
 2336 0622 226A     		ldr	r2, [r4, #32]
 2337 0624 3748     		ldr	r0, .L258+8
 2338 0626 FFF7FEFF 		bl	memcpy
 2339              	.LVL253:
 659:bluetooth_rxtx.c **** 		break;
 2340              		.loc 1 659 0
 2341 062a 1223     		movs	r3, #18
 2342 062c 40E0     		b	.L230
 2343              	.LVL254:
 2344              	.L166:
 662:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2345              		.loc 1 662 0
 2346 062e 1846     		mov	r0, r3
 2347              	.LVL255:
 2348 0630 FFF7FEFF 		bl	malloc
 2349              	.LVL256:
ARM GAS  /tmp/cc1G6faT.s 			page 85


 2350 0634 324B     		ldr	r3, .L258+4
 663:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P2;
 2351              		.loc 1 663 0
 2352 0636 3146     		mov	r1, r6
 2353 0638 226A     		ldr	r2, [r4, #32]
 662:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2354              		.loc 1 662 0
 2355 063a 1860     		str	r0, [r3]
 663:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P2;
 2356              		.loc 1 663 0
 2357 063c FFF7FEFF 		bl	memcpy
 2358              	.LVL257:
 664:bluetooth_rxtx.c **** 		break;
 2359              		.loc 1 664 0
 2360 0640 1323     		movs	r3, #19
 2361 0642 35E0     		b	.L230
 2362              	.LVL258:
 2363              	.L167:
 667:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2364              		.loc 1 667 0
 2365 0644 1846     		mov	r0, r3
 2366              	.LVL259:
 2367 0646 FFF7FEFF 		bl	malloc
 2368              	.LVL260:
 2369 064a 2D4B     		ldr	r3, .L258+4
 668:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P3;
 2370              		.loc 1 668 0
 2371 064c 3146     		mov	r1, r6
 2372 064e 226A     		ldr	r2, [r4, #32]
 667:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2373              		.loc 1 667 0
 2374 0650 1860     		str	r0, [r3]
 668:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P3;
 2375              		.loc 1 668 0
 2376 0652 FFF7FEFF 		bl	memcpy
 2377              	.LVL261:
 669:bluetooth_rxtx.c **** 		break;
 2378              		.loc 1 669 0
 2379 0656 1423     		movs	r3, #20
 2380 0658 2AE0     		b	.L230
 2381              	.LVL262:
 2382              	.L168:
 672:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2383              		.loc 1 672 0
 2384 065a 1846     		mov	r0, r3
 2385              	.LVL263:
 2386 065c FFF7FEFF 		bl	malloc
 2387              	.LVL264:
 2388 0660 274B     		ldr	r3, .L258+4
 673:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P4;
 2389              		.loc 1 673 0
 2390 0662 3146     		mov	r1, r6
 2391 0664 226A     		ldr	r2, [r4, #32]
 672:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2392              		.loc 1 672 0
 2393 0666 1860     		str	r0, [r3]
 673:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P4;
ARM GAS  /tmp/cc1G6faT.s 			page 86


 2394              		.loc 1 673 0
 2395 0668 FFF7FEFF 		bl	memcpy
 2396              	.LVL265:
 674:bluetooth_rxtx.c **** 		break;
 2397              		.loc 1 674 0
 2398 066c 1523     		movs	r3, #21
 2399 066e 1FE0     		b	.L230
 2400              	.LVL266:
 2401              	.L169:
 677:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2402              		.loc 1 677 0
 2403 0670 1846     		mov	r0, r3
 2404              	.LVL267:
 2405 0672 FFF7FEFF 		bl	malloc
 2406              	.LVL268:
 2407 0676 224B     		ldr	r3, .L258+4
 678:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P5;
 2408              		.loc 1 678 0
 2409 0678 3146     		mov	r1, r6
 2410 067a 226A     		ldr	r2, [r4, #32]
 677:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2411              		.loc 1 677 0
 2412 067c 1860     		str	r0, [r3]
 678:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P5;
 2413              		.loc 1 678 0
 2414 067e FFF7FEFF 		bl	memcpy
 2415              	.LVL269:
 679:bluetooth_rxtx.c **** 		break;
 2416              		.loc 1 679 0
 2417 0682 1623     		movs	r3, #22
 2418 0684 14E0     		b	.L230
 2419              	.LVL270:
 2420              	.L170:
 682:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2421              		.loc 1 682 0
 2422 0686 1846     		mov	r0, r3
 2423              	.LVL271:
 2424 0688 FFF7FEFF 		bl	malloc
 2425              	.LVL272:
 2426 068c 1C4B     		ldr	r3, .L258+4
 683:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P6;
 2427              		.loc 1 683 0
 2428 068e 3146     		mov	r1, r6
 2429 0690 226A     		ldr	r2, [r4, #32]
 682:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2430              		.loc 1 682 0
 2431 0692 1860     		str	r0, [r3]
 683:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P6;
 2432              		.loc 1 683 0
 2433 0694 FFF7FEFF 		bl	memcpy
 2434              	.LVL273:
 684:bluetooth_rxtx.c **** 		break;
 2435              		.loc 1 684 0
 2436 0698 1723     		movs	r3, #23
 2437 069a 09E0     		b	.L230
 2438              	.LVL274:
 2439              	.L171:
ARM GAS  /tmp/cc1G6faT.s 			page 87


 687:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2440              		.loc 1 687 0
 2441 069c 1846     		mov	r0, r3
 2442              	.LVL275:
 2443 069e FFF7FEFF 		bl	malloc
 2444              	.LVL276:
 2445 06a2 174B     		ldr	r3, .L258+4
 688:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P7;
 2446              		.loc 1 688 0
 2447 06a4 3146     		mov	r1, r6
 2448 06a6 226A     		ldr	r2, [r4, #32]
 687:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2449              		.loc 1 687 0
 2450 06a8 1860     		str	r0, [r3]
 688:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P7;
 2451              		.loc 1 688 0
 2452 06aa FFF7FEFF 		bl	memcpy
 2453              	.LVL277:
 689:bluetooth_rxtx.c **** 		break;
 2454              		.loc 1 689 0
 2455 06ae 1823     		movs	r3, #24
 2456              	.L230:
 2457 06b0 A374     		strb	r3, [r4, #18]
 2458 06b2 1DE0     		b	.L207
 2459              	.LVL278:
 2460              	.L152:
 696:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 2461              		.loc 1 696 0
 2462 06b4 7279     		ldrb	r2, [r6, #5]	@ zero_extendqisi2
 2463 06b6 144B     		ldr	r3, .L258+12
 702:bluetooth_rxtx.c **** 		break;
 2464              		.loc 1 702 0
 2465 06b8 0120     		movs	r0, #1
 2466              	.LVL279:
 696:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 2467              		.loc 1 696 0
 2468 06ba 83F83820 		strb	r2, [r3, #56]
 697:bluetooth_rxtx.c **** 		le.target[2] = data[3];
 2469              		.loc 1 697 0
 2470 06be 3279     		ldrb	r2, [r6, #4]	@ zero_extendqisi2
 2471 06c0 83F83920 		strb	r2, [r3, #57]
 698:bluetooth_rxtx.c **** 		le.target[3] = data[2];
 2472              		.loc 1 698 0
 2473 06c4 F278     		ldrb	r2, [r6, #3]	@ zero_extendqisi2
 2474 06c6 83F83A20 		strb	r2, [r3, #58]
 699:bluetooth_rxtx.c **** 		le.target[4] = data[1];
 2475              		.loc 1 699 0
 2476 06ca B278     		ldrb	r2, [r6, #2]	@ zero_extendqisi2
 2477 06cc 83F83B20 		strb	r2, [r3, #59]
 700:bluetooth_rxtx.c **** 		le.target[5] = data[0];
 2478              		.loc 1 700 0
 2479 06d0 7278     		ldrb	r2, [r6, #1]	@ zero_extendqisi2
 2480 06d2 83F83C20 		strb	r2, [r3, #60]
 701:bluetooth_rxtx.c **** 		le.target_set = 1;
 2481              		.loc 1 701 0
 2482 06d6 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 2483 06d8 83F83D20 		strb	r2, [r3, #61]
ARM GAS  /tmp/cc1G6faT.s 			page 88


 2484              	.LVL280:
 2485              	.L223:
 702:bluetooth_rxtx.c **** 		break;
 2486              		.loc 1 702 0
 2487 06dc 1864     		str	r0, [r3, #64]
 703:bluetooth_rxtx.c **** 
 2488              		.loc 1 703 0
 2489 06de BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2490              	.LVL281:
 2491              	.L154:
 707:bluetooth_rxtx.c **** 		break;
 2492              		.loc 1 707 0
 2493 06e2 0B78     		ldrb	r3, [r1]	@ zero_extendqisi2
 2494 06e4 E374     		strb	r3, [r4, #19]
 2495 06e6 03E0     		b	.L207
 2496              	.L155:
 716:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 2497              		.loc 1 716 0
 2498 06e8 0D23     		movs	r3, #13
 2499 06ea A374     		strb	r3, [r4, #18]
 717:bluetooth_rxtx.c **** 		break;
 2500              		.loc 1 717 0
 2501 06ec 0B78     		ldrb	r3, [r1]	@ zero_extendqisi2
 2502 06ee 2375     		strb	r3, [r4, #20]
 2503              	.LVL282:
 2504              	.L207:
 723:bluetooth_rxtx.c **** }
 2505              		.loc 1 723 0
 2506 06f0 0120     		movs	r0, #1
 2507 06f2 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2508              	.LVL283:
 2509              	.L214:
 313:bluetooth_rxtx.c **** 		}
 2510              		.loc 1 313 0
 2511 06f6 0020     		movs	r0, #0
 724:bluetooth_rxtx.c **** 
 2512              		.loc 1 724 0
 2513 06f8 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2514              	.LVL284:
 2515              	.L259:
 2516              		.align	2
 2517              	.L258:
 2518 06fc 00000000 		.word	tx_pkt
 2519 0700 00000000 		.word	slave_mac_address_data
 2520 0704 24000000 		.word	.LANCHOR0+36
 2521 0708 00000000 		.word	.LANCHOR1
 2522              		.cfi_endproc
 2523              	.LFE2:
 2525              		.section	.text.enqueue_with_ts,"ax",%progbits
 2526              		.align	1
 2527              		.global	enqueue_with_ts
 2528              		.thumb
 2529              		.thumb_func
 2531              	enqueue_with_ts:
 2532              	.LFB1:
 161:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2533              		.loc 1 161 0
ARM GAS  /tmp/cc1G6faT.s 			page 89


 2534              		.cfi_startproc
 2535              		@ args = 0, pretend = 0, frame = 0
 2536              		@ frame_needed = 0, uses_anonymous_args = 0
 2537              	.LVL285:
 2538 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2539              		.cfi_def_cfa_offset 24
 2540              		.cfi_offset 4, -24
 2541              		.cfi_offset 5, -20
 2542              		.cfi_offset 6, -16
 2543              		.cfi_offset 7, -12
 2544              		.cfi_offset 8, -8
 2545              		.cfi_offset 14, -4
 161:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2546              		.loc 1 161 0
 2547 0004 0646     		mov	r6, r0
 2548 0006 0F46     		mov	r7, r1
 2549 0008 9046     		mov	r8, r2
 162:bluetooth_rxtx.c **** 
 2550              		.loc 1 162 0
 2551 000a FFF7FEFF 		bl	usb_enqueue
 2552              	.LVL286:
 2553 000e 104D     		ldr	r5, .L263
 165:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 2554              		.loc 1 165 0
 2555 0010 0446     		mov	r4, r0
 2556 0012 28B9     		cbnz	r0, .L261
 166:bluetooth_rxtx.c **** 		return 0;
 2557              		.loc 1 166 0
 2558 0014 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 2559 0016 43F00403 		orr	r3, r3, #4
 2560 001a 6B70     		strb	r3, [r5, #1]
 167:bluetooth_rxtx.c **** 	}
 2561              		.loc 1 167 0
 2562 001c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2563              	.LVL287:
 2564              	.L261:
 175:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2565              		.loc 1 175 0
 2566 0020 0C4B     		ldr	r3, .L263+4
 170:bluetooth_rxtx.c **** 
 2567              		.loc 1 170 0
 2568 0022 0670     		strb	r6, [r0]
 175:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2569              		.loc 1 175 0
 2570 0024 1B88     		ldrh	r3, [r3]
 172:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2571              		.loc 1 172 0
 2572 0026 0026     		movs	r6, #0
 175:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2573              		.loc 1 175 0
 2574 0028 9BB2     		uxth	r3, r3
 2575 002a 623B     		subs	r3, r3, #98
 172:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2576              		.loc 1 172 0
 2577 002c C670     		strb	r6, [r0, #3]
 173:bluetooth_rxtx.c **** 
 2578              		.loc 1 173 0
ARM GAS  /tmp/cc1G6faT.s 			page 90


 2579 002e C0F80480 		str	r8, [r0, #4]
 175:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2580              		.loc 1 175 0
 2581 0032 8370     		strb	r3, [r0, #2]
 176:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 2582              		.loc 1 176 0
 2583 0034 8672     		strb	r6, [r0, #10]
 177:bluetooth_rxtx.c **** 
 2584              		.loc 1 177 0
 2585 0036 C672     		strb	r6, [r0, #11]
 179:bluetooth_rxtx.c **** 
 2586              		.loc 1 179 0
 2587 0038 3946     		mov	r1, r7
 2588 003a 3222     		movs	r2, #50
 2589 003c 0E30     		adds	r0, r0, #14
 2590              	.LVL288:
 2591 003e FFF7FEFF 		bl	memcpy
 2592              	.LVL289:
 181:bluetooth_rxtx.c **** 	status = 0;
 2593              		.loc 1 181 0
 2594 0042 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 182:bluetooth_rxtx.c **** 
 2595              		.loc 1 182 0
 2596 0044 6E70     		strb	r6, [r5, #1]
 181:bluetooth_rxtx.c **** 	status = 0;
 2597              		.loc 1 181 0
 2598 0046 6370     		strb	r3, [r4, #1]
 184:bluetooth_rxtx.c **** }
 2599              		.loc 1 184 0
 2600 0048 0120     		movs	r0, #1
 185:bluetooth_rxtx.c **** 
 2601              		.loc 1 185 0
 2602 004a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2603              	.LVL290:
 2604              	.L264:
 2605 004e 00BF     		.align	2
 2606              	.L263:
 2607 0050 00000000 		.word	.LANCHOR0
 2608 0054 00000000 		.word	.LANCHOR1
 2609              		.cfi_endproc
 2610              	.LFE1:
 2612              		.section	.text.TIMER0_IRQHandler,"ax",%progbits
 2613              		.align	1
 2614              		.global	TIMER0_IRQHandler
 2615              		.thumb
 2616              		.thumb_func
 2618              	TIMER0_IRQHandler:
 2619              	.LFB3:
 728:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 2620              		.loc 1 728 0
 2621              		.cfi_startproc
 2622              		@ args = 0, pretend = 0, frame = 0
 2623              		@ frame_needed = 0, uses_anonymous_args = 0
 2624 0000 70B5     		push	{r4, r5, r6, lr}
 2625              		.cfi_def_cfa_offset 16
 2626              		.cfi_offset 4, -16
 2627              		.cfi_offset 5, -12
ARM GAS  /tmp/cc1G6faT.s 			page 91


 2628              		.cfi_offset 6, -8
 2629              		.cfi_offset 14, -4
 729:bluetooth_rxtx.c **** 
 2630              		.loc 1 729 0
 2631 0002 4FF04023 		mov	r3, #1073758208
 2632 0006 1B68     		ldr	r3, [r3]
 2633 0008 DB07     		lsls	r3, r3, #31
 2634 000a 7FD5     		bpl	.L265
 2635              	.LBB22:
 731:bluetooth_rxtx.c **** 		clkn_offset = 0;
 2636              		.loc 1 731 0
 2637 000c 4049     		ldr	r1, .L288
 2638 000e 414B     		ldr	r3, .L288+4
 2639 0010 0868     		ldr	r0, [r1]
 2640 0012 1A68     		ldr	r2, [r3]
 2641 0014 0244     		add	r2, r2, r0
 2642 0016 0132     		adds	r2, r2, #1
 2643 0018 0A60     		str	r2, [r1]
 732:bluetooth_rxtx.c **** 
 2644              		.loc 1 732 0
 2645 001a 0022     		movs	r2, #0
 2646 001c 1A60     		str	r2, [r3]
 739:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2647              		.loc 1 739 0
 2648 001e 3E4A     		ldr	r2, .L288+8
 734:bluetooth_rxtx.c **** 
 2649              		.loc 1 734 0
 2650 0020 0C68     		ldr	r4, [r1]
 2651 0022 3E4B     		ldr	r3, .L288+12
 739:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2652              		.loc 1 739 0
 2653 0024 967A     		ldrb	r6, [r2, #10]	@ zero_extendqisi2
 734:bluetooth_rxtx.c **** 
 2654              		.loc 1 734 0
 2655 0026 D869     		ldr	r0, [r3, #28]
 2656              	.LVL291:
 2657 0028 1546     		mov	r5, r2
 739:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2658              		.loc 1 739 0
 2659 002a 16B1     		cbz	r6, .L267
 739:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2660              		.loc 1 739 0 is_stmt 0 discriminator 1
 2661 002c 967A     		ldrb	r6, [r2, #10]	@ zero_extendqisi2
 2662 002e 012E     		cmp	r6, #1
 2663 0030 05D1     		bne	.L268
 2664              	.L267:
 740:bluetooth_rxtx.c **** 				do_hop = 1;
 2665              		.loc 1 740 0 is_stmt 1
 2666 0032 0B68     		ldr	r3, [r1]
 2667 0034 5E06     		lsls	r6, r3, #25
 2668 0036 37D1     		bne	.L269
 741:bluetooth_rxtx.c **** 		}
 2669              		.loc 1 741 0
 2670 0038 0123     		movs	r3, #1
 2671 003a EB72     		strb	r3, [r5, #11]
 2672 003c 34E0     		b	.L269
 2673              	.L268:
ARM GAS  /tmp/cc1G6faT.s 			page 92


 744:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 2674              		.loc 1 744 0
 2675 003e 957A     		ldrb	r5, [r2, #10]	@ zero_extendqisi2
 2676 0040 022D     		cmp	r5, #2
 2677 0042 03D1     		bne	.L270
 745:bluetooth_rxtx.c **** 				do_hop = 1;
 2678              		.loc 1 745 0
 2679 0044 0B68     		ldr	r3, [r1]
 2680 0046 DC07     		lsls	r4, r3, #31
 2681              	.LVL292:
 2682 0048 2ED4     		bmi	.L269
 2683 004a 2BE0     		b	.L286
 2684              	.LVL293:
 2685              	.L270:
 749:bluetooth_rxtx.c **** 			// Only hop if connected
 2686              		.loc 1 749 0
 2687 004c 957A     		ldrb	r5, [r2, #10]	@ zero_extendqisi2
 2688 004e 032D     		cmp	r5, #3
 2689 0050 1CD1     		bne	.L271
 751:bluetooth_rxtx.c **** 				--le.interval_timer;
 2690              		.loc 1 751 0
 2691 0052 1D7E     		ldrb	r5, [r3, #24]	@ zero_extendqisi2
 2692 0054 032D     		cmp	r5, #3
 2693 0056 27D1     		bne	.L269
 734:bluetooth_rxtx.c **** 
 2694              		.loc 1 734 0 discriminator 1
 2695 0058 201A     		subs	r0, r4, r0
 2696              	.LVL294:
 751:bluetooth_rxtx.c **** 				--le.interval_timer;
 2697              		.loc 1 751 0 discriminator 1
 2698 005a 8007     		lsls	r0, r0, #30
 2699 005c 24D1     		bne	.L269
 752:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 2700              		.loc 1 752 0
 2701 005e 188C     		ldrh	r0, [r3, #32]
 2702 0060 80B2     		uxth	r0, r0
 2703 0062 0138     		subs	r0, r0, #1
 2704 0064 80B2     		uxth	r0, r0
 2705 0066 1884     		strh	r0, [r3, #32]	@ movhi
 753:bluetooth_rxtx.c **** 					do_hop = 1;
 2706              		.loc 1 753 0
 2707 0068 188C     		ldrh	r0, [r3, #32]
 2708 006a 80B2     		uxth	r0, r0
 2709 006c 48B9     		cbnz	r0, .L272
 754:bluetooth_rxtx.c **** 					++le.conn_count;
 2710              		.loc 1 754 0
 2711 006e 0120     		movs	r0, #1
 2712 0070 D072     		strb	r0, [r2, #11]
 755:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 2713              		.loc 1 755 0
 2714 0072 9A8C     		ldrh	r2, [r3, #36]
 2715 0074 92B2     		uxth	r2, r2
 2716 0076 0244     		add	r2, r2, r0
 2717 0078 92B2     		uxth	r2, r2
 2718 007a 9A84     		strh	r2, [r3, #36]	@ movhi
 756:bluetooth_rxtx.c **** 				} else {
 2719              		.loc 1 756 0
ARM GAS  /tmp/cc1G6faT.s 			page 93


 2720 007c 5A8C     		ldrh	r2, [r3, #34]
 2721 007e 1A84     		strh	r2, [r3, #32]	@ movhi
 2722 0080 12E0     		b	.L269
 2723              	.L272:
 758:bluetooth_rxtx.c **** 				}
 2724              		.loc 1 758 0
 2725 0082 274B     		ldr	r3, .L288+16
 2726 0084 4FF48072 		mov	r2, #256
 2727 0088 1A60     		str	r2, [r3]
 2728 008a 0DE0     		b	.L269
 2729              	.LVL295:
 2730              	.L271:
 762:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
 2731              		.loc 1 762 0
 2732 008c 907A     		ldrb	r0, [r2, #10]	@ zero_extendqisi2
 2733              	.LVL296:
 2734 008e 0528     		cmp	r0, #5
 2735 0090 0AD1     		bne	.L269
 763:bluetooth_rxtx.c **** 				do_hop = 1;
 2736              		.loc 1 763 0
 2737 0092 2448     		ldr	r0, .L288+20
 2738 0094 0468     		ldr	r4, [r0]
 2739              	.LVL297:
 2740 0096 B3F84800 		ldrh	r0, [r3, #72]
 2741 009a 0B68     		ldr	r3, [r1]
 2742 009c 80B2     		uxth	r0, r0
 2743 009e 2044     		add	r0, r0, r4
 2744 00a0 9842     		cmp	r0, r3
 2745 00a2 01D1     		bne	.L269
 2746              	.L286:
 764:bluetooth_rxtx.c **** 			}
 2747              		.loc 1 764 0
 2748 00a4 0123     		movs	r3, #1
 2749 00a6 D372     		strb	r3, [r2, #11]
 2750              	.L269:
 769:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2751              		.loc 1 769 0
 2752 00a8 1F4A     		ldr	r2, .L288+24
 2753 00aa 204B     		ldr	r3, .L288+28
 2754 00ac 1068     		ldr	r0, [r2]
 2755 00ae C0B1     		cbz	r0, .L273
 769:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2756              		.loc 1 769 0 is_stmt 0 discriminator 1
 2757 00b0 1888     		ldrh	r0, [r3]
 2758 00b2 80B2     		uxth	r0, r0
 2759 00b4 A8B9     		cbnz	r0, .L273
 770:bluetooth_rxtx.c **** 
 2760              		.loc 1 770 0 is_stmt 1
 2761 00b6 0C68     		ldr	r4, [r1]
 2762 00b8 1068     		ldr	r0, [r2]
 2763 00ba 8442     		cmp	r4, r0
 2764 00bc 11D3     		bcc	.L273
 773:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 2765              		.loc 1 773 0
 2766 00be 1C48     		ldr	r0, .L288+32
 2767 00c0 0088     		ldrh	r0, [r0]
 2768 00c2 00B2     		sxth	r0, r0
ARM GAS  /tmp/cc1G6faT.s 			page 94


 2769 00c4 0028     		cmp	r0, #0
 774:bluetooth_rxtx.c **** 				}
 2770              		.loc 1 774 0
 2771 00c6 ACBF     		ite	ge
 2772 00c8 0120     		movge	r0, #1
 779:bluetooth_rxtx.c **** 				}
 2773              		.loc 1 779 0
 2774 00ca 41F66900 		movwlt	r0, #6249
 2775 00ce 1880     		strh	r0, [r3]	@ movhi
 781:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2776              		.loc 1 781 0
 2777 00d0 0C68     		ldr	r4, [r1]
 2778 00d2 1848     		ldr	r0, .L288+36
 2779 00d4 0460     		str	r4, [r0]
 782:bluetooth_rxtx.c **** 			}
 2780              		.loc 1 782 0
 2781 00d6 0468     		ldr	r4, [r0]
 2782 00d8 1748     		ldr	r0, .L288+40
 2783 00da 0088     		ldrh	r0, [r0]
 2784 00dc 80B2     		uxth	r0, r0
 2785 00de 2044     		add	r0, r0, r4
 2786 00e0 1060     		str	r0, [r2]
 2787              	.L273:
 787:bluetooth_rxtx.c **** 			clkn += 2;
 2788              		.loc 1 787 0
 2789 00e2 1888     		ldrh	r0, [r3]
 2790 00e4 40F63442 		movw	r2, #3124
 2791 00e8 80B2     		uxth	r0, r0
 2792 00ea 9042     		cmp	r0, r2
 2793 00ec 02D9     		bls	.L276
 788:bluetooth_rxtx.c **** 
 2794              		.loc 1 788 0
 2795 00ee 0A68     		ldr	r2, [r1]
 2796 00f0 0232     		adds	r2, r2, #2
 2797 00f2 0A60     		str	r2, [r1]
 2798              	.L276:
 790:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
 2799              		.loc 1 790 0
 2800 00f4 1988     		ldrh	r1, [r3]
 2801 00f6 114A     		ldr	r2, .L288+44
 2802 00f8 89B2     		uxth	r1, r1
 2803 00fa 01F63441 		addw	r1, r1, #3124
 2804 00fe 1160     		str	r1, [r2]
 791:bluetooth_rxtx.c **** 
 2805              		.loc 1 791 0
 2806 0100 0022     		movs	r2, #0
 2807 0102 1A80     		strh	r2, [r3]	@ movhi
 794:bluetooth_rxtx.c **** 	}
 2808              		.loc 1 794 0
 2809 0104 0122     		movs	r2, #1
 2810 0106 4FF04023 		mov	r3, #1073758208
 2811 010a 1A60     		str	r2, [r3]
 2812              	.L265:
 2813 010c 70BD     		pop	{r4, r5, r6, pc}
 2814              	.L289:
 2815 010e 00BF     		.align	2
 2816              	.L288:
ARM GAS  /tmp/cc1G6faT.s 			page 95


 2817 0110 00000000 		.word	clkn
 2818 0114 00000000 		.word	clkn_offset
 2819 0118 00000000 		.word	.LANCHOR0
 2820 011c 00000000 		.word	.LANCHOR1
 2821 0120 3CC00920 		.word	537509948
 2822 0124 00000000 		.word	last_hop
 2823 0128 00000000 		.word	clkn_next_drift_fix
 2824 012c 00000000 		.word	clk100ns_offset
 2825 0130 00000000 		.word	clk_drift_ppm
 2826 0134 00000000 		.word	clkn_last_drift_fix
 2827 0138 00000000 		.word	clk_drift_correction
 2828 013c 18400040 		.word	1073758232
 2829              	.LBE22:
 2830              		.cfi_endproc
 2831              	.LFE3:
 2833              		.section	.text.EINT3_IRQHandler,"ax",%progbits
 2834              		.align	1
 2835              		.global	EINT3_IRQHandler
 2836              		.thumb
 2837              		.thumb_func
 2839              	EINT3_IRQHandler:
 2840              	.LFB4:
 801:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 2841              		.loc 1 801 0
 2842              		.cfi_startproc
 2843              		@ args = 0, pretend = 0, frame = 0
 2844              		@ frame_needed = 0, uses_anonymous_args = 0
 2845              		@ link register save eliminated.
 803:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 2846              		.loc 1 803 0
 2847 0000 084B     		ldr	r3, .L292
 2848 0002 0422     		movs	r2, #4
 2849 0004 1A60     		str	r2, [r3]
 804:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 2850              		.loc 1 804 0
 2851 0006 084B     		ldr	r3, .L292+4
 2852 0008 4FF08052 		mov	r2, #268435456
 2853 000c 1A60     		str	r2, [r3]
 805:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 2854              		.loc 1 805 0
 2855 000e 074B     		ldr	r3, .L292+8
 2856 0010 0122     		movs	r2, #1
 2857 0012 1A70     		strb	r2, [r3]
 806:bluetooth_rxtx.c **** 		dma_discard = 0;
 2858              		.loc 1 806 0
 2859 0014 064B     		ldr	r3, .L292+12
 2860 0016 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 2861 0018 022A     		cmp	r2, #2
 807:bluetooth_rxtx.c **** 
 2862              		.loc 1 807 0
 2863 001a 04BF     		itt	eq
 2864 001c 0022     		moveq	r2, #0
 2865 001e 1A74     		strbeq	r2, [r3, #16]
 2866 0020 7047     		bx	lr
 2867              	.L293:
 2868 0022 00BF     		.align	2
 2869              	.L292:
ARM GAS  /tmp/cc1G6faT.s 			page 96


 2870 0024 AC800240 		.word	1073905836
 2871 0028 9CC00920 		.word	537510044
 2872 002c 00000000 		.word	cs_trigger
 2873 0030 00000000 		.word	.LANCHOR0
 2874              		.cfi_endproc
 2875              	.LFE4:
 2877              		.section	.text.DMA_IRQHandler,"ax",%progbits
 2878              		.align	1
 2879              		.global	DMA_IRQHandler
 2880              		.thumb
 2881              		.thumb_func
 2883              	DMA_IRQHandler:
 2884              	.LFB6:
 831:bluetooth_rxtx.c **** 	if ( mode == MODE_RX_SYMBOLS
 2885              		.loc 1 831 0
 2886              		.cfi_startproc
 2887              		@ args = 0, pretend = 0, frame = 0
 2888              		@ frame_needed = 0, uses_anonymous_args = 0
 2889 0000 10B5     		push	{r4, lr}
 2890              		.cfi_def_cfa_offset 8
 2891              		.cfi_offset 4, -8
 2892              		.cfi_offset 14, -4
 832:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
 2893              		.loc 1 832 0
 2894 0002 344B     		ldr	r3, .L354
 2895 0004 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2896 0006 012A     		cmp	r2, #1
 2897 0008 29D0     		beq	.L295
 833:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 2898              		.loc 1 833 0
 2899 000a 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2900 000c 082A     		cmp	r2, #8
 2901 000e 26D0     		beq	.L295
 834:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 2902              		.loc 1 834 0
 2903 0010 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2904 0012 042A     		cmp	r2, #4
 2905 0014 23D0     		beq	.L295
 835:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 2906              		.loc 1 835 0
 2907 0016 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2908 0018 092A     		cmp	r2, #9
 2909 001a 20D0     		beq	.L295
 836:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
 2910              		.loc 1 836 0
 2911 001c 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2912 001e 0A2A     		cmp	r2, #10
 2913 0020 1DD0     		beq	.L295
 837:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P0
 2914              		.loc 1 837 0
 2915 0022 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2916 0024 0C2A     		cmp	r2, #12
 2917 0026 1AD0     		beq	.L295
 838:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P1
 2918              		.loc 1 838 0
 2919 0028 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2920 002a 112A     		cmp	r2, #17
ARM GAS  /tmp/cc1G6faT.s 			page 97


 2921 002c 17D0     		beq	.L295
 839:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P2
 2922              		.loc 1 839 0
 2923 002e 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2924 0030 122A     		cmp	r2, #18
 2925 0032 14D0     		beq	.L295
 840:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P3
 2926              		.loc 1 840 0
 2927 0034 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2928 0036 132A     		cmp	r2, #19
 2929 0038 11D0     		beq	.L295
 841:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P4
 2930              		.loc 1 841 0
 2931 003a 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2932 003c 142A     		cmp	r2, #20
 2933 003e 0ED0     		beq	.L295
 842:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P5
 2934              		.loc 1 842 0
 2935 0040 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2936 0042 1529     		cmp	r1, #21
 2937 0044 0BD0     		beq	.L295
 843:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P6
 2938              		.loc 1 843 0
 2939 0046 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2940 0048 1629     		cmp	r1, #22
 2941 004a 08D0     		beq	.L295
 844:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P7
 2942              		.loc 1 844 0
 2943 004c 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2944 004e 1729     		cmp	r1, #23
 2945 0050 05D0     		beq	.L295
 845:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 2946              		.loc 1 845 0
 2947 0052 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2948 0054 1829     		cmp	r1, #24
 2949 0056 02D0     		beq	.L295
 846:bluetooth_rxtx.c **** 	{
 2950              		.loc 1 846 0
 2951 0058 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2952 005a 0F2A     		cmp	r2, #15
 2953 005c 39D1     		bne	.L294
 2954              	.L295:
 849:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 2955              		.loc 1 849 0
 2956 005e 1E4A     		ldr	r2, .L354+4
 2957 0060 1268     		ldr	r2, [r2]
 2958 0062 D007     		lsls	r0, r2, #31
 2959 0064 35D5     		bpl	.L294
 850:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 2960              		.loc 1 850 0
 2961 0066 1D4A     		ldr	r2, .L354+8
 2962 0068 1268     		ldr	r2, [r2]
 2963 006a D107     		lsls	r1, r2, #31
 2964 006c 26D5     		bpl	.L298
 2965              	.LBB23:
 851:bluetooth_rxtx.c **** 
 2966              		.loc 1 851 0
ARM GAS  /tmp/cc1G6faT.s 			page 98


 2967 006e 1C4A     		ldr	r2, .L354+12
 2968 0070 0121     		movs	r1, #1
 2969 0072 1160     		str	r1, [r2]
 853:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 2970              		.loc 1 853 0
 2971 0074 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 2972 0076 022A     		cmp	r2, #2
 2973 0078 03D1     		bne	.L299
 854:bluetooth_rxtx.c **** 
 2974              		.loc 1 854 0
 2975 007a 1A4A     		ldr	r2, .L354+16
 2976 007c 4FF08051 		mov	r1, #268435456
 2977 0080 1160     		str	r1, [r2]
 2978              	.L299:
 856:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 2979              		.loc 1 856 0
 2980 0082 194A     		ldr	r2, .L354+20
 2981 0084 1948     		ldr	r0, .L354+24
 2982 0086 1168     		ldr	r1, [r2]
 2983 0088 0068     		ldr	r0, [r0]
 2984 008a C1F31301 		ubfx	r1, r1, #0, #20
 2985 008e 40F63544 		movw	r4, #3125
 2986 0092 04FB0101 		mla	r1, r4, r1, r0
 2987 0096 5960     		str	r1, [r3, #4]
 857:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 2988              		.loc 1 857 0
 2989 0098 1268     		ldr	r2, [r2]
 2990 009a C2F30752 		ubfx	r2, r2, #20, #8
 2991 009e 9A70     		strb	r2, [r3, #2]
 858:bluetooth_rxtx.c **** 
 2992              		.loc 1 858 0
 2993 00a0 134A     		ldr	r2, .L354+28
 2994 00a2 1288     		ldrh	r2, [r2]
 2995 00a4 92B2     		uxth	r2, r2
 2996 00a6 1A81     		strh	r2, [r3, #8]	@ movhi
 861:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 2997              		.loc 1 861 0
 2998 00a8 124A     		ldr	r2, .L354+32
 862:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 2999              		.loc 1 862 0
 3000 00aa 134B     		ldr	r3, .L354+36
 861:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 3001              		.loc 1 861 0
 3002 00ac 1168     		ldr	r1, [r2]
 3003              	.LVL298:
 862:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 3004              		.loc 1 862 0
 3005 00ae 1868     		ldr	r0, [r3]
 3006 00b0 1060     		str	r0, [r2]
 863:bluetooth_rxtx.c **** 
 3007              		.loc 1 863 0
 3008 00b2 1960     		str	r1, [r3]
 865:bluetooth_rxtx.c **** 			}
 3009              		.loc 1 865 0
 3010 00b4 114B     		ldr	r3, .L354+40
 3011 00b6 1A68     		ldr	r2, [r3]
 3012 00b8 0132     		adds	r2, r2, #1
ARM GAS  /tmp/cc1G6faT.s 			page 99


 3013 00ba 1A60     		str	r2, [r3]
 3014              	.LVL299:
 3015              	.L298:
 3016              	.LBE23:
 867:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 3017              		.loc 1 867 0
 3018 00bc 104B     		ldr	r3, .L354+44
 3019 00be 1B68     		ldr	r3, [r3]
 3020 00c0 DA07     		lsls	r2, r3, #31
 3021 00c2 06D5     		bpl	.L294
 868:bluetooth_rxtx.c **** 				++rx_err;
 3022              		.loc 1 868 0
 3023 00c4 0F4B     		ldr	r3, .L354+48
 3024 00c6 0122     		movs	r2, #1
 3025 00c8 1A60     		str	r2, [r3]
 869:bluetooth_rxtx.c **** 			}
 3026              		.loc 1 869 0
 3027 00ca 0F4B     		ldr	r3, .L354+52
 3028 00cc 1A68     		ldr	r2, [r3]
 3029 00ce 0132     		adds	r2, r2, #1
 3030 00d0 1A60     		str	r2, [r3]
 3031              	.L294:
 3032 00d2 10BD     		pop	{r4, pc}
 3033              	.L355:
 3034              		.align	2
 3035              	.L354:
 3036 00d4 00000000 		.word	.LANCHOR0
 3037 00d8 00400050 		.word	1342193664
 3038 00dc 04400050 		.word	1342193668
 3039 00e0 08400050 		.word	1342193672
 3040 00e4 98C00920 		.word	537510040
 3041 00e8 00000000 		.word	clkn
 3042 00ec 08400040 		.word	1073758216
 3043 00f0 00000000 		.word	.LANCHOR1
 3044 00f4 00000000 		.word	active_rxbuf
 3045 00f8 00000000 		.word	idle_rxbuf
 3046 00fc 00000000 		.word	rx_tc
 3047 0100 0C400050 		.word	1342193676
 3048 0104 10400050 		.word	1342193680
 3049 0108 00000000 		.word	rx_err
 3050              		.cfi_endproc
 3051              	.LFE6:
 3053              		.section	.text.le_transmit,"ax",%progbits
 3054              		.align	1
 3055              		.global	le_transmit
 3056              		.thumb
 3057              		.thumb_func
 3059              	le_transmit:
 3060              	.LFB11:
1095:bluetooth_rxtx.c **** 	unsigned i, j;
 3061              		.loc 1 1095 0
 3062              		.cfi_startproc
 3063              		@ args = 4, pretend = 0, frame = 64
 3064              		@ frame_needed = 0, uses_anonymous_args = 0
 3065              	.LVL300:
 3066 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 3067              		.cfi_def_cfa_offset 36
ARM GAS  /tmp/cc1G6faT.s 			page 100


 3068              		.cfi_offset 4, -36
 3069              		.cfi_offset 5, -32
 3070              		.cfi_offset 6, -28
 3071              		.cfi_offset 7, -24
 3072              		.cfi_offset 8, -20
 3073              		.cfi_offset 9, -16
 3074              		.cfi_offset 10, -12
 3075              		.cfi_offset 11, -8
 3076              		.cfi_offset 14, -4
 3077 0004 91B0     		sub	sp, sp, #68
 3078              		.cfi_def_cfa_offset 104
1095:bluetooth_rxtx.c **** 	unsigned i, j;
 3079              		.loc 1 1095 0
 3080 0006 BDF86880 		ldrh	r8, [sp, #104]
 3081              	.LVL301:
 3082 000a 8A46     		mov	r10, r1
 3083 000c 0546     		mov	r5, r0
 3084 000e 9346     		mov	fp, r2
1105:bluetooth_rxtx.c **** 
 3085              		.loc 1 1105 0
 3086 0010 03F00F09 		and	r9, r3, #15
 3087              	.LVL302:
 3088 0014 0DF1FF34 		add	r4, sp, #-1
 3089 0018 0DF10301 		add	r1, sp, #3
 3090              	.LVL303:
 3091              	.L360:
1111:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 3092              		.loc 1 1111 0
 3093 001c 0022     		movs	r2, #0
1109:bluetooth_rxtx.c **** 		aa >>= 8;
 3094              		.loc 1 1109 0
 3095 001e EBB2     		uxtb	r3, r5
 3096              	.LVL304:
1111:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 3097              		.loc 1 1111 0
 3098 0020 6270     		strb	r2, [r4, #1]
1110:bluetooth_rxtx.c **** 		txbuf[i] = 0;
 3099              		.loc 1 1110 0
 3100 0022 2D0A     		lsrs	r5, r5, #8
 3101              	.LVL305:
1111:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 3102              		.loc 1 1111 0
 3103 0024 0726     		movs	r6, #7
 3104              	.LVL306:
 3105              	.L358:
1113:bluetooth_rxtx.c **** 			byte >>= 1;
 3106              		.loc 1 1113 0 discriminator 2
 3107 0026 03F00100 		and	r0, r3, #1
 3108 002a B040     		lsls	r0, r0, r6
1112:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
 3109              		.loc 1 1112 0 discriminator 2
 3110 002c 16F1FF36 		adds	r6, r6, #-1
 3111              	.LVL307:
1113:bluetooth_rxtx.c **** 			byte >>= 1;
 3112              		.loc 1 1113 0 discriminator 2
 3113 0030 40EA0202 		orr	r2, r0, r2
 3114 0034 D2B2     		uxtb	r2, r2
ARM GAS  /tmp/cc1G6faT.s 			page 101


1114:bluetooth_rxtx.c **** 		}
 3115              		.loc 1 1114 0 discriminator 2
 3116 0036 4FEA5303 		lsr	r3, r3, #1
 3117              	.LVL308:
1112:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
 3118              		.loc 1 1112 0 discriminator 2
 3119 003a F4D2     		bcs	.L358
 3120 003c 04F8012F 		strb	r2, [r4, #1]!
 3121              	.LVL309:
1108:bluetooth_rxtx.c **** 		byte = aa & 0xff;
 3122              		.loc 1 1108 0
 3123 0040 8C42     		cmp	r4, r1
 3124 0042 EBD1     		bne	.L360
1119:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
 3125              		.loc 1 1119 0
 3126 0044 A8F16200 		sub	r0, r8, #98
 3127 0048 C0B2     		uxtb	r0, r0
 3128 004a FFF7FEFF 		bl	btle_channel_index
 3129              	.LVL310:
 3130 004e 504B     		ldr	r3, .L384
1120:bluetooth_rxtx.c **** 		byte = data[i];
 3131              		.loc 1 1120 0
 3132 0050 0024     		movs	r4, #0
 3133              	.LVL311:
1119:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
 3134              		.loc 1 1119 0
 3135 0052 1F5C     		ldrb	r7, [r3, r0]	@ zero_extendqisi2
 3136              	.LVL312:
 3137              	.L361:
1120:bluetooth_rxtx.c **** 		byte = data[i];
 3138              		.loc 1 1120 0 discriminator 1
 3139 0054 5445     		cmp	r4, r10
 3140 0056 20D2     		bcs	.L383
 3141 0058 00A8     		add	r0, sp, #0
1121:bluetooth_rxtx.c **** 		txbuf[i+4] = 0;
 3142              		.loc 1 1121 0
 3143 005a 1BF80430 		ldrb	r3, [fp, r4]	@ zero_extendqisi2
 3144              	.LVL313:
 3145 005e 2044     		add	r0, r0, r4
 3146              	.LVL314:
 3147 0060 0726     		movs	r6, #7
 3148 0062 0022     		movs	r2, #0
 3149              	.LVL315:
 3150              	.L363:
1124:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 3151              		.loc 1 1124 0 discriminator 2
 3152 0064 4A49     		ldr	r1, .L384
 3153 0066 03F0010E 		and	lr, r3, #1
 3154 006a 3944     		add	r1, r1, r7
 3155 006c 91F82810 		ldrb	r1, [r1, #40]	@ zero_extendqisi2
1125:bluetooth_rxtx.c **** 			byte >>= 1;
 3156              		.loc 1 1125 0 discriminator 2
 3157 0070 0137     		adds	r7, r7, #1
 3158              	.LVL316:
1124:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 3159              		.loc 1 1124 0 discriminator 2
 3160 0072 8EEA010E 		eor	lr, lr, r1
ARM GAS  /tmp/cc1G6faT.s 			page 102


 3161              	.LVL317:
1125:bluetooth_rxtx.c **** 			byte >>= 1;
 3162              		.loc 1 1125 0 discriminator 2
 3163 0076 7F21     		movs	r1, #127
 3164 0078 B7FBF1FC 		udiv	ip, r7, r1
 3165 007c 01FB1C77 		mls	r7, r1, ip, r7
 3166              	.LVL318:
1127:bluetooth_rxtx.c **** 		}
 3167              		.loc 1 1127 0 discriminator 2
 3168 0080 0EFA06F1 		lsl	r1, lr, r6
1123:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 3169              		.loc 1 1123 0 discriminator 2
 3170 0084 16F1FF36 		adds	r6, r6, #-1
 3171              	.LVL319:
1127:bluetooth_rxtx.c **** 		}
 3172              		.loc 1 1127 0 discriminator 2
 3173 0088 41EA0202 		orr	r2, r1, r2
1126:bluetooth_rxtx.c **** 			txbuf[i+4] |= bit << (7 - j);
 3174              		.loc 1 1126 0 discriminator 2
 3175 008c 4FEA5303 		lsr	r3, r3, #1
 3176              	.LVL320:
1127:bluetooth_rxtx.c **** 		}
 3177              		.loc 1 1127 0 discriminator 2
 3178 0090 D2B2     		uxtb	r2, r2
 3179              	.LVL321:
1123:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 3180              		.loc 1 1123 0 discriminator 2
 3181 0092 E7D2     		bcs	.L363
 3182 0094 0271     		strb	r2, [r0, #4]
1120:bluetooth_rxtx.c **** 		byte = data[i];
 3183              		.loc 1 1120 0
 3184 0096 0134     		adds	r4, r4, #1
 3185              	.LVL322:
 3186 0098 DCE7     		b	.L361
 3187              	.LVL323:
 3188              	.L383:
1134:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3189              		.loc 1 1134 0
 3190 009a 0D20     		movs	r0, #13
 3191 009c 47F6FF71 		movw	r1, #32767
 3192 00a0 FFF7FEFF 		bl	cc2400_set
 3193              	.LVL324:
1135:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 3194              		.loc 1 1135 0
 3195 00a4 1220     		movs	r0, #18
 3196 00a6 42F62231 		movw	r1, #11042
 3197 00aa FFF7FEFF 		bl	cc2400_set
 3198              	.LVL325:
1136:bluetooth_rxtx.c **** 
 3199              		.loc 1 1136 0
 3200 00ae 1420     		movs	r0, #20
 3201 00b0 41F24B31 		movw	r1, #4939
 3202 00b4 FFF7FEFF 		bl	cc2400_set
 3203              	.LVL326:
1138:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 3204              		.loc 1 1138 0
 3205 00b8 2020     		movs	r0, #32
ARM GAS  /tmp/cc1G6faT.s 			page 103


 3206 00ba 40F60141 		movw	r1, #3073
 3207 00be FFF7FEFF 		bl	cc2400_set
 3208              	.LVL327:
1146:bluetooth_rxtx.c **** 	// JWHUR cc2400 data sheet about power control
 3209              		.loc 1 1146 0
 3210 00c2 0220     		movs	r0, #2
 3211 00c4 4146     		mov	r1, r8
 3212 00c6 FFF7FEFF 		bl	cc2400_set
 3213              	.LVL328:
1157:bluetooth_rxtx.c **** 	//cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 3214              		.loc 1 1157 0
 3215 00ca 0520     		movs	r0, #5
 3216 00cc 4946     		mov	r1, r9
 3217 00ce FFF7FEFF 		bl	cc2400_set
 3218              	.LVL329:
1159:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
 3219              		.loc 1 1159 0
 3220 00d2 0320     		movs	r0, #3
 3221 00d4 4021     		movs	r1, #64
 3222 00d6 FFF7FEFF 		bl	cc2400_set
 3223              	.LVL330:
1160:bluetooth_rxtx.c **** 
 3224              		.loc 1 1160 0
 3225 00da 1421     		movs	r1, #20
 3226 00dc 2320     		movs	r0, #35
 3227 00de FFF7FEFF 		bl	cc2400_set
 3228              	.LVL331:
1163:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0xaaaa);
 3229              		.loc 1 1163 0
 3230 00e2 EA07     		lsls	r2, r5, #31
1164:bluetooth_rxtx.c **** 	else
 3231              		.loc 1 1164 0
 3232 00e4 4CBF     		ite	mi
 3233 00e6 4AF6AA21 		movwmi	r1, #43690
1166:bluetooth_rxtx.c **** 
 3234              		.loc 1 1166 0
 3235 00ea 45F25551 		movwpl	r1, #21845
1164:bluetooth_rxtx.c **** 	else
 3236              		.loc 1 1164 0
 3237 00ee 2D20     		movs	r0, #45
1166:bluetooth_rxtx.c **** 
 3238              		.loc 1 1166 0
 3239 00f0 FFF7FEFF 		bl	cc2400_set
 3240              	.LVL332:
1169:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 3241              		.loc 1 1169 0
 3242 00f4 0820     		movs	r0, #8
 3243 00f6 FFF7FEFF 		bl	cc2400_get
 3244              	.LVL333:
1170:bluetooth_rxtx.c **** 
 3245              		.loc 1 1170 0
 3246 00fa C0F30801 		ubfx	r1, r0, #0, #9
1131:bluetooth_rxtx.c **** 
 3247              		.loc 1 1131 0
 3248 00fe 0AF1040A 		add	r10, r10, #4
1169:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 3249              		.loc 1 1169 0
ARM GAS  /tmp/cc1G6faT.s 			page 104


 3250 0102 0446     		mov	r4, r0
 3251              	.LVL334:
1170:bluetooth_rxtx.c **** 
 3252              		.loc 1 1170 0
 3253 0104 41F49C41 		orr	r1, r1, #19968
 3254 0108 0820     		movs	r0, #8
1131:bluetooth_rxtx.c **** 
 3255              		.loc 1 1131 0
 3256 010a 5FFA8AFA 		uxtb	r10, r10
 3257              	.LVL335:
1170:bluetooth_rxtx.c **** 
 3258              		.loc 1 1170 0
 3259 010e FFF7FEFF 		bl	cc2400_set
 3260              	.LVL336:
 3261              	.L368:
1172:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3262              		.loc 1 1172 0 discriminator 1
 3263 0112 FFF7FEFF 		bl	cc2400_status
 3264              	.LVL337:
 3265 0116 4306     		lsls	r3, r0, #25
 3266 0118 FBD5     		bpl	.L368
1173:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3267              		.loc 1 1173 0
 3268 011a 6120     		movs	r0, #97
 3269 011c FFF7FEFF 		bl	cc2400_strobe
 3270              	.LVL338:
 3271              	.L370:
1174:bluetooth_rxtx.c **** 	TXLED_SET;
 3272              		.loc 1 1174 0 discriminator 1
 3273 0120 FFF7FEFF 		bl	cc2400_status
 3274              	.LVL339:
 3275 0124 4707     		lsls	r7, r0, #29
 3276 0126 FBD5     		bpl	.L370
1175:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 3277              		.loc 1 1175 0
 3278 0128 1A4B     		ldr	r3, .L384+4
 3279 012a 4FF48072 		mov	r2, #256
 3280 012e 1A60     		str	r2, [r3]
1177:bluetooth_rxtx.c **** #endif
 3281              		.loc 1 1177 0
 3282 0130 8022     		movs	r2, #128
 3283 0132 1A62     		str	r2, [r3, #32]
 3284              	.L372:
1179:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3285              		.loc 1 1179 0 discriminator 1
 3286 0134 0E20     		movs	r0, #14
 3287 0136 FFF7FEFF 		bl	cc2400_get
 3288              	.LVL340:
 3289 013a 00F01F00 		and	r0, r0, #31
 3290 013e 0F28     		cmp	r0, #15
 3291 0140 F8D1     		bne	.L372
1180:bluetooth_rxtx.c **** 
 3292              		.loc 1 1180 0
 3293 0142 6320     		movs	r0, #99
 3294 0144 FFF7FEFF 		bl	cc2400_strobe
 3295              	.LVL341:
 3296              	.L374:
ARM GAS  /tmp/cc1G6faT.s 			page 105


1193:bluetooth_rxtx.c **** 	cc2400_fifo_write(len, txbuf);
 3297              		.loc 1 1193 0 discriminator 1
 3298 0148 134B     		ldr	r3, .L384+8
 3299 014a 1B68     		ldr	r3, [r3]
 3300 014c 5E07     		lsls	r6, r3, #29
 3301 014e FBD4     		bmi	.L374
1194:bluetooth_rxtx.c **** 
 3302              		.loc 1 1194 0
 3303 0150 5046     		mov	r0, r10
 3304 0152 6946     		mov	r1, sp
 3305 0154 FFF7FEFF 		bl	cc2400_fifo_write
 3306              	.LVL342:
 3307              	.L376:
1196:bluetooth_rxtx.c **** 	TXLED_CLR;
 3308              		.loc 1 1196 0 discriminator 1
 3309 0158 0E20     		movs	r0, #14
 3310 015a FFF7FEFF 		bl	cc2400_get
 3311              	.LVL343:
 3312 015e 00F01F00 		and	r0, r0, #31
 3313 0162 0F28     		cmp	r0, #15
 3314 0164 F8D1     		bne	.L376
1197:bluetooth_rxtx.c **** 
 3315              		.loc 1 1197 0
 3316 0166 0D4B     		ldr	r3, .L384+12
 3317 0168 4FF48072 		mov	r2, #256
 3318 016c 1A60     		str	r2, [r3]
1199:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 3319              		.loc 1 1199 0
 3320 016e 6420     		movs	r0, #100
 3321 0170 FFF7FEFF 		bl	cc2400_strobe
 3322              	.LVL344:
 3323              	.L378:
1200:bluetooth_rxtx.c **** 
 3324              		.loc 1 1200 0 discriminator 1
 3325 0174 FFF7FEFF 		bl	cc2400_status
 3326              	.LVL345:
 3327 0178 4507     		lsls	r5, r0, #29
 3328 017a FBD4     		bmi	.L378
1203:bluetooth_rxtx.c **** #endif
 3329              		.loc 1 1203 0
 3330 017c 084B     		ldr	r3, .L384+16
 3331 017e 8022     		movs	r2, #128
 3332 0180 1A60     		str	r2, [r3]
1207:bluetooth_rxtx.c **** }
 3333              		.loc 1 1207 0
 3334 0182 0820     		movs	r0, #8
 3335 0184 2146     		mov	r1, r4
 3336 0186 FFF7FEFF 		bl	cc2400_set
 3337              	.LVL346:
1208:bluetooth_rxtx.c **** 
 3338              		.loc 1 1208 0
 3339 018a 11B0     		add	sp, sp, #68
 3340              		@ sp needed
 3341 018c BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 3342              	.LVL347:
 3343              	.L385:
 3344              		.align	2
ARM GAS  /tmp/cc1G6faT.s 			page 106


 3345              	.L384:
 3346 0190 00000000 		.word	.LANCHOR2
 3347 0194 38C00920 		.word	537509944
 3348 0198 54C00920 		.word	537509972
 3349 019c 3CC00920 		.word	537509948
 3350 01a0 5CC00920 		.word	537509980
 3351              		.cfi_endproc
 3352              	.LFE11:
 3354              		.section	.text.le_jam,"ax",%progbits
 3355              		.align	1
 3356              		.global	le_jam
 3357              		.thumb
 3358              		.thumb_func
 3360              	le_jam:
 3361              	.LFB12:
1210:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 3362              		.loc 1 1210 0
 3363              		.cfi_startproc
 3364              		@ args = 0, pretend = 0, frame = 0
 3365              		@ frame_needed = 0, uses_anonymous_args = 0
 3366 0000 08B5     		push	{r3, lr}
 3367              		.cfi_def_cfa_offset 8
 3368              		.cfi_offset 3, -8
 3369              		.cfi_offset 14, -4
1212:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3370              		.loc 1 1212 0
 3371 0002 0D20     		movs	r0, #13
 3372 0004 47F6FF71 		movw	r1, #32767
 3373 0008 FFF7FEFF 		bl	cc2400_set
 3374              	.LVL348:
1213:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
 3375              		.loc 1 1213 0
 3376 000c 1220     		movs	r0, #18
 3377 000e 42F62231 		movw	r1, #11042
 3378 0012 FFF7FEFF 		bl	cc2400_set
 3379              	.LVL349:
1214:bluetooth_rxtx.c **** 
 3380              		.loc 1 1214 0
 3381 0016 1420     		movs	r0, #20
 3382 0018 42F24B31 		movw	r1, #9035
 3383 001c FFF7FEFF 		bl	cc2400_set
 3384              	.LVL350:
1216:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 3385              		.loc 1 1216 0
 3386 0020 2020     		movs	r0, #32
 3387 0022 40F60141 		movw	r1, #3073
 3388 0026 FFF7FEFF 		bl	cc2400_set
 3389              	.LVL351:
1225:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 3390              		.loc 1 1225 0
 3391 002a 0520     		movs	r0, #5
 3392 002c 0B21     		movs	r1, #11
 3393 002e FFF7FEFF 		bl	cc2400_set
 3394              	.LVL352:
1226:bluetooth_rxtx.c **** 
 3395              		.loc 1 1226 0
 3396 0032 0320     		movs	r0, #3
ARM GAS  /tmp/cc1G6faT.s 			page 107


 3397 0034 4021     		movs	r1, #64
 3398 0036 FFF7FEFF 		bl	cc2400_set
 3399              	.LVL353:
 3400              	.L388:
1228:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3401              		.loc 1 1228 0 discriminator 1
 3402 003a FFF7FEFF 		bl	cc2400_status
 3403              	.LVL354:
 3404 003e 4006     		lsls	r0, r0, #25
 3405 0040 FBD5     		bpl	.L388
1229:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3406              		.loc 1 1229 0
 3407 0042 6120     		movs	r0, #97
 3408 0044 FFF7FEFF 		bl	cc2400_strobe
 3409              	.LVL355:
 3410              	.L390:
1230:bluetooth_rxtx.c **** 	TXLED_SET;
 3411              		.loc 1 1230 0 discriminator 1
 3412 0048 FFF7FEFF 		bl	cc2400_status
 3413              	.LVL356:
 3414 004c 4107     		lsls	r1, r0, #29
 3415 004e FBD5     		bpl	.L390
1231:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 3416              		.loc 1 1231 0
 3417 0050 084B     		ldr	r3, .L393
 3418 0052 4FF48072 		mov	r2, #256
 3419 0056 1A60     		str	r2, [r3]
1233:bluetooth_rxtx.c **** #endif
 3420              		.loc 1 1233 0
 3421 0058 8022     		movs	r2, #128
 3422 005a 1A62     		str	r2, [r3, #32]
 3423              	.L392:
1235:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3424              		.loc 1 1235 0 discriminator 1
 3425 005c 0E20     		movs	r0, #14
 3426 005e FFF7FEFF 		bl	cc2400_get
 3427              	.LVL357:
 3428 0062 00F01F00 		and	r0, r0, #31
 3429 0066 0F28     		cmp	r0, #15
 3430 0068 F8D1     		bne	.L392
1236:bluetooth_rxtx.c **** #endif
 3431              		.loc 1 1236 0
 3432 006a 6320     		movs	r0, #99
1238:bluetooth_rxtx.c **** 
 3433              		.loc 1 1238 0
 3434 006c BDE80840 		pop	{r3, lr}
1236:bluetooth_rxtx.c **** #endif
 3435              		.loc 1 1236 0
 3436 0070 FFF7FEBF 		b	cc2400_strobe
 3437              	.LVL358:
 3438              	.L394:
 3439              		.align	2
 3440              	.L393:
 3441 0074 38C00920 		.word	537509944
 3442              		.cfi_endproc
 3443              	.LFE12:
 3445              		.section	.text.hop,"ax",%progbits
ARM GAS  /tmp/cc1G6faT.s 			page 108


 3446              		.align	1
 3447              		.global	hop
 3448              		.thumb
 3449              		.thumb_func
 3451              	hop:
 3452              	.LFB13:
1243:bluetooth_rxtx.c **** 	do_hop = 0;
 3453              		.loc 1 1243 0
 3454              		.cfi_startproc
 3455              		@ args = 0, pretend = 0, frame = 0
 3456              		@ frame_needed = 0, uses_anonymous_args = 0
 3457 0000 38B5     		push	{r3, r4, r5, lr}
 3458              		.cfi_def_cfa_offset 16
 3459              		.cfi_offset 3, -16
 3460              		.cfi_offset 4, -12
 3461              		.cfi_offset 5, -8
 3462              		.cfi_offset 14, -4
1244:bluetooth_rxtx.c **** 	last_hop = clkn;
 3463              		.loc 1 1244 0
 3464 0002 5F4C     		ldr	r4, .L435
 3465 0004 0023     		movs	r3, #0
 3466 0006 E372     		strb	r3, [r4, #11]
1245:bluetooth_rxtx.c **** 
 3467              		.loc 1 1245 0
 3468 0008 5E4B     		ldr	r3, .L435+4
 3469 000a 5F4A     		ldr	r2, .L435+8
 3470 000c 1968     		ldr	r1, [r3]
 3471 000e 1160     		str	r1, [r2]
1248:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
 3472              		.loc 1 1248 0
 3473 0010 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3474 0012 4AB9     		cbnz	r2, .L396
1249:bluetooth_rxtx.c **** 			return;
 3475              		.loc 1 1249 0
 3476 0014 0220     		movs	r0, #2
 3477 0016 FFF7FEFF 		bl	cc2400_get
 3478              	.LVL359:
 3479 001a 5C4B     		ldr	r3, .L435+12
 3480 001c 1B88     		ldrh	r3, [r3]
 3481 001e 9BB2     		uxth	r3, r3
 3482 0020 013B     		subs	r3, r3, #1
 3483 0022 9842     		cmp	r0, r3
 3484 0024 7FD1     		bne	.L398
 3485 0026 38BD     		pop	{r3, r4, r5, pc}
 3486              	.L396:
1255:bluetooth_rxtx.c **** 		do {
 3487              		.loc 1 1255 0
 3488 0028 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3489 002a 012A     		cmp	r2, #1
 3490 002c 31D1     		bne	.L399
1260:bluetooth_rxtx.c **** 	}
 3491              		.loc 1 1260 0
 3492 002e 584B     		ldr	r3, .L435+16
 3493 0030 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 3494 0032 584B     		ldr	r3, .L435+20
 3495 0034 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 3496              	.L403:
ARM GAS  /tmp/cc1G6faT.s 			page 109


1257:bluetooth_rxtx.c **** 			if (channel > 2480)
 3497              		.loc 1 1257 0
 3498 0036 554B     		ldr	r3, .L435+12
 3499 0038 1A88     		ldrh	r2, [r3]
 3500 003a 92B2     		uxth	r2, r2
 3501 003c 2032     		adds	r2, r2, #32
 3502 003e 92B2     		uxth	r2, r2
 3503 0040 1A80     		strh	r2, [r3]	@ movhi
1258:bluetooth_rxtx.c **** 				channel -= 79;
 3504              		.loc 1 1258 0
 3505 0042 1A88     		ldrh	r2, [r3]
 3506 0044 92B2     		uxth	r2, r2
 3507 0046 B2F51B6F 		cmp	r2, #2480
 3508 004a 04D9     		bls	.L400
1259:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
 3509              		.loc 1 1259 0
 3510 004c 1A88     		ldrh	r2, [r3]
 3511 004e 92B2     		uxth	r2, r2
 3512 0050 4F3A     		subs	r2, r2, #79
 3513 0052 92B2     		uxth	r2, r2
 3514 0054 1A80     		strh	r2, [r3]	@ movhi
 3515              	.L400:
1260:bluetooth_rxtx.c **** 	}
 3516              		.loc 1 1260 0
 3517 0056 0029     		cmp	r1, #0
 3518 0058 65D0     		beq	.L398
1260:bluetooth_rxtx.c **** 	}
 3519              		.loc 1 1260 0 is_stmt 0 discriminator 1
 3520 005a 0028     		cmp	r0, #0
 3521 005c 63D0     		beq	.L398
 3522 005e 1A88     		ldrh	r2, [r3]
 3523 0060 1D88     		ldrh	r5, [r3]
 3524 0062 92B2     		uxth	r2, r2
 3525 0064 A2F66213 		subw	r3, r2, #2402
 3526 0068 0822     		movs	r2, #8
 3527 006a 93FBF2F3 		sdiv	r3, r3, r2
 3528 006e 4A4A     		ldr	r2, .L435+24
 3529 0070 ADB2     		uxth	r5, r5
 3530 0072 D25C     		ldrb	r2, [r2, r3]	@ zero_extendqisi2
 3531 0074 494B     		ldr	r3, .L435+28
 3532 0076 A5F66215 		subw	r5, r5, #2402
 3533 007a 2B40     		ands	r3, r3, r5
 3534 007c 002B     		cmp	r3, #0
 3535 007e 03DA     		bge	.L402
 3536 0080 013B     		subs	r3, r3, #1
 3537 0082 63F00703 		orn	r3, r3, #7
 3538 0086 0133     		adds	r3, r3, #1
 3539              	.L402:
 3540 0088 42FA03F3 		asr	r3, r2, r3
 3541 008c DD07     		lsls	r5, r3, #31
 3542 008e D2D5     		bpl	.L403
 3543 0090 49E0     		b	.L398
 3544              	.L399:
1266:bluetooth_rxtx.c **** 		do {
 3545              		.loc 1 1266 0 is_stmt 1
 3546 0092 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3547 0094 052A     		cmp	r2, #5
ARM GAS  /tmp/cc1G6faT.s 			page 110


 3548 0096 2DD1     		bne	.L404
1271:bluetooth_rxtx.c **** 	}
 3549              		.loc 1 1271 0
 3550 0098 3D4B     		ldr	r3, .L435+16
 3551 009a 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 3552              	.L407:
1268:bluetooth_rxtx.c **** 			if (channel > 2480)
 3553              		.loc 1 1268 0
 3554 009c 3B4B     		ldr	r3, .L435+12
 3555 009e 1A88     		ldrh	r2, [r3]
 3556 00a0 92B2     		uxth	r2, r2
 3557 00a2 2032     		adds	r2, r2, #32
 3558 00a4 92B2     		uxth	r2, r2
 3559 00a6 1A80     		strh	r2, [r3]	@ movhi
1269:bluetooth_rxtx.c **** 				channel -= 79;
 3560              		.loc 1 1269 0
 3561 00a8 1A88     		ldrh	r2, [r3]
 3562 00aa 92B2     		uxth	r2, r2
 3563 00ac B2F51B6F 		cmp	r2, #2480
 3564 00b0 04D9     		bls	.L405
1270:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
 3565              		.loc 1 1270 0
 3566 00b2 1A88     		ldrh	r2, [r3]
 3567 00b4 92B2     		uxth	r2, r2
 3568 00b6 4F3A     		subs	r2, r2, #79
 3569 00b8 92B2     		uxth	r2, r2
 3570 00ba 1A80     		strh	r2, [r3]	@ movhi
 3571              	.L405:
1271:bluetooth_rxtx.c **** 	}
 3572              		.loc 1 1271 0
 3573 00bc 4F29     		cmp	r1, #79
 3574 00be 32D0     		beq	.L398
1271:bluetooth_rxtx.c **** 	}
 3575              		.loc 1 1271 0 is_stmt 0 discriminator 1
 3576 00c0 1A88     		ldrh	r2, [r3]
 3577 00c2 1888     		ldrh	r0, [r3]
 3578 00c4 92B2     		uxth	r2, r2
 3579 00c6 A2F66213 		subw	r3, r2, #2402
 3580 00ca 0822     		movs	r2, #8
 3581 00cc 93FBF2F3 		sdiv	r3, r3, r2
 3582 00d0 314A     		ldr	r2, .L435+24
 3583 00d2 80B2     		uxth	r0, r0
 3584 00d4 D25C     		ldrb	r2, [r2, r3]	@ zero_extendqisi2
 3585 00d6 314B     		ldr	r3, .L435+28
 3586 00d8 A0F66210 		subw	r0, r0, #2402
 3587 00dc 0340     		ands	r3, r3, r0
 3588 00de 002B     		cmp	r3, #0
 3589 00e0 03DA     		bge	.L406
 3590 00e2 013B     		subs	r3, r3, #1
 3591 00e4 63F00703 		orn	r3, r3, #7
 3592 00e8 0133     		adds	r3, r3, #1
 3593              	.L406:
 3594 00ea 42FA03F3 		asr	r3, r2, r3
 3595 00ee DA07     		lsls	r2, r3, #31
 3596 00f0 D4D4     		bmi	.L407
 3597 00f2 18E0     		b	.L398
 3598              	.L404:
ARM GAS  /tmp/cc1G6faT.s 			page 111


1274:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
 3599              		.loc 1 1274 0 is_stmt 1
 3600 00f4 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3601 00f6 022A     		cmp	r2, #2
 3602 00f8 05D1     		bne	.L408
1275:bluetooth_rxtx.c **** 	}
 3603              		.loc 1 1275 0
 3604 00fa 1868     		ldr	r0, [r3]
 3605 00fc FFF7FEFF 		bl	next_hop
 3606              	.LVL360:
 3607 0100 224B     		ldr	r3, .L435+12
 3608 0102 1880     		strh	r0, [r3]	@ movhi
 3609 0104 0FE0     		b	.L398
 3610              	.L408:
1278:bluetooth_rxtx.c **** 		channel = btle_next_hop(&le);
 3611              		.loc 1 1278 0
 3612 0106 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3613 0108 032B     		cmp	r3, #3
 3614 010a 05D1     		bne	.L409
1279:bluetooth_rxtx.c **** 	}
 3615              		.loc 1 1279 0
 3616 010c 1F4D     		ldr	r5, .L435+12
 3617 010e 281D     		adds	r0, r5, #4
 3618 0110 FFF7FEFF 		bl	btle_next_hop
 3619              	.LVL361:
 3620 0114 2880     		strh	r0, [r5]	@ movhi
 3621 0116 06E0     		b	.L398
 3622              	.L409:
1282:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
 3623              		.loc 1 1282 0
 3624 0118 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3625 011a 042B     		cmp	r3, #4
 3626 011c 03D1     		bne	.L398
1283:bluetooth_rxtx.c **** 	}
 3627              		.loc 1 1283 0
 3628 011e A289     		ldrh	r2, [r4, #12]
 3629 0120 1A4B     		ldr	r3, .L435+12
 3630 0122 92B2     		uxth	r2, r2
 3631 0124 1A80     		strh	r2, [r3]	@ movhi
 3632              	.L398:
1286:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 3633              		.loc 1 1286 0
 3634 0126 6420     		movs	r0, #100
 3635 0128 FFF7FEFF 		bl	cc2400_strobe
 3636              	.LVL362:
 3637              	.L411:
1287:bluetooth_rxtx.c **** 
 3638              		.loc 1 1287 0 discriminator 1
 3639 012c FFF7FEFF 		bl	cc2400_status
 3640              	.LVL363:
 3641 0130 4307     		lsls	r3, r0, #29
 3642 0132 FBD4     		bmi	.L411
 3643 0134 154D     		ldr	r5, .L435+12
1290:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3644              		.loc 1 1290 0
 3645 0136 607C     		ldrb	r0, [r4, #17]	@ zero_extendqisi2
1291:bluetooth_rxtx.c **** 	else
ARM GAS  /tmp/cc1G6faT.s 			page 112


 3646              		.loc 1 1291 0
 3647 0138 2988     		ldrh	r1, [r5]
1290:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3648              		.loc 1 1290 0
 3649 013a C0B2     		uxtb	r0, r0
 3650 013c 0228     		cmp	r0, #2
1291:bluetooth_rxtx.c **** 	else
 3651              		.loc 1 1291 0
 3652 013e 89B2     		uxth	r1, r1
1293:bluetooth_rxtx.c **** 
 3653              		.loc 1 1293 0
 3654 0140 1EBF     		ittt	ne
 3655 0142 01F1FF31 		addne	r1, r1, #-1
 3656 0146 0220     		movne	r0, #2
 3657 0148 89B2     		uxthne	r1, r1
 3658 014a FFF7FEFF 		bl	cc2400_set
 3659              	.LVL364:
1296:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 3660              		.loc 1 1296 0
 3661 014e A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3662 0150 1BB1     		cbz	r3, .L414
1297:bluetooth_rxtx.c **** 	}
 3663              		.loc 1 1297 0
 3664 0152 2888     		ldrh	r0, [r5]
 3665 0154 80B2     		uxth	r0, r0
 3666 0156 FFF7FEFF 		bl	cs_threshold_calc_and_set
 3667              	.LVL365:
 3668              	.L414:
1301:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3669              		.loc 1 1301 0
 3670 015a 6120     		movs	r0, #97
 3671 015c FFF7FEFF 		bl	cc2400_strobe
 3672              	.LVL366:
 3673              	.L416:
1302:bluetooth_rxtx.c **** 
 3674              		.loc 1 1302 0 discriminator 1
 3675 0160 FFF7FEFF 		bl	cc2400_status
 3676              	.LVL367:
 3677 0164 4507     		lsls	r5, r0, #29
 3678 0166 FBD5     		bpl	.L416
1304:bluetooth_rxtx.c **** 
 3679              		.loc 1 1304 0
 3680 0168 0123     		movs	r3, #1
 3681 016a 2374     		strb	r3, [r4, #16]
1306:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 3682              		.loc 1 1306 0
 3683 016c 637C     		ldrb	r3, [r4, #17]	@ zero_extendqisi2
 3684 016e 022B     		cmp	r3, #2
1307:bluetooth_rxtx.c **** 	else
 3685              		.loc 1 1307 0
 3686 0170 0CBF     		ite	eq
 3687 0172 6320     		moveq	r0, #99
1309:bluetooth_rxtx.c **** }
 3688              		.loc 1 1309 0
 3689 0174 6220     		movne	r0, #98
1310:bluetooth_rxtx.c **** 
 3690              		.loc 1 1310 0
ARM GAS  /tmp/cc1G6faT.s 			page 113


 3691 0176 BDE83840 		pop	{r3, r4, r5, lr}
1309:bluetooth_rxtx.c **** }
 3692              		.loc 1 1309 0
 3693 017a FFF7FEBF 		b	cc2400_strobe
 3694              	.LVL368:
 3695              	.L436:
 3696 017e 00BF     		.align	2
 3697              	.L435:
 3698 0180 00000000 		.word	.LANCHOR0
 3699 0184 00000000 		.word	clkn
 3700 0188 00000000 		.word	last_hop
 3701 018c 00000000 		.word	.LANCHOR1
 3702 0190 00000000 		.word	used_channels
 3703 0194 00000000 		.word	afh_enabled
 3704 0198 00000000 		.word	afh_map
 3705 019c 07000080 		.word	-2147483641
 3706              		.cfi_endproc
 3707              	.LFE13:
 3709              		.section	.text.bt_stream_rx,"ax",%progbits
 3710              		.align	1
 3711              		.global	bt_stream_rx
 3712              		.thumb
 3713              		.thumb_func
 3715              	bt_stream_rx:
 3716              	.LFB14:
1314:bluetooth_rxtx.c **** 	int8_t rssi;
 3717              		.loc 1 1314 0
 3718              		.cfi_startproc
 3719              		@ args = 0, pretend = 0, frame = 0
 3720              		@ frame_needed = 0, uses_anonymous_args = 0
 3721 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 3722              		.cfi_def_cfa_offset 32
 3723              		.cfi_offset 3, -32
 3724              		.cfi_offset 4, -28
 3725              		.cfi_offset 5, -24
 3726              		.cfi_offset 6, -20
 3727              		.cfi_offset 7, -16
 3728              		.cfi_offset 8, -12
 3729              		.cfi_offset 9, -8
 3730              		.cfi_offset 14, -4
1318:bluetooth_rxtx.c **** 
 3731              		.loc 1 1318 0
 3732 0004 494B     		ldr	r3, .L471
 3733 0006 1022     		movs	r2, #16
 3734 0008 1A60     		str	r2, [r3]
1320:bluetooth_rxtx.c **** 	dio_ssp_init();
 3735              		.loc 1 1320 0
 3736 000a FFF7FEFF 		bl	queue_init
 3737              	.LVL369:
1321:bluetooth_rxtx.c **** 	dma_init();
 3738              		.loc 1 1321 0
 3739 000e FFF7FEFF 		bl	dio_ssp_init
 3740              	.LVL370:
1322:bluetooth_rxtx.c **** 	dio_ssp_start();
 3741              		.loc 1 1322 0
 3742 0012 FFF7FEFF 		bl	dma_init
 3743              	.LVL371:
ARM GAS  /tmp/cc1G6faT.s 			page 114


1323:bluetooth_rxtx.c **** 
 3744              		.loc 1 1323 0
 3745 0016 FFF7FEFF 		bl	dio_ssp_start
 3746              	.LVL372:
1325:bluetooth_rxtx.c **** 
 3747              		.loc 1 1325 0
 3748 001a FFF7FEFF 		bl	cc2400_rx
 3749              	.LVL373:
1327:bluetooth_rxtx.c **** 
 3750              		.loc 1 1327 0
 3751 001e FFF7FEFF 		bl	cs_trigger_enable
 3752              	.LVL374:
 3753              	.L438:
1329:bluetooth_rxtx.c **** 	{
 3754              		.loc 1 1329 0 discriminator 1
 3755 0022 434C     		ldr	r4, .L471+4
 3756 0024 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 3757 0026 A146     		mov	r9, r4
 3758 0028 012B     		cmp	r3, #1
 3759 002a 75D1     		bne	.L469
 3760              	.L450:
1332:bluetooth_rxtx.c **** 
 3761              		.loc 1 1332 0
 3762 002c 3F4B     		ldr	r3, .L471
 3763 002e 1022     		movs	r2, #16
 3764 0030 1A60     		str	r2, [r3]
1344:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 3765              		.loc 1 1344 0
 3766 0032 FFF7FEFF 		bl	rssi_reset
 3767              	.LVL375:
1345:bluetooth_rxtx.c **** 		while (!rx_tc) {
 3768              		.loc 1 1345 0
 3769 0036 8025     		movs	r5, #128
 3770              	.LVL376:
 3771              	.L439:
1346:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 3772              		.loc 1 1346 0 discriminator 1
 3773 0038 3E4F     		ldr	r7, .L471+8
 3774 003a 3F4E     		ldr	r6, .L471+12
 3775 003c 3B68     		ldr	r3, [r7]
 3776 003e DFF81881 		ldr	r8, .L471+44
 3777 0042 2BBB     		cbnz	r3, .L470
1347:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 3778              		.loc 1 1347 0
 3779 0044 0620     		movs	r0, #6
 3780 0046 FFF7FEFF 		bl	cc2400_get
 3781              	.LVL377:
1348:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3782              		.loc 1 1348 0
 3783 004a 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
1347:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 3784              		.loc 1 1347 0
 3785 004c C0F30720 		ubfx	r0, r0, #8, #8
 3786              	.LVL378:
1348:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3787              		.loc 1 1348 0
 3788 0050 63B1     		cbz	r3, .L440
ARM GAS  /tmp/cc1G6faT.s 			page 115


1348:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3789              		.loc 1 1348 0 is_stmt 0 discriminator 1
 3790 0052 6BB2     		sxtb	r3, r5
 3791 0054 8033     		adds	r3, r3, #128
 3792 0056 09D1     		bne	.L440
1349:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 3793              		.loc 1 1349 0 is_stmt 1
 3794 0058 384B     		ldr	r3, .L471+16
 3795 005a 40B2     		sxtb	r0, r0
 3796              	.LVL379:
 3797 005c 93F90050 		ldrsb	r5, [r3]
 3798              	.LVL380:
 3799 0060 3635     		adds	r5, r5, #54
 3800 0062 A842     		cmp	r0, r5
 3801 0064 A8BF     		it	ge
 3802 0066 0546     		movge	r5, r0
 3803 0068 EDB2     		uxtb	r5, r5
1350:bluetooth_rxtx.c **** 			}
 3804              		.loc 1 1350 0
 3805 006a 2846     		mov	r0, r5
 3806              	.L440:
 3807              	.LVL381:
1352:bluetooth_rxtx.c **** 
 3808              		.loc 1 1352 0
 3809 006c 40B2     		sxtb	r0, r0
 3810              	.LVL382:
 3811 006e FFF7FEFF 		bl	rssi_add
 3812              	.LVL383:
1354:bluetooth_rxtx.c **** 
 3813              		.loc 1 1354 0
 3814 0072 D8F80000 		ldr	r0, [r8]
 3815 0076 FFF7FEFF 		bl	handle_usb
 3816              	.LVL384:
1357:bluetooth_rxtx.c **** 				hop();
 3817              		.loc 1 1357 0
 3818 007a 99F80B30 		ldrb	r3, [r9, #11]	@ zero_extendqisi2
 3819 007e 13B1     		cbz	r3, .L441
1358:bluetooth_rxtx.c **** 			} else {
 3820              		.loc 1 1358 0
 3821 0080 FFF7FEFF 		bl	hop
 3822              	.LVL385:
 3823 0084 D8E7     		b	.L439
 3824              	.L441:
1360:bluetooth_rxtx.c **** 			}
 3825              		.loc 1 1360 0
 3826 0086 294B     		ldr	r3, .L471
 3827 0088 4FF48072 		mov	r2, #256
 3828 008c 1A60     		str	r2, [r3]
 3829 008e D3E7     		b	.L439
 3830              	.L470:
1366:bluetooth_rxtx.c **** 
 3831              		.loc 1 1366 0
 3832 0090 2B4B     		ldr	r3, .L471+20
 3833 0092 1022     		movs	r2, #16
1368:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 3834              		.loc 1 1368 0
 3835 0094 2B4D     		ldr	r5, .L471+24
ARM GAS  /tmp/cc1G6faT.s 			page 116


 3836              	.LVL386:
1366:bluetooth_rxtx.c **** 
 3837              		.loc 1 1366 0
 3838 0096 1A60     		str	r2, [r3]
1368:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 3839              		.loc 1 1368 0
 3840 0098 2B68     		ldr	r3, [r5]
 3841 009a 1BB1     		cbz	r3, .L444
1369:bluetooth_rxtx.c **** 		}
 3842              		.loc 1 1369 0
 3843 009c 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3844 009e 43F00203 		orr	r3, r3, #2
 3845 00a2 6370     		strb	r3, [r4, #1]
 3846              	.L444:
1373:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 3847              		.loc 1 1373 0
 3848 00a4 3B68     		ldr	r3, [r7]
 3849 00a6 012B     		cmp	r3, #1
 3850 00a8 03D9     		bls	.L445
1374:bluetooth_rxtx.c **** 
 3851              		.loc 1 1374 0
 3852 00aa 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3853 00ac 43F00103 		orr	r3, r3, #1
 3854 00b0 6370     		strb	r3, [r4, #1]
 3855              	.L445:
1376:bluetooth_rxtx.c **** 			status |= DISCARD;
 3856              		.loc 1 1376 0
 3857 00b2 227C     		ldrb	r2, [r4, #16]	@ zero_extendqisi2
 3858 00b4 1E4B     		ldr	r3, .L471+4
 3859 00b6 2AB1     		cbz	r2, .L446
1377:bluetooth_rxtx.c **** 			dma_discard = 0;
 3860              		.loc 1 1377 0
 3861 00b8 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 3862 00ba 42F02002 		orr	r2, r2, #32
 3863 00be 5A70     		strb	r2, [r3, #1]
1378:bluetooth_rxtx.c **** 		}
 3864              		.loc 1 1378 0
 3865 00c0 0022     		movs	r2, #0
 3866 00c2 1A74     		strb	r2, [r3, #16]
 3867              	.L446:
1381:bluetooth_rxtx.c **** 
 3868              		.loc 1 1381 0
 3869 00c4 204B     		ldr	r3, .L471+28
 3870 00c6 1888     		ldrh	r0, [r3]
 3871 00c8 80B2     		uxth	r0, r0
 3872 00ca FFF7FEFF 		bl	rssi_iir_update
 3873              	.LVL387:
1387:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 3874              		.loc 1 1387 0
 3875 00ce 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 3876 00d0 13B9     		cbnz	r3, .L447
1387:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 3877              		.loc 1 1387 0 is_stmt 0 discriminator 1
 3878 00d2 1E4B     		ldr	r3, .L471+32
 3879 00d4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3880 00d6 2BB1     		cbz	r3, .L448
 3881              	.L447:
ARM GAS  /tmp/cc1G6faT.s 			page 117


1388:bluetooth_rxtx.c **** 			cs_trigger = 0;
 3882              		.loc 1 1388 0 is_stmt 1
 3883 00d8 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3884 00da 43F00803 		orr	r3, r3, #8
 3885 00de 6370     		strb	r3, [r4, #1]
1389:bluetooth_rxtx.c **** 		}
 3886              		.loc 1 1389 0
 3887 00e0 0023     		movs	r3, #0
 3888 00e2 3370     		strb	r3, [r6]
 3889              	.L448:
1392:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 3890              		.loc 1 1392 0
 3891 00e4 154B     		ldr	r3, .L471+16
 3892 00e6 93F90020 		ldrsb	r2, [r3]
 3893 00ea 194B     		ldr	r3, .L471+36
 3894 00ec 3532     		adds	r2, r2, #53
 3895 00ee 93F90030 		ldrsb	r3, [r3]
 3896 00f2 9A42     		cmp	r2, r3
 3897 00f4 03DA     		bge	.L449
1393:bluetooth_rxtx.c **** 		}
 3898              		.loc 1 1393 0
 3899 00f6 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3900 00f8 43F01003 		orr	r3, r3, #16
 3901 00fc 6370     		strb	r3, [r4, #1]
 3902              	.L449:
1396:bluetooth_rxtx.c **** 
 3903              		.loc 1 1396 0
 3904 00fe 154B     		ldr	r3, .L471+40
 3905 0100 0020     		movs	r0, #0
 3906 0102 1968     		ldr	r1, [r3]
 3907 0104 FFF7FEFF 		bl	enqueue
 3908              	.LVL388:
1398:bluetooth_rxtx.c **** 		rx_tc = 0;
 3909              		.loc 1 1398 0
 3910 0108 D8F80000 		ldr	r0, [r8]
 3911 010c FFF7FEFF 		bl	handle_usb
 3912              	.LVL389:
1399:bluetooth_rxtx.c **** 		rx_err = 0;
 3913              		.loc 1 1399 0
 3914 0110 0023     		movs	r3, #0
 3915 0112 3B60     		str	r3, [r7]
1400:bluetooth_rxtx.c **** 	}
 3916              		.loc 1 1400 0
 3917 0114 2B60     		str	r3, [r5]
 3918 0116 84E7     		b	.L438
 3919              	.L469:
1329:bluetooth_rxtx.c **** 	{
 3920              		.loc 1 1329 0 discriminator 2
 3921 0118 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 3922 011a 082B     		cmp	r3, #8
 3923 011c 86D0     		beq	.L450
1407:bluetooth_rxtx.c **** 	cs_trigger_disable();
 3924              		.loc 1 1407 0
 3925 011e FFF7FEFF 		bl	dio_ssp_stop
 3926              	.LVL390:
1409:bluetooth_rxtx.c **** 
 3927              		.loc 1 1409 0
ARM GAS  /tmp/cc1G6faT.s 			page 118


 3928 0122 BDE8F843 		pop	{r3, r4, r5, r6, r7, r8, r9, lr}
1408:bluetooth_rxtx.c **** }
 3929              		.loc 1 1408 0
 3930 0126 FFF7FEBF 		b	cs_trigger_disable
 3931              	.LVL391:
 3932              	.L472:
 3933 012a 00BF     		.align	2
 3934              	.L471:
 3935 012c 3CC00920 		.word	537509948
 3936 0130 00000000 		.word	.LANCHOR0
 3937 0134 00000000 		.word	rx_tc
 3938 0138 00000000 		.word	cs_trigger
 3939 013c 00000000 		.word	cs_threshold_cur
 3940 0140 38C00920 		.word	537509944
 3941 0144 00000000 		.word	rx_err
 3942 0148 00000000 		.word	.LANCHOR1
 3943 014c 00000000 		.word	cs_no_squelch
 3944 0150 00000000 		.word	rssi_max
 3945 0154 00000000 		.word	idle_rxbuf
 3946 0158 00000000 		.word	clkn
 3947              		.cfi_endproc
 3948              	.LFE14:
 3950              		.section	.text.br_transmit,"ax",%progbits
 3951              		.align	1
 3952              		.global	br_transmit
 3953              		.thumb
 3954              		.thumb_func
 3956              	br_transmit:
 3957              	.LFB17:
1441:bluetooth_rxtx.c **** 	uint16_t gio_save;
 3958              		.loc 1 1441 0
 3959              		.cfi_startproc
 3960              		@ args = 0, pretend = 0, frame = 16
 3961              		@ frame_needed = 0, uses_anonymous_args = 0
 3962 0000 2DE9FF41 		push	{r0, r1, r2, r3, r4, r5, r6, r7, r8, lr}
 3963              		.cfi_def_cfa_offset 40
 3964              		.cfi_offset 0, -40
 3965              		.cfi_offset 1, -36
 3966              		.cfi_offset 2, -32
 3967              		.cfi_offset 3, -28
 3968              		.cfi_offset 4, -24
 3969              		.cfi_offset 5, -20
 3970              		.cfi_offset 6, -16
 3971              		.cfi_offset 7, -12
 3972              		.cfi_offset 8, -8
 3973              		.cfi_offset 14, -4
 3974              	.LVL392:
1446:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 3975              		.loc 1 1446 0
 3976 0004 954B     		ldr	r3, .L509
 3977 0006 0122     		movs	r2, #1
 3978 0008 D3E90245 		ldrd	r4, [r3, #8]
 3979 000c 0023     		movs	r3, #0
 3980 000e 2240     		ands	r2, r2, r4
 3981 0010 2B40     		ands	r3, r3, r5
 3982 0012 52EA0301 		orrs	r1, r2, r3
1447:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cc1G6faT.s 			page 119


 3983              		.loc 1 1447 0
 3984 0016 4FF00007 		mov	r7, #0
1446:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 3985              		.loc 1 1446 0
 3986 001a 45F25553 		movw	r3, #21845
1447:bluetooth_rxtx.c **** 
 3987              		.loc 1 1447 0
 3988 001e 4FEAD576 		lsr	r6, r5, #31
1446:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 3989              		.loc 1 1446 0
 3990 0022 4AF6AA28 		movw	r8, #43690
 3991 0026 18BF     		it	ne
 3992 0028 9846     		movne	r8, r3
 3993              	.LVL393:
1450:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 3994              		.loc 1 1450 0
 3995 002a E0B2     		uxtb	r0, r4
1447:bluetooth_rxtx.c **** 
 3996              		.loc 1 1447 0
 3997 002c 002F     		cmp	r7, #0
 3998 002e 08BF     		it eq
 3999 0030 012E     		cmpeq	r6, #1
 4000 0032 14BF     		ite	ne
 4001 0034 5526     		movne	r6, #85
 4002 0036 AA26     		moveq	r6, #170
 4003              	.LVL394:
1450:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 4004              		.loc 1 1450 0
 4005 0038 FFF7FEFF 		bl	reverse8
 4006              	.LVL395:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4007              		.loc 1 1449 0
 4008 003c 8DF80000 		strb	r0, [sp]
1451:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
 4009              		.loc 1 1451 0
 4010 0040 C4F30720 		ubfx	r0, r4, #8, #8
 4011 0044 FFF7FEFF 		bl	reverse8
 4012              	.LVL396:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4013              		.loc 1 1449 0
 4014 0048 8DF80100 		strb	r0, [sp, #1]
1452:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
 4015              		.loc 1 1452 0
 4016 004c C4F30740 		ubfx	r0, r4, #16, #8
 4017 0050 FFF7FEFF 		bl	reverse8
 4018              	.LVL397:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4019              		.loc 1 1449 0
 4020 0054 8DF80200 		strb	r0, [sp, #2]
1453:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
 4021              		.loc 1 1453 0
 4022 0058 200E     		lsrs	r0, r4, #24
 4023 005a FFF7FEFF 		bl	reverse8
 4024              	.LVL398:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4025              		.loc 1 1449 0
 4026 005e 8DF80300 		strb	r0, [sp, #3]
ARM GAS  /tmp/cc1G6faT.s 			page 120


1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
 4027              		.loc 1 1454 0
 4028 0062 E8B2     		uxtb	r0, r5
 4029 0064 FFF7FEFF 		bl	reverse8
 4030              	.LVL399:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4031              		.loc 1 1449 0
 4032 0068 8DF80400 		strb	r0, [sp, #4]
1455:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
 4033              		.loc 1 1455 0
 4034 006c C5F30720 		ubfx	r0, r5, #8, #8
 4035 0070 FFF7FEFF 		bl	reverse8
 4036              	.LVL400:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4037              		.loc 1 1449 0
 4038 0074 8DF80500 		strb	r0, [sp, #5]
1456:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
 4039              		.loc 1 1456 0
 4040 0078 C5F30740 		ubfx	r0, r5, #16, #8
 4041 007c FFF7FEFF 		bl	reverse8
 4042              	.LVL401:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4043              		.loc 1 1449 0
 4044 0080 8DF80600 		strb	r0, [sp, #6]
1457:bluetooth_rxtx.c **** 		reverse8(trailer),
 4045              		.loc 1 1457 0
 4046 0084 280E     		lsrs	r0, r5, #24
 4047 0086 FFF7FEFF 		bl	reverse8
 4048              	.LVL402:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4049              		.loc 1 1449 0
 4050 008a 8DF80700 		strb	r0, [sp, #7]
1458:bluetooth_rxtx.c **** 		reverse8(0x77),
 4051              		.loc 1 1458 0
 4052 008e 3046     		mov	r0, r6
 4053 0090 FFF7FEFF 		bl	reverse8
 4054              	.LVL403:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4055              		.loc 1 1449 0
 4056 0094 8DF80800 		strb	r0, [sp, #8]
1459:bluetooth_rxtx.c **** 		reverse8(0x66),
 4057              		.loc 1 1459 0
 4058 0098 7720     		movs	r0, #119
 4059 009a FFF7FEFF 		bl	reverse8
 4060              	.LVL404:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4061              		.loc 1 1449 0
 4062 009e 8DF80900 		strb	r0, [sp, #9]
1460:bluetooth_rxtx.c **** 		reverse8(0x55),
 4063              		.loc 1 1460 0
 4064 00a2 6620     		movs	r0, #102
 4065 00a4 FFF7FEFF 		bl	reverse8
 4066              	.LVL405:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4067              		.loc 1 1449 0
 4068 00a8 8DF80A00 		strb	r0, [sp, #10]
1461:bluetooth_rxtx.c **** 		reverse8(0x44),
ARM GAS  /tmp/cc1G6faT.s 			page 121


 4069              		.loc 1 1461 0
 4070 00ac 5520     		movs	r0, #85
 4071 00ae FFF7FEFF 		bl	reverse8
 4072              	.LVL406:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4073              		.loc 1 1449 0
 4074 00b2 8DF80B00 		strb	r0, [sp, #11]
1462:bluetooth_rxtx.c **** 		reverse8(0x33),
 4075              		.loc 1 1462 0
 4076 00b6 4420     		movs	r0, #68
 4077 00b8 FFF7FEFF 		bl	reverse8
 4078              	.LVL407:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4079              		.loc 1 1449 0
 4080 00bc 8DF80C00 		strb	r0, [sp, #12]
1463:bluetooth_rxtx.c **** 		reverse8(0x22),
 4081              		.loc 1 1463 0
 4082 00c0 3320     		movs	r0, #51
 4083 00c2 FFF7FEFF 		bl	reverse8
 4084              	.LVL408:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4085              		.loc 1 1449 0
 4086 00c6 8DF80D00 		strb	r0, [sp, #13]
1464:bluetooth_rxtx.c **** 		reverse8(0x11)
 4087              		.loc 1 1464 0
 4088 00ca 2220     		movs	r0, #34
 4089 00cc FFF7FEFF 		bl	reverse8
 4090              	.LVL409:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4091              		.loc 1 1449 0
 4092 00d0 8DF80E00 		strb	r0, [sp, #14]
1465:bluetooth_rxtx.c **** 	};
 4093              		.loc 1 1465 0
 4094 00d4 1120     		movs	r0, #17
 4095 00d6 FFF7FEFF 		bl	reverse8
 4096              	.LVL410:
 4097              	.LBB29:
 4098              	.LBB30:
1425:bluetooth_rxtx.c **** 
 4099              		.loc 1 1425 0
 4100 00da 3C46     		mov	r4, r7
 4101              	.LBE30:
 4102              	.LBE29:
1449:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4103              		.loc 1 1449 0
 4104 00dc 8DF80F00 		strb	r0, [sp, #15]
 4105              	.LVL411:
 4106              	.LBB33:
 4107              	.LBB32:
 4108              	.LBB31:
1427:bluetooth_rxtx.c **** 	{
 4109              		.loc 1 1427 0
 4110 00e0 3B46     		mov	r3, r7
 4111              	.LVL412:
 4112              	.L477:
1429:bluetooth_rxtx.c **** 	}
 4113              		.loc 1 1429 0
ARM GAS  /tmp/cc1G6faT.s 			page 122


 4114 00e2 48FA03F2 		asr	r2, r8, r3
 4115 00e6 C3F10F01 		rsb	r1, r3, #15
 4116 00ea 02F00102 		and	r2, r2, #1
 4117 00ee 8A40     		lsls	r2, r2, r1
1427:bluetooth_rxtx.c **** 	{
 4118              		.loc 1 1427 0
 4119 00f0 0133     		adds	r3, r3, #1
 4120              	.LVL413:
1429:bluetooth_rxtx.c **** 	}
 4121              		.loc 1 1429 0
 4122 00f2 1443     		orrs	r4, r4, r2
 4123              	.LVL414:
1427:bluetooth_rxtx.c **** 	{
 4124              		.loc 1 1427 0
 4125 00f4 102B     		cmp	r3, #16
1429:bluetooth_rxtx.c **** 	}
 4126              		.loc 1 1429 0
 4127 00f6 A4B2     		uxth	r4, r4
 4128              	.LVL415:
1427:bluetooth_rxtx.c **** 	{
 4129              		.loc 1 1427 0
 4130 00f8 F3D1     		bne	.L477
 4131              	.LVL416:
 4132              	.LBE31:
 4133              	.LBE32:
 4134              	.LBE33:
 4135              	.LBB34:
 4136              	.LBB35:
1044:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 4137              		.loc 1 1044 0
 4138 00fa 0D20     		movs	r0, #13
 4139 00fc 47F6FF71 		movw	r1, #32767
 4140 0100 FFF7FEFF 		bl	cc2400_set
 4141              	.LVL417:
1045:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 4142              		.loc 1 1045 0
 4143 0104 1220     		movs	r0, #18
 4144 0106 42F62231 		movw	r1, #11042
 4145 010a FFF7FEFF 		bl	cc2400_set
 4146              	.LVL418:
1046:bluetooth_rxtx.c **** 
 4147              		.loc 1 1046 0
 4148 010e 1420     		movs	r0, #20
 4149 0110 41F24B31 		movw	r1, #4939
 4150 0114 FFF7FEFF 		bl	cc2400_set
 4151              	.LVL419:
1048:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 4152              		.loc 1 1048 0
 4153 0118 2020     		movs	r0, #32
 4154 011a 40F60141 		movw	r1, #3073
 4155 011e FFF7FEFF 		bl	cc2400_set
 4156              	.LVL420:
1056:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 4157              		.loc 1 1056 0
 4158 0122 2146     		mov	r1, r4
 4159 0124 2C20     		movs	r0, #44
 4160 0126 FFF7FEFF 		bl	cc2400_set
ARM GAS  /tmp/cc1G6faT.s 			page 123


 4161              	.LVL421:
1057:bluetooth_rxtx.c **** 
 4162              		.loc 1 1057 0
 4163 012a 2D20     		movs	r0, #45
 4164 012c 0021     		movs	r1, #0
 4165 012e FFF7FEFF 		bl	cc2400_set
 4166              	.LVL422:
1059:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 4167              		.loc 1 1059 0
 4168 0132 4B4B     		ldr	r3, .L509+4
 4169 0134 0220     		movs	r0, #2
 4170 0136 1988     		ldrh	r1, [r3]
1062:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 4171              		.loc 1 1062 0
 4172 0138 4A4C     		ldr	r4, .L509+8
 4173              	.LVL423:
1059:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 4174              		.loc 1 1059 0
 4175 013a 89B2     		uxth	r1, r1
 4176 013c FFF7FEFF 		bl	cc2400_set
 4177              	.LVL424:
1060:bluetooth_rxtx.c **** 
 4178              		.loc 1 1060 0
 4179 0140 0520     		movs	r0, #5
 4180 0142 0B21     		movs	r1, #11
 4181 0144 FFF7FEFF 		bl	cc2400_set
 4182              	.LVL425:
1062:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 4183              		.loc 1 1062 0
 4184 0148 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4185 014a 13B9     		cbnz	r3, .L478
1063:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 4186              		.loc 1 1063 0
 4187 014c 0320     		movs	r0, #3
 4188 014e 2921     		movs	r1, #41
 4189 0150 04E0     		b	.L507
 4190              	.L478:
1064:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 4191              		.loc 1 1064 0
 4192 0152 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4193 0154 012B     		cmp	r3, #1
 4194 0156 1DD1     		bne	.L480
1065:bluetooth_rxtx.c **** 	} else {
 4195              		.loc 1 1065 0
 4196 0158 0320     		movs	r0, #3
 4197 015a 4021     		movs	r1, #64
 4198              	.L507:
 4199 015c FFF7FEFF 		bl	cc2400_set
 4200              	.LVL426:
1071:bluetooth_rxtx.c **** 
 4201              		.loc 1 1071 0
 4202 0160 FFF7FEFF 		bl	clkn_start
 4203              	.LVL427:
 4204              	.L482:
1073:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 4205              		.loc 1 1073 0
 4206 0164 FFF7FEFF 		bl	cc2400_status
ARM GAS  /tmp/cc1G6faT.s 			page 124


 4207              	.LVL428:
 4208 0168 4506     		lsls	r5, r0, #25
 4209 016a FBD5     		bpl	.L482
1074:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 4210              		.loc 1 1074 0
 4211 016c 6120     		movs	r0, #97
 4212 016e FFF7FEFF 		bl	cc2400_strobe
 4213              	.LVL429:
 4214              	.L484:
1075:bluetooth_rxtx.c **** 
 4215              		.loc 1 1075 0
 4216 0172 FFF7FEFF 		bl	cc2400_status
 4217              	.LVL430:
 4218 0176 4007     		lsls	r0, r0, #29
 4219 0178 FBD5     		bpl	.L484
1078:bluetooth_rxtx.c **** #endif
 4220              		.loc 1 1078 0
 4221 017a 3B4B     		ldr	r3, .L509+12
 4222 017c 8022     		movs	r2, #128
 4223 017e 1A60     		str	r2, [r3]
 4224              	.L486:
1081:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 4225              		.loc 1 1081 0
 4226 0180 0E20     		movs	r0, #14
 4227 0182 FFF7FEFF 		bl	cc2400_get
 4228              	.LVL431:
 4229 0186 00F01F00 		and	r0, r0, #31
 4230 018a 0F28     		cmp	r0, #15
 4231 018c F8D1     		bne	.L486
1082:bluetooth_rxtx.c **** 
 4232              		.loc 1 1082 0
 4233 018e 6320     		movs	r0, #99
 4234 0190 FFF7FEFF 		bl	cc2400_strobe
 4235              	.LVL432:
 4236              	.L480:
 4237              	.LBE35:
 4238              	.LBE34:
1470:bluetooth_rxtx.c **** 
 4239              		.loc 1 1470 0 discriminator 3
 4240 0194 1421     		movs	r1, #20
 4241 0196 2320     		movs	r0, #35
 4242 0198 FFF7FEFF 		bl	cc2400_set
 4243              	.LVL433:
1473:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4244              		.loc 1 1473 0 discriminator 3
 4245 019c 0820     		movs	r0, #8
 4246 019e FFF7FEFF 		bl	cc2400_get
 4247              	.LVL434:
1474:bluetooth_rxtx.c **** 
 4248              		.loc 1 1474 0 discriminator 3
 4249 01a2 C0F30801 		ubfx	r1, r0, #0, #9
1473:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4250              		.loc 1 1473 0 discriminator 3
 4251 01a6 0546     		mov	r5, r0
 4252              	.LVL435:
1474:bluetooth_rxtx.c **** 
 4253              		.loc 1 1474 0 discriminator 3
ARM GAS  /tmp/cc1G6faT.s 			page 125


 4254 01a8 41F49C41 		orr	r1, r1, #19968
 4255 01ac 0820     		movs	r0, #8
 4256              	.LVL436:
 4257 01ae FFF7FEFF 		bl	cc2400_set
 4258              	.LVL437:
1444:bluetooth_rxtx.c **** 
 4259              		.loc 1 1444 0 discriminator 3
 4260 01b2 0026     		movs	r6, #0
 4261              	.LVL438:
 4262              	.L487:
1476:bluetooth_rxtx.c **** 	{
 4263              		.loc 1 1476 0 discriminator 1
 4264 01b4 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4265 01b6 022B     		cmp	r3, #2
 4266 01b8 45D1     		bne	.L501
1479:bluetooth_rxtx.c **** 
 4267              		.loc 1 1479 0
 4268 01ba 7608     		lsrs	r6, r6, #1
 4269              	.LVL439:
 4270              	.L489:
1479:bluetooth_rxtx.c **** 
 4271              		.loc 1 1479 0 is_stmt 0 discriminator 1
 4272 01bc 2B4F     		ldr	r7, .L509+16
 4273 01be 3B68     		ldr	r3, [r7]
 4274 01c0 B6EB530F 		cmp	r6, r3, lsr #1
 4275 01c4 05D1     		bne	.L508
 4276              	.L490:
1482:bluetooth_rxtx.c **** 				hop();
 4277              		.loc 1 1482 0 is_stmt 1
 4278 01c6 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4279 01c8 002B     		cmp	r3, #0
 4280 01ca F7D0     		beq	.L489
1483:bluetooth_rxtx.c **** 			}
 4281              		.loc 1 1483 0
 4282 01cc FFF7FEFF 		bl	hop
 4283              	.LVL440:
 4284 01d0 F4E7     		b	.L489
 4285              	.L508:
1479:bluetooth_rxtx.c **** 
 4286              		.loc 1 1479 0 discriminator 2
 4287 01d2 274B     		ldr	r3, .L509+20
 4288 01d4 1A68     		ldr	r2, [r3]
 4289 01d6 40F6C903 		movw	r3, #2249
 4290 01da 9A42     		cmp	r2, r3
 4291 01dc F3D9     		bls	.L490
1489:bluetooth_rxtx.c **** 
 4292              		.loc 1 1489 0
 4293 01de 254B     		ldr	r3, .L509+24
 4294 01e0 4FF48072 		mov	r2, #256
1487:bluetooth_rxtx.c **** 
 4295              		.loc 1 1487 0
 4296 01e4 3E68     		ldr	r6, [r7]
 4297              	.LVL441:
1491:bluetooth_rxtx.c **** 
 4298              		.loc 1 1491 0
 4299 01e6 1020     		movs	r0, #16
1489:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cc1G6faT.s 			page 126


 4300              		.loc 1 1489 0
 4301 01e8 1A60     		str	r2, [r3]
1491:bluetooth_rxtx.c **** 
 4302              		.loc 1 1491 0
 4303 01ea 6946     		mov	r1, sp
 4304 01ec FFF7FEFF 		bl	cc2400_fifo_write
 4305              	.LVL442:
 4306              	.L492:
1493:bluetooth_rxtx.c **** 		TXLED_CLR;
 4307              		.loc 1 1493 0 discriminator 1
 4308 01f0 0E20     		movs	r0, #14
 4309 01f2 FFF7FEFF 		bl	cc2400_get
 4310              	.LVL443:
 4311 01f6 00F01F00 		and	r0, r0, #31
 4312 01fa 0F28     		cmp	r0, #15
 4313 01fc F8D1     		bne	.L492
1494:bluetooth_rxtx.c **** 
 4314              		.loc 1 1494 0
 4315 01fe 1E4B     		ldr	r3, .L509+28
 4316 0200 4FF48072 		mov	r2, #256
 4317 0204 1A60     		str	r2, [r3]
1496:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 4318              		.loc 1 1496 0
 4319 0206 6420     		movs	r0, #100
 4320 0208 FFF7FEFF 		bl	cc2400_strobe
 4321              	.LVL444:
 4322              	.L494:
1497:bluetooth_rxtx.c **** 
 4323              		.loc 1 1497 0 discriminator 1
 4324 020c FFF7FEFF 		bl	cc2400_status
 4325              	.LVL445:
 4326 0210 4107     		lsls	r1, r0, #29
 4327 0212 FBD4     		bmi	.L494
 4328              	.L496:
1499:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 4329              		.loc 1 1499 0
 4330 0214 FFF7FEFF 		bl	cc2400_status
 4331              	.LVL446:
 4332 0218 4206     		lsls	r2, r0, #25
 4333 021a FBD5     		bpl	.L496
1500:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 4334              		.loc 1 1500 0
 4335 021c 6120     		movs	r0, #97
 4336 021e FFF7FEFF 		bl	cc2400_strobe
 4337              	.LVL447:
 4338              	.L498:
1501:bluetooth_rxtx.c **** 
 4339              		.loc 1 1501 0 discriminator 1
 4340 0222 FFF7FEFF 		bl	cc2400_status
 4341              	.LVL448:
 4342 0226 4307     		lsls	r3, r0, #29
 4343 0228 FBD5     		bpl	.L498
 4344              	.L500:
1503:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 4345              		.loc 1 1503 0
 4346 022a 0E20     		movs	r0, #14
 4347 022c FFF7FEFF 		bl	cc2400_get
ARM GAS  /tmp/cc1G6faT.s 			page 127


 4348              	.LVL449:
 4349 0230 00F01F00 		and	r0, r0, #31
 4350 0234 0F28     		cmp	r0, #15
 4351 0236 F8D1     		bne	.L500
1504:bluetooth_rxtx.c **** 
 4352              		.loc 1 1504 0
 4353 0238 6320     		movs	r0, #99
 4354 023a FFF7FEFF 		bl	cc2400_strobe
 4355              	.LVL450:
1506:bluetooth_rxtx.c **** 	}
 4356              		.loc 1 1506 0
 4357 023e 3868     		ldr	r0, [r7]
 4358 0240 FFF7FEFF 		bl	handle_usb
 4359              	.LVL451:
 4360 0244 B6E7     		b	.L487
 4361              	.L501:
1510:bluetooth_rxtx.c **** #endif
 4362              		.loc 1 1510 0
 4363 0246 0D4B     		ldr	r3, .L509+32
 4364 0248 8022     		movs	r2, #128
 4365 024a 1A60     		str	r2, [r3]
1514:bluetooth_rxtx.c **** }
 4366              		.loc 1 1514 0
 4367 024c 0820     		movs	r0, #8
 4368 024e 2946     		mov	r1, r5
 4369 0250 FFF7FEFF 		bl	cc2400_set
 4370              	.LVL452:
1515:bluetooth_rxtx.c **** 
 4371              		.loc 1 1515 0
 4372 0254 04B0     		add	sp, sp, #16
 4373              		@ sp needed
 4374 0256 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 4375              	.LVL453:
 4376              	.L510:
 4377 025a 00BF     		.align	2
 4378              	.L509:
 4379 025c 00000000 		.word	target
 4380 0260 00000000 		.word	.LANCHOR1
 4381 0264 00000000 		.word	.LANCHOR0
 4382 0268 58C00920 		.word	537509976
 4383 026c 00000000 		.word	clkn
 4384 0270 08400040 		.word	1073758216
 4385 0274 38C00920 		.word	537509944
 4386 0278 3CC00920 		.word	537509948
 4387 027c 5CC00920 		.word	537509980
 4388              		.cfi_endproc
 4389              	.LFE17:
 4391              		.section	.text.reset_le,"ax",%progbits
 4392              		.align	1
 4393              		.global	reset_le
 4394              		.thumb
 4395              		.thumb_func
 4397              	reset_le:
 4398              	.LFB19:
1528:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
 4399              		.loc 1 1528 0
 4400              		.cfi_startproc
ARM GAS  /tmp/cc1G6faT.s 			page 128


 4401              		@ args = 0, pretend = 0, frame = 0
 4402              		@ frame_needed = 0, uses_anonymous_args = 0
 4403 0000 08B5     		push	{r3, lr}
 4404              		.cfi_def_cfa_offset 8
 4405              		.cfi_offset 3, -8
 4406              		.cfi_offset 14, -4
1529:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
 4407              		.loc 1 1529 0
 4408 0002 0F48     		ldr	r0, .L512
 4409 0004 FFF7FEFF 		bl	le_set_access_address
 4410              	.LVL454:
1530:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
 4411              		.loc 1 1530 0
 4412 0008 0E4B     		ldr	r3, .L512+4
 4413 000a 0F4A     		ldr	r2, .L512+8
 4414 000c DA60     		str	r2, [r3, #12]
1531:bluetooth_rxtx.c **** 	le.crc_verify = 0;
 4415              		.loc 1 1531 0
 4416 000e 0F4A     		ldr	r2, .L512+12
 4417 0010 1A61     		str	r2, [r3, #16]
1532:bluetooth_rxtx.c **** 	le.last_packet = 0;
 4418              		.loc 1 1532 0
 4419 0012 0022     		movs	r2, #0
1541:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 4420              		.loc 1 1541 0
 4421 0014 1A84     		strh	r2, [r3, #32]	@ movhi
1532:bluetooth_rxtx.c **** 	le.last_packet = 0;
 4422              		.loc 1 1532 0
 4423 0016 5A61     		str	r2, [r3, #20]
1544:bluetooth_rxtx.c **** 
 4424              		.loc 1 1544 0
 4425 0018 9A84     		strh	r2, [r3, #36]	@ movhi
1533:bluetooth_rxtx.c **** 
 4426              		.loc 1 1533 0
 4427 001a 5A64     		str	r2, [r3, #68]
1535:bluetooth_rxtx.c **** 
 4428              		.loc 1 1535 0
 4429 001c 1A76     		strb	r2, [r3, #24]
1537:bluetooth_rxtx.c **** 	le.channel_increment = 0;
 4430              		.loc 1 1537 0
 4431 001e 5A76     		strb	r2, [r3, #25]
1538:bluetooth_rxtx.c **** 
 4432              		.loc 1 1538 0
 4433 0020 9A76     		strb	r2, [r3, #26]
1540:bluetooth_rxtx.c **** 	le.interval_timer = 0;
 4434              		.loc 1 1540 0
 4435 0022 DA61     		str	r2, [r3, #28]
1542:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 4436              		.loc 1 1542 0
 4437 0024 5A84     		strh	r2, [r3, #34]	@ movhi
1546:bluetooth_rxtx.c **** 	le.win_offset = 0;
 4438              		.loc 1 1546 0
 4439 0026 83F82620 		strb	r2, [r3, #38]
1547:bluetooth_rxtx.c **** 
 4440              		.loc 1 1547 0
 4441 002a 1A85     		strh	r2, [r3, #40]	@ movhi
1549:bluetooth_rxtx.c **** 	le.update_instant = 0;
ARM GAS  /tmp/cc1G6faT.s 			page 129


 4442              		.loc 1 1549 0
 4443 002c DA62     		str	r2, [r3, #44]
1550:bluetooth_rxtx.c **** 	le.interval_update = 0;
 4444              		.loc 1 1550 0
 4445 002e 1A86     		strh	r2, [r3, #48]	@ movhi
1551:bluetooth_rxtx.c **** 	le.win_size_update = 0;
 4446              		.loc 1 1551 0
 4447 0030 5A86     		strh	r2, [r3, #50]	@ movhi
1552:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
 4448              		.loc 1 1552 0
 4449 0032 83F83420 		strb	r2, [r3, #52]
1553:bluetooth_rxtx.c **** 
 4450              		.loc 1 1553 0
 4451 0036 DA86     		strh	r2, [r3, #54]	@ movhi
1555:bluetooth_rxtx.c **** }
 4452              		.loc 1 1555 0
 4453 0038 054B     		ldr	r3, .L512+16
 4454 003a DA72     		strb	r2, [r3, #11]
 4455 003c 08BD     		pop	{r3, pc}
 4456              	.L513:
 4457 003e 00BF     		.align	2
 4458              	.L512:
 4459 0040 D6BE898E 		.word	-1903575338
 4460 0044 00000000 		.word	.LANCHOR1
 4461 0048 55555500 		.word	5592405
 4462 004c AAAAAA00 		.word	11184810
 4463 0050 00000000 		.word	.LANCHOR0
 4464              		.cfi_endproc
 4465              	.LFE19:
 4467              		.section	.text.reset_le_promisc,"ax",%progbits
 4468              		.align	1
 4469              		.global	reset_le_promisc
 4470              		.thumb
 4471              		.thumb_func
 4473              	reset_le_promisc:
 4474              	.LFB20:
1559:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
 4475              		.loc 1 1559 0
 4476              		.cfi_startproc
 4477              		@ args = 0, pretend = 0, frame = 0
 4478              		@ frame_needed = 0, uses_anonymous_args = 0
 4479 0000 10B5     		push	{r4, lr}
 4480              		.cfi_def_cfa_offset 8
 4481              		.cfi_offset 4, -8
 4482              		.cfi_offset 14, -4
1560:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
 4483              		.loc 1 1560 0
 4484 0002 064C     		ldr	r4, .L515
 4485 0004 0021     		movs	r1, #0
 4486 0006 2046     		mov	r0, r4
 4487 0008 4FF48472 		mov	r2, #264
 4488 000c FFF7FEFF 		bl	memset
 4489              	.LVL455:
1561:bluetooth_rxtx.c **** }
 4490              		.loc 1 1561 0
 4491 0010 4FF0FF33 		mov	r3, #-1
 4492 0014 C4F80031 		str	r3, [r4, #256]
ARM GAS  /tmp/cc1G6faT.s 			page 130


 4493 0018 10BD     		pop	{r4, pc}
 4494              	.L516:
 4495 001a 00BF     		.align	2
 4496              	.L515:
 4497 001c 00000000 		.word	le_promisc
 4498              		.cfi_endproc
 4499              	.LFE20:
 4501              		.section	.text.bt_generic_le,"ax",%progbits
 4502              		.align	1
 4503              		.global	bt_generic_le
 4504              		.thumb
 4505              		.thumb_func
 4507              	bt_generic_le:
 4508              	.LFB21:
1566:bluetooth_rxtx.c **** 	u8 hold;
 4509              		.loc 1 1566 0
 4510              		.cfi_startproc
 4511              		@ args = 0, pretend = 0, frame = 0
 4512              		@ frame_needed = 0, uses_anonymous_args = 0
 4513              	.LVL456:
 4514 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 4515              		.cfi_def_cfa_offset 32
 4516              		.cfi_offset 3, -32
 4517              		.cfi_offset 4, -28
 4518              		.cfi_offset 5, -24
 4519              		.cfi_offset 6, -20
 4520              		.cfi_offset 7, -16
 4521              		.cfi_offset 8, -12
 4522              		.cfi_offset 9, -8
 4523              		.cfi_offset 14, -4
1571:bluetooth_rxtx.c **** 	mode = active_mode;
 4524              		.loc 1 1571 0
 4525 0004 694C     		ldr	r4, .L562
 4526 0006 0123     		movs	r3, #1
1566:bluetooth_rxtx.c **** 	u8 hold;
 4527              		.loc 1 1566 0
 4528 0008 8046     		mov	r8, r0
1571:bluetooth_rxtx.c **** 	mode = active_mode;
 4529              		.loc 1 1571 0
 4530 000a 2370     		strb	r3, [r4]
1572:bluetooth_rxtx.c **** 
 4531              		.loc 1 1572 0
 4532 000c 6074     		strb	r0, [r4, #17]
1574:bluetooth_rxtx.c **** 
 4533              		.loc 1 1574 0
 4534 000e FFF7FEFF 		bl	reset_le
 4535              	.LVL457:
1577:bluetooth_rxtx.c **** 
 4536              		.loc 1 1577 0
 4537 0012 674B     		ldr	r3, .L562+4
 4538 0014 4FF08072 		mov	r2, #16777216
 4539 0018 1A60     		str	r2, [r3]
1579:bluetooth_rxtx.c **** 
 4540              		.loc 1 1579 0
 4541 001a 664B     		ldr	r3, .L562+8
 4542 001c 1022     		movs	r2, #16
 4543 001e 1A60     		str	r2, [r3]
ARM GAS  /tmp/cc1G6faT.s 			page 131


1581:bluetooth_rxtx.c **** 	dio_ssp_init();
 4544              		.loc 1 1581 0
 4545 0020 FFF7FEFF 		bl	queue_init
 4546              	.LVL458:
1582:bluetooth_rxtx.c **** 	dma_init();
 4547              		.loc 1 1582 0
 4548 0024 FFF7FEFF 		bl	dio_ssp_init
 4549              	.LVL459:
1583:bluetooth_rxtx.c **** 	dio_ssp_start();
 4550              		.loc 1 1583 0
 4551 0028 FFF7FEFF 		bl	dma_init
 4552              	.LVL460:
1584:bluetooth_rxtx.c **** 	cc2400_rx();
 4553              		.loc 1 1584 0
 4554 002c FFF7FEFF 		bl	dio_ssp_start
 4555              	.LVL461:
1585:bluetooth_rxtx.c **** 
 4556              		.loc 1 1585 0
 4557 0030 FFF7FEFF 		bl	cc2400_rx
 4558              	.LVL462:
1587:bluetooth_rxtx.c **** 
 4559              		.loc 1 1587 0
 4560 0034 FFF7FEFF 		bl	cs_trigger_enable
 4561              	.LVL463:
1589:bluetooth_rxtx.c **** 
 4562              		.loc 1 1589 0
 4563 0038 0025     		movs	r5, #0
 4564              	.LVL464:
 4565              	.L518:
1591:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 4566              		.loc 1 1591 0 discriminator 1
 4567 003a A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4568 003c 4345     		cmp	r3, r8
 4569 003e 40F0A380 		bne	.L542
 4570              	.LBB36:
1592:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 4571              		.loc 1 1592 0
 4572 0042 5A4B     		ldr	r3, .L562
 4573 0044 DB89     		ldrh	r3, [r3, #14]
 4574 0046 9BB2     		uxth	r3, r3
 4575 0048 D3B1     		cbz	r3, .L519
1593:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 4576              		.loc 1 1593 0
 4577 004a 6420     		movs	r0, #100
 4578 004c FFF7FEFF 		bl	cc2400_strobe
 4579              	.LVL465:
 4580              	.L521:
1594:bluetooth_rxtx.c **** 
 4581              		.loc 1 1594 0 discriminator 1
 4582 0050 FFF7FEFF 		bl	cc2400_status
 4583              	.LVL466:
 4584 0054 4707     		lsls	r7, r0, #29
 4585 0056 FBD4     		bmi	.L521
1597:bluetooth_rxtx.c **** 
 4586              		.loc 1 1597 0
 4587 0058 574B     		ldr	r3, .L562+12
 4588 005a 0220     		movs	r0, #2
ARM GAS  /tmp/cc1G6faT.s 			page 132


 4589 005c 1988     		ldrh	r1, [r3]
 4590 005e 89B2     		uxth	r1, r1
 4591 0060 0139     		subs	r1, r1, #1
 4592 0062 89B2     		uxth	r1, r1
 4593 0064 FFF7FEFF 		bl	cc2400_set
 4594              	.LVL467:
1600:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 4595              		.loc 1 1600 0
 4596 0068 6120     		movs	r0, #97
 4597 006a FFF7FEFF 		bl	cc2400_strobe
 4598              	.LVL468:
 4599              	.L523:
1601:bluetooth_rxtx.c **** 
 4600              		.loc 1 1601 0 discriminator 1
 4601 006e FFF7FEFF 		bl	cc2400_status
 4602              	.LVL469:
 4603 0072 4607     		lsls	r6, r0, #29
 4604 0074 FBD5     		bpl	.L523
1604:bluetooth_rxtx.c **** 
 4605              		.loc 1 1604 0
 4606 0076 6220     		movs	r0, #98
 4607 0078 FFF7FEFF 		bl	cc2400_strobe
 4608              	.LVL470:
1606:bluetooth_rxtx.c **** 		}
 4609              		.loc 1 1606 0
 4610 007c 0023     		movs	r3, #0
 4611 007e E381     		strh	r3, [r4, #14]	@ movhi
 4612              	.L519:
1609:bluetooth_rxtx.c **** 			hop();
 4613              		.loc 1 1609 0
 4614 0080 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4615 0082 4C4E     		ldr	r6, .L562+8
 4616 0084 13B1     		cbz	r3, .L524
1610:bluetooth_rxtx.c **** 		} else {
 4617              		.loc 1 1610 0
 4618 0086 FFF7FEFF 		bl	hop
 4619              	.LVL471:
 4620 008a 02E0     		b	.L525
 4621              	.L524:
1612:bluetooth_rxtx.c **** 		}
 4622              		.loc 1 1612 0
 4623 008c 4FF48073 		mov	r3, #256
 4624 0090 3360     		str	r3, [r6]
 4625              	.L525:
1615:bluetooth_rxtx.c **** 
 4626              		.loc 1 1615 0
 4627 0092 1023     		movs	r3, #16
 4628 0094 3360     		str	r3, [r6]
1618:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 4629              		.loc 1 1618 0
 4630 0096 FFF7FEFF 		bl	rssi_reset
 4631              	.LVL472:
1619:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
 4632              		.loc 1 1619 0
 4633 009a 8027     		movs	r7, #128
 4634              	.LVL473:
 4635              	.L526:
ARM GAS  /tmp/cc1G6faT.s 			page 133


1620:bluetooth_rxtx.c **** 		{
 4636              		.loc 1 1620 0 discriminator 1
 4637 009c 474B     		ldr	r3, .L562+16
 4638 009e 484E     		ldr	r6, .L562+20
 4639 00a0 1A68     		ldr	r2, [r3]
 4640 00a2 9946     		mov	r9, r3
 4641 00a4 D2B9     		cbnz	r2, .L528
1620:bluetooth_rxtx.c **** 		{
 4642              		.loc 1 1620 0 is_stmt 0 discriminator 2
 4643 00a6 3368     		ldr	r3, [r6]
 4644 00a8 C3B9     		cbnz	r3, .L528
1622:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4645              		.loc 1 1622 0 is_stmt 1
 4646 00aa 0620     		movs	r0, #6
 4647 00ac FFF7FEFF 		bl	cc2400_get
 4648              	.LVL474:
1623:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4649              		.loc 1 1623 0
 4650 00b0 444B     		ldr	r3, .L562+24
1622:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4651              		.loc 1 1622 0
 4652 00b2 C0F30720 		ubfx	r0, r0, #8, #8
 4653              	.LVL475:
1623:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4654              		.loc 1 1623 0
 4655 00b6 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 4656 00b8 63B1     		cbz	r3, .L527
1623:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4657              		.loc 1 1623 0 is_stmt 0 discriminator 1
 4658 00ba 7BB2     		sxtb	r3, r7
 4659 00bc 8033     		adds	r3, r3, #128
 4660 00be 09D1     		bne	.L527
1624:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 4661              		.loc 1 1624 0 is_stmt 1
 4662 00c0 414B     		ldr	r3, .L562+28
 4663 00c2 40B2     		sxtb	r0, r0
 4664              	.LVL476:
 4665 00c4 93F90070 		ldrsb	r7, [r3]
 4666              	.LVL477:
 4667 00c8 3637     		adds	r7, r7, #54
 4668 00ca B842     		cmp	r0, r7
 4669 00cc A8BF     		it	ge
 4670 00ce 0746     		movge	r7, r0
 4671 00d0 FFB2     		uxtb	r7, r7
1625:bluetooth_rxtx.c **** 			}
 4672              		.loc 1 1625 0
 4673 00d2 3846     		mov	r0, r7
 4674              	.L527:
 4675              	.LVL478:
1627:bluetooth_rxtx.c **** 		}
 4676              		.loc 1 1627 0
 4677 00d4 40B2     		sxtb	r0, r0
 4678              	.LVL479:
 4679 00d6 FFF7FEFF 		bl	rssi_add
 4680              	.LVL480:
 4681 00da DFE7     		b	.L526
 4682              	.L528:
ARM GAS  /tmp/cc1G6faT.s 			page 134


1630:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 4683              		.loc 1 1630 0
 4684 00dc 3368     		ldr	r3, [r6]
 4685 00de 1BB1     		cbz	r3, .L530
1631:bluetooth_rxtx.c **** 		}
 4686              		.loc 1 1631 0
 4687 00e0 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4688 00e2 43F00203 		orr	r3, r3, #2
 4689 00e6 6370     		strb	r3, [r4, #1]
 4690              	.L530:
1635:bluetooth_rxtx.c **** 			goto rx_continue;
 4691              		.loc 1 1635 0
 4692 00e8 D9F80030 		ldr	r3, [r9]
 4693 00ec 002B     		cmp	r3, #0
 4694 00ee 57D0     		beq	.L531
1639:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 4695              		.loc 1 1639 0
 4696 00f0 324B     		ldr	r3, .L562+16
 4697 00f2 1B68     		ldr	r3, [r3]
 4698 00f4 012B     		cmp	r3, #1
 4699 00f6 03D9     		bls	.L532
1640:bluetooth_rxtx.c **** 
 4700              		.loc 1 1640 0
 4701 00f8 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4702 00fa 43F00103 		orr	r3, r3, #1
 4703 00fe 6370     		strb	r3, [r4, #1]
 4704              	.L532:
1642:bluetooth_rxtx.c **** 
 4705              		.loc 1 1642 0
 4706 0100 2D4B     		ldr	r3, .L562+12
 4707 0102 1888     		ldrh	r0, [r3]
 4708 0104 80B2     		uxth	r0, r0
 4709 0106 FFF7FEFF 		bl	rssi_iir_update
 4710              	.LVL481:
1648:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4711              		.loc 1 1648 0
 4712 010a 2E4B     		ldr	r3, .L562+24
 4713 010c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 4714 010e 12B9     		cbnz	r2, .L533
1648:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4715              		.loc 1 1648 0 is_stmt 0 discriminator 1
 4716 0110 2E4A     		ldr	r2, .L562+32
 4717 0112 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 4718 0114 32B1     		cbz	r2, .L534
 4719              	.L533:
1649:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4720              		.loc 1 1649 0 is_stmt 1
 4721 0116 6278     		ldrb	r2, [r4, #1]	@ zero_extendqisi2
1650:bluetooth_rxtx.c **** 			cs_trigger = 0;
 4722              		.loc 1 1650 0
 4723 0118 0225     		movs	r5, #2
 4724              	.LVL482:
1649:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4725              		.loc 1 1649 0
 4726 011a 42F00802 		orr	r2, r2, #8
 4727 011e 6270     		strb	r2, [r4, #1]
 4728              	.LVL483:
ARM GAS  /tmp/cc1G6faT.s 			page 135


1651:bluetooth_rxtx.c **** 		}
 4729              		.loc 1 1651 0
 4730 0120 0022     		movs	r2, #0
 4731 0122 1A70     		strb	r2, [r3]
 4732              	.LVL484:
 4733              	.L534:
1654:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 4734              		.loc 1 1654 0
 4735 0124 284B     		ldr	r3, .L562+28
 4736 0126 93F90020 		ldrsb	r2, [r3]
 4737 012a 294B     		ldr	r3, .L562+36
 4738 012c 3532     		adds	r2, r2, #53
 4739 012e 93F90030 		ldrsb	r3, [r3]
 4740 0132 9A42     		cmp	r2, r3
 4741 0134 05DA     		bge	.L535
1655:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4742              		.loc 1 1655 0
 4743 0136 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
1656:bluetooth_rxtx.c **** 		}
 4744              		.loc 1 1656 0
 4745 0138 0225     		movs	r5, #2
 4746              	.LVL485:
1655:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4747              		.loc 1 1655 0
 4748 013a 43F01003 		orr	r3, r3, #16
 4749 013e 6370     		strb	r3, [r4, #1]
 4750              	.LVL486:
 4751 0140 00E0     		b	.L536
 4752              	.LVL487:
 4753              	.L535:
1660:bluetooth_rxtx.c **** 			goto rx_continue;
 4754              		.loc 1 1660 0
 4755 0142 6DB3     		cbz	r5, .L531
 4756              	.LVL488:
 4757              	.L536:
1666:bluetooth_rxtx.c **** 
 4758              		.loc 1 1666 0
 4759 0144 2348     		ldr	r0, .L562+40
1663:bluetooth_rxtx.c **** 
 4760              		.loc 1 1663 0
 4761 0146 013D     		subs	r5, r5, #1
 4762              	.LVL489:
1666:bluetooth_rxtx.c **** 
 4763              		.loc 1 1666 0
 4764 0148 00F5C871 		add	r1, r0, #400
 4765 014c 4FF4C872 		mov	r2, #400
 4766 0150 FFF7FEFF 		bl	memcpy
 4767              	.LVL490:
1663:bluetooth_rxtx.c **** 
 4768              		.loc 1 1663 0
 4769 0154 EDB2     		uxtb	r5, r5
 4770              	.LVL491:
1669:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 4771              		.loc 1 1669 0
 4772 0156 0023     		movs	r3, #0
 4773              	.LVL492:
 4774              	.L537:
ARM GAS  /tmp/cc1G6faT.s 			page 136


 4775 0158 1F48     		ldr	r0, .L562+44
1656:bluetooth_rxtx.c **** 		}
 4776              		.loc 1 1656 0 discriminator 1
 4777 015a 0022     		movs	r2, #0
 4778 015c 00EBC300 		add	r0, r0, r3, lsl #3
 4779              	.LVL493:
 4780              	.L540:
1672:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4781              		.loc 1 1672 0 discriminator 2
 4782 0160 1E49     		ldr	r1, .L562+48
 4783 0162 0F68     		ldr	r7, [r1]
 4784 0164 FF5C     		ldrb	r7, [r7, r3]	@ zero_extendqisi2
1673:bluetooth_rxtx.c **** 			}
 4785              		.loc 1 1673 0 discriminator 2
 4786 0166 0968     		ldr	r1, [r1]
1672:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4787              		.loc 1 1672 0 discriminator 2
 4788 0168 FF09     		lsrs	r7, r7, #7
 4789 016a 8754     		strb	r7, [r0, r2]
1673:bluetooth_rxtx.c **** 			}
 4790              		.loc 1 1673 0 discriminator 2
 4791 016c CF5C     		ldrb	r7, [r1, r3]	@ zero_extendqisi2
1671:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4792              		.loc 1 1671 0 discriminator 2
 4793 016e 0132     		adds	r2, r2, #1
 4794              	.LVL494:
1673:bluetooth_rxtx.c **** 			}
 4795              		.loc 1 1673 0 discriminator 2
 4796 0170 7F00     		lsls	r7, r7, #1
 4797 0172 FFB2     		uxtb	r7, r7
1671:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4798              		.loc 1 1671 0 discriminator 2
 4799 0174 082A     		cmp	r2, #8
1673:bluetooth_rxtx.c **** 			}
 4800              		.loc 1 1673 0 discriminator 2
 4801 0176 CF54     		strb	r7, [r1, r3]
1671:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4802              		.loc 1 1671 0 discriminator 2
 4803 0178 F2D1     		bne	.L540
1669:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 4804              		.loc 1 1669 0
 4805 017a 0133     		adds	r3, r3, #1
 4806              	.LVL495:
 4807 017c 322B     		cmp	r3, #50
 4808 017e EBD1     		bne	.L537
1677:bluetooth_rxtx.c **** 		if (!ret) break;
 4809              		.loc 1 1677 0
 4810 0180 E36A     		ldr	r3, [r4, #44]
 4811              	.LVL496:
 4812 0182 1448     		ldr	r0, .L562+40
 4813 0184 9847     		blx	r3
 4814              	.LVL497:
1678:bluetooth_rxtx.c **** 
 4815              		.loc 1 1678 0
 4816 0186 58B9     		cbnz	r0, .L531
 4817              	.LVL498:
 4818              	.L542:
ARM GAS  /tmp/cc1G6faT.s 			page 137


 4819              	.LBE36:
1686:bluetooth_rxtx.c **** 
 4820              		.loc 1 1686 0
 4821 0188 154B     		ldr	r3, .L562+52
 4822 018a 4FF08072 		mov	r2, #16777216
 4823 018e 1A60     		str	r2, [r3]
1689:bluetooth_rxtx.c **** 	dio_ssp_stop();
 4824              		.loc 1 1689 0
 4825 0190 FFF7FEFF 		bl	cc2400_idle
 4826              	.LVL499:
1690:bluetooth_rxtx.c **** 	cs_trigger_disable();
 4827              		.loc 1 1690 0
 4828 0194 FFF7FEFF 		bl	dio_ssp_stop
 4829              	.LVL500:
1692:bluetooth_rxtx.c **** 
 4830              		.loc 1 1692 0
 4831 0198 BDE8F843 		pop	{r3, r4, r5, r6, r7, r8, r9, lr}
1691:bluetooth_rxtx.c **** }
 4832              		.loc 1 1691 0
 4833 019c FFF7FEBF 		b	cs_trigger_disable
 4834              	.LVL501:
 4835              	.L531:
 4836              	.LBB37:
1681:bluetooth_rxtx.c **** 		rx_err = 0;
 4837              		.loc 1 1681 0
 4838 01a0 0023     		movs	r3, #0
 4839 01a2 C9F80030 		str	r3, [r9]
1682:bluetooth_rxtx.c **** 	}
 4840              		.loc 1 1682 0
 4841 01a6 3360     		str	r3, [r6]
 4842 01a8 47E7     		b	.L518
 4843              	.L563:
 4844 01aa 00BF     		.align	2
 4845              	.L562:
 4846 01ac 00000000 		.word	.LANCHOR0
 4847 01b0 00E100E0 		.word	-536813312
 4848 01b4 3CC00920 		.word	537509948
 4849 01b8 00000000 		.word	.LANCHOR1
 4850 01bc 00000000 		.word	rx_tc
 4851 01c0 00000000 		.word	rx_err
 4852 01c4 00000000 		.word	cs_trigger
 4853 01c8 00000000 		.word	cs_threshold_cur
 4854 01cc 00000000 		.word	cs_no_squelch
 4855 01d0 00000000 		.word	rssi_max
 4856 01d4 00000000 		.word	unpacked
 4857 01d8 90010000 		.word	unpacked+400
 4858 01dc 00000000 		.word	idle_rxbuf
 4859 01e0 80E100E0 		.word	-536813184
 4860              	.LBE37:
 4861              		.cfi_endproc
 4862              	.LFE21:
 4864              		.section	.text.bt_le_sync,"ax",%progbits
 4865              		.align	1
 4866              		.global	bt_le_sync
 4867              		.thumb
 4868              		.thumb_func
 4870              	bt_le_sync:
ARM GAS  /tmp/cc1G6faT.s 			page 138


 4871              	.LFB22:
1696:bluetooth_rxtx.c **** 	int i;
 4872              		.loc 1 1696 0
 4873              		.cfi_startproc
 4874              		@ args = 0, pretend = 0, frame = 64
 4875              		@ frame_needed = 0, uses_anonymous_args = 0
 4876              	.LVL502:
 4877 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 4878              		.cfi_def_cfa_offset 36
 4879              		.cfi_offset 4, -36
 4880              		.cfi_offset 5, -32
 4881              		.cfi_offset 6, -28
 4882              		.cfi_offset 7, -24
 4883              		.cfi_offset 8, -20
 4884              		.cfi_offset 9, -16
 4885              		.cfi_offset 10, -12
 4886              		.cfi_offset 11, -8
 4887              		.cfi_offset 14, -4
 4888 0004 91B0     		sub	sp, sp, #68
 4889              		.cfi_def_cfa_offset 104
1701:bluetooth_rxtx.c **** 	mode = active_mode;
 4890              		.loc 1 1701 0
 4891 0006 AF4D     		ldr	r5, .L627
1704:bluetooth_rxtx.c **** 
 4892              		.loc 1 1704 0
 4893 0008 AF4C     		ldr	r4, .L627+4
1701:bluetooth_rxtx.c **** 	mode = active_mode;
 4894              		.loc 1 1701 0
 4895 000a 0123     		movs	r3, #1
 4896 000c 2B70     		strb	r3, [r5]
1704:bluetooth_rxtx.c **** 
 4897              		.loc 1 1704 0
 4898 000e 2376     		strb	r3, [r4, #24]
1707:bluetooth_rxtx.c **** 
 4899              		.loc 1 1707 0
 4900 0010 AE4B     		ldr	r3, .L627+8
 4901 0012 4FF08072 		mov	r2, #16777216
1702:bluetooth_rxtx.c **** 
 4902              		.loc 1 1702 0
 4903 0016 6874     		strb	r0, [r5, #17]
1707:bluetooth_rxtx.c **** 
 4904              		.loc 1 1707 0
 4905 0018 1A60     		str	r2, [r3]
1709:bluetooth_rxtx.c **** 
 4906              		.loc 1 1709 0
 4907 001a AD4B     		ldr	r3, .L627+12
 4908 001c 1022     		movs	r2, #16
 4909 001e 1A60     		str	r2, [r3]
1696:bluetooth_rxtx.c **** 	int i;
 4910              		.loc 1 1696 0
 4911 0020 0646     		mov	r6, r0
1711:bluetooth_rxtx.c **** 	dio_ssp_init();
 4912              		.loc 1 1711 0
 4913 0022 FFF7FEFF 		bl	queue_init
 4914              	.LVL503:
1712:bluetooth_rxtx.c **** 	dma_init_le();
 4915              		.loc 1 1712 0
ARM GAS  /tmp/cc1G6faT.s 			page 139


 4916 0026 FFF7FEFF 		bl	dio_ssp_init
 4917              	.LVL504:
1713:bluetooth_rxtx.c **** 	dio_ssp_start();
 4918              		.loc 1 1713 0
 4919 002a FFF7FEFF 		bl	dma_init_le
 4920              	.LVL505:
1714:bluetooth_rxtx.c **** 
 4921              		.loc 1 1714 0
 4922 002e FFF7FEFF 		bl	dio_ssp_start
 4923              	.LVL506:
1716:bluetooth_rxtx.c **** 
 4924              		.loc 1 1716 0
 4925 0032 6068     		ldr	r0, [r4, #4]
 4926 0034 FFF7FEFF 		bl	rbit
 4927              	.LVL507:
 4928 0038 FFF7FEFF 		bl	cc2400_rx_sync
 4929              	.LVL508:
 4930              	.L565:
1718:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 4931              		.loc 1 1718 0 discriminator 1
 4932 003c AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
 4933 003e B342     		cmp	r3, r6
 4934 0040 40F0B681 		bne	.L605
 4935              	.LBB38:
1719:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 4936              		.loc 1 1719 0
 4937 0044 9F4B     		ldr	r3, .L627
 4938 0046 DB89     		ldrh	r3, [r3, #14]
 4939 0048 9BB2     		uxth	r3, r3
 4940 004a CBB1     		cbz	r3, .L566
1720:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 4941              		.loc 1 1720 0
 4942 004c 6420     		movs	r0, #100
 4943 004e FFF7FEFF 		bl	cc2400_strobe
 4944              	.LVL509:
 4945              	.L568:
1721:bluetooth_rxtx.c **** 
 4946              		.loc 1 1721 0 discriminator 1
 4947 0052 FFF7FEFF 		bl	cc2400_status
 4948              	.LVL510:
 4949 0056 4307     		lsls	r3, r0, #29
 4950 0058 FBD4     		bmi	.L568
1724:bluetooth_rxtx.c **** 
 4951              		.loc 1 1724 0
 4952 005a 2188     		ldrh	r1, [r4]
 4953 005c 0220     		movs	r0, #2
 4954 005e 89B2     		uxth	r1, r1
 4955 0060 0139     		subs	r1, r1, #1
 4956 0062 89B2     		uxth	r1, r1
 4957 0064 FFF7FEFF 		bl	cc2400_set
 4958              	.LVL511:
1727:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 4959              		.loc 1 1727 0
 4960 0068 6120     		movs	r0, #97
 4961 006a FFF7FEFF 		bl	cc2400_strobe
 4962              	.LVL512:
 4963              	.L570:
ARM GAS  /tmp/cc1G6faT.s 			page 140


1728:bluetooth_rxtx.c **** 
 4964              		.loc 1 1728 0 discriminator 1
 4965 006e FFF7FEFF 		bl	cc2400_status
 4966              	.LVL513:
 4967 0072 4707     		lsls	r7, r0, #29
 4968 0074 FBD5     		bpl	.L570
1731:bluetooth_rxtx.c **** 
 4969              		.loc 1 1731 0
 4970 0076 6220     		movs	r0, #98
 4971 0078 FFF7FEFF 		bl	cc2400_strobe
 4972              	.LVL514:
1733:bluetooth_rxtx.c **** 		}
 4973              		.loc 1 1733 0
 4974 007c 0023     		movs	r3, #0
 4975 007e EB81     		strh	r3, [r5, #14]	@ movhi
 4976              	.L566:
1736:bluetooth_rxtx.c **** 
 4977              		.loc 1 1736 0
 4978 0080 934B     		ldr	r3, .L627+12
 4979 0082 1022     		movs	r2, #16
 4980 0084 1A60     		str	r2, [r3]
1739:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)
 4981              		.loc 1 1739 0
 4982 0086 FFF7FEFF 		bl	rssi_reset
 4983              	.LVL515:
 4984              	.L572:
1740:bluetooth_rxtx.c **** 			;
 4985              		.loc 1 1740 0 discriminator 1
 4986 008a 924B     		ldr	r3, .L627+16
 4987 008c 1A68     		ldr	r2, [r3]
 4988 008e 9946     		mov	r9, r3
 4989 0090 42B9     		cbnz	r2, .L571
1740:bluetooth_rxtx.c **** 			;
 4990              		.loc 1 1740 0 is_stmt 0 discriminator 2
 4991 0092 914B     		ldr	r3, .L627+20
 4992 0094 1B68     		ldr	r3, [r3]
 4993 0096 2BB9     		cbnz	r3, .L571
1740:bluetooth_rxtx.c **** 			;
 4994              		.loc 1 1740 0 discriminator 1
 4995 0098 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 4996 009a 1BB9     		cbnz	r3, .L571
 4997 009c 894B     		ldr	r3, .L627
 4998 009e 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 4999 00a0 B342     		cmp	r3, r6
 5000 00a2 F2D0     		beq	.L572
 5001              	.L571:
1743:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 5002              		.loc 1 1743 0 is_stmt 1
 5003 00a4 0620     		movs	r0, #6
 5004 00a6 FFF7FEFF 		bl	cc2400_get
 5005              	.LVL516:
1744:bluetooth_rxtx.c **** 
 5006              		.loc 1 1744 0
 5007 00aa 8C4B     		ldr	r3, .L627+24
1743:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 5008              		.loc 1 1743 0
 5009 00ac C0F30720 		ubfx	r0, r0, #8, #8
ARM GAS  /tmp/cc1G6faT.s 			page 141


 5010              	.LVL517:
1746:bluetooth_rxtx.c **** 			goto cleanup;
 5011              		.loc 1 1746 0
 5012 00b0 AA7C     		ldrb	r2, [r5, #18]	@ zero_extendqisi2
1744:bluetooth_rxtx.c **** 
 5013              		.loc 1 1744 0
 5014 00b2 1870     		strb	r0, [r3]
 5015 00b4 8A4B     		ldr	r3, .L627+28
1746:bluetooth_rxtx.c **** 			goto cleanup;
 5016              		.loc 1 1746 0
 5017 00b6 B242     		cmp	r2, r6
1744:bluetooth_rxtx.c **** 
 5018              		.loc 1 1744 0
 5019 00b8 1870     		strb	r0, [r3]
1746:bluetooth_rxtx.c **** 			goto cleanup;
 5020              		.loc 1 1746 0
 5021 00ba 824B     		ldr	r3, .L627
 5022 00bc 40F07881 		bne	.L605
1750:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 5023              		.loc 1 1750 0
 5024 00c0 854F     		ldr	r7, .L627+20
 5025 00c2 3A68     		ldr	r2, [r7]
 5026 00c4 BB46     		mov	fp, r7
 5027 00c6 1AB1     		cbz	r2, .L574
1751:bluetooth_rxtx.c **** 		}
 5028              		.loc 1 1751 0
 5029 00c8 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 5030 00ca 42F00202 		orr	r2, r2, #2
 5031 00ce 5A70     		strb	r2, [r3, #1]
 5032              	.L574:
1754:bluetooth_rxtx.c **** 			goto rx_flush;
 5033              		.loc 1 1754 0
 5034 00d0 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 5035 00d2 03F0FF01 		and	r1, r3, #255
 5036 00d6 002B     		cmp	r3, #0
 5037 00d8 40F0B780 		bne	.L576
1758:bluetooth_rxtx.c **** 			continue;
 5038              		.loc 1 1758 0
 5039 00dc D9F80030 		ldr	r3, [r9]
 5040 00e0 002B     		cmp	r3, #0
 5041 00e2 ABD0     		beq	.L565
1764:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
 5042              		.loc 1 1764 0
 5043 00e4 3422     		movs	r2, #52
 5044 00e6 03A8     		add	r0, sp, #12
 5045              	.LVL518:
 5046 00e8 FFF7FEFF 		bl	memset
 5047              	.LVL519:
1768:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5048              		.loc 1 1768 0
 5049 00ec 2088     		ldrh	r0, [r4]
1766:bluetooth_rxtx.c **** 
 5050              		.loc 1 1766 0
 5051 00ee 6368     		ldr	r3, [r4, #4]
1768:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5052              		.loc 1 1768 0
 5053 00f0 80B2     		uxth	r0, r0
ARM GAS  /tmp/cc1G6faT.s 			page 142


 5054 00f2 6238     		subs	r0, r0, #98
 5055 00f4 C0B2     		uxtb	r0, r0
1766:bluetooth_rxtx.c **** 
 5056              		.loc 1 1766 0
 5057 00f6 0393     		str	r3, [sp, #12]
1768:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5058              		.loc 1 1768 0
 5059 00f8 FFF7FEFF 		bl	btle_channel_index
 5060              	.LVL520:
 5061 00fc 4FF03008 		mov	r8, #48
 5062 0100 08FB00F8 		mul	r8, r8, r0
 5063 0104 DFF808A2 		ldr	r10, .L627+76
 5064 0108 0AEB0803 		add	r3, r10, r8
 5065 010c 0193     		str	r3, [sp, #4]
 5066              	.LVL521:
 5067              	.LBB39:
1770:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5068              		.loc 1 1770 0
 5069 010e 754B     		ldr	r3, .L627+32
 5070              	.LVL522:
 5071 0110 93F800E0 		ldrb	lr, [r3]	@ zero_extendqisi2
1771:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5072              		.loc 1 1771 0
 5073 0114 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
1772:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5074              		.loc 1 1772 0
 5075 0116 9878     		ldrb	r0, [r3, #2]	@ zero_extendqisi2
1771:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5076              		.loc 1 1771 0
 5077 0118 1204     		lsls	r2, r2, #16
1773:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5078              		.loc 1 1773 0
 5079 011a D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 5080              	.LVL523:
1771:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5081              		.loc 1 1771 0
 5082 011c 42EA0E62 		orr	r2, r2, lr, lsl #24
1772:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5083              		.loc 1 1772 0
 5084 0120 0A43     		orrs	r2, r2, r1
1774:bluetooth_rxtx.c **** 		}
 5085              		.loc 1 1774 0
 5086 0122 42EA0020 		orr	r0, r2, r0, lsl #8
 5087 0126 0093     		str	r3, [sp]
 5088 0128 FFF7FEFF 		bl	rbit
 5089              	.LVL524:
 5090 012c 5AF80820 		ldr	r2, [r10, r8]
 5091              	.LBE39:
1778:bluetooth_rxtx.c **** 			goto rx_flush;
 5092              		.loc 1 1778 0
 5093 0130 009B     		ldr	r3, [sp]
 5094              	.LBB40:
1774:bluetooth_rxtx.c **** 		}
 5095              		.loc 1 1774 0
 5096 0132 5040     		eors	r0, r0, r2
 5097              	.LBE40:
1777:bluetooth_rxtx.c **** 		if (len > 39)
ARM GAS  /tmp/cc1G6faT.s 			page 143


 5098              		.loc 1 1777 0
 5099 0134 C0F3052A 		ubfx	r10, r0, #8, #6
 5100 0138 0AF10208 		add	r8, r10, #2
1778:bluetooth_rxtx.c **** 			goto rx_flush;
 5101              		.loc 1 1778 0
 5102 013c B8F1270F 		cmp	r8, #39
 5103              	.LBB41:
1774:bluetooth_rxtx.c **** 		}
 5104              		.loc 1 1774 0
 5105 0140 0490     		str	r0, [sp, #16]
 5106              	.LVL525:
 5107              	.LBE41:
1778:bluetooth_rxtx.c **** 			goto rx_flush;
 5108              		.loc 1 1778 0
 5109 0142 00F28280 		bhi	.L576
1783:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
 5110              		.loc 1 1783 0
 5111 0146 0AF1080A 		add	r10, r10, #8
 5112 014a 4FEA9A02 		lsr	r2, r10, #2
 5113              	.LVL526:
1784:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
 5114              		.loc 1 1784 0
 5115 014e 0B2A     		cmp	r2, #11
 5116 0150 0DD0     		beq	.L583
1785:bluetooth_rxtx.c **** 				;
 5117              		.loc 1 1785 0
 5118 0152 03EB8203 		add	r3, r3, r2, lsl #2
 5119              	.LVL527:
 5120              	.L582:
 5121 0156 644A     		ldr	r2, .L627+36
 5122 0158 1268     		ldr	r2, [r2]
 5123 015a 9A42     		cmp	r2, r3
 5124 015c 0BD2     		bcs	.L581
1785:bluetooth_rxtx.c **** 				;
 5125              		.loc 1 1785 0 is_stmt 0 discriminator 2
 5126 015e DBF80010 		ldr	r1, [fp]
 5127 0162 0029     		cmp	r1, #0
 5128 0164 F7D0     		beq	.L582
 5129 0166 06E0     		b	.L581
 5130              	.LVL528:
 5131              	.L625:
1788:bluetooth_rxtx.c **** 				;
 5132              		.loc 1 1788 0 is_stmt 1 discriminator 2
 5133 0168 DBF80030 		ldr	r3, [fp]
 5134 016c 1BB9     		cbnz	r3, .L581
 5135              	.L583:
1788:bluetooth_rxtx.c **** 				;
 5136              		.loc 1 1788 0 is_stmt 0
 5137 016e 5F4B     		ldr	r3, .L627+40
 5138 0170 1B68     		ldr	r3, [r3]
 5139 0172 D807     		lsls	r0, r3, #31
 5140 0174 F8D4     		bmi	.L625
 5141              	.LVL529:
 5142              	.L581:
1791:bluetooth_rxtx.c **** 
 5143              		.loc 1 1791 0 is_stmt 1
 5144 0176 5E4B     		ldr	r3, .L627+44
ARM GAS  /tmp/cc1G6faT.s 			page 144


1794:bluetooth_rxtx.c **** 
 5145              		.loc 1 1794 0
 5146 0178 6120     		movs	r0, #97
1791:bluetooth_rxtx.c **** 
 5147              		.loc 1 1791 0
 5148 017a 1A68     		ldr	r2, [r3]
1797:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5149              		.loc 1 1797 0
 5150 017c 4FF0040B 		mov	fp, #4
1791:bluetooth_rxtx.c **** 
 5151              		.loc 1 1791 0
 5152 0180 22F00102 		bic	r2, r2, #1
 5153 0184 1A60     		str	r2, [r3]
1794:bluetooth_rxtx.c **** 
 5154              		.loc 1 1794 0
 5155 0186 FFF7FEFF 		bl	cc2400_strobe
 5156              	.LVL530:
 5157              	.L585:
 5158              	.LBB42:
1798:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5159              		.loc 1 1798 0 discriminator 2
 5160 018a 564A     		ldr	r2, .L627+32
 5161 018c 0BF10100 		add	r0, fp, #1
 5162 0190 12F80B10 		ldrb	r1, [r2, fp]	@ zero_extendqisi2
 5163 0194 0BF1030C 		add	ip, fp, #3
1799:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5164              		.loc 1 1799 0 discriminator 2
 5165 0198 12F800E0 		ldrb	lr, [r2, r0]	@ zero_extendqisi2
 5166 019c 0BF10200 		add	r0, fp, #2
1800:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5167              		.loc 1 1800 0 discriminator 2
 5168 01a0 105C     		ldrb	r0, [r2, r0]	@ zero_extendqisi2
1801:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5169              		.loc 1 1801 0 discriminator 2
 5170 01a2 12F80CC0 		ldrb	ip, [r2, ip]	@ zero_extendqisi2
 5171              	.LVL531:
1802:bluetooth_rxtx.c **** 		}
 5172              		.loc 1 1802 0 discriminator 2
 5173 01a6 4FEAAB02 		asr	r2, fp, #2
1799:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5174              		.loc 1 1799 0 discriminator 2
 5175 01aa 4CEA0161 		orr	r1, ip, r1, lsl #24
 5176              	.LVL532:
1800:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5177              		.loc 1 1800 0 discriminator 2
 5178 01ae 41EA0E41 		orr	r1, r1, lr, lsl #16
1802:bluetooth_rxtx.c **** 		}
 5179              		.loc 1 1802 0 discriminator 2
 5180 01b2 41EA0020 		orr	r0, r1, r0, lsl #8
 5181 01b6 0092     		str	r2, [sp]
 5182 01b8 FFF7FEFF 		bl	rbit
 5183              	.LVL533:
 5184 01bc 009A     		ldr	r2, [sp]
 5185 01be 10AB     		add	r3, sp, #64
 5186 01c0 03EB8201 		add	r1, r3, r2, lsl #2
 5187 01c4 019B     		ldr	r3, [sp, #4]
 5188              	.LBE42:
ARM GAS  /tmp/cc1G6faT.s 			page 145


1797:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5189              		.loc 1 1797 0 discriminator 2
 5190 01c6 0BF1040B 		add	fp, fp, #4
 5191              	.LVL534:
 5192              	.LBB43:
1802:bluetooth_rxtx.c **** 		}
 5193              		.loc 1 1802 0 discriminator 2
 5194 01ca 53F82220 		ldr	r2, [r3, r2, lsl #2]
 5195              	.LBE43:
1797:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5196              		.loc 1 1797 0 discriminator 2
 5197 01ce BBF12C0F 		cmp	fp, #44
 5198              	.LBB44:
1802:bluetooth_rxtx.c **** 		}
 5199              		.loc 1 1802 0 discriminator 2
 5200 01d2 82EA0000 		eor	r0, r2, r0
 5201 01d6 41F8300C 		str	r0, [r1, #-48]
 5202              	.LBE44:
1797:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5203              		.loc 1 1797 0 discriminator 2
 5204 01da D6D1     		bne	.L585
1805:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
 5205              		.loc 1 1805 0
 5206 01dc 6369     		ldr	r3, [r4, #20]
 5207 01de EBB9     		cbnz	r3, .L586
 5208              	.L587:
1815:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
 5209              		.loc 1 1815 0
 5210 01e0 444B     		ldr	r3, .L627+48
 5211 01e2 1022     		movs	r2, #16
 5212 01e4 1A60     		str	r2, [r3]
1816:bluetooth_rxtx.c **** 
 5213              		.loc 1 1816 0
 5214 01e6 03A8     		add	r0, sp, #12
 5215              	.LVL535:
 5216 01e8 AB69     		ldr	r3, [r5, #24]
 5217 01ea 9847     		blx	r3
 5218              	.LVL536:
1819:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
 5219              		.loc 1 1819 0
 5220 01ec 424B     		ldr	r3, .L627+52
 5221 01ee 4FF08078 		mov	r8, #16777216
 5222              	.LVL537:
 5223 01f2 C3F80080 		str	r8, [r3]
1820:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 5224              		.loc 1 1820 0
 5225 01f6 03A9     		add	r1, sp, #12
 5226              	.LVL538:
 5227 01f8 0120     		movs	r0, #1
 5228 01fa FFF7FEFF 		bl	enqueue
 5229              	.LVL539:
1821:bluetooth_rxtx.c **** 
 5230              		.loc 1 1821 0
 5231 01fe 334B     		ldr	r3, .L627+8
1823:bluetooth_rxtx.c **** 
 5232              		.loc 1 1823 0
 5233 0200 3E4A     		ldr	r2, .L627+56
ARM GAS  /tmp/cc1G6faT.s 			page 146


1821:bluetooth_rxtx.c **** 
 5234              		.loc 1 1821 0
 5235 0202 C3F80080 		str	r8, [r3]
1823:bluetooth_rxtx.c **** 
 5236              		.loc 1 1823 0
 5237 0206 3E4B     		ldr	r3, .L627+60
 5238 0208 40F63541 		movw	r1, #3125
 5239 020c 1B68     		ldr	r3, [r3]
 5240 020e 1268     		ldr	r2, [r2]
 5241 0210 C3F31303 		ubfx	r3, r3, #0, #20
 5242 0214 01FB0323 		mla	r3, r1, r3, r2
 5243 0218 6364     		str	r3, [r4, #68]
 5244 021a 16E0     		b	.L576
 5245              	.LVL540:
 5246              	.L586:
 5247              	.LBB45:
1806:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
 5248              		.loc 1 1806 0
 5249 021c 2A4B     		ldr	r3, .L627+4
 5250 021e 04A9     		add	r1, sp, #16
 5251 0220 1869     		ldr	r0, [r3, #16]
 5252 0222 4246     		mov	r2, r8
 5253 0224 FFF7FEFF 		bl	btle_crcgen_lut
 5254              	.LVL541:
1807:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 5255              		.loc 1 1807 0
 5256 0228 10AB     		add	r3, sp, #64
 5257 022a 5344     		add	r3, r3, r10
 5258 022c 13F8342C 		ldrb	r2, [r3, #-52]	@ zero_extendqisi2
1808:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5259              		.loc 1 1808 0
 5260 0230 10AB     		add	r3, sp, #64
 5261 0232 4344     		add	r3, r3, r8
 5262 0234 13F82F1C 		ldrb	r1, [r3, #-47]	@ zero_extendqisi2
 5263 0238 0902     		lsls	r1, r1, #8
 5264 023a 41EA0241 		orr	r1, r1, r2, lsl #16
1809:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
 5265              		.loc 1 1809 0
 5266 023e 13F8302C 		ldrb	r2, [r3, #-48]	@ zero_extendqisi2
 5267 0242 41EA0203 		orr	r3, r1, r2
1810:bluetooth_rxtx.c **** 				goto rx_flush;
 5268              		.loc 1 1810 0
 5269 0246 9842     		cmp	r0, r3
 5270 0248 CAD0     		beq	.L587
 5271              	.LVL542:
 5272              	.L576:
 5273              	.LBE45:
1827:bluetooth_rxtx.c **** 
 5274              		.loc 1 1827 0
 5275 024a 6120     		movs	r0, #97
 5276 024c FFF7FEFF 		bl	cc2400_strobe
 5277              	.LVL543:
1830:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
 5278              		.loc 1 1830 0
 5279 0250 274B     		ldr	r3, .L627+44
 5280 0252 1A68     		ldr	r2, [r3]
 5281 0254 22F00102 		bic	r2, r2, #1
ARM GAS  /tmp/cc1G6faT.s 			page 147


 5282 0258 1A60     		str	r2, [r3]
 5283              	.L588:
1831:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
 5284              		.loc 1 1831 0 discriminator 1
 5285 025a 2A4B     		ldr	r3, .L627+64
 5286 025c 1B68     		ldr	r3, [r3]
 5287 025e 5907     		lsls	r1, r3, #29
 5288 0260 02D5     		bpl	.L626
 5289              	.LBB46:
1832:bluetooth_rxtx.c **** 		}
 5290              		.loc 1 1832 0
 5291 0262 294B     		ldr	r3, .L627+68
 5292 0264 1B68     		ldr	r3, [r3]
 5293 0266 F8E7     		b	.L588
 5294              	.L626:
 5295              	.LBE46:
1836:bluetooth_rxtx.c **** 		if (now < le.last_packet)
 5296              		.loc 1 1836 0
 5297 0268 254B     		ldr	r3, .L627+60
 5298 026a 244A     		ldr	r2, .L627+56
 5299 026c 1B68     		ldr	r3, [r3]
 5300 026e 1268     		ldr	r2, [r2]
 5301 0270 40F63541 		movw	r1, #3125
 5302 0274 C3F31303 		ubfx	r3, r3, #0, #20
 5303 0278 01FB0323 		mla	r3, r1, r3, r2
 5304              	.LVL544:
1837:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5305              		.loc 1 1837 0
 5306 027c 626C     		ldr	r2, [r4, #68]
1840:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
 5307              		.loc 1 1840 0
 5308 027e 217E     		ldrb	r1, [r4, #24]	@ zero_extendqisi2
1837:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5309              		.loc 1 1837 0
 5310 0280 9342     		cmp	r3, r2
1840:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
 5311              		.loc 1 1840 0
 5312 0282 A1F10201 		sub	r1, r1, #2
1838:bluetooth_rxtx.c **** 		if  ( // timeout
 5313              		.loc 1 1838 0
 5314 0286 38BF     		it	cc
 5315 0288 03F14343 		addcc	r3, r3, #-1023410176
 5316              	.LVL545:
1839:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5317              		.loc 1 1839 0
 5318 028c C9B2     		uxtb	r1, r1
1838:bluetooth_rxtx.c **** 		if  ( // timeout
 5319              		.loc 1 1838 0
 5320 028e 38BF     		it	cc
 5321 0290 03F5A003 		addcc	r3, r3, #5242880
 5322              	.LVL546:
1839:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5323              		.loc 1 1839 0
 5324 0294 0129     		cmp	r1, #1
 5325 0296 03D8     		bhi	.L591
1841:bluetooth_rxtx.c **** 			// jam finished
 5326              		.loc 1 1841 0
ARM GAS  /tmp/cc1G6faT.s 			page 148


 5327 0298 1C49     		ldr	r1, .L627+72
 5328 029a 9B1A     		subs	r3, r3, r2
 5329              	.LVL547:
 5330 029c 8B42     		cmp	r3, r1
 5331 029e 02D8     		bhi	.L592
 5332              	.L591:
1843:bluetooth_rxtx.c **** 			)
 5333              		.loc 1 1843 0
 5334 02a0 EB69     		ldr	r3, [r5, #28]
 5335 02a2 012B     		cmp	r3, #1
 5336 02a4 4FD1     		bne	.L593
 5337              	.L592:
1846:bluetooth_rxtx.c **** 			le_jam_count = 0;
 5338              		.loc 1 1846 0
 5339 02a6 FFF7FEFF 		bl	reset_le
 5340              	.LVL548:
1848:bluetooth_rxtx.c **** 
 5341              		.loc 1 1848 0
 5342 02aa 0949     		ldr	r1, .L627+12
1847:bluetooth_rxtx.c **** 			TXLED_CLR;
 5343              		.loc 1 1847 0
 5344 02ac 0023     		movs	r3, #0
1848:bluetooth_rxtx.c **** 
 5345              		.loc 1 1848 0
 5346 02ae 4FF48070 		mov	r0, #256
1847:bluetooth_rxtx.c **** 			TXLED_CLR;
 5347              		.loc 1 1847 0
 5348 02b2 EB61     		str	r3, [r5, #28]
1848:bluetooth_rxtx.c **** 
 5349              		.loc 1 1848 0
 5350 02b4 0860     		str	r0, [r1]
1850:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 5351              		.loc 1 1850 0
 5352 02b6 E97C     		ldrb	r1, [r5, #19]	@ zero_extendqisi2
1847:bluetooth_rxtx.c **** 			TXLED_CLR;
 5353              		.loc 1 1847 0
 5354 02b8 024A     		ldr	r2, .L627
1850:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 5355              		.loc 1 1850 0
 5356 02ba 0129     		cmp	r1, #1
 5357 02bc 2AD1     		bne	.L594
1851:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
 5358              		.loc 1 1851 0
 5359 02be D374     		strb	r3, [r2, #19]
1852:bluetooth_rxtx.c **** 				goto cleanup;
 5360              		.loc 1 1852 0
 5361 02c0 9374     		strb	r3, [r2, #18]
1853:bluetooth_rxtx.c **** 			}
 5362              		.loc 1 1853 0
 5363 02c2 75E0     		b	.L605
 5364              	.L628:
 5365              		.align	2
 5366              	.L627:
 5367 02c4 00000000 		.word	.LANCHOR0
 5368 02c8 00000000 		.word	.LANCHOR1
 5369 02cc 00E100E0 		.word	-536813312
 5370 02d0 3CC00920 		.word	537509948
ARM GAS  /tmp/cc1G6faT.s 			page 149


 5371 02d4 00000000 		.word	rx_tc
 5372 02d8 00000000 		.word	rx_err
 5373 02dc 00000000 		.word	rssi_max
 5374 02e0 00000000 		.word	rssi_min
 5375 02e4 00000000 		.word	rxbuf1
 5376 02e8 04410050 		.word	1342193924
 5377 02ec 10410050 		.word	1342193936
 5378 02f0 24000340 		.word	1073938468
 5379 02f4 38C00920 		.word	537509944
 5380 02f8 80E100E0 		.word	-536813184
 5381 02fc 08400040 		.word	1073758216
 5382 0300 00000000 		.word	clkn
 5383 0304 0C000340 		.word	1073938444
 5384 0308 08000340 		.word	1073938440
 5385 030c 80F0FA02 		.word	50000000
 5386 0310 F0000000 		.word	.LANCHOR2+240
 5387              	.L594:
1857:bluetooth_rxtx.c **** 				goto cleanup;
 5388              		.loc 1 1857 0
 5389 0314 0A2E     		cmp	r6, #10
 5390 0316 4BD0     		beq	.L605
1860:bluetooth_rxtx.c **** 
 5391              		.loc 1 1860 0
 5392 0318 0123     		movs	r3, #1
1862:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5393              		.loc 1 1862 0
 5394 031a 6420     		movs	r0, #100
1860:bluetooth_rxtx.c **** 
 5395              		.loc 1 1860 0
 5396 031c 2376     		strb	r3, [r4, #24]
1862:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5397              		.loc 1 1862 0
 5398 031e FFF7FEFF 		bl	cc2400_strobe
 5399              	.LVL549:
 5400              	.L597:
1863:bluetooth_rxtx.c **** 
 5401              		.loc 1 1863 0 discriminator 1
 5402 0322 FFF7FEFF 		bl	cc2400_status
 5403              	.LVL550:
 5404 0326 4207     		lsls	r2, r0, #29
 5405 0328 FBD4     		bmi	.L597
1866:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5406              		.loc 1 1866 0
 5407 032a B4F84A30 		ldrh	r3, [r4, #74]
 5408 032e 9BB2     		uxth	r3, r3
 5409 0330 23B1     		cbz	r3, .L607
1866:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5410              		.loc 1 1866 0 is_stmt 0 discriminator 1
 5411 0332 264B     		ldr	r3, .L629
 5412 0334 B3F84A30 		ldrh	r3, [r3, #74]
 5413 0338 9BB2     		uxth	r3, r3
 5414 033a 01E0     		b	.L598
 5415              	.L607:
1866:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5416              		.loc 1 1866 0
 5417 033c 40F66213 		movw	r3, #2402
 5418              	.L598:
ARM GAS  /tmp/cc1G6faT.s 			page 150


1866:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5419              		.loc 1 1866 0 discriminator 3
 5420 0340 2380     		strh	r3, [r4]	@ movhi
1867:bluetooth_rxtx.c **** 		}
 5421              		.loc 1 1867 0 is_stmt 1 discriminator 3
 5422 0342 0123     		movs	r3, #1
 5423 0344 2B63     		str	r3, [r5, #48]
 5424              	.L593:
1870:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
 5425              		.loc 1 1870 0
 5426 0346 2C20     		movs	r0, #44
 5427 0348 6189     		ldrh	r1, [r4, #10]
 5428 034a FFF7FEFF 		bl	cc2400_set
 5429              	.LVL551:
1871:bluetooth_rxtx.c **** 
 5430              		.loc 1 1871 0
 5431 034e 2D20     		movs	r0, #45
 5432 0350 2189     		ldrh	r1, [r4, #8]
 5433 0352 FFF7FEFF 		bl	cc2400_set
 5434              	.LVL552:
1873:bluetooth_rxtx.c **** 			hop();
 5435              		.loc 1 1873 0
 5436 0356 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 5437 0358 0BB1     		cbz	r3, .L599
1874:bluetooth_rxtx.c **** 
 5438              		.loc 1 1874 0
 5439 035a FFF7FEFF 		bl	hop
 5440              	.LVL553:
 5441              	.L599:
1877:bluetooth_rxtx.c **** 			le_jam();
 5442              		.loc 1 1877 0
 5443 035e EB69     		ldr	r3, [r5, #28]
 5444 0360 DFF87080 		ldr	r8, .L629+8
 5445 0364 002B     		cmp	r3, #0
 5446 0366 07DD     		ble	.L600
1878:bluetooth_rxtx.c **** 			--le_jam_count;
 5447              		.loc 1 1878 0
 5448 0368 FFF7FEFF 		bl	le_jam
 5449              	.LVL554:
1879:bluetooth_rxtx.c **** 		} else {
 5450              		.loc 1 1879 0
 5451 036c D8F81C30 		ldr	r3, [r8, #28]
 5452 0370 013B     		subs	r3, r3, #1
 5453 0372 C8F81C30 		str	r3, [r8, #28]
 5454 0376 16E0     		b	.L601
 5455              	.L600:
1882:bluetooth_rxtx.c **** 			dio_ssp_start();
 5456              		.loc 1 1882 0
 5457 0378 FFF7FEFF 		bl	dma_init_le
 5458              	.LVL555:
1883:bluetooth_rxtx.c **** 
 5459              		.loc 1 1883 0
 5460 037c FFF7FEFF 		bl	dio_ssp_start
 5461              	.LVL556:
1885:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
 5462              		.loc 1 1885 0
 5463 0380 D8F83030 		ldr	r3, [r8, #48]
ARM GAS  /tmp/cc1G6faT.s 			page 151


 5464 0384 43B1     		cbz	r3, .L604
1886:bluetooth_rxtx.c **** 				restart_jamming = 0;
 5465              		.loc 1 1886 0
 5466 0386 6068     		ldr	r0, [r4, #4]
 5467 0388 FFF7FEFF 		bl	rbit
 5468              	.LVL557:
 5469 038c FFF7FEFF 		bl	cc2400_rx_sync
 5470              	.LVL558:
1887:bluetooth_rxtx.c **** 			} else {
 5471              		.loc 1 1887 0
 5472 0390 0023     		movs	r3, #0
 5473 0392 C8F83030 		str	r3, [r8, #48]
 5474 0396 06E0     		b	.L601
 5475              	.L604:
1890:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
 5476              		.loc 1 1890 0
 5477 0398 FFF7FEFF 		bl	cc2400_status
 5478              	.LVL559:
 5479 039c 4307     		lsls	r3, r0, #29
 5480 039e FBD5     		bpl	.L604
1891:bluetooth_rxtx.c **** 			}
 5481              		.loc 1 1891 0
 5482 03a0 6220     		movs	r0, #98
 5483 03a2 FFF7FEFF 		bl	cc2400_strobe
 5484              	.LVL560:
 5485              	.L601:
1895:bluetooth_rxtx.c **** 		rx_err = 0;
 5486              		.loc 1 1895 0 discriminator 1
 5487 03a6 0023     		movs	r3, #0
 5488 03a8 C9F80030 		str	r3, [r9]
1896:bluetooth_rxtx.c **** 	}
 5489              		.loc 1 1896 0 discriminator 1
 5490 03ac 3B60     		str	r3, [r7]
 5491 03ae 45E6     		b	.L565
 5492              	.L605:
 5493              	.LBE38:
1902:bluetooth_rxtx.c **** 
 5494              		.loc 1 1902 0
 5495 03b0 074B     		ldr	r3, .L629+4
 5496 03b2 4FF08072 		mov	r2, #16777216
 5497 03b6 1A60     		str	r2, [r3]
1905:bluetooth_rxtx.c **** 	dio_ssp_stop();
 5498              		.loc 1 1905 0
 5499 03b8 FFF7FEFF 		bl	cc2400_idle
 5500              	.LVL561:
1906:bluetooth_rxtx.c **** 	cs_trigger_disable();
 5501              		.loc 1 1906 0
 5502 03bc FFF7FEFF 		bl	dio_ssp_stop
 5503              	.LVL562:
1907:bluetooth_rxtx.c **** }
 5504              		.loc 1 1907 0
 5505 03c0 FFF7FEFF 		bl	cs_trigger_disable
 5506              	.LVL563:
1908:bluetooth_rxtx.c **** 
 5507              		.loc 1 1908 0
 5508 03c4 11B0     		add	sp, sp, #68
 5509              		@ sp needed
ARM GAS  /tmp/cc1G6faT.s 			page 152


 5510 03c6 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 5511              	.L630:
 5512 03ca 00BF     		.align	2
 5513              	.L629:
 5514 03cc 00000000 		.word	.LANCHOR1
 5515 03d0 80E100E0 		.word	-536813184
 5516 03d4 00000000 		.word	.LANCHOR0
 5517              		.cfi_endproc
 5518              	.LFE22:
 5520              		.section	.text.bt_follow_le,"ax",%progbits
 5521              		.align	1
 5522              		.global	bt_follow_le
 5523              		.thumb
 5524              		.thumb_func
 5526              	bt_follow_le:
 5527              	.LFB25:
2073:bluetooth_rxtx.c **** 		}
2074:bluetooth_rxtx.c **** 	}
2075:bluetooth_rxtx.c **** }
2076:bluetooth_rxtx.c **** 
2077:bluetooth_rxtx.c **** void bt_follow_le() {
 5528              		.loc 1 2077 0
 5529              		.cfi_startproc
 5530              		@ args = 0, pretend = 0, frame = 0
 5531              		@ frame_needed = 0, uses_anonymous_args = 0
 5532 0000 10B5     		push	{r4, lr}
 5533              		.cfi_def_cfa_offset 8
 5534              		.cfi_offset 4, -8
 5535              		.cfi_offset 14, -4
2078:bluetooth_rxtx.c **** 	reset_le();
 5536              		.loc 1 2078 0
 5537 0002 FFF7FEFF 		bl	reset_le
 5538              	.LVL564:
2079:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 5539              		.loc 1 2079 0
 5540 0006 044C     		ldr	r4, .L632
 5541 0008 044B     		ldr	r3, .L632+4
2080:bluetooth_rxtx.c **** 	bt_le_sync(MODE_BT_FOLLOW_LE);
 5542              		.loc 1 2080 0
 5543 000a 0920     		movs	r0, #9
2079:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 5544              		.loc 1 2079 0
 5545 000c A361     		str	r3, [r4, #24]
 5546              		.loc 1 2080 0
 5547 000e FFF7FEFF 		bl	bt_le_sync
 5548              	.LVL565:
2081:bluetooth_rxtx.c **** 
2082:bluetooth_rxtx.c **** 	/* old non-sync mode
2083:bluetooth_rxtx.c **** 	data_cb = cb_follow_le;
2084:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
2085:bluetooth_rxtx.c **** 	bt_generic_le(MODE_BT_FOLLOW_LE);
2086:bluetooth_rxtx.c **** 	*/
2087:bluetooth_rxtx.c **** 
2088:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 5549              		.loc 1 2088 0
 5550 0012 0023     		movs	r3, #0
 5551 0014 6374     		strb	r3, [r4, #17]
ARM GAS  /tmp/cc1G6faT.s 			page 153


 5552 0016 10BD     		pop	{r4, pc}
 5553              	.L633:
 5554              		.align	2
 5555              	.L632:
 5556 0018 00000000 		.word	.LANCHOR0
 5557 001c 00000000 		.word	connection_follow_cb
 5558              		.cfi_endproc
 5559              	.LFE25:
 5561              		.section	.text.le_promisc_state,"ax",%progbits
 5562              		.align	1
 5563              		.global	le_promisc_state
 5564              		.thumb
 5565              		.thumb_func
 5567              	le_promisc_state:
 5568              	.LFB26:
2089:bluetooth_rxtx.c **** }
2090:bluetooth_rxtx.c **** 
2091:bluetooth_rxtx.c **** // issue state change message
2092:bluetooth_rxtx.c **** void le_promisc_state(u8 type, void *data, unsigned len) {
 5569              		.loc 1 2092 0
 5570              		.cfi_startproc
 5571              		@ args = 0, pretend = 0, frame = 56
 5572              		@ frame_needed = 0, uses_anonymous_args = 0
 5573              	.LVL566:
 5574 0000 70B5     		push	{r4, r5, r6, lr}
 5575              		.cfi_def_cfa_offset 16
 5576              		.cfi_offset 4, -16
 5577              		.cfi_offset 5, -12
 5578              		.cfi_offset 6, -8
 5579              		.cfi_offset 14, -4
 5580 0002 8EB0     		sub	sp, sp, #56
 5581              		.cfi_def_cfa_offset 72
 5582              		.loc 1 2092 0
 5583 0004 0646     		mov	r6, r0
 5584 0006 0D46     		mov	r5, r1
 5585 0008 1446     		mov	r4, r2
2093:bluetooth_rxtx.c **** 	u8 buf[50] = { 0, };
 5586              		.loc 1 2093 0
 5587 000a 01A8     		add	r0, sp, #4
 5588              	.LVL567:
 5589 000c 0021     		movs	r1, #0
 5590              	.LVL568:
 5591 000e 3222     		movs	r2, #50
 5592              	.LVL569:
 5593 0010 FFF7FEFF 		bl	memset
 5594              	.LVL570:
2094:bluetooth_rxtx.c **** 	if (len > 49)
2095:bluetooth_rxtx.c **** 		len = 49;
2096:bluetooth_rxtx.c **** 
2097:bluetooth_rxtx.c **** 	buf[0] = type;
2098:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 5595              		.loc 1 2098 0
 5596 0014 2946     		mov	r1, r5
 5597 0016 312C     		cmp	r4, #49
 5598 0018 34BF     		ite	cc
 5599 001a 2246     		movcc	r2, r4
 5600 001c 3122     		movcs	r2, #49
ARM GAS  /tmp/cc1G6faT.s 			page 154


 5601              	.LVL571:
 5602 001e 0DF10500 		add	r0, sp, #5
2097:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 5603              		.loc 1 2097 0
 5604 0022 8DF80460 		strb	r6, [sp, #4]
 5605              		.loc 1 2098 0
 5606 0026 FFF7FEFF 		bl	memcpy
 5607              	.LVL572:
2099:bluetooth_rxtx.c **** 	enqueue(LE_PROMISC, (uint8_t*)buf);
 5608              		.loc 1 2099 0
 5609 002a 01A9     		add	r1, sp, #4
 5610 002c 0520     		movs	r0, #5
 5611 002e FFF7FEFF 		bl	enqueue
 5612              	.LVL573:
2100:bluetooth_rxtx.c **** }
 5613              		.loc 1 2100 0
 5614 0032 0EB0     		add	sp, sp, #56
 5615              		@ sp needed
 5616 0034 70BD     		pop	{r4, r5, r6, pc}
 5617              		.cfi_endproc
 5618              	.LFE26:
 5620              		.section	.text.promisc_recover_hop_increment,"ax",%progbits
 5621              		.align	1
 5622              		.global	promisc_recover_hop_increment
 5623              		.thumb
 5624              		.thumb_func
 5626              	promisc_recover_hop_increment:
 5627              	.LFB27:
2101:bluetooth_rxtx.c **** 
2102:bluetooth_rxtx.c **** // divide, rounding to the nearest integer: round up at 0.5.
2103:bluetooth_rxtx.c **** #define DIVIDE_ROUND(N, D) ((N) + (D)/2) / (D)
2104:bluetooth_rxtx.c **** 
2105:bluetooth_rxtx.c **** void promisc_recover_hop_increment(u8 *packet) {
 5628              		.loc 1 2105 0
 5629              		.cfi_startproc
 5630              		@ args = 0, pretend = 0, frame = 0
 5631              		@ frame_needed = 0, uses_anonymous_args = 0
 5632              	.LVL574:
 5633 0000 38B5     		push	{r3, r4, r5, lr}
 5634              		.cfi_def_cfa_offset 16
 5635              		.cfi_offset 3, -16
 5636              		.cfi_offset 4, -12
 5637              		.cfi_offset 5, -8
 5638              		.cfi_offset 14, -4
2106:bluetooth_rxtx.c **** 	static u32 first_ts = 0;
2107:bluetooth_rxtx.c **** 	if (channel == 2404) {
 5639              		.loc 1 2107 0
 5640 0002 314A     		ldr	r2, .L644
 5641 0004 40F66413 		movw	r3, #2404
 5642 0008 1188     		ldrh	r1, [r2]
 5643 000a 304C     		ldr	r4, .L644+4
 5644 000c 89B2     		uxth	r1, r1
 5645 000e 9942     		cmp	r1, r3
 5646 0010 0DD1     		bne	.L636
2108:bluetooth_rxtx.c **** 		first_ts = CLK100NS;
 5647              		.loc 1 2108 0
 5648 0012 2F4B     		ldr	r3, .L644+8
ARM GAS  /tmp/cc1G6faT.s 			page 155


 5649 0014 2F4A     		ldr	r2, .L644+12
 5650 0016 1B68     		ldr	r3, [r3]
 5651 0018 1268     		ldr	r2, [r2]
 5652 001a C3F31303 		ubfx	r3, r3, #0, #20
 5653 001e 40F63541 		movw	r1, #3125
 5654 0022 01FB0323 		mla	r3, r1, r3, r2
 5655 0026 6363     		str	r3, [r4, #52]
2109:bluetooth_rxtx.c **** 		hop_direct_channel = 2406;
 5656              		.loc 1 2109 0
 5657 0028 40F66613 		movw	r3, #2406
 5658 002c 48E0     		b	.L638
 5659              	.L636:
2110:bluetooth_rxtx.c **** 		do_hop = 1;
2111:bluetooth_rxtx.c **** 	} else if (channel == 2406) {
 5660              		.loc 1 2111 0
 5661 002e 1088     		ldrh	r0, [r2]
 5662              	.LVL575:
 5663 0030 40F66611 		movw	r1, #2406
 5664 0034 80B2     		uxth	r0, r0
 5665 0036 8842     		cmp	r0, r1
 5666 0038 42D1     		bne	.L638
 5667              	.LVL576:
 5668              	.LBB51:
 5669              	.LBB52:
 5670              	.LBB53:
2112:bluetooth_rxtx.c **** 		u32 second_ts = CLK100NS;
 5671              		.loc 1 2112 0
 5672 003a 254B     		ldr	r3, .L644+8
 5673 003c 2549     		ldr	r1, .L644+12
 5674 003e 1B68     		ldr	r3, [r3]
 5675 0040 0968     		ldr	r1, [r1]
 5676 0042 40F63540 		movw	r0, #3125
 5677 0046 C3F31303 		ubfx	r3, r3, #0, #20
 5678 004a 00FB0313 		mla	r3, r0, r3, r1
 5679              	.LVL577:
2113:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
 5680              		.loc 1 2113 0
 5681 004e 606B     		ldr	r0, [r4, #52]
2114:bluetooth_rxtx.c **** 			second_ts += 3276800000; // handle rollover
2115:bluetooth_rxtx.c **** 		// Number of channels hopped between previous and current timestamp.
2116:bluetooth_rxtx.c **** 		u32 channels_hopped = DIVIDE_ROUND(second_ts - first_ts,
 5682              		.loc 1 2116 0
 5683 0050 528C     		ldrh	r2, [r2, #34]
2113:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
 5684              		.loc 1 2113 0
 5685 0052 8342     		cmp	r3, r0
2114:bluetooth_rxtx.c **** 			second_ts += 3276800000; // handle rollover
 5686              		.loc 1 2114 0
 5687 0054 3CBF     		itt	cc
 5688 0056 03F14343 		addcc	r3, r3, #-1023410176
 5689              	.LVL578:
 5690 005a 03F5A003 		addcc	r3, r3, #5242880
 5691              	.LVL579:
 5692              		.loc 1 2116 0
 5693 005e 1B1A     		subs	r3, r3, r0
 5694              	.LVL580:
 5695 0060 43F2D405 		movw	r5, #12500
ARM GAS  /tmp/cc1G6faT.s 			page 156


 5696 0064 41F66A00 		movw	r0, #6250
 5697 0068 00FB0233 		mla	r3, r0, r2, r3
 5698 006c 5543     		muls	r5, r2, r5
 5699 006e B3FBF5F3 		udiv	r3, r3, r5
 5700              	.LVL581:
2117:bluetooth_rxtx.c **** 										   le.conn_interval * LE_BASECLK);
2118:bluetooth_rxtx.c **** 		if (channels_hopped < 37) {
 5701              		.loc 1 2118 0
 5702 0072 242B     		cmp	r3, #36
2116:bluetooth_rxtx.c **** 										   le.conn_interval * LE_BASECLK);
 5703              		.loc 1 2116 0
 5704 0074 1449     		ldr	r1, .L644
 5705              		.loc 1 2118 0
 5706 0076 21D8     		bhi	.L640
2119:bluetooth_rxtx.c **** 			// Get the hop increment based on the number of channels hopped.
2120:bluetooth_rxtx.c **** 			le.channel_increment = hop_interval_lut[channels_hopped];
 5707              		.loc 1 2120 0
 5708 0078 1748     		ldr	r0, .L644+16
2121:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 5709              		.loc 1 2121 0
 5710 007a 5208     		lsrs	r2, r2, #1
2120:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 5711              		.loc 1 2120 0
 5712 007c 0344     		add	r3, r3, r0
 5713              	.LVL582:
 5714 007e 93F87008 		ldrb	r0, [r3, #2160]	@ zero_extendqisi2
 5715              		.loc 1 2121 0
 5716 0082 0A84     		strh	r2, [r1, #32]	@ movhi
2120:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 5717              		.loc 1 2120 0
 5718 0084 8876     		strb	r0, [r1, #26]
2122:bluetooth_rxtx.c **** 			le.conn_count = 0;
2123:bluetooth_rxtx.c **** 			le.conn_epoch = 0;
2124:bluetooth_rxtx.c **** 			do_hop = 0;
2125:bluetooth_rxtx.c **** 			// Move on to regular connection following.
2126:bluetooth_rxtx.c **** 			le.channel_idx = (1 + le.channel_increment) % 37;
 5719              		.loc 1 2126 0
 5720 0086 2522     		movs	r2, #37
 5721 0088 0130     		adds	r0, r0, #1
 5722 008a 90FBF2F5 		sdiv	r5, r0, r2
 5723 008e 02FB1502 		mls	r2, r2, r5, r0
2122:bluetooth_rxtx.c **** 			le.conn_count = 0;
 5724              		.loc 1 2122 0
 5725 0092 0023     		movs	r3, #0
 5726              	.LVL583:
 5727 0094 8B84     		strh	r3, [r1, #36]	@ movhi
2123:bluetooth_rxtx.c **** 			do_hop = 0;
 5728              		.loc 1 2123 0
 5729 0096 CB61     		str	r3, [r1, #28]
2124:bluetooth_rxtx.c **** 			// Move on to regular connection following.
 5730              		.loc 1 2124 0
 5731 0098 E372     		strb	r3, [r4, #11]
2127:bluetooth_rxtx.c **** 			le.link_state = LINK_CONNECTED;
 5732              		.loc 1 2127 0
 5733 009a 0320     		movs	r0, #3
2128:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 5734              		.loc 1 2128 0
ARM GAS  /tmp/cc1G6faT.s 			page 157


 5735 009c 4B61     		str	r3, [r1, #20]
2129:bluetooth_rxtx.c **** 			hop_mode = HOP_BTLE;
2130:bluetooth_rxtx.c **** 			packet_cb = connection_follow_cb;
 5736              		.loc 1 2130 0
 5737 009e 0F4B     		ldr	r3, .L644+20
2126:bluetooth_rxtx.c **** 			le.link_state = LINK_CONNECTED;
 5738              		.loc 1 2126 0
 5739 00a0 4A76     		strb	r2, [r1, #25]
2127:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 5740              		.loc 1 2127 0
 5741 00a2 0876     		strb	r0, [r1, #24]
2131:bluetooth_rxtx.c **** 			le_promisc_state(3, &le.channel_increment, 1);
 5742              		.loc 1 2131 0
 5743 00a4 0122     		movs	r2, #1
 5744 00a6 1A31     		adds	r1, r1, #26
2130:bluetooth_rxtx.c **** 			le_promisc_state(3, &le.channel_increment, 1);
 5745              		.loc 1 2130 0
 5746 00a8 A361     		str	r3, [r4, #24]
2129:bluetooth_rxtx.c **** 			packet_cb = connection_follow_cb;
 5747              		.loc 1 2129 0
 5748 00aa A072     		strb	r0, [r4, #10]
 5749              		.loc 1 2131 0
 5750 00ac FFF7FEFF 		bl	le_promisc_state
 5751              	.LVL584:
2132:bluetooth_rxtx.c **** 
2133:bluetooth_rxtx.c **** 			if (jam_mode != JAM_NONE)
 5752              		.loc 1 2133 0
 5753 00b0 E37C     		ldrb	r3, [r4, #19]	@ zero_extendqisi2
 5754 00b2 43B1     		cbz	r3, .L635
2134:bluetooth_rxtx.c **** 				le_jam_count = JAM_COUNT_DEFAULT;
 5755              		.loc 1 2134 0
 5756 00b4 054B     		ldr	r3, .L644+4
 5757 00b6 2822     		movs	r2, #40
 5758 00b8 DA61     		str	r2, [r3, #28]
 5759 00ba 38BD     		pop	{r3, r4, r5, pc}
 5760              	.LVL585:
 5761              	.L640:
2135:bluetooth_rxtx.c **** 
2136:bluetooth_rxtx.c **** 			return;
2137:bluetooth_rxtx.c **** 		}
2138:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 5762              		.loc 1 2138 0
 5763 00bc 40F66413 		movw	r3, #2404
 5764              	.LVL586:
 5765              	.L638:
 5766              	.LBE53:
 5767              	.LBE52:
 5768              	.LBE51:
2139:bluetooth_rxtx.c **** 		do_hop = 1;
2140:bluetooth_rxtx.c **** 	}
2141:bluetooth_rxtx.c **** 	else {
2142:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 5769              		.loc 1 2142 0
 5770 00c0 A381     		strh	r3, [r4, #12]	@ movhi
2143:bluetooth_rxtx.c **** 		do_hop = 1;
 5771              		.loc 1 2143 0
 5772 00c2 0123     		movs	r3, #1
ARM GAS  /tmp/cc1G6faT.s 			page 158


 5773 00c4 E372     		strb	r3, [r4, #11]
 5774              	.L635:
 5775 00c6 38BD     		pop	{r3, r4, r5, pc}
 5776              	.L645:
 5777              		.align	2
 5778              	.L644:
 5779 00c8 00000000 		.word	.LANCHOR1
 5780 00cc 00000000 		.word	.LANCHOR0
 5781 00d0 00000000 		.word	clkn
 5782 00d4 08400040 		.word	1073758216
 5783 00d8 00000000 		.word	.LANCHOR2
 5784 00dc 00000000 		.word	connection_follow_cb
 5785              		.cfi_endproc
 5786              	.LFE27:
 5788              		.section	.text.promisc_recover_hop_interval,"ax",%progbits
 5789              		.align	1
 5790              		.global	promisc_recover_hop_interval
 5791              		.thumb
 5792              		.thumb_func
 5794              	promisc_recover_hop_interval:
 5795              	.LFB28:
2144:bluetooth_rxtx.c **** 	}
2145:bluetooth_rxtx.c **** }
2146:bluetooth_rxtx.c **** 
2147:bluetooth_rxtx.c **** void promisc_recover_hop_interval(u8 *packet) {
 5796              		.loc 1 2147 0
 5797              		.cfi_startproc
 5798              		@ args = 0, pretend = 0, frame = 0
 5799              		@ frame_needed = 0, uses_anonymous_args = 0
 5800              	.LVL587:
 5801 0000 38B5     		push	{r3, r4, r5, lr}
 5802              		.cfi_def_cfa_offset 16
 5803              		.cfi_offset 3, -16
 5804              		.cfi_offset 4, -12
 5805              		.cfi_offset 5, -8
 5806              		.cfi_offset 14, -4
2148:bluetooth_rxtx.c **** 	static u32 prev_clk = 0;
2149:bluetooth_rxtx.c **** 
2150:bluetooth_rxtx.c **** 	u32 cur_clk = CLK100NS;
 5807              		.loc 1 2150 0
 5808 0002 254B     		ldr	r3, .L652
 5809 0004 40F63542 		movw	r2, #3125
 5810 0008 1C68     		ldr	r4, [r3]
 5811 000a 244B     		ldr	r3, .L652+4
 5812 000c C4F31304 		ubfx	r4, r4, #0, #20
 5813 0010 1B68     		ldr	r3, [r3]
2151:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
 5814              		.loc 1 2151 0
 5815 0012 234D     		ldr	r5, .L652+8
2150:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
 5816              		.loc 1 2150 0
 5817 0014 02FB0434 		mla	r4, r2, r4, r3
 5818              	.LVL588:
 5819              		.loc 1 2151 0
 5820 0018 AB6B     		ldr	r3, [r5, #56]
 5821 001a 9C42     		cmp	r4, r3
 5822 001c 05D2     		bcs	.L647
ARM GAS  /tmp/cc1G6faT.s 			page 159


2152:bluetooth_rxtx.c **** 		cur_clk += 3267800000; // handle rollover
 5823              		.loc 1 2152 0
 5824 001e 04F14344 		add	r4, r4, #-1023410176
 5825              	.LVL589:
 5826 0022 A4F56514 		sub	r4, r4, #3751936
 5827              	.LVL590:
 5828 0026 A4F5A254 		sub	r4, r4, #5184
 5829              	.LVL591:
 5830              	.L647:
2153:bluetooth_rxtx.c **** 	u32 clk_diff = cur_clk - prev_clk;
 5831              		.loc 1 2153 0
 5832 002a E31A     		subs	r3, r4, r3
 5833              	.LVL592:
2154:bluetooth_rxtx.c **** 	u16 obsv_hop_interval; // observed hop interval
2155:bluetooth_rxtx.c **** 
2156:bluetooth_rxtx.c **** 	// probably consecutive data packets on the same channel
2157:bluetooth_rxtx.c **** 	if (clk_diff < 2 * LE_BASECLK)
 5834              		.loc 1 2157 0
 5835 002c 46F2A712 		movw	r2, #24999
 5836 0030 9342     		cmp	r3, r2
 5837 0032 30D9     		bls	.L646
2158:bluetooth_rxtx.c **** 		return;
2159:bluetooth_rxtx.c **** 
2160:bluetooth_rxtx.c **** 	if (clk_diff < le_promisc.smallest_hop_interval)
 5838              		.loc 1 2160 0
 5839 0034 1B4A     		ldr	r2, .L652+12
 5840 0036 D2F80011 		ldr	r1, [r2, #256]
 5841 003a 8B42     		cmp	r3, r1
2161:bluetooth_rxtx.c **** 		le_promisc.smallest_hop_interval = clk_diff;
 5842              		.loc 1 2161 0
 5843 003c 38BF     		it	cc
 5844 003e C2F80031 		strcc	r3, [r2, #256]
2162:bluetooth_rxtx.c **** 
2163:bluetooth_rxtx.c **** 	obsv_hop_interval = DIVIDE_ROUND(le_promisc.smallest_hop_interval, 37 * LE_BASECLK);
 5845              		.loc 1 2163 0
 5846 0042 D2F80021 		ldr	r2, [r2, #256]
 5847 0046 1849     		ldr	r1, .L652+16
 5848 0048 02F56132 		add	r2, r2, #230400
 5849 004c 02F25232 		addw	r2, r2, #850
 5850 0050 B2FBF1F2 		udiv	r2, r2, r1
2164:bluetooth_rxtx.c **** 
2165:bluetooth_rxtx.c **** 	if (le.conn_interval == obsv_hop_interval) {
 5851              		.loc 1 2165 0
 5852 0054 1549     		ldr	r1, .L652+20
2163:bluetooth_rxtx.c **** 
 5853              		.loc 1 2163 0
 5854 0056 92B2     		uxth	r2, r2
 5855              	.LVL593:
 5856              		.loc 1 2165 0
 5857 0058 488C     		ldrh	r0, [r1, #34]
 5858              	.LVL594:
2163:bluetooth_rxtx.c **** 
 5859              		.loc 1 2163 0
 5860 005a 124B     		ldr	r3, .L652+12
 5861              	.LVL595:
 5862              		.loc 1 2165 0
 5863 005c 9042     		cmp	r0, r2
ARM GAS  /tmp/cc1G6faT.s 			page 160


 5864 005e 15D1     		bne	.L650
2166:bluetooth_rxtx.c **** 		// 5 consecutive hop intervals: consider it legit and move on
2167:bluetooth_rxtx.c **** 		++le_promisc.consec_intervals;
 5865              		.loc 1 2167 0
 5866 0060 D3F80421 		ldr	r2, [r3, #260]
 5867              	.LVL596:
 5868 0064 0132     		adds	r2, r2, #1
2168:bluetooth_rxtx.c **** 		if (le_promisc.consec_intervals == 5) {
 5869              		.loc 1 2168 0
 5870 0066 052A     		cmp	r2, #5
2167:bluetooth_rxtx.c **** 		if (le_promisc.consec_intervals == 5) {
 5871              		.loc 1 2167 0
 5872 0068 C3F80421 		str	r2, [r3, #260]
 5873              		.loc 1 2168 0
 5874 006c 12D1     		bne	.L651
2169:bluetooth_rxtx.c **** 			packet_cb = promisc_recover_hop_increment;
 5875              		.loc 1 2169 0
 5876 006e 104B     		ldr	r3, .L652+24
2170:bluetooth_rxtx.c **** 			hop_direct_channel = 2404;
2171:bluetooth_rxtx.c **** 			hop_mode = HOP_DIRECT;
2172:bluetooth_rxtx.c **** 			do_hop = 1;
2173:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 5877              		.loc 1 2173 0
 5878 0070 0220     		movs	r0, #2
2169:bluetooth_rxtx.c **** 			packet_cb = promisc_recover_hop_increment;
 5879              		.loc 1 2169 0
 5880 0072 AB61     		str	r3, [r5, #24]
2170:bluetooth_rxtx.c **** 			hop_direct_channel = 2404;
 5881              		.loc 1 2170 0
 5882 0074 40F66413 		movw	r3, #2404
 5883 0078 AB81     		strh	r3, [r5, #12]	@ movhi
2171:bluetooth_rxtx.c **** 			do_hop = 1;
 5884              		.loc 1 2171 0
 5885 007a 0423     		movs	r3, #4
 5886 007c AB72     		strb	r3, [r5, #10]
 5887              		.loc 1 2173 0
 5888 007e 2231     		adds	r1, r1, #34
2172:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 5889              		.loc 1 2172 0
 5890 0080 0123     		movs	r3, #1
 5891              		.loc 1 2173 0
 5892 0082 0246     		mov	r2, r0
2172:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 5893              		.loc 1 2172 0
 5894 0084 EB72     		strb	r3, [r5, #11]
 5895              		.loc 1 2173 0
 5896 0086 FFF7FEFF 		bl	le_promisc_state
 5897              	.LVL597:
 5898 008a 03E0     		b	.L651
 5899              	.LVL598:
 5900              	.L650:
2174:bluetooth_rxtx.c **** 		}
2175:bluetooth_rxtx.c **** 	} else {
2176:bluetooth_rxtx.c **** 		le.conn_interval = obsv_hop_interval;
 5901              		.loc 1 2176 0
 5902 008c 4A84     		strh	r2, [r1, #34]	@ movhi
2177:bluetooth_rxtx.c **** 		le_promisc.consec_intervals = 0;
ARM GAS  /tmp/cc1G6faT.s 			page 161


 5903              		.loc 1 2177 0
 5904 008e 0022     		movs	r2, #0
 5905              	.LVL599:
 5906 0090 C3F80421 		str	r2, [r3, #260]
 5907              	.LVL600:
 5908              	.L651:
2178:bluetooth_rxtx.c **** 	}
2179:bluetooth_rxtx.c **** 
2180:bluetooth_rxtx.c **** 	prev_clk = cur_clk;
 5909              		.loc 1 2180 0
 5910 0094 AC63     		str	r4, [r5, #56]
 5911              	.L646:
 5912 0096 38BD     		pop	{r3, r4, r5, pc}
 5913              	.LVL601:
 5914              	.L653:
 5915              		.align	2
 5916              	.L652:
 5917 0098 00000000 		.word	clkn
 5918 009c 08400040 		.word	1073758216
 5919 00a0 00000000 		.word	.LANCHOR0
 5920 00a4 00000000 		.word	le_promisc
 5921 00a8 A40E0700 		.word	462500
 5922 00ac 00000000 		.word	.LANCHOR1
 5923 00b0 00000000 		.word	promisc_recover_hop_increment
 5924              		.cfi_endproc
 5925              	.LFE28:
 5927              		.section	.text.promisc_follow_cb,"ax",%progbits
 5928              		.align	1
 5929              		.global	promisc_follow_cb
 5930              		.thumb
 5931              		.thumb_func
 5933              	promisc_follow_cb:
 5934              	.LFB29:
2181:bluetooth_rxtx.c **** }
2182:bluetooth_rxtx.c **** 
2183:bluetooth_rxtx.c **** void promisc_follow_cb(u8 *packet) {
 5935              		.loc 1 2183 0
 5936              		.cfi_startproc
 5937              		@ args = 0, pretend = 0, frame = 0
 5938              		@ frame_needed = 0, uses_anonymous_args = 0
 5939              	.LVL602:
 5940 0000 38B5     		push	{r3, r4, r5, lr}
 5941              		.cfi_def_cfa_offset 16
 5942              		.cfi_offset 3, -16
 5943              		.cfi_offset 4, -12
 5944              		.cfi_offset 5, -8
 5945              		.cfi_offset 14, -4
2184:bluetooth_rxtx.c **** 	int i;
2185:bluetooth_rxtx.c **** 
2186:bluetooth_rxtx.c **** 	// get the CRCInit
2187:bluetooth_rxtx.c **** 	if (!le.crc_verify && packet[4] == 0x01 && packet[5] == 0x00) {
 5946              		.loc 1 2187 0
 5947 0002 184C     		ldr	r4, .L659
2183:bluetooth_rxtx.c **** 	int i;
 5948              		.loc 1 2183 0
 5949 0004 0146     		mov	r1, r0
 5950              		.loc 1 2187 0
ARM GAS  /tmp/cc1G6faT.s 			page 162


 5951 0006 6369     		ldr	r3, [r4, #20]
 5952 0008 53BB     		cbnz	r3, .L654
 5953              		.loc 1 2187 0 is_stmt 0 discriminator 1
 5954 000a 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 5955 000c 012B     		cmp	r3, #1
 5956 000e 27D1     		bne	.L654
 5957 0010 4579     		ldrb	r5, [r0, #5]	@ zero_extendqisi2
 5958 0012 2DBB     		cbnz	r5, .L654
 5959              	.LVL603:
 5960              	.LBB57:
 5961              	.LBB58:
 5962              	.LBB59:
2188:bluetooth_rxtx.c **** 		u32 crc = (packet[8] << 16) | (packet[7] << 8) | packet[6];
 5963              		.loc 1 2188 0 is_stmt 1
 5964 0014 037A     		ldrb	r3, [r0, #8]	@ zero_extendqisi2
 5965 0016 C079     		ldrb	r0, [r0, #7]	@ zero_extendqisi2
 5966              	.LVL604:
2189:bluetooth_rxtx.c **** 
2190:bluetooth_rxtx.c **** 		le.crc_init = btle_reverse_crc(crc, packet + 4, 2);
 5967              		.loc 1 2190 0
 5968 0018 0222     		movs	r2, #2
2188:bluetooth_rxtx.c **** 		u32 crc = (packet[8] << 16) | (packet[7] << 8) | packet[6];
 5969              		.loc 1 2188 0
 5970 001a 0002     		lsls	r0, r0, #8
 5971 001c 40EA0340 		orr	r0, r0, r3, lsl #16
 5972 0020 8B79     		ldrb	r3, [r1, #6]	@ zero_extendqisi2
 5973              		.loc 1 2190 0
 5974 0022 0431     		adds	r1, r1, #4
 5975              	.LVL605:
 5976 0024 1843     		orrs	r0, r0, r3
 5977 0026 FFF7FEFF 		bl	btle_reverse_crc
 5978              	.LVL606:
 5979 002a 2A46     		mov	r2, r5
 5980 002c E060     		str	r0, [r4, #12]
 5981              	.LVL607:
2191:bluetooth_rxtx.c **** 		le.crc_init_reversed = 0;
2192:bluetooth_rxtx.c **** 		for (i = 0; i < 24; ++i)
 5982              		.loc 1 2192 0
 5983 002e 2B46     		mov	r3, r5
 5984              	.LVL608:
 5985              	.L657:
2193:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 5986              		.loc 1 2193 0
 5987 0030 20FA03F1 		lsr	r1, r0, r3
 5988 0034 C3F11705 		rsb	r5, r3, #23
 5989 0038 01F00101 		and	r1, r1, #1
 5990 003c A940     		lsls	r1, r1, r5
2192:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 5991              		.loc 1 2192 0
 5992 003e 0133     		adds	r3, r3, #1
 5993              	.LVL609:
 5994 0040 182B     		cmp	r3, #24
 5995              		.loc 1 2193 0
 5996 0042 42EA0102 		orr	r2, r2, r1
2192:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 5997              		.loc 1 2192 0
 5998 0046 F3D1     		bne	.L657
ARM GAS  /tmp/cc1G6faT.s 			page 163


 5999 0048 2261     		str	r2, [r4, #16]
2194:bluetooth_rxtx.c **** 
2195:bluetooth_rxtx.c **** 		le.crc_verify = 1;
2196:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 6000              		.loc 1 2196 0
 6001 004a 074B     		ldr	r3, .L659+4
 6002              	.LVL610:
 6003 004c 074A     		ldr	r2, .L659+8
2195:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 6004              		.loc 1 2195 0
 6005 004e 0120     		movs	r0, #1
 6006              		.loc 1 2196 0
 6007 0050 9A61     		str	r2, [r3, #24]
2195:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 6008              		.loc 1 2195 0
 6009 0052 6061     		str	r0, [r4, #20]
2197:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 6010              		.loc 1 2197 0
 6011 0054 0649     		ldr	r1, .L659+12
 6012 0056 0322     		movs	r2, #3
 6013              	.LBE59:
 6014              	.LBE58:
 6015              	.LBE57:
2198:bluetooth_rxtx.c **** 	}
2199:bluetooth_rxtx.c **** }
 6016              		.loc 1 2199 0
 6017 0058 BDE83840 		pop	{r3, r4, r5, lr}
 6018              	.LBB62:
 6019              	.LBB61:
 6020              	.LBB60:
2197:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 6021              		.loc 1 2197 0
 6022 005c FFF7FEBF 		b	le_promisc_state
 6023              	.LVL611:
 6024              	.L654:
 6025 0060 38BD     		pop	{r3, r4, r5, pc}
 6026              	.L660:
 6027 0062 00BF     		.align	2
 6028              	.L659:
 6029 0064 00000000 		.word	.LANCHOR1
 6030 0068 00000000 		.word	.LANCHOR0
 6031 006c 00000000 		.word	promisc_recover_hop_interval
 6032 0070 0C000000 		.word	.LANCHOR1+12
 6033              	.LBE60:
 6034              	.LBE61:
 6035              	.LBE62:
 6036              		.cfi_endproc
 6037              	.LFE29:
 6039              		.section	.text.see_aa,"ax",%progbits
 6040              		.align	1
 6041              		.global	see_aa
 6042              		.thumb
 6043              		.thumb_func
 6045              	see_aa:
 6046              	.LFB30:
2200:bluetooth_rxtx.c **** 
2201:bluetooth_rxtx.c **** // called when we see an AA, add it to the list
ARM GAS  /tmp/cc1G6faT.s 			page 164


2202:bluetooth_rxtx.c **** void see_aa(u32 aa) {
 6047              		.loc 1 2202 0
 6048              		.cfi_startproc
 6049              		@ args = 0, pretend = 0, frame = 0
 6050              		@ frame_needed = 0, uses_anonymous_args = 0
 6051              	.LVL612:
 6052 0000 30B5     		push	{r4, r5, lr}
 6053              		.cfi_def_cfa_offset 12
 6054              		.cfi_offset 4, -12
 6055              		.cfi_offset 5, -8
 6056              		.cfi_offset 14, -4
 6057              	.LVL613:
2203:bluetooth_rxtx.c **** 	int i, max = -1, killme = -1;
2204:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
 6058              		.loc 1 2204 0
 6059 0002 0022     		movs	r2, #0
 6060              	.LVL614:
 6061              	.L665:
2205:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 6062              		.loc 1 2205 0
 6063 0004 144D     		ldr	r5, .L674
 6064 0006 55F83210 		ldr	r1, [r5, r2, lsl #3]
 6065 000a 05EBC203 		add	r3, r5, r2, lsl #3
 6066 000e 8142     		cmp	r1, r0
 6067 0010 02D1     		bne	.L662
2206:bluetooth_rxtx.c **** 			++le_promisc.active_aa[i].count;
 6068              		.loc 1 2206 0
 6069 0012 5A68     		ldr	r2, [r3, #4]
 6070              	.LVL615:
 6071 0014 0132     		adds	r2, r2, #1
 6072 0016 1CE0     		b	.L673
 6073              	.LVL616:
 6074              	.L662:
2204:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 6075              		.loc 1 2204 0
 6076 0018 0132     		adds	r2, r2, #1
 6077              	.LVL617:
 6078 001a 202A     		cmp	r2, #32
 6079 001c F2D1     		bne	.L665
 6080 001e 4FF0FF33 		mov	r3, #-1
 6081 0022 1946     		mov	r1, r3
 6082 0024 0022     		movs	r2, #0
 6083              	.LVL618:
 6084              	.L668:
 6085 0026 05EBC204 		add	r4, r5, r2, lsl #3
2207:bluetooth_rxtx.c **** 			return;
2208:bluetooth_rxtx.c **** 		}
2209:bluetooth_rxtx.c **** 
2210:bluetooth_rxtx.c **** 	// evict someone
2211:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
2212:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 6086              		.loc 1 2212 0
 6087 002a 6468     		ldr	r4, [r4, #4]
 6088 002c 8C42     		cmp	r4, r1
 6089 002e 05DB     		blt	.L669
 6090              		.loc 1 2212 0 is_stmt 0 discriminator 1
 6091 0030 0029     		cmp	r1, #0
ARM GAS  /tmp/cc1G6faT.s 			page 165


 6092 0032 A8BF     		it	ge
 6093 0034 0C46     		movge	r4, r1
 6094 0036 B8BF     		it	lt
 6095 0038 1346     		movlt	r3, r2
 6096              	.LVL619:
 6097 003a 00E0     		b	.L666
 6098              	.LVL620:
 6099              	.L669:
 6100 003c 1346     		mov	r3, r2
 6101              	.LVL621:
 6102              	.L666:
2211:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 6103              		.loc 1 2211 0 is_stmt 1
 6104 003e 0132     		adds	r2, r2, #1
 6105              	.LVL622:
 6106 0040 202A     		cmp	r2, #32
 6107 0042 01D0     		beq	.L667
 6108 0044 2146     		mov	r1, r4
 6109 0046 EEE7     		b	.L668
 6110              	.L667:
2213:bluetooth_rxtx.c **** 			killme = i;
2214:bluetooth_rxtx.c **** 			max = le_promisc.active_aa[i].count;
2215:bluetooth_rxtx.c **** 		}
2216:bluetooth_rxtx.c **** 
2217:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].aa = aa;
 6111              		.loc 1 2217 0
 6112 0048 45F83300 		str	r0, [r5, r3, lsl #3]
2218:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].count = 1;
 6113              		.loc 1 2218 0
 6114 004c 0122     		movs	r2, #1
 6115              	.LVL623:
 6116 004e 05EBC303 		add	r3, r5, r3, lsl #3
 6117              	.LVL624:
 6118              	.L673:
 6119 0052 5A60     		str	r2, [r3, #4]
 6120 0054 30BD     		pop	{r4, r5, pc}
 6121              	.L675:
 6122 0056 00BF     		.align	2
 6123              	.L674:
 6124 0058 00000000 		.word	le_promisc
 6125              		.cfi_endproc
 6126              	.LFE30:
 6128              		.section	.text.cb_le_promisc,"ax",%progbits
 6129              		.align	1
 6130              		.global	cb_le_promisc
 6131              		.thumb
 6132              		.thumb_func
 6134              	cb_le_promisc:
 6135              	.LFB31:
2219:bluetooth_rxtx.c **** }
2220:bluetooth_rxtx.c **** 
2221:bluetooth_rxtx.c **** /* le promiscuous mode */
2222:bluetooth_rxtx.c **** int cb_le_promisc(char *unpacked) {
 6136              		.loc 1 2222 0
 6137              		.cfi_startproc
 6138              		@ args = 0, pretend = 0, frame = 80
 6139              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/cc1G6faT.s 			page 166


 6140              	.LVL625:
 6141 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 6142              		.cfi_def_cfa_offset 28
 6143              		.cfi_offset 4, -28
 6144              		.cfi_offset 5, -24
 6145              		.cfi_offset 6, -20
 6146              		.cfi_offset 7, -16
 6147              		.cfi_offset 8, -12
 6148              		.cfi_offset 9, -8
 6149              		.cfi_offset 14, -4
 6150 0004 95B0     		sub	sp, sp, #84
 6151              		.cfi_def_cfa_offset 112
2223:bluetooth_rxtx.c **** 	int i, j, k;
2224:bluetooth_rxtx.c **** 	int idx;
2225:bluetooth_rxtx.c **** 
2226:bluetooth_rxtx.c **** 	// empty data PDU: 01 00
2227:bluetooth_rxtx.c **** 	char desired[4][16] = {
 6152              		.loc 1 2227 0
 6153 0006 0021     		movs	r1, #0
2222:bluetooth_rxtx.c **** 	int i, j, k;
 6154              		.loc 1 2222 0
 6155 0008 8046     		mov	r8, r0
 6156              		.loc 1 2227 0
 6157 000a 4022     		movs	r2, #64
 6158 000c 04A8     		add	r0, sp, #16
 6159              	.LVL626:
 6160 000e FFF7FEFF 		bl	memset
 6161              	.LVL627:
 6162 0012 0123     		movs	r3, #1
 6163 0014 8DF81030 		strb	r3, [sp, #16]
 6164 0018 8DF82030 		strb	r3, [sp, #32]
 6165 001c 8DF82330 		strb	r3, [sp, #35]
 6166 0020 8DF83030 		strb	r3, [sp, #48]
 6167 0024 8DF83230 		strb	r3, [sp, #50]
 6168 0028 8DF84030 		strb	r3, [sp, #64]
 6169 002c 8DF84230 		strb	r3, [sp, #66]
 6170 0030 8DF84330 		strb	r3, [sp, #67]
 6171              	.LVL628:
 6172 0034 14AD     		add	r5, sp, #80
 6173 0036 04AC     		add	r4, sp, #16
 6174              	.LVL629:
 6175              	.L680:
2228:bluetooth_rxtx.c **** 		{ 1, 0, 0, 0, 0, 0, 0, 0,
2229:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2230:bluetooth_rxtx.c **** 		{ 1, 0, 0, 1, 0, 0, 0, 0,
2231:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2232:bluetooth_rxtx.c **** 		{ 1, 0, 1, 0, 0, 0, 0, 0,
2233:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2234:bluetooth_rxtx.c **** 		{ 1, 0, 1, 1, 0, 0, 0, 0,
2235:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2236:bluetooth_rxtx.c **** 	};
2237:bluetooth_rxtx.c **** 
2238:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
2239:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 6176              		.loc 1 2239 0
 6177 0038 504E     		ldr	r6, .L712
 6178 003a 514F     		ldr	r7, .L712+4
ARM GAS  /tmp/cc1G6faT.s 			page 167


 6179 003c 3088     		ldrh	r0, [r6]
 6180 003e 80B2     		uxth	r0, r0
 6181 0040 6238     		subs	r0, r0, #98
 6182 0042 C0B2     		uxtb	r0, r0
 6183 0044 FFF7FEFF 		bl	btle_channel_index
 6184              	.LVL630:
 6185 0048 3A5C     		ldrb	r2, [r7, r0]	@ zero_extendqisi2
 6186              	.LVL631:
2240:bluetooth_rxtx.c **** 
2241:bluetooth_rxtx.c **** 		// whiten the desired data
2242:bluetooth_rxtx.c **** 		for (j = 0; j < (int)sizeof(desired[i]); ++j) {
 6187              		.loc 1 2242 0
 6188 004a 0023     		movs	r3, #0
 6189              	.LVL632:
 6190              	.L678:
2243:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6191              		.loc 1 2243 0 discriminator 2
 6192 004c B918     		adds	r1, r7, r2
 6193 004e E05C     		ldrb	r0, [r4, r3]	@ zero_extendqisi2
 6194 0050 91F82810 		ldrb	r1, [r1, #40]	@ zero_extendqisi2
2244:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 6195              		.loc 1 2244 0 discriminator 2
 6196 0054 0132     		adds	r2, r2, #1
 6197              	.LVL633:
2243:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6198              		.loc 1 2243 0 discriminator 2
 6199 0056 4140     		eors	r1, r1, r0
 6200 0058 E154     		strb	r1, [r4, r3]
 6201              		.loc 1 2244 0 discriminator 2
 6202 005a 7F21     		movs	r1, #127
2242:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6203              		.loc 1 2242 0 discriminator 2
 6204 005c 0133     		adds	r3, r3, #1
 6205              	.LVL634:
 6206              		.loc 1 2244 0 discriminator 2
 6207 005e B2FBF1F0 		udiv	r0, r2, r1
2242:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6208              		.loc 1 2242 0 discriminator 2
 6209 0062 102B     		cmp	r3, #16
 6210              		.loc 1 2244 0 discriminator 2
 6211 0064 01FB1022 		mls	r2, r1, r0, r2
 6212              	.LVL635:
2242:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6213              		.loc 1 2242 0 discriminator 2
 6214 0068 F0D1     		bne	.L678
 6215 006a 1034     		adds	r4, r4, #16
2238:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 6216              		.loc 1 2238 0
 6217 006c AC42     		cmp	r4, r5
 6218 006e E3D1     		bne	.L680
 6219 0070 08F12005 		add	r5, r8, #32
 6220 0074 08F53C78 		add	r8, r8, #752
 6221              	.LVL636:
 6222              	.L696:
 6223              	.LBB63:
2245:bluetooth_rxtx.c **** 		}
2246:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/cc1G6faT.s 			page 168


2247:bluetooth_rxtx.c **** 
2248:bluetooth_rxtx.c **** 	// then look for that bitsream in our receive buffer
2249:bluetooth_rxtx.c **** 	for (i = 32; i < (DMA_SIZE*8*2 - 32 - 16); i++) {
2250:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 6224              		.loc 1 2250 0
 6225 0078 424B     		ldr	r3, .L712+8
 6226 007a 6C46     		mov	r4, sp
 6227 007c 0FCB     		ldmia	r3, {r0, r1, r2, r3}
 6228 007e 8DE80F00 		stmia	sp, {r0, r1, r2, r3}
 6229              	.LVL637:
 6230 0082 0022     		movs	r2, #0
 6231              	.LVL638:
 6232              	.L681:
 6233 0084 04AB     		add	r3, sp, #16
 6234 0086 03EB8201 		add	r1, r3, r2, lsl #2
 6235              	.LBE63:
2242:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6236              		.loc 1 2242 0 discriminator 1
 6237 008a 0023     		movs	r3, #0
 6238              	.LVL639:
 6239              	.L686:
 6240              	.LBB68:
2251:bluetooth_rxtx.c **** 		int matching = -1;
2252:bluetooth_rxtx.c **** 
2253:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
2254:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
2255:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 6241              		.loc 1 2255 0
 6242 008c 15F803C0 		ldrb	ip, [r5, r3]	@ zero_extendqisi2
 6243 0090 C85C     		ldrb	r0, [r1, r3]	@ zero_extendqisi2
 6244 0092 8445     		cmp	ip, r0
 6245 0094 02D0     		beq	.L682
2256:bluetooth_rxtx.c **** 					ok[j] = 0;
 6246              		.loc 1 2256 0
 6247 0096 0023     		movs	r3, #0
 6248              	.LVL640:
 6249 0098 A350     		str	r3, [r4, r2]
2257:bluetooth_rxtx.c **** 					break;
 6250              		.loc 1 2257 0
 6251 009a 02E0     		b	.L683
 6252              	.LVL641:
 6253              	.L682:
2254:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 6254              		.loc 1 2254 0
 6255 009c 0133     		adds	r3, r3, #1
 6256              	.LVL642:
 6257 009e 102B     		cmp	r3, #16
 6258 00a0 F4D1     		bne	.L686
 6259              	.LVL643:
 6260              	.L683:
 6261 00a2 0432     		adds	r2, r2, #4
2253:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 6262              		.loc 1 2253 0
 6263 00a4 102A     		cmp	r2, #16
 6264 00a6 EDD1     		bne	.L681
 6265 00a8 0023     		movs	r3, #0
 6266              	.L689:
ARM GAS  /tmp/cc1G6faT.s 			page 169


2258:bluetooth_rxtx.c **** 				}
2259:bluetooth_rxtx.c **** 			}
2260:bluetooth_rxtx.c **** 		}
2261:bluetooth_rxtx.c **** 
2262:bluetooth_rxtx.c **** 		// see if any match
2263:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
2264:bluetooth_rxtx.c **** 			if (ok[j]) {
 6267              		.loc 1 2264 0
 6268 00aa E258     		ldr	r2, [r4, r3]
 6269 00ac 1AB9     		cbnz	r2, .L687
 6270 00ae 0433     		adds	r3, r3, #4
2263:bluetooth_rxtx.c **** 			if (ok[j]) {
 6271              		.loc 1 2263 0
 6272 00b0 102B     		cmp	r3, #16
 6273 00b2 FAD1     		bne	.L689
 6274 00b4 3EE0     		b	.L700
 6275              	.L687:
 6276              	.LVL644:
2265:bluetooth_rxtx.c **** 				matching = j;
2266:bluetooth_rxtx.c **** 				break;
2267:bluetooth_rxtx.c **** 			}
2268:bluetooth_rxtx.c **** 		}
2269:bluetooth_rxtx.c **** 
2270:bluetooth_rxtx.c **** 		// skip if no match
2271:bluetooth_rxtx.c **** 		if (matching < 0)
2272:bluetooth_rxtx.c **** 			continue;
2273:bluetooth_rxtx.c **** 
2274:bluetooth_rxtx.c **** 		// found a match! unwhiten it and send it home
2275:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 6277              		.loc 1 2275 0
 6278 00b6 3088     		ldrh	r0, [r6]
 6279 00b8 80B2     		uxth	r0, r0
 6280 00ba 6238     		subs	r0, r0, #98
 6281 00bc C0B2     		uxtb	r0, r0
 6282 00be FFF7FEFF 		bl	btle_channel_index
 6283              	.LVL645:
 6284 00c2 385C     		ldrb	r0, [r7, r0]	@ zero_extendqisi2
 6285              	.LVL646:
2276:bluetooth_rxtx.c **** 		for (j = 0; j < 4+3+3; ++j) {
 6286              		.loc 1 2276 0
 6287 00c4 0023     		movs	r3, #0
 6288              	.LVL647:
 6289              	.L701:
2253:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 6290              		.loc 1 2253 0 discriminator 1
 6291 00c6 0021     		movs	r1, #0
 6292 00c8 05EBC30C 		add	ip, r5, r3, lsl #3
 6293 00cc 0A46     		mov	r2, r1
 6294              	.LVL648:
 6295              	.L694:
 6296 00ce 0CEB0204 		add	r4, ip, r2
 6297              	.LBB64:
 6298              	.LBB65:
2277:bluetooth_rxtx.c **** 			u8 byte = 0;
2278:bluetooth_rxtx.c **** 			for (k = 0; k < 8; k++) {
2279:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
2280:bluetooth_rxtx.c **** 				if (offset >= DMA_SIZE*8*2) break;
ARM GAS  /tmp/cc1G6faT.s 			page 170


2281:bluetooth_rxtx.c **** 				int bit = unpacked[offset];
2282:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 6299              		.loc 1 2282 0
 6300 00d2 032B     		cmp	r3, #3
2281:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 6301              		.loc 1 2281 0
 6302 00d4 14F8204C 		ldrb	r4, [r4, #-32]	@ zero_extendqisi2
 6303              	.LVL649:
 6304              		.loc 1 2282 0
 6305 00d8 0CDD     		ble	.L691
2283:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 6306              		.loc 1 2283 0
 6307 00da 07EB000E 		add	lr, r7, r0
 6308 00de 9EF828E0 		ldrb	lr, [lr, #40]	@ zero_extendqisi2
2284:bluetooth_rxtx.c **** 					idx = (idx + 1) % sizeof(whitening);
 6309              		.loc 1 2284 0
 6310 00e2 0130     		adds	r0, r0, #1
 6311              	.LVL650:
2283:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 6312              		.loc 1 2283 0
 6313 00e4 84EA0E04 		eor	r4, r4, lr
 6314              	.LVL651:
 6315              		.loc 1 2284 0
 6316 00e8 4FF07F0E 		mov	lr, #127
 6317 00ec B0FBFEF9 		udiv	r9, r0, lr
 6318 00f0 0EFB1900 		mls	r0, lr, r9, r0
 6319              	.LVL652:
 6320              	.L691:
2285:bluetooth_rxtx.c **** 				}
2286:bluetooth_rxtx.c **** 				byte |= bit << k;
 6321              		.loc 1 2286 0
 6322 00f4 9440     		lsls	r4, r4, r2
 6323              	.LVL653:
 6324              	.LBE65:
2278:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 6325              		.loc 1 2278 0
 6326 00f6 0132     		adds	r2, r2, #1
 6327              	.LVL654:
 6328              	.LBB66:
 6329              		.loc 1 2286 0
 6330 00f8 2143     		orrs	r1, r1, r4
 6331              	.LVL655:
 6332              	.LBE66:
2278:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 6333              		.loc 1 2278 0
 6334 00fa 082A     		cmp	r2, #8
 6335              	.LBB67:
 6336              		.loc 1 2286 0
 6337 00fc C9B2     		uxtb	r1, r1
 6338              	.LVL656:
 6339              	.LBE67:
2278:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 6340              		.loc 1 2278 0
 6341 00fe E6D1     		bne	.L694
2287:bluetooth_rxtx.c **** 			}
2288:bluetooth_rxtx.c **** 			idle_rxbuf[j] = byte;
 6342              		.loc 1 2288 0
ARM GAS  /tmp/cc1G6faT.s 			page 171


 6343 0100 214C     		ldr	r4, .L712+12
 6344 0102 2268     		ldr	r2, [r4]
 6345              	.LVL657:
 6346 0104 D154     		strb	r1, [r2, r3]
 6347              	.LBE64:
2276:bluetooth_rxtx.c **** 			u8 byte = 0;
 6348              		.loc 1 2276 0
 6349 0106 0133     		adds	r3, r3, #1
 6350              	.LVL658:
 6351 0108 0A2B     		cmp	r3, #10
 6352 010a DCD1     		bne	.L701
2289:bluetooth_rxtx.c **** 		}
2290:bluetooth_rxtx.c **** 
2291:bluetooth_rxtx.c **** 		u32 aa = (idle_rxbuf[3] << 24) |
 6353              		.loc 1 2291 0
 6354 010c 2368     		ldr	r3, [r4]
 6355              	.LVL659:
 6356 010e D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 6357              	.LVL660:
2292:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 6358              		.loc 1 2292 0
 6359 0110 2368     		ldr	r3, [r4]
 6360 0112 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
2293:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 6361              		.loc 1 2293 0
 6362 0114 2268     		ldr	r2, [r4]
2292:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 6363              		.loc 1 2292 0
 6364 0116 1B04     		lsls	r3, r3, #16
 6365              		.loc 1 2293 0
 6366 0118 5078     		ldrb	r0, [r2, #1]	@ zero_extendqisi2
 6367              	.LVL661:
2294:bluetooth_rxtx.c **** 				 (idle_rxbuf[0]);
 6368              		.loc 1 2294 0
 6369 011a 2268     		ldr	r2, [r4]
2291:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 6370              		.loc 1 2291 0
 6371 011c 43EA0163 		orr	r3, r3, r1, lsl #24
 6372              		.loc 1 2294 0
 6373 0120 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 6374              	.LVL662:
2292:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 6375              		.loc 1 2292 0
 6376 0122 1343     		orrs	r3, r3, r2
2295:bluetooth_rxtx.c **** 		see_aa(aa);
 6377              		.loc 1 2295 0
 6378 0124 43EA0020 		orr	r0, r3, r0, lsl #8
 6379 0128 FFF7FEFF 		bl	see_aa
 6380              	.LVL663:
2296:bluetooth_rxtx.c **** 
2297:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
 6381              		.loc 1 2297 0
 6382 012c 2168     		ldr	r1, [r4]
 6383 012e 0120     		movs	r0, #1
 6384 0130 FFF7FEFF 		bl	enqueue
 6385              	.LVL664:
 6386              	.L700:
ARM GAS  /tmp/cc1G6faT.s 			page 172


 6387 0134 0135     		adds	r5, r5, #1
 6388              	.LVL665:
 6389              	.LBE68:
2249:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 6390              		.loc 1 2249 0
 6391 0136 4545     		cmp	r5, r8
 6392 0138 9ED1     		bne	.L696
 6393 013a 0023     		movs	r3, #0
 6394              	.LVL666:
 6395              	.L699:
 6396 013c 134A     		ldr	r2, .L712+16
 6397 013e 02EBC301 		add	r1, r2, r3, lsl #3
2298:bluetooth_rxtx.c **** 
2299:bluetooth_rxtx.c **** 	}
2300:bluetooth_rxtx.c **** 
2301:bluetooth_rxtx.c **** 	// once we see an AA 5 times, start following it
2302:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i) {
2303:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 6398              		.loc 1 2303 0
 6399 0142 4968     		ldr	r1, [r1, #4]
 6400 0144 0329     		cmp	r1, #3
 6401 0146 11DD     		ble	.L697
2304:bluetooth_rxtx.c **** 			le_set_access_address(le_promisc.active_aa[i].aa);
 6402              		.loc 1 2304 0
 6403 0148 52F83300 		ldr	r0, [r2, r3, lsl #3]
 6404 014c FFF7FEFF 		bl	le_set_access_address
 6405              	.LVL667:
2305:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 6406              		.loc 1 2305 0
 6407 0150 0F4B     		ldr	r3, .L712+20
 6408 0152 104A     		ldr	r2, .L712+24
2306:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
2307:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 6409              		.loc 1 2307 0
 6410 0154 0024     		movs	r4, #0
2305:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 6411              		.loc 1 2305 0
 6412 0156 DA62     		str	r2, [r3, #44]
2306:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 6413              		.loc 1 2306 0
 6414 0158 0F4A     		ldr	r2, .L712+28
2308:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 6415              		.loc 1 2308 0
 6416 015a 2046     		mov	r0, r4
2306:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 6417              		.loc 1 2306 0
 6418 015c 9A61     		str	r2, [r3, #24]
 6419              		.loc 1 2308 0
 6420 015e 0F49     		ldr	r1, .L712+32
 6421 0160 0422     		movs	r2, #4
2307:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 6422              		.loc 1 2307 0
 6423 0162 7461     		str	r4, [r6, #20]
 6424              		.loc 1 2308 0
 6425 0164 FFF7FEFF 		bl	le_promisc_state
 6426              	.LVL668:
2309:bluetooth_rxtx.c **** 			// quit using the old stuff and switch to sync mode
ARM GAS  /tmp/cc1G6faT.s 			page 173


2310:bluetooth_rxtx.c **** 			return 0;
 6427              		.loc 1 2310 0
 6428 0168 2046     		mov	r0, r4
 6429 016a 03E0     		b	.L711
 6430              	.LVL669:
 6431              	.L697:
2302:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 6432              		.loc 1 2302 0
 6433 016c 0133     		adds	r3, r3, #1
 6434              	.LVL670:
 6435 016e 202B     		cmp	r3, #32
 6436 0170 E4D1     		bne	.L699
2311:bluetooth_rxtx.c **** 		}
2312:bluetooth_rxtx.c **** 	}
2313:bluetooth_rxtx.c **** 
2314:bluetooth_rxtx.c **** 	return 1;
 6437              		.loc 1 2314 0
 6438 0172 0120     		movs	r0, #1
 6439              	.LVL671:
 6440              	.L711:
2315:bluetooth_rxtx.c **** }
 6441              		.loc 1 2315 0
 6442 0174 15B0     		add	sp, sp, #84
 6443              		@ sp needed
 6444 0176 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 6445              	.LVL672:
 6446              	.L713:
 6447 017a 00BF     		.align	2
 6448              	.L712:
 6449 017c 00000000 		.word	.LANCHOR1
 6450 0180 00000000 		.word	.LANCHOR2
 6451 0184 98080000 		.word	.LANCHOR2+2200
 6452 0188 00000000 		.word	idle_rxbuf
 6453 018c 00000000 		.word	le_promisc
 6454 0190 00000000 		.word	.LANCHOR0
 6455 0194 00000000 		.word	cb_follow_le
 6456 0198 00000000 		.word	promisc_follow_cb
 6457 019c 04000000 		.word	.LANCHOR1+4
 6458              		.cfi_endproc
 6459              	.LFE31:
 6461              		.section	.text.bt_promisc_le,"ax",%progbits
 6462              		.align	1
 6463              		.global	bt_promisc_le
 6464              		.thumb
 6465              		.thumb_func
 6467              	bt_promisc_le:
 6468              	.LFB32:
2316:bluetooth_rxtx.c **** 
2317:bluetooth_rxtx.c **** void bt_promisc_le() {
 6469              		.loc 1 2317 0
 6470              		.cfi_startproc
 6471              		@ args = 0, pretend = 0, frame = 0
 6472              		@ frame_needed = 0, uses_anonymous_args = 0
 6473 0000 38B5     		push	{r3, r4, r5, lr}
 6474              		.cfi_def_cfa_offset 16
 6475              		.cfi_offset 3, -16
 6476              		.cfi_offset 4, -12
ARM GAS  /tmp/cc1G6faT.s 			page 174


 6477              		.cfi_offset 5, -8
 6478              		.cfi_offset 14, -4
 6479              	.L715:
2318:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_PROMISC_LE) {
 6480              		.loc 1 2318 0 discriminator 1
 6481 0002 164D     		ldr	r5, .L724
 6482 0004 AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
 6483 0006 0A2B     		cmp	r3, #10
 6484 0008 26D1     		bne	.L714
2319:bluetooth_rxtx.c **** 		reset_le_promisc();
2320:bluetooth_rxtx.c **** 
2321:bluetooth_rxtx.c **** 		// jump to a random data channel and turn up the squelch
2322:bluetooth_rxtx.c **** 		if ((channel & 1) == 1)
 6485              		.loc 1 2322 0
 6486 000a 154C     		ldr	r4, .L724+4
2319:bluetooth_rxtx.c **** 		reset_le_promisc();
 6487              		.loc 1 2319 0
 6488 000c FFF7FEFF 		bl	reset_le_promisc
 6489              	.LVL673:
 6490              		.loc 1 2322 0
 6491 0010 2388     		ldrh	r3, [r4]
 6492 0012 DA07     		lsls	r2, r3, #31
2323:bluetooth_rxtx.c **** 			channel = 2440;
 6493              		.loc 1 2323 0
 6494 0014 44BF     		itt	mi
 6495 0016 40F68813 		movwmi	r3, #2440
 6496 001a 2380     		strhmi	r3, [r4]	@ movhi
2324:bluetooth_rxtx.c **** 
2325:bluetooth_rxtx.c **** 		// if the PC hasn't given us AA, determine by listening
2326:bluetooth_rxtx.c **** 		if (!le.target_set) {
 6497              		.loc 1 2326 0
 6498 001c 236C     		ldr	r3, [r4, #64]
 6499 001e 4BB9     		cbnz	r3, .L717
2327:bluetooth_rxtx.c **** 			// cs_threshold_req = -80;
2328:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
 6500              		.loc 1 2328 0
 6501 0020 0F4B     		ldr	r3, .L724+4
 6502 0022 1888     		ldrh	r0, [r3]
 6503 0024 80B2     		uxth	r0, r0
 6504 0026 FFF7FEFF 		bl	cs_threshold_calc_and_set
 6505              	.LVL674:
2329:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 6506              		.loc 1 2329 0
 6507 002a 0E4B     		ldr	r3, .L724+8
2330:bluetooth_rxtx.c **** 			bt_generic_le(MODE_BT_PROMISC_LE);
 6508              		.loc 1 2330 0
 6509 002c 0A20     		movs	r0, #10
2329:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 6510              		.loc 1 2329 0
 6511 002e EB62     		str	r3, [r5, #44]
 6512              		.loc 1 2330 0
 6513 0030 FFF7FEFF 		bl	bt_generic_le
 6514              	.LVL675:
 6515              	.L717:
2331:bluetooth_rxtx.c **** 		}
2332:bluetooth_rxtx.c **** 
2333:bluetooth_rxtx.c **** 		// could have got mode change in middle of above
ARM GAS  /tmp/cc1G6faT.s 			page 175


2334:bluetooth_rxtx.c **** 		if (requested_mode != MODE_BT_PROMISC_LE)
 6516              		.loc 1 2334 0
 6517 0034 AD7C     		ldrb	r5, [r5, #18]	@ zero_extendqisi2
 6518 0036 EDB2     		uxtb	r5, r5
 6519 0038 0A2D     		cmp	r5, #10
 6520 003a 0DD1     		bne	.L714
2335:bluetooth_rxtx.c **** 			break;
2336:bluetooth_rxtx.c **** 
2337:bluetooth_rxtx.c **** 		le_promisc_state(0, &le.access_address, 4);
 6521              		.loc 1 2337 0
 6522 003c 0020     		movs	r0, #0
 6523 003e 0A49     		ldr	r1, .L724+12
 6524 0040 0422     		movs	r2, #4
 6525 0042 FFF7FEFF 		bl	le_promisc_state
 6526              	.LVL676:
2338:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 6527              		.loc 1 2338 0
 6528 0046 094A     		ldr	r2, .L724+16
 6529 0048 044B     		ldr	r3, .L724
2339:bluetooth_rxtx.c **** 		le.crc_verify = 0;
2340:bluetooth_rxtx.c **** 		bt_le_sync(MODE_BT_PROMISC_LE);
 6530              		.loc 1 2340 0
 6531 004a 2846     		mov	r0, r5
2338:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 6532              		.loc 1 2338 0
 6533 004c 9A61     		str	r2, [r3, #24]
2339:bluetooth_rxtx.c **** 		le.crc_verify = 0;
 6534              		.loc 1 2339 0
 6535 004e 0023     		movs	r3, #0
 6536 0050 6361     		str	r3, [r4, #20]
 6537              		.loc 1 2340 0
 6538 0052 FFF7FEFF 		bl	bt_le_sync
 6539              	.LVL677:
 6540 0056 D4E7     		b	.L715
 6541              	.L714:
 6542 0058 38BD     		pop	{r3, r4, r5, pc}
 6543              	.L725:
 6544 005a 00BF     		.align	2
 6545              	.L724:
 6546 005c 00000000 		.word	.LANCHOR0
 6547 0060 00000000 		.word	.LANCHOR1
 6548 0064 00000000 		.word	cb_le_promisc
 6549 0068 04000000 		.word	.LANCHOR1+4
 6550 006c 00000000 		.word	promisc_follow_cb
 6551              		.cfi_endproc
 6552              	.LFE32:
 6554              		.section	.text.bt_slave_le,"ax",%progbits
 6555              		.align	1
 6556              		.global	bt_slave_le
 6557              		.thumb
 6558              		.thumb_func
 6560              	bt_slave_le:
 6561              	.LFB33:
2341:bluetooth_rxtx.c **** 	}
2342:bluetooth_rxtx.c **** }
2343:bluetooth_rxtx.c **** 
2344:bluetooth_rxtx.c **** void bt_slave_le(u16 tx_pwr) {
ARM GAS  /tmp/cc1G6faT.s 			page 176


 6562              		.loc 1 2344 0
 6563              		.cfi_startproc
 6564              		@ args = 0, pretend = 0, frame = 48
 6565              		@ frame_needed = 0, uses_anonymous_args = 0
 6566              	.LVL678:
 6567 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 6568              		.cfi_def_cfa_offset 36
 6569              		.cfi_offset 4, -36
 6570              		.cfi_offset 5, -32
 6571              		.cfi_offset 6, -28
 6572              		.cfi_offset 7, -24
 6573              		.cfi_offset 8, -20
 6574              		.cfi_offset 9, -16
 6575              		.cfi_offset 10, -12
 6576              		.cfi_offset 11, -8
 6577              		.cfi_offset 14, -4
 6578 0004 8FB0     		sub	sp, sp, #60
 6579              		.cfi_def_cfa_offset 96
 6580              	.LVL679:
2345:bluetooth_rxtx.c **** 	u32 calc_crc;
2346:bluetooth_rxtx.c **** 	int i, j;
2347:bluetooth_rxtx.c **** 	int num_adv_ind = 1;
2348:bluetooth_rxtx.c **** 	int fin_adv_len = 0;
2349:bluetooth_rxtx.c **** 	u8 **adv_ind;
2350:bluetooth_rxtx.c **** 	u8 adv_ind_len;
2351:bluetooth_rxtx.c **** 	u16 ch[] = {2402, 2426, 2480};
 6581              		.loc 1 2351 0
 6582 0006 9049     		ldr	r1, .L792
2344:bluetooth_rxtx.c **** 	u32 calc_crc;
 6583              		.loc 1 2344 0
 6584 0008 8246     		mov	r10, r0
 6585              		.loc 1 2351 0
 6586 000a 8B88     		ldrh	r3, [r1, #4]	@ unaligned
 6587 000c 0868     		ldr	r0, [r1]	@ unaligned
 6588              	.LVL680:
 6589 000e ADF82030 		strh	r3, [sp, #32]	@ unaligned
 6590 0012 0790     		str	r0, [sp, #28]	@ unaligned
2352:bluetooth_rxtx.c **** 
2353:bluetooth_rxtx.c **** 	u8 adv_overhead[20] = {0x42, 0x1d,	// adv_nonconn_ind, length 29 (__01 1101)
 6591              		.loc 1 2353 0
 6592 0014 8B1D     		adds	r3, r1, #6
 6593 0016 09AA     		add	r2, sp, #36
 6594 0018 01F11605 		add	r5, r1, #22
 6595              	.L727:
 6596 001c 1868     		ldr	r0, [r3]	@ unaligned
 6597 001e 5968     		ldr	r1, [r3, #4]	@ unaligned
 6598 0020 1446     		mov	r4, r2
 6599 0022 03C4     		stmia	r4!, {r0, r1}
 6600 0024 0833     		adds	r3, r3, #8
 6601 0026 AB42     		cmp	r3, r5
 6602 0028 2246     		mov	r2, r4
 6603 002a F7D1     		bne	.L727
 6604 002c 1868     		ldr	r0, [r3]	@ unaligned
2354:bluetooth_rxtx.c **** 						   0xff, 0xff, 0xff, 0xff, 0xff, 0xff, // adv mac address
2355:bluetooth_rxtx.c **** 						   0x03, 0x03, 0xaa, 0xfe, // service advertised - len, type, eddystone UUID
2356:bluetooth_rxtx.c **** 						   0x12, 0x16, 0xaa, 0xfe, // len(3 + URL frame + Eddystone URL), type, eddystone UUID
2357:bluetooth_rxtx.c **** 						   0x10, 0x00, 0x02, // URL frame - frametype(URL), tx power, URL scheme prefix (0x02: http:/
ARM GAS  /tmp/cc1G6faT.s 			page 177


2358:bluetooth_rxtx.c **** 						   0xaa }; // preamble 0xaa
2359:bluetooth_rxtx.c **** 
2360:bluetooth_rxtx.c **** 	for (i = 0; i < 6; i++)
2361:bluetooth_rxtx.c **** 		slave_mac_address[i] = slave_mac_address_data[i];
 6605              		.loc 1 2361 0
 6606 002e 874A     		ldr	r2, .L792+4
2353:bluetooth_rxtx.c **** 						   0xff, 0xff, 0xff, 0xff, 0xff, 0xff, // adv mac address
 6607              		.loc 1 2353 0
 6608 0030 2060     		str	r0, [r4]	@ unaligned
 6609              	.LVL681:
 6610              		.loc 1 2361 0
 6611 0032 1468     		ldr	r4, [r2]
2360:bluetooth_rxtx.c **** 		slave_mac_address[i] = slave_mac_address_data[i];
 6612              		.loc 1 2360 0
 6613 0034 0023     		movs	r3, #0
 6614 0036 9346     		mov	fp, r2
 6615              	.LVL682:
 6616              	.L729:
 6617              		.loc 1 2361 0 discriminator 2
 6618 0038 854A     		ldr	r2, .L792+8
 6619 003a E05C     		ldrb	r0, [r4, r3]	@ zero_extendqisi2
 6620 003c 02F12401 		add	r1, r2, #36
 6621 0040 5854     		strb	r0, [r3, r1]
2360:bluetooth_rxtx.c **** 		slave_mac_address[i] = slave_mac_address_data[i];
 6622              		.loc 1 2360 0 discriminator 2
 6623 0042 0133     		adds	r3, r3, #1
 6624              	.LVL683:
 6625 0044 062B     		cmp	r3, #6
 6626 0046 9046     		mov	r8, r2
 6627 0048 F6D1     		bne	.L729
2362:bluetooth_rxtx.c **** 
2363:bluetooth_rxtx.c **** 	// Standards said maximum advertising channel PDU length 39 bytes (adv payload 19 + 1 (preamble))
2364:bluetooth_rxtx.c **** 	// There's a probem, actual maximum length 34 bytes (adv payload 14 + 1 (preamble)) in ubertooth
2365:bluetooth_rxtx.c **** 	// Nexsus 5 smartphone can not receive BLE packet which has length over 31 bytes (adv payload 11 +
2366:bluetooth_rxtx.c **** 	fin_adv_len = (dlen-6) % 11;
 6628              		.loc 1 2366 0
 6629 004a 126A     		ldr	r2, [r2, #32]
 6630 004c 0B23     		movs	r3, #11
 6631              	.LVL684:
 6632 004e 971F     		subs	r7, r2, #6
 6633 0050 97FBF3F6 		sdiv	r6, r7, r3
2367:bluetooth_rxtx.c **** 	if (dlen > 11 + 6) {
 6634              		.loc 1 2367 0
 6635 0054 112A     		cmp	r2, #17
2366:bluetooth_rxtx.c **** 	if (dlen > 11 + 6) {
 6636              		.loc 1 2366 0
 6637 0056 03FB1677 		mls	r7, r3, r6, r7
 6638              	.LVL685:
 6639              		.loc 1 2367 0
 6640 005a 02DD     		ble	.L753
 6641              	.LVL686:
2368:bluetooth_rxtx.c **** 		num_adv_ind = (dlen-6)/11 + 1;
2369:bluetooth_rxtx.c **** 		fin_adv_len = (dlen-6) % 11;
2370:bluetooth_rxtx.c **** 		if (fin_adv_len == 0) {
 6642              		.loc 1 2370 0
 6643 005c 1FB1     		cbz	r7, .L754
2368:bluetooth_rxtx.c **** 		num_adv_ind = (dlen-6)/11 + 1;
ARM GAS  /tmp/cc1G6faT.s 			page 178


 6644              		.loc 1 2368 0
 6645 005e 0136     		adds	r6, r6, #1
 6646              	.LVL687:
 6647 0060 02E0     		b	.L730
 6648              	.LVL688:
 6649              	.L753:
2347:bluetooth_rxtx.c **** 	int fin_adv_len = 0;
 6650              		.loc 1 2347 0
 6651 0062 0126     		movs	r6, #1
 6652 0064 00E0     		b	.L730
 6653              	.LVL689:
 6654              	.L754:
2371:bluetooth_rxtx.c **** 			fin_adv_len = 11;
 6655              		.loc 1 2371 0
 6656 0066 1F46     		mov	r7, r3
 6657              	.LVL690:
 6658              	.L730:
2372:bluetooth_rxtx.c **** 			num_adv_ind = num_adv_ind - 1;}
2373:bluetooth_rxtx.c **** 	}
2374:bluetooth_rxtx.c **** 
2375:bluetooth_rxtx.c **** 	adv_ind = (u8**) malloc(sizeof(u8*)*num_adv_ind);
 6659              		.loc 1 2375 0
 6660 0068 B500     		lsls	r5, r6, #2
 6661 006a 2846     		mov	r0, r5
 6662 006c FFF7FEFF 		bl	malloc
 6663              	.LVL691:
2376:bluetooth_rxtx.c **** 	for (i=0; i< num_adv_ind-1; i++) {
 6664              		.loc 1 2376 0
 6665 0070 0023     		movs	r3, #0
2375:bluetooth_rxtx.c **** 	for (i=0; i< num_adv_ind-1; i++) {
 6666              		.loc 1 2375 0
 6667 0072 0446     		mov	r4, r0
 6668              	.LVL692:
 6669              	.L731:
 6670              		.loc 1 2376 0 discriminator 1
 6671 0074 06F1FF39 		add	r9, r6, #-1
 6672 0078 4B45     		cmp	r3, r9
 6673 007a 08DA     		bge	.L788
2377:bluetooth_rxtx.c **** 		adv_ind[i] = (u8*) malloc(sizeof(u8)*31);
 6674              		.loc 1 2377 0 discriminator 2
 6675 007c 1F20     		movs	r0, #31
 6676 007e 0293     		str	r3, [sp, #8]
 6677 0080 FFF7FEFF 		bl	malloc
 6678              	.LVL693:
 6679 0084 029B     		ldr	r3, [sp, #8]
 6680 0086 44F82300 		str	r0, [r4, r3, lsl #2]
2376:bluetooth_rxtx.c **** 	for (i=0; i< num_adv_ind-1; i++) {
 6681              		.loc 1 2376 0 discriminator 2
 6682 008a 0133     		adds	r3, r3, #1
 6683              	.LVL694:
 6684 008c F2E7     		b	.L731
 6685              	.L788:
2378:bluetooth_rxtx.c **** 	}
2379:bluetooth_rxtx.c **** 	adv_ind[num_adv_ind-1] = (u8*) malloc(sizeof(u8)*(fin_adv_len + 1 + 3 + 4 + 4 + 6 + 2 + 3));
 6686              		.loc 1 2379 0
 6687 008e 07F11700 		add	r0, r7, #23
 6688 0092 FFF7FEFF 		bl	malloc
ARM GAS  /tmp/cc1G6faT.s 			page 179


 6689              	.LVL695:
 6690 0096 043D     		subs	r5, r5, #4
 6691 0098 6051     		str	r0, [r4, r5]
 6692              	.LVL696:
2380:bluetooth_rxtx.c **** 
2381:bluetooth_rxtx.c **** 	for (i=0; i< num_adv_ind; i++) {
 6693              		.loc 1 2381 0
 6694 009a 0025     		movs	r5, #0
 6695 009c 2B46     		mov	r3, r5
 6696              	.LVL697:
 6697              	.L733:
 6698              		.loc 1 2381 0 is_stmt 0 discriminator 1
 6699 009e B342     		cmp	r3, r6
 6700 00a0 6FDA     		bge	.L742
 6701              		.loc 1 2381 0
 6702 00a2 0022     		movs	r2, #0
 6703              	.L743:
 6704              	.LVL698:
2382:bluetooth_rxtx.c **** 		for (j=0; j<20; j++) adv_ind[i][j] = adv_overhead[j];
 6705              		.loc 1 2382 0 is_stmt 1 discriminator 2
 6706 00a4 0DF1240E 		add	lr, sp, #36
 6707 00a8 1EF80200 		ldrb	r0, [lr, r2]	@ zero_extendqisi2
 6708 00ac 6159     		ldr	r1, [r4, r5]
 6709 00ae 8854     		strb	r0, [r1, r2]
 6710 00b0 0132     		adds	r2, r2, #1
 6711              	.LVL699:
 6712 00b2 142A     		cmp	r2, #20
 6713 00b4 F6D1     		bne	.L743
 6714              		.loc 1 2382 0 is_stmt 0
 6715 00b6 0522     		movs	r2, #5
 6716              	.LVL700:
 6717              	.L736:
2383:bluetooth_rxtx.c **** 		for (j=0; j<6; j++) adv_ind[i][j+2] = slave_mac_address[5-j];
 6718              		.loc 1 2383 0 is_stmt 1 discriminator 2
 6719 00b8 6649     		ldr	r1, .L792+12
 6720 00ba C2F10700 		rsb	r0, r2, #7
 6721 00be 12F801E0 		ldrb	lr, [r2, r1]	@ zero_extendqisi2
 6722 00c2 6159     		ldr	r1, [r4, r5]
 6723 00c4 12F1FF32 		adds	r2, r2, #-1
 6724              	.LVL701:
 6725 00c8 01F800E0 		strb	lr, [r1, r0]
 6726              	.LVL702:
 6727 00cc F4D2     		bcs	.L736
2384:bluetooth_rxtx.c **** 		adv_ind[i][17] = (u8) num_adv_ind;
 6728              		.loc 1 2384 0
 6729 00ce 6259     		ldr	r2, [r4, r5]
2385:bluetooth_rxtx.c **** 		adv_ind[i][19] = adv_overhead[19] + (u8) i;
 6730              		.loc 1 2385 0
 6731 00d0 9DF83710 		ldrb	r1, [sp, #55]	@ zero_extendqisi2
2384:bluetooth_rxtx.c **** 		adv_ind[i][17] = (u8) num_adv_ind;
 6732              		.loc 1 2384 0
 6733 00d4 5674     		strb	r6, [r2, #17]
 6734              		.loc 1 2385 0
 6735 00d6 6259     		ldr	r2, [r4, r5]
 6736 00d8 1944     		add	r1, r1, r3
2386:bluetooth_rxtx.c **** 		if (i < num_adv_ind -1) {
 6737              		.loc 1 2386 0
ARM GAS  /tmp/cc1G6faT.s 			page 180


 6738 00da 4B45     		cmp	r3, r9
2385:bluetooth_rxtx.c **** 		adv_ind[i][19] = adv_overhead[19] + (u8) i;
 6739              		.loc 1 2385 0
 6740 00dc D174     		strb	r1, [r2, #19]
 6741              		.loc 1 2386 0
 6742 00de 12DA     		bge	.L737
 6743 00e0 0B21     		movs	r1, #11
 6744 00e2 5943     		muls	r1, r3, r1
 6745 00e4 4FF0140C 		mov	ip, #20
 6746              	.L739:
 6747              	.LVL703:
2387:bluetooth_rxtx.c **** 			for (j=0; j<11; j++) adv_ind[i][j+20] = slave_mac_address_data[6+11*i+j];
 6748              		.loc 1 2387 0 discriminator 2
 6749 00e8 DBF80020 		ldr	r2, [fp]
 6750 00ec 0A44     		add	r2, r2, r1
 6751 00ee 6244     		add	r2, r2, ip
 6752 00f0 12F80E0C 		ldrb	r0, [r2, #-14]	@ zero_extendqisi2
 6753 00f4 6259     		ldr	r2, [r4, r5]
 6754 00f6 02F80C00 		strb	r0, [r2, ip]
 6755              	.LVL704:
 6756 00fa 0CF1010C 		add	ip, ip, #1
 6757              	.LVL705:
 6758 00fe BCF11F0F 		cmp	ip, #31
 6759 0102 F1D1     		bne	.L739
 6760 0104 23E0     		b	.L738
 6761              	.LVL706:
 6762              	.L737:
 6763              	.LBB69:
2388:bluetooth_rxtx.c **** 			adv_ind_len = (u8) 31;
2389:bluetooth_rxtx.c **** 		} else {
2390:bluetooth_rxtx.c **** 			u8 tot_len = (u8)(fin_adv_len + 18);
 6764              		.loc 1 2390 0
 6765 0106 FAB2     		uxtb	r2, r7
 6766 0108 02F11201 		add	r1, r2, #18
 6767 010c 4FF00B0E 		mov	lr, #11
 6768 0110 C9B2     		uxtb	r1, r1
 6769 0112 0EFB03FE 		mul	lr, lr, r3
 6770 0116 0491     		str	r1, [sp, #16]
 6771              	.LVL707:
2391:bluetooth_rxtx.c **** 			u8 adv_len = (u8)(fin_adv_len + 7);
 6772              		.loc 1 2391 0
 6773 0118 D11D     		adds	r1, r2, #7
 6774 011a C9B2     		uxtb	r1, r1
 6775 011c 0591     		str	r1, [sp, #20]
 6776              	.LVL708:
2392:bluetooth_rxtx.c **** 			for (j=0; j<fin_adv_len; j++) adv_ind[i][j+20] = slave_mac_address_data[6+11*i+j];
 6777              		.loc 1 2392 0
 6778 011e 0021     		movs	r1, #0
 6779              	.LVL709:
 6780              	.L740:
 6781              		.loc 1 2392 0 is_stmt 0 discriminator 1
 6782 0120 B942     		cmp	r1, r7
 6783 0122 0BDA     		bge	.L789
 6784              		.loc 1 2392 0 discriminator 2
 6785 0124 4948     		ldr	r0, .L792+4
 6786 0126 0068     		ldr	r0, [r0]
 6787 0128 7044     		add	r0, r0, lr
ARM GAS  /tmp/cc1G6faT.s 			page 181


 6788 012a 0844     		add	r0, r0, r1
 6789 012c 90F806C0 		ldrb	ip, [r0, #6]	@ zero_extendqisi2
 6790 0130 6059     		ldr	r0, [r4, r5]
 6791 0132 0844     		add	r0, r0, r1
 6792 0134 80F814C0 		strb	ip, [r0, #20]
 6793 0138 0131     		adds	r1, r1, #1
 6794              	.LVL710:
 6795 013a F1E7     		b	.L740
 6796              	.L789:
2393:bluetooth_rxtx.c **** 			adv_ind[i][1] = tot_len;
 6797              		.loc 1 2393 0 is_stmt 1
 6798 013c 6159     		ldr	r1, [r4, r5]
 6799              	.LVL711:
 6800 013e 0498     		ldr	r0, [sp, #16]
2394:bluetooth_rxtx.c **** 			adv_ind[i][12] = adv_len;
2395:bluetooth_rxtx.c **** 			adv_ind_len = (u8) (fin_adv_len + 20);
 6801              		.loc 1 2395 0
 6802 0140 1432     		adds	r2, r2, #20
2393:bluetooth_rxtx.c **** 			adv_ind[i][1] = tot_len;
 6803              		.loc 1 2393 0
 6804 0142 4870     		strb	r0, [r1, #1]
2394:bluetooth_rxtx.c **** 			adv_ind[i][12] = adv_len;
 6805              		.loc 1 2394 0
 6806 0144 6159     		ldr	r1, [r4, r5]
 6807 0146 0598     		ldr	r0, [sp, #20]
 6808              		.loc 1 2395 0
 6809 0148 5FFA82FC 		uxtb	ip, r2
 6810              	.LVL712:
2394:bluetooth_rxtx.c **** 			adv_ind[i][12] = adv_len;
 6811              		.loc 1 2394 0
 6812 014c 0873     		strb	r0, [r1, #12]
 6813              	.LVL713:
 6814              	.L738:
 6815              	.LBE69:
2396:bluetooth_rxtx.c **** 		}
2397:bluetooth_rxtx.c **** 		
2398:bluetooth_rxtx.c **** 		calc_crc = btle_calc_crc(le.crc_init_reversed, adv_ind[i], adv_ind_len);
 6816              		.loc 1 2398 0
 6817 014e 424A     		ldr	r2, .L792+16
 6818 0150 6159     		ldr	r1, [r4, r5]
 6819 0152 1069     		ldr	r0, [r2, #16]
 6820 0154 6246     		mov	r2, ip
 6821 0156 0293     		str	r3, [sp, #8]
 6822 0158 CDF80CC0 		str	ip, [sp, #12]
 6823 015c FFF7FEFF 		bl	btle_calc_crc
 6824              	.LVL714:
2399:bluetooth_rxtx.c **** 		adv_ind_len = (int) adv_ind_len;
2400:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+0] = (calc_crc >> 0) & 0xff;
 6825              		.loc 1 2400 0
 6826 0160 6259     		ldr	r2, [r4, r5]
 6827 0162 DDF80CC0 		ldr	ip, [sp, #12]
2401:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+1] = (calc_crc >> 8) & 0xff;
 6828              		.loc 1 2401 0
 6829 0166 010A     		lsrs	r1, r0, #8
2400:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+1] = (calc_crc >> 8) & 0xff;
 6830              		.loc 1 2400 0
 6831 0168 02F80C00 		strb	r0, [r2, ip]
ARM GAS  /tmp/cc1G6faT.s 			page 182


 6832              	.LVL715:
 6833              		.loc 1 2401 0
 6834 016c 6259     		ldr	r2, [r4, r5]
2402:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+2] = (calc_crc >> 16) & 0xff;
 6835              		.loc 1 2402 0
 6836 016e 000C     		lsrs	r0, r0, #16
 6837              	.LVL716:
2401:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+1] = (calc_crc >> 8) & 0xff;
 6838              		.loc 1 2401 0
 6839 0170 6244     		add	r2, r2, ip
 6840 0172 5170     		strb	r1, [r2, #1]
 6841              		.loc 1 2402 0
 6842 0174 6259     		ldr	r2, [r4, r5]
 6843 0176 0435     		adds	r5, r5, #4
 6844 0178 6244     		add	r2, r2, ip
 6845 017a 9070     		strb	r0, [r2, #2]
2381:bluetooth_rxtx.c **** 		for (j=0; j<20; j++) adv_ind[i][j] = adv_overhead[j];
 6846              		.loc 1 2381 0
 6847 017c 029B     		ldr	r3, [sp, #8]
 6848 017e 0133     		adds	r3, r3, #1
 6849              	.LVL717:
 6850 0180 8DE7     		b	.L733
 6851              	.L742:
2403:bluetooth_rxtx.c **** 	}
2404:bluetooth_rxtx.c **** 
2405:bluetooth_rxtx.c **** 	clkn_start();
 6852              		.loc 1 2405 0
 6853 0182 FFF7FEFF 		bl	clkn_start
 6854              	.LVL718:
 6855              	.L744:
2406:bluetooth_rxtx.c **** 
2407:bluetooth_rxtx.c **** 	// spam advertising packets
2408:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_SLAVE_LE 
 6856              		.loc 1 2408 0 discriminator 1
 6857 0186 98F81220 		ldrb	r2, [r8, #18]	@ zero_extendqisi2
 6858 018a 314B     		ldr	r3, .L792+8
 6859 018c 0C2A     		cmp	r2, #12
 6860 018e 3FD1     		bne	.L790
 6861              	.L752:
2409:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P0
2410:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P1
2411:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P2
2412:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P3
2413:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P4
2414:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P5
2415:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P6
2416:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P7) {
2417:bluetooth_rxtx.c **** 		if (requested_mode != mode) break;
 6862              		.loc 1 2417 0
 6863 0190 98F81220 		ldrb	r2, [r8, #18]	@ zero_extendqisi2
 6864 0194 98F81130 		ldrb	r3, [r8, #17]	@ zero_extendqisi2
 6865 0198 9A42     		cmp	r2, r3
 6866 019a 51D1     		bne	.L726
2418:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
 6867              		.loc 1 2418 0
 6868 019c 2F4B     		ldr	r3, .L792+20
 6869 019e 4FF08072 		mov	r2, #16777216
ARM GAS  /tmp/cc1G6faT.s 			page 183


 6870 01a2 1A60     		str	r2, [r3]
2419:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_DMA;
 6871              		.loc 1 2419 0
 6872 01a4 4FF08062 		mov	r2, #67108864
 6873 01a8 1A60     		str	r2, [r3]
 6874              	.LVL719:
 6875 01aa 4FF0000B 		mov	fp, #0
 6876              	.LVL720:
 6877              	.L746:
2381:bluetooth_rxtx.c **** 		for (j=0; j<20; j++) adv_ind[i][j] = adv_overhead[j];
 6878              		.loc 1 2381 0 discriminator 1
 6879 01ae 0025     		movs	r5, #0
 6880              	.L751:
 6881              	.LVL721:
2420:bluetooth_rxtx.c **** 		for(i=0; i<3; i++) {
2421:bluetooth_rxtx.c **** 			for(j=0; j<num_adv_ind; j++) {
 6882              		.loc 1 2421 0 discriminator 1
 6883 01b0 B542     		cmp	r5, r6
 6884 01b2 19DA     		bge	.L791
2422:bluetooth_rxtx.c **** 				if (j < num_adv_ind -1) {
 6885              		.loc 1 2422 0
 6886 01b4 4D45     		cmp	r5, r9
 6887 01b6 07AB     		add	r3, sp, #28
 6888 01b8 05DA     		bge	.L747
 6889              	.LVL722:
2423:bluetooth_rxtx.c **** 					adv_ind_len = (u8) (31 + 3);
2424:bluetooth_rxtx.c **** 					le_transmit(0x8e89bed6, adv_ind_len, adv_ind[j], tx_pwr, ch[i]);
 6890              		.loc 1 2424 0
 6891 01ba 33F80B30 		ldrh	r3, [r3, fp]
 6892 01be 2848     		ldr	r0, .L792+24
 6893 01c0 0093     		str	r3, [sp]
 6894 01c2 2221     		movs	r1, #34
 6895 01c4 06E0     		b	.L787
 6896              	.LVL723:
 6897              	.L747:
2425:bluetooth_rxtx.c **** 				} else {
2426:bluetooth_rxtx.c **** 					adv_ind_len = (u8) (fin_adv_len + 20 + 3);
2427:bluetooth_rxtx.c **** 					le_transmit(0x8e89bed6, adv_ind_len, adv_ind[j], tx_pwr, ch[i]);
 6898              		.loc 1 2427 0
 6899 01c6 33F80B30 		ldrh	r3, [r3, fp]
2426:bluetooth_rxtx.c **** 					le_transmit(0x8e89bed6, adv_ind_len, adv_ind[j], tx_pwr, ch[i]);
 6900              		.loc 1 2426 0
 6901 01ca 07F11701 		add	r1, r7, #23
 6902              		.loc 1 2427 0
 6903 01ce 2448     		ldr	r0, .L792+24
 6904 01d0 0093     		str	r3, [sp]
 6905 01d2 C9B2     		uxtb	r1, r1
 6906              	.LVL724:
 6907              	.L787:
 6908 01d4 54F82520 		ldr	r2, [r4, r5, lsl #2]
 6909 01d8 5346     		mov	r3, r10
 6910 01da FFF7FEFF 		bl	le_transmit
 6911              	.LVL725:
2428:bluetooth_rxtx.c **** 				}
2429:bluetooth_rxtx.c **** 				msleep(10);
 6912              		.loc 1 2429 0
 6913 01de 0A20     		movs	r0, #10
ARM GAS  /tmp/cc1G6faT.s 			page 184


 6914 01e0 FFF7FEFF 		bl	msleep
 6915              	.LVL726:
2421:bluetooth_rxtx.c **** 				if (j < num_adv_ind -1) {
 6916              		.loc 1 2421 0
 6917 01e4 0135     		adds	r5, r5, #1
 6918              	.LVL727:
 6919 01e6 E3E7     		b	.L751
 6920              	.L791:
2430:bluetooth_rxtx.c **** 			}
2431:bluetooth_rxtx.c **** 			msleep(5);
 6921              		.loc 1 2431 0
 6922 01e8 0520     		movs	r0, #5
 6923 01ea 0BF1020B 		add	fp, fp, #2
 6924 01ee FFF7FEFF 		bl	msleep
 6925              	.LVL728:
2420:bluetooth_rxtx.c **** 			for(j=0; j<num_adv_ind; j++) {
 6926              		.loc 1 2420 0
 6927 01f2 BBF1060F 		cmp	fp, #6
 6928 01f6 DAD1     		bne	.L746
2432:bluetooth_rxtx.c **** 		}
2433:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 6929              		.loc 1 2433 0
 6930 01f8 1A4B     		ldr	r3, .L792+28
 6931 01fa 4FF08072 		mov	r2, #16777216
 6932 01fe 1A60     		str	r2, [r3]
2434:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_DMA;
 6933              		.loc 1 2434 0
 6934 0200 4FF08062 		mov	r2, #67108864
 6935 0204 1A60     		str	r2, [r3]
2435:bluetooth_rxtx.c **** 		msleep(1000);
 6936              		.loc 1 2435 0
 6937 0206 4FF47A70 		mov	r0, #1000
 6938 020a FFF7FEFF 		bl	msleep
 6939              	.LVL729:
 6940 020e BAE7     		b	.L744
 6941              	.LVL730:
 6942              	.L790:
2409:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P1
 6943              		.loc 1 2409 0
 6944 0210 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 6945 0212 112A     		cmp	r2, #17
 6946 0214 BCD0     		beq	.L752
2410:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P2
 6947              		.loc 1 2410 0
 6948 0216 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 6949 0218 122A     		cmp	r2, #18
 6950 021a B9D0     		beq	.L752
2411:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P3
 6951              		.loc 1 2411 0
 6952 021c 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 6953 021e 132A     		cmp	r2, #19
 6954 0220 B6D0     		beq	.L752
2412:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P4
 6955              		.loc 1 2412 0
 6956 0222 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 6957 0224 142A     		cmp	r2, #20
 6958 0226 B3D0     		beq	.L752
ARM GAS  /tmp/cc1G6faT.s 			page 185


2413:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P5
 6959              		.loc 1 2413 0
 6960 0228 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 6961 022a 152A     		cmp	r2, #21
 6962 022c B0D0     		beq	.L752
2414:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P6
 6963              		.loc 1 2414 0
 6964 022e 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 6965 0230 162A     		cmp	r2, #22
 6966 0232 ADD0     		beq	.L752
2415:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P7) {
 6967              		.loc 1 2415 0
 6968 0234 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 6969 0236 172A     		cmp	r2, #23
 6970 0238 AAD0     		beq	.L752
2416:bluetooth_rxtx.c **** 		if (requested_mode != mode) break;
 6971              		.loc 1 2416 0
 6972 023a 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 6973 023c 182B     		cmp	r3, #24
 6974 023e A7D0     		beq	.L752
 6975              	.L726:
2436:bluetooth_rxtx.c **** 	}
2437:bluetooth_rxtx.c **** }
 6976              		.loc 1 2437 0
 6977 0240 0FB0     		add	sp, sp, #60
 6978              		@ sp needed
 6979 0242 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 6980              	.LVL731:
 6981              	.L793:
 6982 0246 00BF     		.align	2
 6983              	.L792:
 6984 0248 A8080000 		.word	.LANCHOR2+2216
 6985 024c 00000000 		.word	slave_mac_address_data
 6986 0250 00000000 		.word	.LANCHOR0
 6987 0254 24000000 		.word	.LANCHOR0+36
 6988 0258 00000000 		.word	.LANCHOR1
 6989 025c 80E100E0 		.word	-536813184
 6990 0260 D6BE898E 		.word	-1903575338
 6991 0264 00E100E0 		.word	-536813312
 6992              		.cfi_endproc
 6993              	.LFE33:
 6995              		.section	.text.rx_generic_sync,"ax",%progbits
 6996              		.align	1
 6997              		.global	rx_generic_sync
 6998              		.thumb
 6999              		.thumb_func
 7001              	rx_generic_sync:
 7002              	.LFB34:
2438:bluetooth_rxtx.c **** 
2439:bluetooth_rxtx.c **** void rx_generic_sync(void) {
 7003              		.loc 1 2439 0
 7004              		.cfi_startproc
 7005              		@ args = 0, pretend = 0, frame = 40
 7006              		@ frame_needed = 0, uses_anonymous_args = 0
 7007 0000 00B5     		push	{lr}
 7008              		.cfi_def_cfa_offset 4
 7009              		.cfi_offset 14, -4
ARM GAS  /tmp/cc1G6faT.s 			page 186


 7010 0002 8BB0     		sub	sp, sp, #44
 7011              		.cfi_def_cfa_offset 48
 7012              	.LVL732:
2440:bluetooth_rxtx.c **** 	u8 len = 32;
2441:bluetooth_rxtx.c **** 	u8 buf[len+4];
2442:bluetooth_rxtx.c **** 	u16 reg_val;
2443:bluetooth_rxtx.c **** 
2444:bluetooth_rxtx.c **** 	/* Put syncword at start of buffer
2445:bluetooth_rxtx.c **** 	 * DGS: fix this later, we don't know number of syncword bytes, etc
2446:bluetooth_rxtx.c **** 	 */
2447:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCH);
 7013              		.loc 1 2447 0
 7014 0004 2D20     		movs	r0, #45
 7015 0006 FFF7FEFF 		bl	cc2400_get
 7016              	.LVL733:
2448:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
 7017              		.loc 1 2448 0
 7018 000a 030A     		lsrs	r3, r0, #8
2449:bluetooth_rxtx.c **** 	buf[1] = reg_val & 0xFF;
 7019              		.loc 1 2449 0
 7020 000c 8DF80500 		strb	r0, [sp, #5]
2450:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCL);
 7021              		.loc 1 2450 0
 7022 0010 2C20     		movs	r0, #44
 7023              	.LVL734:
2448:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
 7024              		.loc 1 2448 0
 7025 0012 8DF80430 		strb	r3, [sp, #4]
 7026              		.loc 1 2450 0
 7027 0016 FFF7FEFF 		bl	cc2400_get
 7028              	.LVL735:
2451:bluetooth_rxtx.c **** 	buf[2] = (reg_val >> 8) & 0xFF;
 7029              		.loc 1 2451 0
 7030 001a 030A     		lsrs	r3, r0, #8
 7031 001c 8DF80630 		strb	r3, [sp, #6]
2452:bluetooth_rxtx.c **** 	buf[3] = reg_val & 0xFF;
 7032              		.loc 1 2452 0
 7033 0020 8DF80700 		strb	r0, [sp, #7]
2453:bluetooth_rxtx.c **** 
2454:bluetooth_rxtx.c **** 	queue_init();
 7034              		.loc 1 2454 0
 7035 0024 FFF7FEFF 		bl	queue_init
 7036              	.LVL736:
2455:bluetooth_rxtx.c **** 	clkn_start();
 7037              		.loc 1 2455 0
 7038 0028 FFF7FEFF 		bl	clkn_start
 7039              	.LVL737:
 7040              	.L796:
2456:bluetooth_rxtx.c **** 
2457:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 7041              		.loc 1 2457 0 discriminator 1
 7042 002c FFF7FEFF 		bl	cc2400_status
 7043              	.LVL738:
 7044 0030 4306     		lsls	r3, r0, #25
 7045 0032 FBD5     		bpl	.L796
2458:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 7046              		.loc 1 2458 0
ARM GAS  /tmp/cc1G6faT.s 			page 187


 7047 0034 6120     		movs	r0, #97
 7048 0036 FFF7FEFF 		bl	cc2400_strobe
 7049              	.LVL739:
 7050              	.L798:
2459:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 7051              		.loc 1 2459 0 discriminator 1
 7052 003a FFF7FEFF 		bl	cc2400_status
 7053              	.LVL740:
 7054 003e 4007     		lsls	r0, r0, #29
 7055 0040 FBD5     		bpl	.L798
2460:bluetooth_rxtx.c **** 	RXLED_SET;
 7056              		.loc 1 2460 0
 7057 0042 144B     		ldr	r3, .L804
 7058 0044 1022     		movs	r2, #16
 7059 0046 1A60     		str	r2, [r3]
2461:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2462:bluetooth_rxtx.c **** 		PAEN_SET;
 7060              		.loc 1 2462 0
 7061 0048 8022     		movs	r2, #128
 7062 004a 1A62     		str	r2, [r3, #32]
2463:bluetooth_rxtx.c **** 		HGM_SET;
 7063              		.loc 1 2463 0
 7064 004c 4FF48072 		mov	r2, #256
 7065 0050 1A62     		str	r2, [r3, #32]
 7066              	.L800:
2464:bluetooth_rxtx.c **** #endif
2465:bluetooth_rxtx.c **** 	while (1) {
2466:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 7067              		.loc 1 2466 0 discriminator 1
 7068 0052 0E20     		movs	r0, #14
 7069 0054 FFF7FEFF 		bl	cc2400_get
 7070              	.LVL741:
 7071 0058 00F01F00 		and	r0, r0, #31
 7072 005c 0F28     		cmp	r0, #15
 7073 005e F8D1     		bne	.L800
2467:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 7074              		.loc 1 2467 0
 7075 0060 6220     		movs	r0, #98
 7076 0062 FFF7FEFF 		bl	cc2400_strobe
 7077              	.LVL742:
2468:bluetooth_rxtx.c **** 		USRLED_CLR;
 7078              		.loc 1 2468 0
 7079 0066 0C4B     		ldr	r3, .L804+4
 7080 0068 0222     		movs	r2, #2
 7081 006a 1A60     		str	r2, [r3]
 7082              	.L802:
2469:bluetooth_rxtx.c **** 		while (!(cc2400_status() & SYNC_RECEIVED));
 7083              		.loc 1 2469 0 discriminator 1
 7084 006c FFF7FEFF 		bl	cc2400_status
 7085              	.LVL743:
 7086 0070 C106     		lsls	r1, r0, #27
 7087 0072 FBD5     		bpl	.L802
2470:bluetooth_rxtx.c **** 		USRLED_SET;
 7088              		.loc 1 2470 0
 7089 0074 074B     		ldr	r3, .L804
 7090 0076 0222     		movs	r2, #2
 7091 0078 1A60     		str	r2, [r3]
ARM GAS  /tmp/cc1G6faT.s 			page 188


2471:bluetooth_rxtx.c **** 
2472:bluetooth_rxtx.c **** 		cc2400_fifo_read(len, buf+4);
 7092              		.loc 1 2472 0
 7093 007a 02A9     		add	r1, sp, #8
 7094 007c 2020     		movs	r0, #32
 7095 007e FFF7FEFF 		bl	cc2400_fifo_read
 7096              	.LVL744:
2473:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, buf);
 7097              		.loc 1 2473 0
 7098 0082 01A9     		add	r1, sp, #4
 7099              	.LVL745:
 7100 0084 0020     		movs	r0, #0
 7101 0086 FFF7FEFF 		bl	enqueue
 7102              	.LVL746:
2474:bluetooth_rxtx.c **** 		handle_usb(clkn);
 7103              		.loc 1 2474 0
 7104 008a 044B     		ldr	r3, .L804+8
 7105 008c 1868     		ldr	r0, [r3]
 7106 008e FFF7FEFF 		bl	handle_usb
 7107              	.LVL747:
2475:bluetooth_rxtx.c **** 	}
 7108              		.loc 1 2475 0
 7109 0092 DEE7     		b	.L800
 7110              	.L805:
 7111              		.align	2
 7112              	.L804:
 7113 0094 38C00920 		.word	537509944
 7114 0098 3CC00920 		.word	537509948
 7115 009c 00000000 		.word	clkn
 7116              		.cfi_endproc
 7117              	.LFE34:
 7119              		.section	.text.rx_generic,"ax",%progbits
 7120              		.align	1
 7121              		.global	rx_generic
 7122              		.thumb
 7123              		.thumb_func
 7125              	rx_generic:
 7126              	.LFB35:
2476:bluetooth_rxtx.c **** }
2477:bluetooth_rxtx.c **** 
2478:bluetooth_rxtx.c **** void rx_generic(void) {
 7127              		.loc 1 2478 0
 7128              		.cfi_startproc
 7129              		@ args = 0, pretend = 0, frame = 0
 7130              		@ frame_needed = 0, uses_anonymous_args = 0
 7131 0000 08B5     		push	{r3, lr}
 7132              		.cfi_def_cfa_offset 8
 7133              		.cfi_offset 3, -8
 7134              		.cfi_offset 14, -4
2479:bluetooth_rxtx.c **** 	// Check for packet mode
2480:bluetooth_rxtx.c **** 	if(cc2400_get(GRMDM) && 0x0400) {
 7135              		.loc 1 2480 0
 7136 0002 2020     		movs	r0, #32
 7137 0004 FFF7FEFF 		bl	cc2400_get
 7138              	.LVL748:
 7139 0008 08B1     		cbz	r0, .L807
2481:bluetooth_rxtx.c **** 		rx_generic_sync();
ARM GAS  /tmp/cc1G6faT.s 			page 189


 7140              		.loc 1 2481 0
 7141 000a FFF7FEFF 		bl	rx_generic_sync
 7142              	.LVL749:
 7143              	.L807:
2482:bluetooth_rxtx.c **** 	} else {
2483:bluetooth_rxtx.c **** 		modulation = MOD_NONE;
 7144              		.loc 1 2483 0
 7145 000e 034B     		ldr	r3, .L808
 7146 0010 0322     		movs	r2, #3
 7147 0012 1A70     		strb	r2, [r3]
2484:bluetooth_rxtx.c **** 		bt_stream_rx();
2485:bluetooth_rxtx.c **** 	}
2486:bluetooth_rxtx.c **** }
 7148              		.loc 1 2486 0
 7149 0014 BDE80840 		pop	{r3, lr}
2484:bluetooth_rxtx.c **** 		bt_stream_rx();
 7150              		.loc 1 2484 0
 7151 0018 FFF7FEBF 		b	bt_stream_rx
 7152              	.LVL750:
 7153              	.L809:
 7154              		.align	2
 7155              	.L808:
 7156 001c 00000000 		.word	.LANCHOR0
 7157              		.cfi_endproc
 7158              	.LFE35:
 7160              		.section	.text.tx_generic,"ax",%progbits
 7161              		.align	1
 7162              		.global	tx_generic
 7163              		.thumb
 7164              		.thumb_func
 7166              	tx_generic:
 7167              	.LFB36:
2487:bluetooth_rxtx.c **** 
2488:bluetooth_rxtx.c **** void tx_generic(void) {
 7168              		.loc 1 2488 0
 7169              		.cfi_startproc
 7170              		@ args = 0, pretend = 0, frame = 0
 7171              		@ frame_needed = 0, uses_anonymous_args = 0
 7172 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 7173              		.cfi_def_cfa_offset 24
 7174              		.cfi_offset 4, -24
 7175              		.cfi_offset 5, -20
 7176              		.cfi_offset 6, -16
 7177              		.cfi_offset 7, -12
 7178              		.cfi_offset 8, -8
 7179              		.cfi_offset 14, -4
2489:bluetooth_rxtx.c **** 	u16 synch, syncl;
2490:bluetooth_rxtx.c **** 	u8 prev_mode = mode;
 7180              		.loc 1 2490 0
 7181 0004 354D     		ldr	r5, .L821
2491:bluetooth_rxtx.c **** 
2492:bluetooth_rxtx.c **** 	mode = MODE_TX_GENERIC;
 7182              		.loc 1 2492 0
 7183 0006 1023     		movs	r3, #16
2493:bluetooth_rxtx.c **** 
2494:bluetooth_rxtx.c **** 	// Save existing syncword
2495:bluetooth_rxtx.c **** 	synch = cc2400_get(SYNCH);
ARM GAS  /tmp/cc1G6faT.s 			page 190


 7184              		.loc 1 2495 0
 7185 0008 2D20     		movs	r0, #45
2490:bluetooth_rxtx.c **** 
 7186              		.loc 1 2490 0
 7187 000a 6E7C     		ldrb	r6, [r5, #17]	@ zero_extendqisi2
2492:bluetooth_rxtx.c **** 
 7188              		.loc 1 2492 0
 7189 000c 6B74     		strb	r3, [r5, #17]
 7190              		.loc 1 2495 0
 7191 000e FFF7FEFF 		bl	cc2400_get
 7192              	.LVL751:
 7193 0012 8046     		mov	r8, r0
2496:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 7194              		.loc 1 2496 0
 7195 0014 2C20     		movs	r0, #44
 7196 0016 FFF7FEFF 		bl	cc2400_get
 7197              	.LVL752:
2497:bluetooth_rxtx.c **** 
2498:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, tx_pkt.synch);
 7198              		.loc 1 2498 0
 7199 001a 314C     		ldr	r4, .L821+4
2496:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 7200              		.loc 1 2496 0
 7201 001c 0746     		mov	r7, r0
 7202              		.loc 1 2498 0
 7203 001e 2188     		ldrh	r1, [r4]
 7204 0020 2D20     		movs	r0, #45
 7205 0022 FFF7FEFF 		bl	cc2400_set
 7206              	.LVL753:
2499:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, tx_pkt.syncl);
 7207              		.loc 1 2499 0
 7208 0026 2C20     		movs	r0, #44
 7209 0028 6188     		ldrh	r1, [r4, #2]
 7210 002a FFF7FEFF 		bl	cc2400_set
 7211              	.LVL754:
2500:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0057);
 7212              		.loc 1 2500 0
 7213 002e 0320     		movs	r0, #3
 7214 0030 5721     		movs	r1, #87
 7215 0032 FFF7FEFF 		bl	cc2400_set
 7216              	.LVL755:
2501:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);
 7217              		.loc 1 2501 0
 7218 0036 1420     		movs	r0, #20
 7219 0038 41F24B31 		movw	r1, #4939
 7220 003c FFF7FEFF 		bl	cc2400_set
 7221              	.LVL756:
2502:bluetooth_rxtx.c **** 	cc2400_set(GRMDM, 0x0f61);
 7222              		.loc 1 2502 0
 7223 0040 2020     		movs	r0, #32
 7224 0042 40F66171 		movw	r1, #3937
 7225 0046 FFF7FEFF 		bl	cc2400_set
 7226              	.LVL757:
2503:bluetooth_rxtx.c **** 	cc2400_set(FSDIV, tx_pkt.channel);
 7227              		.loc 1 2503 0
 7228 004a 0220     		movs	r0, #2
 7229 004c A188     		ldrh	r1, [r4, #4]
ARM GAS  /tmp/cc1G6faT.s 			page 191


 7230 004e FFF7FEFF 		bl	cc2400_set
 7231              	.LVL758:
2504:bluetooth_rxtx.c **** 	cc2400_set(FREND, tx_pkt.pa_level);
 7232              		.loc 1 2504 0
 7233 0052 0520     		movs	r0, #5
 7234 0054 E179     		ldrb	r1, [r4, #7]	@ zero_extendqisi2
2490:bluetooth_rxtx.c **** 
 7235              		.loc 1 2490 0
 7236 0056 F6B2     		uxtb	r6, r6
 7237              	.LVL759:
 7238              		.loc 1 2504 0
 7239 0058 FFF7FEFF 		bl	cc2400_set
 7240              	.LVL760:
 7241              	.L812:
2505:bluetooth_rxtx.c **** 
2506:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 7242              		.loc 1 2506 0 discriminator 1
 7243 005c FFF7FEFF 		bl	cc2400_status
 7244              	.LVL761:
 7245 0060 4006     		lsls	r0, r0, #25
 7246 0062 FBD5     		bpl	.L812
2507:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 7247              		.loc 1 2507 0
 7248 0064 6120     		movs	r0, #97
 7249 0066 FFF7FEFF 		bl	cc2400_strobe
 7250              	.LVL762:
 7251              	.L814:
2508:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 7252              		.loc 1 2508 0 discriminator 1
 7253 006a FFF7FEFF 		bl	cc2400_status
 7254              	.LVL763:
 7255 006e 4107     		lsls	r1, r0, #29
 7256 0070 FBD5     		bpl	.L814
2509:bluetooth_rxtx.c **** 	TXLED_SET;
 7257              		.loc 1 2509 0
 7258 0072 1C4B     		ldr	r3, .L821+8
 7259 0074 4FF48072 		mov	r2, #256
 7260 0078 1A60     		str	r2, [r3]
2510:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2511:bluetooth_rxtx.c **** 		PAEN_SET;
 7261              		.loc 1 2511 0
 7262 007a 8022     		movs	r2, #128
 7263 007c 1A62     		str	r2, [r3, #32]
 7264              	.L816:
2512:bluetooth_rxtx.c **** #endif
2513:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 7265              		.loc 1 2513 0 discriminator 1
 7266 007e 0E20     		movs	r0, #14
 7267 0080 FFF7FEFF 		bl	cc2400_get
 7268              	.LVL764:
 7269 0084 00F01F00 		and	r0, r0, #31
 7270 0088 0F28     		cmp	r0, #15
 7271 008a F8D1     		bne	.L816
2514:bluetooth_rxtx.c **** 
2515:bluetooth_rxtx.c **** 	cc2400_fifo_write(tx_pkt.length, tx_pkt.data);
 7272              		.loc 1 2515 0
 7273 008c A079     		ldrb	r0, [r4, #6]	@ zero_extendqisi2
ARM GAS  /tmp/cc1G6faT.s 			page 192


 7274 008e 1649     		ldr	r1, .L821+12
 7275 0090 FFF7FEFF 		bl	cc2400_fifo_write
 7276              	.LVL765:
2516:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 7277              		.loc 1 2516 0
 7278 0094 6320     		movs	r0, #99
 7279 0096 FFF7FEFF 		bl	cc2400_strobe
 7280              	.LVL766:
 7281              	.L818:
2517:bluetooth_rxtx.c **** 
2518:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 7282              		.loc 1 2518 0 discriminator 1
 7283 009a 0E20     		movs	r0, #14
 7284 009c FFF7FEFF 		bl	cc2400_get
 7285              	.LVL767:
 7286 00a0 00F01F00 		and	r0, r0, #31
 7287 00a4 0F28     		cmp	r0, #15
 7288 00a6 F8D1     		bne	.L818
2519:bluetooth_rxtx.c **** 	TXLED_CLR;
 7289              		.loc 1 2519 0
 7290 00a8 104B     		ldr	r3, .L821+16
 7291 00aa 4FF48072 		mov	r2, #256
 7292 00ae 1A60     		str	r2, [r3]
2520:bluetooth_rxtx.c **** 
2521:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 7293              		.loc 1 2521 0
 7294 00b0 6420     		movs	r0, #100
 7295 00b2 FFF7FEFF 		bl	cc2400_strobe
 7296              	.LVL768:
 7297              	.L820:
2522:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 7298              		.loc 1 2522 0 discriminator 1
 7299 00b6 FFF7FEFF 		bl	cc2400_status
 7300              	.LVL769:
 7301 00ba 4207     		lsls	r2, r0, #29
 7302 00bc FBD4     		bmi	.L820
2523:bluetooth_rxtx.c **** 
2524:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2525:bluetooth_rxtx.c **** 	PAEN_CLR;
 7303              		.loc 1 2525 0
 7304 00be 0C4B     		ldr	r3, .L821+20
 7305 00c0 8022     		movs	r2, #128
 7306 00c2 1A60     		str	r2, [r3]
2526:bluetooth_rxtx.c **** #endif
2527:bluetooth_rxtx.c **** 
2528:bluetooth_rxtx.c **** 	// Restore state
2529:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, synch);
 7307              		.loc 1 2529 0
 7308 00c4 2D20     		movs	r0, #45
 7309 00c6 4146     		mov	r1, r8
 7310 00c8 FFF7FEFF 		bl	cc2400_set
 7311              	.LVL770:
2530:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, syncl);
 7312              		.loc 1 2530 0
 7313 00cc 2C20     		movs	r0, #44
 7314 00ce 3946     		mov	r1, r7
 7315 00d0 FFF7FEFF 		bl	cc2400_set
ARM GAS  /tmp/cc1G6faT.s 			page 193


 7316              	.LVL771:
2531:bluetooth_rxtx.c **** 	requested_mode = prev_mode;
 7317              		.loc 1 2531 0
 7318 00d4 AE74     		strb	r6, [r5, #18]
 7319 00d6 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 7320              	.LVL772:
 7321              	.L822:
 7322 00da 00BF     		.align	2
 7323              	.L821:
 7324 00dc 00000000 		.word	.LANCHOR0
 7325 00e0 00000000 		.word	tx_pkt
 7326 00e4 38C00920 		.word	537509944
 7327 00e8 08000000 		.word	tx_pkt+8
 7328 00ec 3CC00920 		.word	537509948
 7329 00f0 5CC00920 		.word	537509980
 7330              		.cfi_endproc
 7331              	.LFE36:
 7333              		.section	.text.specan,"ax",%progbits
 7334              		.align	1
 7335              		.global	specan
 7336              		.thumb
 7337              		.thumb_func
 7339              	specan:
 7340              	.LFB37:
2532:bluetooth_rxtx.c **** }
2533:bluetooth_rxtx.c **** 
2534:bluetooth_rxtx.c **** /* spectrum analysis */
2535:bluetooth_rxtx.c **** void specan()
2536:bluetooth_rxtx.c **** {
 7341              		.loc 1 2536 0
 7342              		.cfi_startproc
 7343              		@ args = 0, pretend = 0, frame = 56
 7344              		@ frame_needed = 0, uses_anonymous_args = 0
 7345 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 7346              		.cfi_def_cfa_offset 24
 7347              		.cfi_offset 4, -24
 7348              		.cfi_offset 5, -20
 7349              		.cfi_offset 6, -16
 7350              		.cfi_offset 7, -12
 7351              		.cfi_offset 8, -8
 7352              		.cfi_offset 14, -4
 7353 0004 8EB0     		sub	sp, sp, #56
 7354              		.cfi_def_cfa_offset 80
 7355              	.LVL773:
2537:bluetooth_rxtx.c **** 	u16 f;
2538:bluetooth_rxtx.c **** 	u8 i = 0;
2539:bluetooth_rxtx.c **** 	u8 buf[DMA_SIZE];
2540:bluetooth_rxtx.c **** 
2541:bluetooth_rxtx.c **** 	RXLED_SET;
 7356              		.loc 1 2541 0
 7357 0006 3D4B     		ldr	r3, .L840
 7358 0008 1022     		movs	r2, #16
 7359 000a 1A60     		str	r2, [r3]
2542:bluetooth_rxtx.c **** 
2543:bluetooth_rxtx.c **** 	queue_init();
 7360              		.loc 1 2543 0
 7361 000c FFF7FEFF 		bl	queue_init
ARM GAS  /tmp/cc1G6faT.s 			page 194


 7362              	.LVL774:
2544:bluetooth_rxtx.c **** 	clkn_start();
 7363              		.loc 1 2544 0
 7364 0010 FFF7FEFF 		bl	clkn_start
 7365              	.LVL775:
2545:bluetooth_rxtx.c **** 
2546:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2547:bluetooth_rxtx.c **** 	PAEN_SET;
 7366              		.loc 1 2547 0
 7367 0014 3A4B     		ldr	r3, .L840+4
 7368 0016 8022     		movs	r2, #128
 7369 0018 1A60     		str	r2, [r3]
2548:bluetooth_rxtx.c **** 	//HGM_SET;
2549:bluetooth_rxtx.c **** #endif
2550:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 7370              		.loc 1 2550 0
 7371 001a 1220     		movs	r0, #18
 7372 001c 42F62231 		movw	r1, #11042
 7373 0020 FFF7FEFF 		bl	cc2400_set
 7374              	.LVL776:
2551:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 7375              		.loc 1 2551 0
 7376 0024 1420     		movs	r0, #20
 7377 0026 41F24B31 		movw	r1, #4939
 7378 002a FFF7FEFF 		bl	cc2400_set
 7379              	.LVL777:
2552:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 7380              		.loc 1 2552 0
 7381 002e 2020     		movs	r0, #32
 7382 0030 40F20111 		movw	r1, #257
 7383 0034 FFF7FEFF 		bl	cc2400_set
 7384              	.LVL778:
2553:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 7385              		.loc 1 2553 0
 7386 0038 0320     		movs	r0, #3
 7387 003a 2921     		movs	r1, #41
 7388 003c FFF7FEFF 		bl	cc2400_set
 7389              	.LVL779:
 7390              	.L825:
2554:bluetooth_rxtx.c **** 	//FIXME maybe set RSSI.RSSI_FILT
2555:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 7391              		.loc 1 2555 0 discriminator 1
 7392 0040 FFF7FEFF 		bl	cc2400_status
 7393              	.LVL780:
 7394 0044 4306     		lsls	r3, r0, #25
 7395 0046 FBD5     		bpl	.L825
 7396              	.L827:
2556:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 7397              		.loc 1 2556 0
 7398 0048 FFF7FEFF 		bl	cc2400_status
 7399              	.LVL781:
 7400 004c 00F00400 		and	r0, r0, #4
 7401 0050 00F0FF05 		and	r5, r0, #255
 7402 0054 0028     		cmp	r0, #0
 7403 0056 F7D1     		bne	.L827
 7404              	.LVL782:
 7405              	.L828:
ARM GAS  /tmp/cc1G6faT.s 			page 195


2557:bluetooth_rxtx.c **** 
2558:bluetooth_rxtx.c **** 	while (requested_mode == MODE_SPECAN) {
 7406              		.loc 1 2558 0 discriminator 1
 7407 0058 2A4B     		ldr	r3, .L840+8
 7408 005a 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 7409 005c 042B     		cmp	r3, #4
 7410 005e 47D1     		bne	.L839
2559:bluetooth_rxtx.c **** 		for (f = low_freq; f < high_freq + 1; f++) {
 7411              		.loc 1 2559 0
 7412 0060 294B     		ldr	r3, .L840+12
 7413 0062 B3F84C40 		ldrh	r4, [r3, #76]
 7414 0066 9846     		mov	r8, r3
 7415 0068 A4B2     		uxth	r4, r4
 7416              	.LVL783:
 7417              	.L829:
 7418              		.loc 1 2559 0 is_stmt 0 discriminator 1
 7419 006a B8F84E30 		ldrh	r3, [r8, #78]
 7420 006e 9BB2     		uxth	r3, r3
 7421 0070 A342     		cmp	r3, r4
 7422 0072 F1DB     		blt	.L828
 7423 0074 611E     		subs	r1, r4, #1
 7424              	.LBB70:
2560:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 7425              		.loc 1 2560 0 is_stmt 1
 7426 0076 0220     		movs	r0, #2
 7427 0078 89B2     		uxth	r1, r1
 7428 007a FFF7FEFF 		bl	cc2400_set
 7429              	.LVL784:
2561:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 7430              		.loc 1 2561 0
 7431 007e 6120     		movs	r0, #97
 7432 0080 FFF7FEFF 		bl	cc2400_strobe
 7433              	.LVL785:
 7434              	.L831:
2562:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 7435              		.loc 1 2562 0 discriminator 1
 7436 0084 FFF7FEFF 		bl	cc2400_status
 7437              	.LVL786:
 7438 0088 4707     		lsls	r7, r0, #29
 7439 008a FBD5     		bpl	.L831
2563:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 7440              		.loc 1 2563 0
 7441 008c 6220     		movs	r0, #98
 7442 008e FFF7FEFF 		bl	cc2400_strobe
 7443              	.LVL787:
2564:bluetooth_rxtx.c **** 
2565:bluetooth_rxtx.c **** 			/* give the CC2400 time to acquire RSSI reading */
2566:bluetooth_rxtx.c **** 			volatile u32 j = 500; while (--j); //FIXME crude delay
 7444              		.loc 1 2566 0
 7445 0092 4FF4FA73 		mov	r3, #500
 7446 0096 0093     		str	r3, [sp]
 7447              	.L833:
 7448              		.loc 1 2566 0 is_stmt 0 discriminator 1
 7449 0098 009E     		ldr	r6, [sp]
 7450 009a 013E     		subs	r6, r6, #1
 7451 009c 0096     		str	r6, [sp]
 7452 009e 002E     		cmp	r6, #0
ARM GAS  /tmp/cc1G6faT.s 			page 196


 7453 00a0 FAD1     		bne	.L833
2567:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 7454              		.loc 1 2567 0 is_stmt 1
 7455 00a2 0EAB     		add	r3, sp, #56
 7456 00a4 0327     		movs	r7, #3
 7457 00a6 07FB0537 		mla	r7, r7, r5, r3
2568:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
2569:bluetooth_rxtx.c **** 			buf[(3 * i) + 2] = cc2400_get(RSSI) >> 8;
 7458              		.loc 1 2569 0
 7459 00aa 0620     		movs	r0, #6
2567:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 7460              		.loc 1 2567 0
 7461 00ac 230A     		lsrs	r3, r4, #8
 7462 00ae 07F8343C 		strb	r3, [r7, #-52]
2568:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
 7463              		.loc 1 2568 0
 7464 00b2 07F8334C 		strb	r4, [r7, #-51]
 7465              		.loc 1 2569 0
 7466 00b6 FFF7FEFF 		bl	cc2400_get
 7467              	.LVL788:
2570:bluetooth_rxtx.c **** 			i++;
 7468              		.loc 1 2570 0
 7469 00ba 0135     		adds	r5, r5, #1
 7470              	.LVL789:
 7471 00bc EDB2     		uxtb	r5, r5
 7472              	.LVL790:
2569:bluetooth_rxtx.c **** 			i++;
 7473              		.loc 1 2569 0
 7474 00be 000A     		lsrs	r0, r0, #8
2571:bluetooth_rxtx.c **** 			if (i == 16) {
 7475              		.loc 1 2571 0
 7476 00c0 102D     		cmp	r5, #16
2569:bluetooth_rxtx.c **** 			i++;
 7477              		.loc 1 2569 0
 7478 00c2 07F8320C 		strb	r0, [r7, #-50]
 7479              		.loc 1 2571 0
 7480 00c6 09D1     		bne	.L834
2572:bluetooth_rxtx.c **** 				enqueue(SPECAN, buf);
 7481              		.loc 1 2572 0
 7482 00c8 0420     		movs	r0, #4
 7483 00ca 0DEB0001 		add	r1, sp, r0
 7484 00ce FFF7FEFF 		bl	enqueue
 7485              	.LVL791:
2573:bluetooth_rxtx.c **** 				i = 0;
2574:bluetooth_rxtx.c **** 
2575:bluetooth_rxtx.c **** 				handle_usb(clkn);
 7486              		.loc 1 2575 0
 7487 00d2 0E4B     		ldr	r3, .L840+16
2573:bluetooth_rxtx.c **** 				i = 0;
 7488              		.loc 1 2573 0
 7489 00d4 3546     		mov	r5, r6
 7490              		.loc 1 2575 0
 7491 00d6 1868     		ldr	r0, [r3]
 7492 00d8 FFF7FEFF 		bl	handle_usb
 7493              	.LVL792:
 7494              	.L834:
2576:bluetooth_rxtx.c **** 			}
ARM GAS  /tmp/cc1G6faT.s 			page 197


2577:bluetooth_rxtx.c **** 
2578:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 7495              		.loc 1 2578 0
 7496 00dc 6420     		movs	r0, #100
 7497 00de FFF7FEFF 		bl	cc2400_strobe
 7498              	.LVL793:
 7499              	.L836:
2579:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 7500              		.loc 1 2579 0 discriminator 1
 7501 00e2 FFF7FEFF 		bl	cc2400_status
 7502              	.LVL794:
 7503 00e6 4607     		lsls	r6, r0, #29
 7504 00e8 FBD4     		bmi	.L836
 7505              	.LBE70:
2559:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 7506              		.loc 1 2559 0
 7507 00ea 0134     		adds	r4, r4, #1
 7508              	.LVL795:
 7509 00ec A4B2     		uxth	r4, r4
 7510              	.LVL796:
 7511 00ee BCE7     		b	.L829
 7512              	.LVL797:
 7513              	.L839:
2580:bluetooth_rxtx.c **** 		}
2581:bluetooth_rxtx.c **** 	}
2582:bluetooth_rxtx.c **** 	RXLED_CLR;
 7514              		.loc 1 2582 0
 7515 00f0 074B     		ldr	r3, .L840+20
 7516 00f2 1022     		movs	r2, #16
 7517 00f4 1A60     		str	r2, [r3]
2583:bluetooth_rxtx.c **** }
 7518              		.loc 1 2583 0
 7519 00f6 0EB0     		add	sp, sp, #56
 7520              		@ sp needed
 7521 00f8 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 7522              	.LVL798:
 7523              	.L841:
 7524              		.align	2
 7525              	.L840:
 7526 00fc 38C00920 		.word	537509944
 7527 0100 58C00920 		.word	537509976
 7528 0104 00000000 		.word	.LANCHOR0
 7529 0108 00000000 		.word	.LANCHOR1
 7530 010c 00000000 		.word	clkn
 7531 0110 3CC00920 		.word	537509948
 7532              		.cfi_endproc
 7533              	.LFE37:
 7535              		.section	.text.led_specan,"ax",%progbits
 7536              		.align	1
 7537              		.global	led_specan
 7538              		.thumb
 7539              		.thumb_func
 7541              	led_specan:
 7542              	.LFB38:
2584:bluetooth_rxtx.c **** 
2585:bluetooth_rxtx.c **** /* LED based spectrum analysis */
2586:bluetooth_rxtx.c **** void led_specan()
ARM GAS  /tmp/cc1G6faT.s 			page 198


2587:bluetooth_rxtx.c **** {
 7543              		.loc 1 2587 0
 7544              		.cfi_startproc
 7545              		@ args = 0, pretend = 0, frame = 16
 7546              		@ frame_needed = 0, uses_anonymous_args = 0
 7547 0000 1FB5     		push	{r0, r1, r2, r3, r4, lr}
 7548              		.cfi_def_cfa_offset 24
 7549              		.cfi_offset 0, -24
 7550              		.cfi_offset 1, -20
 7551              		.cfi_offset 2, -16
 7552              		.cfi_offset 3, -12
 7553              		.cfi_offset 4, -8
 7554              		.cfi_offset 14, -4
 7555              	.LVL799:
2588:bluetooth_rxtx.c **** 	int8_t lvl;
2589:bluetooth_rxtx.c **** 	u8 i = 0;
2590:bluetooth_rxtx.c **** 	u16 channels[3] = {2412, 2437, 2462};
 7556              		.loc 1 2590 0
 7557 0002 444B     		ldr	r3, .L869
2591:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
2592:bluetooth_rxtx.c **** 	//void (*clr[3]) = {TXLED_CLR, RXLED_CLR, USRLED_CLR};
2593:bluetooth_rxtx.c **** 
2594:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2595:bluetooth_rxtx.c **** 	PAEN_SET;
 7558              		.loc 1 2595 0
 7559 0004 8022     		movs	r2, #128
2590:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
 7560              		.loc 1 2590 0
 7561 0006 1868     		ldr	r0, [r3]	@ unaligned
 7562 0008 9B88     		ldrh	r3, [r3, #4]	@ unaligned
 7563 000a 0290     		str	r0, [sp, #8]	@ unaligned
 7564 000c ADF80C30 		strh	r3, [sp, #12]	@ unaligned
 7565              		.loc 1 2595 0
 7566 0010 414B     		ldr	r3, .L869+4
2596:bluetooth_rxtx.c **** 	//HGM_SET;
2597:bluetooth_rxtx.c **** #endif
2598:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 7567              		.loc 1 2598 0
 7568 0012 1220     		movs	r0, #18
2595:bluetooth_rxtx.c **** 	//HGM_SET;
 7569              		.loc 1 2595 0
 7570 0014 1A60     		str	r2, [r3]
 7571              		.loc 1 2598 0
 7572 0016 42F62231 		movw	r1, #11042
 7573 001a FFF7FEFF 		bl	cc2400_set
 7574              	.LVL800:
2599:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 7575              		.loc 1 2599 0
 7576 001e 1420     		movs	r0, #20
 7577 0020 41F24B31 		movw	r1, #4939
 7578 0024 FFF7FEFF 		bl	cc2400_set
 7579              	.LVL801:
2600:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 7580              		.loc 1 2600 0
 7581 0028 2020     		movs	r0, #32
 7582 002a 40F20111 		movw	r1, #257
 7583 002e FFF7FEFF 		bl	cc2400_set
ARM GAS  /tmp/cc1G6faT.s 			page 199


 7584              	.LVL802:
2601:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 7585              		.loc 1 2601 0
 7586 0032 0320     		movs	r0, #3
 7587 0034 2921     		movs	r1, #41
 7588 0036 FFF7FEFF 		bl	cc2400_set
 7589              	.LVL803:
2602:bluetooth_rxtx.c **** 	cc2400_set(RSSI,    0x00F1); // RSSI Sample over 2 symbols
 7590              		.loc 1 2602 0
 7591 003a 0620     		movs	r0, #6
 7592 003c F121     		movs	r1, #241
 7593 003e FFF7FEFF 		bl	cc2400_set
 7594              	.LVL804:
 7595              	.L844:
2603:bluetooth_rxtx.c **** 
2604:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 7596              		.loc 1 2604 0 discriminator 1
 7597 0042 FFF7FEFF 		bl	cc2400_status
 7598              	.LVL805:
 7599 0046 4006     		lsls	r0, r0, #25
 7600 0048 FBD5     		bpl	.L844
 7601              	.L846:
2605:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 7602              		.loc 1 2605 0
 7603 004a FFF7FEFF 		bl	cc2400_status
 7604              	.LVL806:
 7605 004e 00F00400 		and	r0, r0, #4
 7606 0052 00F0FF04 		and	r4, r0, #255
 7607 0056 0028     		cmp	r0, #0
 7608 0058 F7D1     		bne	.L846
 7609              	.LVL807:
 7610              	.L847:
2606:bluetooth_rxtx.c **** 
2607:bluetooth_rxtx.c **** 	while (requested_mode == MODE_LED_SPECAN) {
 7611              		.loc 1 2607 0 discriminator 1
 7612 005a 304B     		ldr	r3, .L869+8
 7613 005c 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 7614 005e 072B     		cmp	r3, #7
 7615 0060 55D1     		bne	.L868
 7616              	.LBB71:
2608:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channels[i] - 1);
 7617              		.loc 1 2608 0
 7618 0062 04AA     		add	r2, sp, #16
 7619 0064 02EB4403 		add	r3, r2, r4, lsl #1
 7620 0068 33F8081C 		ldrh	r1, [r3, #-8]
 7621 006c 0220     		movs	r0, #2
 7622 006e 0139     		subs	r1, r1, #1
 7623 0070 89B2     		uxth	r1, r1
 7624 0072 FFF7FEFF 		bl	cc2400_set
 7625              	.LVL808:
2609:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 7626              		.loc 1 2609 0
 7627 0076 6120     		movs	r0, #97
 7628 0078 FFF7FEFF 		bl	cc2400_strobe
 7629              	.LVL809:
 7630              	.L849:
2610:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
ARM GAS  /tmp/cc1G6faT.s 			page 200


 7631              		.loc 1 2610 0 discriminator 1
 7632 007c FFF7FEFF 		bl	cc2400_status
 7633              	.LVL810:
 7634 0080 4107     		lsls	r1, r0, #29
 7635 0082 FBD5     		bpl	.L849
2611:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 7636              		.loc 1 2611 0
 7637 0084 6220     		movs	r0, #98
 7638 0086 FFF7FEFF 		bl	cc2400_strobe
 7639              	.LVL811:
2612:bluetooth_rxtx.c **** 
2613:bluetooth_rxtx.c **** 		/* give the CC2400 time to acquire RSSI reading */
2614:bluetooth_rxtx.c **** 		volatile u32 j = 500; while (--j); //FIXME crude delay
 7640              		.loc 1 2614 0
 7641 008a 4FF4FA73 		mov	r3, #500
 7642 008e 0193     		str	r3, [sp, #4]
 7643              	.L851:
 7644              		.loc 1 2614 0 is_stmt 0 discriminator 1
 7645 0090 019B     		ldr	r3, [sp, #4]
 7646 0092 013B     		subs	r3, r3, #1
 7647 0094 0193     		str	r3, [sp, #4]
 7648 0096 002B     		cmp	r3, #0
 7649 0098 FAD1     		bne	.L851
2615:bluetooth_rxtx.c **** 		lvl = (int8_t)((cc2400_get(RSSI) >> 8) & 0xff);
 7650              		.loc 1 2615 0 is_stmt 1
 7651 009a 0620     		movs	r0, #6
 7652 009c FFF7FEFF 		bl	cc2400_get
 7653              	.LVL812:
2616:bluetooth_rxtx.c **** 		if (lvl > rssi_threshold) {
 7654              		.loc 1 2616 0
 7655 00a0 1F4B     		ldr	r3, .L869+12
 7656 00a2 40F30720 		sbfx	r0, r0, #8, #8
 7657              	.LVL813:
 7658 00a6 93F85030 		ldrb	r3, [r3, #80]	@ zero_extendqisi2
 7659 00aa 5BB2     		sxtb	r3, r3
 7660 00ac 9842     		cmp	r0, r3
 7661 00ae 0CDD     		ble	.L852
2617:bluetooth_rxtx.c **** 			switch (i) {
 7662              		.loc 1 2617 0
 7663 00b0 012C     		cmp	r4, #1
 7664 00b2 07D0     		beq	.L854
 7665 00b4 03D3     		bcc	.L855
 7666 00b6 022C     		cmp	r4, #2
 7667 00b8 16D1     		bne	.L853
2618:bluetooth_rxtx.c **** 				case 0:
2619:bluetooth_rxtx.c **** 					TXLED_SET;
2620:bluetooth_rxtx.c **** 					break;
2621:bluetooth_rxtx.c **** 				case 1:
2622:bluetooth_rxtx.c **** 					RXLED_SET;
2623:bluetooth_rxtx.c **** 					break;
2624:bluetooth_rxtx.c **** 				case 2:
2625:bluetooth_rxtx.c **** 					USRLED_SET;
 7668              		.loc 1 2625 0
 7669 00ba 1A4B     		ldr	r3, .L869+16
 7670 00bc 13E0     		b	.L864
 7671              	.L855:
2619:bluetooth_rxtx.c **** 					break;
ARM GAS  /tmp/cc1G6faT.s 			page 201


 7672              		.loc 1 2619 0
 7673 00be 4FF48072 		mov	r2, #256
 7674 00c2 00E0     		b	.L867
 7675              	.L854:
2622:bluetooth_rxtx.c **** 					break;
 7676              		.loc 1 2622 0
 7677 00c4 1022     		movs	r2, #16
 7678              	.L867:
 7679 00c6 174B     		ldr	r3, .L869+16
 7680 00c8 0BE0     		b	.L866
 7681              	.L852:
2626:bluetooth_rxtx.c **** 					break;
2627:bluetooth_rxtx.c **** 			}
2628:bluetooth_rxtx.c **** 		}
2629:bluetooth_rxtx.c **** 		else {
2630:bluetooth_rxtx.c **** 			switch (i) {
 7682              		.loc 1 2630 0
 7683 00ca 012C     		cmp	r4, #1
 7684 00cc 07D0     		beq	.L857
 7685 00ce 03D3     		bcc	.L858
 7686 00d0 022C     		cmp	r4, #2
 7687 00d2 09D1     		bne	.L853
2631:bluetooth_rxtx.c **** 				case 0:
2632:bluetooth_rxtx.c **** 					TXLED_CLR;
2633:bluetooth_rxtx.c **** 					break;
2634:bluetooth_rxtx.c **** 				case 1:
2635:bluetooth_rxtx.c **** 					RXLED_CLR;
2636:bluetooth_rxtx.c **** 					break;
2637:bluetooth_rxtx.c **** 				case 2:
2638:bluetooth_rxtx.c **** 					USRLED_CLR;
 7688              		.loc 1 2638 0
 7689 00d4 144B     		ldr	r3, .L869+20
 7690 00d6 06E0     		b	.L864
 7691              	.L858:
2632:bluetooth_rxtx.c **** 					break;
 7692              		.loc 1 2632 0
 7693 00d8 4FF48072 		mov	r2, #256
 7694 00dc 00E0     		b	.L865
 7695              	.L857:
2635:bluetooth_rxtx.c **** 					break;
 7696              		.loc 1 2635 0
 7697 00de 1022     		movs	r2, #16
 7698              	.L865:
 7699 00e0 114B     		ldr	r3, .L869+20
 7700              	.L866:
 7701 00e2 1A60     		str	r2, [r3]
2636:bluetooth_rxtx.c **** 				case 2:
 7702              		.loc 1 2636 0
 7703 00e4 00E0     		b	.L853
 7704              	.L864:
 7705              		.loc 1 2638 0
 7706 00e6 1C60     		str	r4, [r3]
 7707              	.L853:
2639:bluetooth_rxtx.c **** 					break;
2640:bluetooth_rxtx.c **** 			}
2641:bluetooth_rxtx.c **** 		}
2642:bluetooth_rxtx.c **** 
ARM GAS  /tmp/cc1G6faT.s 			page 202


2643:bluetooth_rxtx.c **** 		i = (i+1) % 3;
 7708              		.loc 1 2643 0
 7709 00e8 0323     		movs	r3, #3
 7710 00ea 0134     		adds	r4, r4, #1
 7711              	.LVL814:
 7712 00ec 94FBF3F2 		sdiv	r2, r4, r3
 7713 00f0 03FB1244 		mls	r4, r3, r2, r4
 7714              	.LVL815:
2644:bluetooth_rxtx.c **** 
2645:bluetooth_rxtx.c **** 		handle_usb(clkn);
 7715              		.loc 1 2645 0
 7716 00f4 0D4B     		ldr	r3, .L869+24
2643:bluetooth_rxtx.c **** 
 7717              		.loc 1 2643 0
 7718 00f6 E4B2     		uxtb	r4, r4
 7719              	.LVL816:
 7720              		.loc 1 2645 0
 7721 00f8 1868     		ldr	r0, [r3]
 7722 00fa FFF7FEFF 		bl	handle_usb
 7723              	.LVL817:
2646:bluetooth_rxtx.c **** 
2647:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
 7724              		.loc 1 2647 0
 7725 00fe 6420     		movs	r0, #100
 7726 0100 FFF7FEFF 		bl	cc2400_strobe
 7727              	.LVL818:
 7728              	.L861:
2648:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 7729              		.loc 1 2648 0 discriminator 1
 7730 0104 FFF7FEFF 		bl	cc2400_status
 7731              	.LVL819:
 7732 0108 4207     		lsls	r2, r0, #29
 7733 010a FBD4     		bmi	.L861
 7734 010c A5E7     		b	.L847
 7735              	.L868:
 7736              	.LBE71:
2649:bluetooth_rxtx.c **** 	}
2650:bluetooth_rxtx.c **** }
 7737              		.loc 1 2650 0
 7738 010e 04B0     		add	sp, sp, #16
 7739              		@ sp needed
 7740 0110 10BD     		pop	{r4, pc}
 7741              	.LVL820:
 7742              	.L870:
 7743 0112 00BF     		.align	2
 7744              	.L869:
 7745 0114 C2080000 		.word	.LANCHOR2+2242
 7746 0118 58C00920 		.word	537509976
 7747 011c 00000000 		.word	.LANCHOR0
 7748 0120 00000000 		.word	.LANCHOR1
 7749 0124 38C00920 		.word	537509944
 7750 0128 3CC00920 		.word	537509948
 7751 012c 00000000 		.word	clkn
 7752              		.cfi_endproc
 7753              	.LFE38:
 7755              		.section	.text.startup.main,"ax",%progbits
 7756              		.align	1
ARM GAS  /tmp/cc1G6faT.s 			page 203


 7757              		.global	main
 7758              		.thumb
 7759              		.thumb_func
 7761              	main:
 7762              	.LFB39:
2651:bluetooth_rxtx.c **** 
2652:bluetooth_rxtx.c **** int main()
2653:bluetooth_rxtx.c **** {
 7763              		.loc 1 2653 0
 7764              		.cfi_startproc
 7765              		@ args = 0, pretend = 0, frame = 0
 7766              		@ frame_needed = 0, uses_anonymous_args = 0
 7767 0000 10B5     		push	{r4, lr}
 7768              		.cfi_def_cfa_offset 8
 7769              		.cfi_offset 4, -8
 7770              		.cfi_offset 14, -4
2654:bluetooth_rxtx.c **** 	ubertooth_init();
 7771              		.loc 1 2654 0
 7772 0002 FFF7FEFF 		bl	ubertooth_init
 7773              	.LVL821:
2655:bluetooth_rxtx.c **** 	clkn_init();
 7774              		.loc 1 2655 0
 7775 0006 FFF7FEFF 		bl	clkn_init
 7776              	.LVL822:
2656:bluetooth_rxtx.c **** 	ubertooth_usb_init(vendor_request_handler);
 7777              		.loc 1 2656 0
 7778 000a 5748     		ldr	r0, .L904
 7779 000c FFF7FEFF 		bl	ubertooth_usb_init
 7780              	.LVL823:
 7781              	.L901:
2657:bluetooth_rxtx.c **** 	cc2400_idle();
 7782              		.loc 1 2657 0
 7783 0010 FFF7FEFF 		bl	cc2400_idle
 7784              	.LVL824:
 7785              	.L872:
2658:bluetooth_rxtx.c **** 
2659:bluetooth_rxtx.c **** 	while (1) {
2660:bluetooth_rxtx.c **** 		handle_usb(clkn);
 7786              		.loc 1 2660 0
 7787 0014 554B     		ldr	r3, .L904+4
2661:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 7788              		.loc 1 2661 0
 7789 0016 564C     		ldr	r4, .L904+8
2660:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 7790              		.loc 1 2660 0
 7791 0018 1868     		ldr	r0, [r3]
 7792 001a FFF7FEFF 		bl	handle_usb
 7793              	.LVL825:
 7794              		.loc 1 2661 0
 7795 001e A27C     		ldrb	r2, [r4, #18]	@ zero_extendqisi2
 7796 0020 637C     		ldrb	r3, [r4, #17]	@ zero_extendqisi2
 7797 0022 9A42     		cmp	r2, r3
 7798 0024 F6D0     		beq	.L872
2662:bluetooth_rxtx.c **** 			switch (requested_mode) {
 7799              		.loc 1 2662 0
 7800 0026 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 7801 0028 182B     		cmp	r3, #24
ARM GAS  /tmp/cc1G6faT.s 			page 204


 7802 002a F3D8     		bhi	.L872
 7803 002c 01A2     		adr	r2, .L875
 7804 002e 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 7805 0032 00BF     		.p2align 2
 7806              	.L875:
 7807 0034 11000000 		.word	.L901+1
 7808 0038 A9000000 		.word	.L876+1
 7809 003c B3000000 		.word	.L877+1
 7810 0040 D1000000 		.word	.L878+1
 7811 0044 FB000000 		.word	.L879+1
 7812 0048 DF000000 		.word	.L880+1
 7813 004c EF000000 		.word	.L881+1
 7814 0050 01010000 		.word	.L882+1
 7815 0054 BD000000 		.word	.L883+1
 7816 0058 C1000000 		.word	.L884+1
 7817 005c C7000000 		.word	.L885+1
 7818 0060 99000000 		.word	.L886+1
 7819 0064 CD000000 		.word	.L887+1
 7820 0068 07010000 		.word	.L888+1
 7821 006c A5000000 		.word	.L889+1
 7822 0070 13010000 		.word	.L890+1
 7823 0074 1D010000 		.word	.L891+1
 7824 0078 23010000 		.word	.L892+1
 7825 007c 2B010000 		.word	.L893+1
 7826 0080 33010000 		.word	.L894+1
 7827 0084 3B010000 		.word	.L895+1
 7828 0088 43010000 		.word	.L896+1
 7829 008c 4B010000 		.word	.L897+1
 7830 0090 53010000 		.word	.L898+1
 7831 0094 5B010000 		.word	.L899+1
 7832              	.L886:
2663:bluetooth_rxtx.c **** 				case MODE_RESET:
2664:bluetooth_rxtx.c **** 					/* Allow time for the USB command to return correctly */
2665:bluetooth_rxtx.c **** 					wait(1);
 7833              		.loc 1 2665 0
 7834 0098 0120     		movs	r0, #1
 7835 009a FFF7FEFF 		bl	wait
 7836              	.LVL826:
2666:bluetooth_rxtx.c **** 					reset();
 7837              		.loc 1 2666 0
 7838 009e FFF7FEFF 		bl	reset
 7839              	.LVL827:
2667:bluetooth_rxtx.c **** 					break;
 7840              		.loc 1 2667 0
 7841 00a2 B7E7     		b	.L872
 7842              	.L889:
2668:bluetooth_rxtx.c **** 				case MODE_AFH:
2669:bluetooth_rxtx.c **** 					mode = MODE_AFH;
 7843              		.loc 1 2669 0
 7844 00a4 0E23     		movs	r3, #14
 7845 00a6 00E0     		b	.L902
 7846              	.L876:
2670:bluetooth_rxtx.c **** 					bt_stream_rx();
2671:bluetooth_rxtx.c **** 					break;
2672:bluetooth_rxtx.c **** 				case MODE_RX_SYMBOLS:
2673:bluetooth_rxtx.c **** 					mode = MODE_RX_SYMBOLS;
 7847              		.loc 1 2673 0
ARM GAS  /tmp/cc1G6faT.s 			page 205


 7848 00a8 0123     		movs	r3, #1
 7849              	.L902:
 7850 00aa 6374     		strb	r3, [r4, #17]
2674:bluetooth_rxtx.c **** 					bt_stream_rx();
 7851              		.loc 1 2674 0
 7852 00ac FFF7FEFF 		bl	bt_stream_rx
 7853              	.LVL828:
2675:bluetooth_rxtx.c **** 					break;
 7854              		.loc 1 2675 0
 7855 00b0 B0E7     		b	.L872
 7856              	.L877:
2676:bluetooth_rxtx.c **** 				case MODE_TX_SYMBOLS:
2677:bluetooth_rxtx.c **** 					mode = MODE_TX_SYMBOLS;
 7857              		.loc 1 2677 0
 7858 00b2 0223     		movs	r3, #2
 7859 00b4 6374     		strb	r3, [r4, #17]
2678:bluetooth_rxtx.c **** 					br_transmit();
 7860              		.loc 1 2678 0
 7861 00b6 FFF7FEFF 		bl	br_transmit
 7862              	.LVL829:
2679:bluetooth_rxtx.c **** 					break;
 7863              		.loc 1 2679 0
 7864 00ba ABE7     		b	.L872
 7865              	.L883:
2680:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW:
2681:bluetooth_rxtx.c **** 					mode = MODE_BT_FOLLOW;
 7866              		.loc 1 2681 0
 7867 00bc 0823     		movs	r3, #8
 7868 00be F4E7     		b	.L902
 7869              	.L884:
2682:bluetooth_rxtx.c **** 					bt_stream_rx();
2683:bluetooth_rxtx.c **** 					break;
2684:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW_LE:
2685:bluetooth_rxtx.c **** 					bt_follow_le();
 7870              		.loc 1 2685 0
 7871 00c0 FFF7FEFF 		bl	bt_follow_le
 7872              	.LVL830:
2686:bluetooth_rxtx.c **** 					break;
 7873              		.loc 1 2686 0
 7874 00c4 A6E7     		b	.L872
 7875              	.L885:
2687:bluetooth_rxtx.c **** 				case MODE_BT_PROMISC_LE:
2688:bluetooth_rxtx.c **** 					bt_promisc_le();
 7876              		.loc 1 2688 0
 7877 00c6 FFF7FEFF 		bl	bt_promisc_le
 7878              	.LVL831:
2689:bluetooth_rxtx.c **** 					break;
 7879              		.loc 1 2689 0
 7880 00ca A3E7     		b	.L872
 7881              	.L887:
2690:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE:
2691:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE;
 7882              		.loc 1 2691 0
 7883 00cc 0C23     		movs	r3, #12
 7884 00ce 45E0     		b	.L903
 7885              	.L878:
2692:bluetooth_rxtx.c **** 					bt_slave_le(0x000f);
ARM GAS  /tmp/cc1G6faT.s 			page 206


2693:bluetooth_rxtx.c **** 					break;
2694:bluetooth_rxtx.c **** 				case MODE_TX_TEST:
2695:bluetooth_rxtx.c **** 					mode = MODE_TX_TEST;
 7886              		.loc 1 2695 0
 7887 00d0 0323     		movs	r3, #3
2696:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 7888              		.loc 1 2696 0
 7889 00d2 2748     		ldr	r0, .L904+8
 7890 00d4 2749     		ldr	r1, .L904+12
2695:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 7891              		.loc 1 2695 0
 7892 00d6 6374     		strb	r3, [r4, #17]
 7893              		.loc 1 2696 0
 7894 00d8 FFF7FEFF 		bl	cc2400_txtest
 7895              	.LVL832:
2697:bluetooth_rxtx.c **** 					break;
 7896              		.loc 1 2697 0
 7897 00dc 9AE7     		b	.L872
 7898              	.L880:
2698:bluetooth_rxtx.c **** 				case MODE_RANGE_TEST:
2699:bluetooth_rxtx.c **** 					mode = MODE_RANGE_TEST;
 7899              		.loc 1 2699 0
 7900 00de 0523     		movs	r3, #5
2700:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 7901              		.loc 1 2700 0
 7902 00e0 2448     		ldr	r0, .L904+12
2699:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 7903              		.loc 1 2699 0
 7904 00e2 6374     		strb	r3, [r4, #17]
 7905              		.loc 1 2700 0
 7906 00e4 FFF7FEFF 		bl	cc2400_rangetest
 7907              	.LVL833:
2701:bluetooth_rxtx.c **** 					requested_mode = MODE_IDLE;
 7908              		.loc 1 2701 0
 7909 00e8 0023     		movs	r3, #0
 7910 00ea A374     		strb	r3, [r4, #18]
2702:bluetooth_rxtx.c **** 					break;
 7911              		.loc 1 2702 0
 7912 00ec 92E7     		b	.L872
 7913              	.L881:
2703:bluetooth_rxtx.c **** 				case MODE_REPEATER:
2704:bluetooth_rxtx.c **** 					mode = MODE_REPEATER;
 7914              		.loc 1 2704 0
 7915 00ee 0623     		movs	r3, #6
2705:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 7916              		.loc 1 2705 0
 7917 00f0 2048     		ldr	r0, .L904+12
2704:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 7918              		.loc 1 2704 0
 7919 00f2 6374     		strb	r3, [r4, #17]
 7920              		.loc 1 2705 0
 7921 00f4 FFF7FEFF 		bl	cc2400_repeater
 7922              	.LVL834:
2706:bluetooth_rxtx.c **** 					break;
 7923              		.loc 1 2706 0
 7924 00f8 8CE7     		b	.L872
 7925              	.L879:
ARM GAS  /tmp/cc1G6faT.s 			page 207


2707:bluetooth_rxtx.c **** 				case MODE_SPECAN:
2708:bluetooth_rxtx.c **** 					specan();
 7926              		.loc 1 2708 0
 7927 00fa FFF7FEFF 		bl	specan
 7928              	.LVL835:
2709:bluetooth_rxtx.c **** 					break;
 7929              		.loc 1 2709 0
 7930 00fe 89E7     		b	.L872
 7931              	.L882:
2710:bluetooth_rxtx.c **** 				case MODE_LED_SPECAN:
2711:bluetooth_rxtx.c **** 					led_specan();
 7932              		.loc 1 2711 0
 7933 0100 FFF7FEFF 		bl	led_specan
 7934              	.LVL836:
2712:bluetooth_rxtx.c **** 					break;
 7935              		.loc 1 2712 0
 7936 0104 86E7     		b	.L872
 7937              	.L888:
2713:bluetooth_rxtx.c **** 				case MODE_EGO:
2714:bluetooth_rxtx.c **** 					mode = MODE_EGO;
 7938              		.loc 1 2714 0
 7939 0106 0D23     		movs	r3, #13
 7940 0108 6374     		strb	r3, [r4, #17]
2715:bluetooth_rxtx.c **** 					ego_main(ego_mode);
 7941              		.loc 1 2715 0
 7942 010a 207D     		ldrb	r0, [r4, #20]	@ zero_extendqisi2
 7943 010c FFF7FEFF 		bl	ego_main
 7944              	.LVL837:
2716:bluetooth_rxtx.c **** 					break;
 7945              		.loc 1 2716 0
 7946 0110 80E7     		b	.L872
 7947              	.L890:
2717:bluetooth_rxtx.c **** 				case MODE_RX_GENERIC:
2718:bluetooth_rxtx.c **** 					mode = MODE_RX_GENERIC;
 7948              		.loc 1 2718 0
 7949 0112 0F23     		movs	r3, #15
 7950 0114 6374     		strb	r3, [r4, #17]
2719:bluetooth_rxtx.c **** 					rx_generic();
 7951              		.loc 1 2719 0
 7952 0116 FFF7FEFF 		bl	rx_generic
 7953              	.LVL838:
2720:bluetooth_rxtx.c **** 					break;
 7954              		.loc 1 2720 0
 7955 011a 7BE7     		b	.L872
 7956              	.L891:
2721:bluetooth_rxtx.c **** 				case MODE_TX_GENERIC:
2722:bluetooth_rxtx.c **** 					tx_generic();
 7957              		.loc 1 2722 0
 7958 011c FFF7FEFF 		bl	tx_generic
 7959              	.LVL839:
2723:bluetooth_rxtx.c **** 					break;
 7960              		.loc 1 2723 0
 7961 0120 78E7     		b	.L872
 7962              	.L892:
2724:bluetooth_rxtx.c **** 				case MODE_IDLE:
2725:bluetooth_rxtx.c **** 					cc2400_idle();
2726:bluetooth_rxtx.c **** 					break;
ARM GAS  /tmp/cc1G6faT.s 			page 208


2727:bluetooth_rxtx.c **** 				// JWHUR POWER CONTROL
2728:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P0:
2729:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P0;
 7963              		.loc 1 2729 0
 7964 0122 1123     		movs	r3, #17
 7965 0124 6374     		strb	r3, [r4, #17]
2730:bluetooth_rxtx.c **** 					bt_slave_le(0x0008);
 7966              		.loc 1 2730 0
 7967 0126 0820     		movs	r0, #8
 7968 0128 1AE0     		b	.L900
 7969              	.L893:
2731:bluetooth_rxtx.c **** 					break;
2732:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P1:
2733:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P1;
 7970              		.loc 1 2733 0
 7971 012a 1223     		movs	r3, #18
 7972 012c 6374     		strb	r3, [r4, #17]
2734:bluetooth_rxtx.c **** 					bt_slave_le(0x0009);
 7973              		.loc 1 2734 0
 7974 012e 0920     		movs	r0, #9
 7975 0130 16E0     		b	.L900
 7976              	.L894:
2735:bluetooth_rxtx.c **** 					break;
2736:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P2:
2737:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P2;
 7977              		.loc 1 2737 0
 7978 0132 1323     		movs	r3, #19
 7979 0134 6374     		strb	r3, [r4, #17]
2738:bluetooth_rxtx.c **** 					bt_slave_le(0x000a);
 7980              		.loc 1 2738 0
 7981 0136 0A20     		movs	r0, #10
 7982 0138 12E0     		b	.L900
 7983              	.L895:
2739:bluetooth_rxtx.c **** 					break;
2740:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P3:
2741:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P3;
 7984              		.loc 1 2741 0
 7985 013a 1423     		movs	r3, #20
 7986 013c 6374     		strb	r3, [r4, #17]
2742:bluetooth_rxtx.c **** 					bt_slave_le(0x000b);
 7987              		.loc 1 2742 0
 7988 013e 0B20     		movs	r0, #11
 7989 0140 0EE0     		b	.L900
 7990              	.L896:
2743:bluetooth_rxtx.c **** 					break;
2744:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P4:
2745:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P4;
 7991              		.loc 1 2745 0
 7992 0142 1523     		movs	r3, #21
 7993 0144 6374     		strb	r3, [r4, #17]
2746:bluetooth_rxtx.c **** 					bt_slave_le(0x000c);
 7994              		.loc 1 2746 0
 7995 0146 0C20     		movs	r0, #12
 7996 0148 0AE0     		b	.L900
 7997              	.L897:
2747:bluetooth_rxtx.c **** 					break;
2748:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P5:
ARM GAS  /tmp/cc1G6faT.s 			page 209


2749:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P5;
 7998              		.loc 1 2749 0
 7999 014a 1623     		movs	r3, #22
 8000 014c 6374     		strb	r3, [r4, #17]
2750:bluetooth_rxtx.c **** 					bt_slave_le(0x000d);
 8001              		.loc 1 2750 0
 8002 014e 0D20     		movs	r0, #13
 8003 0150 06E0     		b	.L900
 8004              	.L898:
2751:bluetooth_rxtx.c **** 					break;
2752:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P6:
2753:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P6;
 8005              		.loc 1 2753 0
 8006 0152 1723     		movs	r3, #23
 8007 0154 6374     		strb	r3, [r4, #17]
2754:bluetooth_rxtx.c **** 					bt_slave_le(0x000e);
 8008              		.loc 1 2754 0
 8009 0156 0E20     		movs	r0, #14
 8010 0158 02E0     		b	.L900
 8011              	.L899:
2755:bluetooth_rxtx.c **** 					break;
2756:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P7:
2757:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE_P7;
 8012              		.loc 1 2757 0
 8013 015a 1823     		movs	r3, #24
 8014              	.L903:
 8015 015c 6374     		strb	r3, [r4, #17]
2758:bluetooth_rxtx.c **** 					bt_slave_le(0x000f);
 8016              		.loc 1 2758 0
 8017 015e 0F20     		movs	r0, #15
 8018              	.L900:
 8019 0160 FFF7FEFF 		bl	bt_slave_le
 8020              	.LVL840:
2759:bluetooth_rxtx.c **** 					break;
 8021              		.loc 1 2759 0
 8022 0164 56E7     		b	.L872
 8023              	.L905:
 8024 0166 00BF     		.align	2
 8025              	.L904:
 8026 0168 00000000 		.word	vendor_request_handler
 8027 016c 00000000 		.word	clkn
 8028 0170 00000000 		.word	.LANCHOR0
 8029 0174 00000000 		.word	.LANCHOR1
 8030              		.cfi_endproc
 8031              	.LFE39:
 8033              		.comm	unpacked,800,1
 8034              		.global	packet_cb
 8035              		.global	data_cb
 8036              		.global	le_jam_count
 8037              		.comm	le_promisc,264,4
 8038              		.global	le
 8039              		.global	slave_mac_address
 8040              		.comm	slave_mac_address_data,4,4
 8041              		.global	dlen
 8042              		.comm	tx_pkt,58,2
 8043              		.global	rssi_threshold
 8044              		.global	high_freq
ARM GAS  /tmp/cc1G6faT.s 			page 210


 8045              		.global	low_freq
 8046              		.global	modulation
 8047              		.global	ego_mode
 8048              		.global	jam_mode
 8049              		.global	requested_mode
 8050              		.global	mode
 8051              		.global	status
 8052              		.global	dma_discard
 8053              		.global	idle_buf_channel
 8054              		.global	idle_buf_clk100ns
 8055              		.global	idle_buf_clkn_high
 8056              		.global	le_adv_channel
 8057              		.global	requested_channel
 8058              		.global	hop_timeout
 8059              		.global	hop_direct_channel
 8060              		.global	channel
 8061              		.global	do_hop
 8062              		.global	hop_mode
 8063              		.global	compile_info
 8064              		.comm	rr,5,1
 8065              		.comm	used_channels,1,1
 8066              		.comm	afh_map,10,1
 8067              		.comm	afh_enabled,1,1
 8068              		.comm	syncword,8,8
 8069              		.comm	target,16,8
 8070              		.comm	clkn_next_drift_fix,4,4
 8071              		.comm	clkn_last_drift_fix,4,4
 8072              		.comm	clk_drift_correction,2,2
 8073              		.comm	clk_drift_ppm,2,2
 8074              		.comm	clk100ns_offset,2,2
 8075              		.comm	clkn_offset,4,4
 8076              		.comm	last_hop,4,4
 8077              		.comm	clkn,4,4
 8078              		.comm	rx_err,4,4
 8079              		.comm	rx_tc,4,4
 8080              		.comm	idle_rxbuf,4,4
 8081              		.comm	active_rxbuf,4,4
 8082              		.comm	rxbuf2,50,1
 8083              		.comm	rxbuf1,50,1
 8084              		.comm	cs_trigger,1,1
 8085              		.comm	cs_threshold_cur,1,1
 8086              		.comm	cs_threshold_req,1,1
 8087              		.comm	cs_no_squelch,1,1
 8088              		.comm	rssi_count,1,1
 8089              		.comm	rssi_min,1,1
 8090              		.comm	rssi_max,1,1
 8091              		.section	.rodata
 8092              		.align	2
 8093              		.set	.LANCHOR2,. + 0
 8096              	whitening_index:
 8097 0000 46       		.byte	70
 8098 0001 3E       		.byte	62
 8099 0002 78       		.byte	120
 8100 0003 6F       		.byte	111
 8101 0004 4D       		.byte	77
 8102 0005 2E       		.byte	46
 8103 0006 0F       		.byte	15
ARM GAS  /tmp/cc1G6faT.s 			page 211


 8104 0007 65       		.byte	101
 8105 0008 42       		.byte	66
 8106 0009 27       		.byte	39
 8107 000a 1F       		.byte	31
 8108 000b 1A       		.byte	26
 8109 000c 50       		.byte	80
 8110 000d 53       		.byte	83
 8111 000e 7D       		.byte	125
 8112 000f 59       		.byte	89
 8113 0010 0A       		.byte	10
 8114 0011 23       		.byte	35
 8115 0012 08       		.byte	8
 8116 0013 36       		.byte	54
 8117 0014 7A       		.byte	122
 8118 0015 11       		.byte	17
 8119 0016 21       		.byte	33
 8120 0017 00       		.byte	0
 8121 0018 3A       		.byte	58
 8122 0019 73       		.byte	115
 8123 001a 06       		.byte	6
 8124 001b 5E       		.byte	94
 8125 001c 56       		.byte	86
 8126 001d 31       		.byte	49
 8127 001e 34       		.byte	52
 8128 001f 14       		.byte	20
 8129 0020 28       		.byte	40
 8130 0021 1B       		.byte	27
 8131 0022 54       		.byte	84
 8132 0023 5A       		.byte	90
 8133 0024 3F       		.byte	63
 8134 0025 70       		.byte	112
 8135 0026 2F       		.byte	47
 8136 0027 66       		.byte	102
 8139              	whitening:
 8140 0028 01       		.byte	1
 8141 0029 01       		.byte	1
 8142 002a 01       		.byte	1
 8143 002b 01       		.byte	1
 8144 002c 00       		.byte	0
 8145 002d 01       		.byte	1
 8146 002e 00       		.byte	0
 8147 002f 01       		.byte	1
 8148 0030 00       		.byte	0
 8149 0031 01       		.byte	1
 8150 0032 00       		.byte	0
 8151 0033 00       		.byte	0
 8152 0034 00       		.byte	0
 8153 0035 00       		.byte	0
 8154 0036 01       		.byte	1
 8155 0037 00       		.byte	0
 8156 0038 01       		.byte	1
 8157 0039 01       		.byte	1
 8158 003a 00       		.byte	0
 8159 003b 01       		.byte	1
 8160 003c 01       		.byte	1
 8161 003d 01       		.byte	1
 8162 003e 01       		.byte	1
ARM GAS  /tmp/cc1G6faT.s 			page 212


 8163 003f 00       		.byte	0
 8164 0040 00       		.byte	0
 8165 0041 01       		.byte	1
 8166 0042 01       		.byte	1
 8167 0043 01       		.byte	1
 8168 0044 00       		.byte	0
 8169 0045 00       		.byte	0
 8170 0046 01       		.byte	1
 8171 0047 00       		.byte	0
 8172 0048 01       		.byte	1
 8173 0049 00       		.byte	0
 8174 004a 01       		.byte	1
 8175 004b 01       		.byte	1
 8176 004c 00       		.byte	0
 8177 004d 00       		.byte	0
 8178 004e 01       		.byte	1
 8179 004f 01       		.byte	1
 8180 0050 00       		.byte	0
 8181 0051 00       		.byte	0
 8182 0052 00       		.byte	0
 8183 0053 00       		.byte	0
 8184 0054 00       		.byte	0
 8185 0055 01       		.byte	1
 8186 0056 01       		.byte	1
 8187 0057 00       		.byte	0
 8188 0058 01       		.byte	1
 8189 0059 01       		.byte	1
 8190 005a 00       		.byte	0
 8191 005b 01       		.byte	1
 8192 005c 00       		.byte	0
 8193 005d 01       		.byte	1
 8194 005e 01       		.byte	1
 8195 005f 01       		.byte	1
 8196 0060 00       		.byte	0
 8197 0061 01       		.byte	1
 8198 0062 00       		.byte	0
 8199 0063 00       		.byte	0
 8200 0064 00       		.byte	0
 8201 0065 01       		.byte	1
 8202 0066 01       		.byte	1
 8203 0067 00       		.byte	0
 8204 0068 00       		.byte	0
 8205 0069 01       		.byte	1
 8206 006a 00       		.byte	0
 8207 006b 00       		.byte	0
 8208 006c 00       		.byte	0
 8209 006d 01       		.byte	1
 8210 006e 00       		.byte	0
 8211 006f 00       		.byte	0
 8212 0070 00       		.byte	0
 8213 0071 00       		.byte	0
 8214 0072 00       		.byte	0
 8215 0073 00       		.byte	0
 8216 0074 01       		.byte	1
 8217 0075 00       		.byte	0
 8218 0076 00       		.byte	0
 8219 0077 01       		.byte	1
ARM GAS  /tmp/cc1G6faT.s 			page 213


 8220 0078 00       		.byte	0
 8221 0079 00       		.byte	0
 8222 007a 01       		.byte	1
 8223 007b 01       		.byte	1
 8224 007c 00       		.byte	0
 8225 007d 01       		.byte	1
 8226 007e 00       		.byte	0
 8227 007f 00       		.byte	0
 8228 0080 01       		.byte	1
 8229 0081 01       		.byte	1
 8230 0082 01       		.byte	1
 8231 0083 01       		.byte	1
 8232 0084 00       		.byte	0
 8233 0085 01       		.byte	1
 8234 0086 01       		.byte	1
 8235 0087 01       		.byte	1
 8236 0088 00       		.byte	0
 8237 0089 00       		.byte	0
 8238 008a 00       		.byte	0
 8239 008b 00       		.byte	0
 8240 008c 01       		.byte	1
 8241 008d 01       		.byte	1
 8242 008e 01       		.byte	1
 8243 008f 01       		.byte	1
 8244 0090 01       		.byte	1
 8245 0091 01       		.byte	1
 8246 0092 01       		.byte	1
 8247 0093 00       		.byte	0
 8248 0094 00       		.byte	0
 8249 0095 00       		.byte	0
 8250 0096 01       		.byte	1
 8251 0097 01       		.byte	1
 8252 0098 01       		.byte	1
 8253 0099 00       		.byte	0
 8254 009a 01       		.byte	1
 8255 009b 01       		.byte	1
 8256 009c 00       		.byte	0
 8257 009d 00       		.byte	0
 8258 009e 00       		.byte	0
 8259 009f 01       		.byte	1
 8260 00a0 00       		.byte	0
 8261 00a1 01       		.byte	1
 8262 00a2 00       		.byte	0
 8263 00a3 00       		.byte	0
 8264 00a4 01       		.byte	1
 8265 00a5 00       		.byte	0
 8266 00a6 01       		.byte	1
 8269              	compile_info:
 8270 00a7 75626572 		.ascii	"ubertooth 2017-03-R2 (mwnl@mwnl-lenovo) 2018. 06. 2"
 8270      746F6F74 
 8270      68203230 
 8270      31372D30 
 8270      332D5232 
 8271 00da 362E2028 		.ascii	"6. (\355\231\224) 13:44:04 KST\000"
 8271      ED999429 
 8271      2031333A 
 8271      34343A30 
ARM GAS  /tmp/cc1G6faT.s 			page 214


 8271      34204B53 
 8274              	whitening_word:
 8275 00f0 40B2BCC3 		.word	-1011043776
 8276 00f4 1F374A5F 		.word	1598699295
 8277 00f8 85F69C9A 		.word	-1700989307
 8278 00fc C1D6C544 		.word	1153816257
 8279 0100 2059DEE1 		.word	-505521888
 8280 0104 8F1BA5AF 		.word	-1348134001
 8281 0108 427B4ECD 		.word	-850494654
 8282 010c 60EB6222 		.word	576908128
 8283 0110 902CEFF0 		.word	-252760944
 8284 0114 C78DD257 		.word	1473416647
 8285 0118 A13DA766 		.word	1722236321
 8286 011c B0753111 		.word	288454064
 8287 0120 8940B2BC 		.word	-1129168759
 8288 0124 C31F374A 		.word	1245126595
 8289 0128 5F85F69C 		.word	-1661565601
 8290 012c 9AC1D6C5 		.word	-975781478
 8291 0130 442059DE 		.word	-564584380
 8292 0134 E18F1BA5 		.word	-1524920351
 8293 0138 AF427B4E 		.word	1316700847
 8294 013c CD60EB62 		.word	1659592909
 8295 0140 22902CEF 		.word	-282292190
 8296 0144 F0C78DD2 		.word	-762460176
 8297 0148 57A13DA7 		.word	-1489133225
 8298 014c 66B07531 		.word	829796454
 8299 0150 D257A13D 		.word	1033983954
 8300 0154 A766B075 		.word	1974494887
 8301 0158 31114896 		.word	-1773661903
 8302 015c 77F8E346 		.word	1189345399
 8303 0160 E9ABD09E 		.word	-1630491671
 8304 0164 5333D8BA 		.word	-1160236205
 8305 0168 980824CB 		.word	-886830952
 8306 016c 3BFC71A3 		.word	-1552810949
 8307 0170 F45568CF 		.word	-815245836
 8308 0174 A9196C5D 		.word	1567365545
 8309 0178 4C0492E5 		.word	-443415476
 8310 017c 1DFEB851 		.word	1371078173
 8311 0180 1BA5AF42 		.word	1118807323
 8312 0184 7B4ECD60 		.word	1624067707
 8313 0188 EB622290 		.word	-1876794645
 8314 018c 2CEFF0C7 		.word	-940511444
 8315 0190 8DD257A1 		.word	-1588079987
 8316 0194 3DA766B0 		.word	-1335449795
 8317 0198 75311148 		.word	1209086325
 8318 019c 9677F8E3 		.word	-470255722
 8319 01a0 46E9ABD0 		.word	-794039994
 8320 01a4 9E5333D8 		.word	-667724898
 8321 01a8 BA980824 		.word	604543162
 8322 01ac CB3BFC71 		.word	1912355787
 8323 01b0 6479873F 		.word	1065843044
 8324 01b4 6E94BE0A 		.word	180261998
 8325 01b8 ED393583 		.word	-2093663763
 8326 01bc AD8B8940 		.word	1082756013
 8327 01c0 B2BCC31F 		.word	532921522
 8328 01c4 374A5F85 		.word	-2057352649
 8329 01c8 F69C9AC1 		.word	-1046831882
ARM GAS  /tmp/cc1G6faT.s 			page 215


 8330 01cc D6C54420 		.word	541378006
 8331 01d0 59DEE18F 		.word	-1881022887
 8332 01d4 1BA5AF42 		.word	1118807323
 8333 01d8 7B4ECD60 		.word	1624067707
 8334 01dc EB622290 		.word	-1876794645
 8335 01e0 AD8B8940 		.word	1082756013
 8336 01e4 B2BCC31F 		.word	532921522
 8337 01e8 374A5F85 		.word	-2057352649
 8338 01ec F69C9AC1 		.word	-1046831882
 8339 01f0 D6C54420 		.word	541378006
 8340 01f4 59DEE18F 		.word	-1881022887
 8341 01f8 1BA5AF42 		.word	1118807323
 8342 01fc 7B4ECD60 		.word	1624067707
 8343 0200 EB622290 		.word	-1876794645
 8344 0204 2CEFF0C7 		.word	-940511444
 8345 0208 8DD257A1 		.word	-1588079987
 8346 020c 3DA766B0 		.word	-1335449795
 8347 0210 F69C9AC1 		.word	-1046831882
 8348 0214 D6C54420 		.word	541378006
 8349 0218 59DEE18F 		.word	-1881022887
 8350 021c 1BA5AF42 		.word	1118807323
 8351 0220 7B4ECD60 		.word	1624067707
 8352 0224 EB622290 		.word	-1876794645
 8353 0228 2CEFF0C7 		.word	-940511444
 8354 022c 8DD257A1 		.word	-1588079987
 8355 0230 3DA766B0 		.word	-1335449795
 8356 0234 75311148 		.word	1209086325
 8357 0238 9677F8E3 		.word	-470255722
 8358 023c 46E9ABD0 		.word	-794039994
 8359 0240 3F6E94BE 		.word	-1097568705
 8360 0244 0AED3935 		.word	892988682
 8361 0248 83AD8B89 		.word	-1987334781
 8362 024c 40B2BCC3 		.word	-1011043776
 8363 0250 1F374A5F 		.word	1598699295
 8364 0254 85F69C9A 		.word	-1700989307
 8365 0258 C1D6C544 		.word	1153816257
 8366 025c 2059DEE1 		.word	-505521888
 8367 0260 8F1BA5AF 		.word	-1348134001
 8368 0264 427B4ECD 		.word	-850494654
 8369 0268 60EB6222 		.word	576908128
 8370 026c 902CEFF0 		.word	-252760944
 8371 0270 0824CB3B 		.word	1003168776
 8372 0274 FC71A3F4 		.word	-190615044
 8373 0278 5568CFA9 		.word	-1446025131
 8374 027c 196C5D4C 		.word	1281190937
 8375 0280 0492E51D 		.word	501584388
 8376 0284 FEB851FA 		.word	-95307522
 8377 0288 2AB4E7D4 		.word	-723012566
 8378 028c 0CB62E26 		.word	640595468
 8379 0290 02C9F20E 		.word	250792194
 8380 0294 7FDC287D 		.word	2099829887
 8381 0298 15DA736A 		.word	1785977365
 8382 029c 065B1713 		.word	320297734
 8383 02a0 C1D6C544 		.word	1153816257
 8384 02a4 2059DEE1 		.word	-505521888
 8385 02a8 8F1BA5AF 		.word	-1348134001
 8386 02ac 427B4ECD 		.word	-850494654
ARM GAS  /tmp/cc1G6faT.s 			page 216


 8387 02b0 60EB6222 		.word	576908128
 8388 02b4 902CEFF0 		.word	-252760944
 8389 02b8 C78DD257 		.word	1473416647
 8390 02bc A13DA766 		.word	1722236321
 8391 02c0 B0753111 		.word	288454064
 8392 02c4 489677F8 		.word	-126380472
 8393 02c8 E346E9AB 		.word	-1410775325
 8394 02cc D09E5333 		.word	861118160
 8395 02d0 9AC1D6C5 		.word	-975781478
 8396 02d4 442059DE 		.word	-564584380
 8397 02d8 E18F1BA5 		.word	-1524920351
 8398 02dc AF427B4E 		.word	1316700847
 8399 02e0 CD60EB62 		.word	1659592909
 8400 02e4 22902CEF 		.word	-282292190
 8401 02e8 F0C78DD2 		.word	-762460176
 8402 02ec 57A13DA7 		.word	-1489133225
 8403 02f0 66B07531 		.word	829796454
 8404 02f4 11489677 		.word	2006337553
 8405 02f8 F8E346E9 		.word	-381230088
 8406 02fc ABD09E53 		.word	1402917035
 8407 0300 5333D8BA 		.word	-1160236205
 8408 0304 980824CB 		.word	-886830952
 8409 0308 3BFC71A3 		.word	-1552810949
 8410 030c F45568CF 		.word	-815245836
 8411 0310 A9196C5D 		.word	1567365545
 8412 0314 4C0492E5 		.word	-443415476
 8413 0318 1DFEB851 		.word	1371078173
 8414 031c FA2AB4E7 		.word	-407622918
 8415 0320 D40CB62E 		.word	783682772
 8416 0324 2602C9F2 		.word	-221707738
 8417 0328 0E7FDC28 		.word	685539086
 8418 032c 7D15DA73 		.word	1943672189
 8419 0330 2CEFF0C7 		.word	-940511444
 8420 0334 8DD257A1 		.word	-1588079987
 8421 0338 3DA766B0 		.word	-1335449795
 8422 033c 75311148 		.word	1209086325
 8423 0340 9677F8E3 		.word	-470255722
 8424 0344 46E9ABD0 		.word	-794039994
 8425 0348 9E5333D8 		.word	-667724898
 8426 034c BA980824 		.word	604543162
 8427 0350 CB3BFC71 		.word	1912355787
 8428 0354 A3F45568 		.word	1750463651
 8429 0358 CFA9196C 		.word	1813621199
 8430 035c 5D4C0492 		.word	-1845212067
 8431 0360 E51DFEB8 		.word	-1191305755
 8432 0364 51FA2AB4 		.word	-1272251823
 8433 0368 E7D40CB6 		.word	-1240673049
 8434 036c 2E2602C9 		.word	-922606034
 8435 0370 F20E7FDC 		.word	-595652878
 8436 0374 287D15DA 		.word	-636125912
 8437 0378 736A065B 		.word	1527147123
 8438 037c 17138164 		.word	1686180631
 8439 0380 79873F6E 		.word	1849657209
 8440 0384 94BE0AED 		.word	-318062956
 8441 0388 393583AD 		.word	-1383910087
 8442 038c 8B8940B2 		.word	-1304393333
 8443 0390 BE0AED39 		.word	971836094
ARM GAS  /tmp/cc1G6faT.s 			page 217


 8444 0394 3583AD8B 		.word	-1951562955
 8445 0398 8940B2BC 		.word	-1129168759
 8446 039c C31F374A 		.word	1245126595
 8447 03a0 5F85F69C 		.word	-1661565601
 8448 03a4 9AC1D6C5 		.word	-975781478
 8449 03a8 442059DE 		.word	-564584380
 8450 03ac E18F1BA5 		.word	-1524920351
 8451 03b0 AF427B4E 		.word	1316700847
 8452 03b4 CD60EB62 		.word	1659592909
 8453 03b8 22902CEF 		.word	-282292190
 8454 03bc F0C78DD2 		.word	-762460176
 8455 03c0 77F8E346 		.word	1189345399
 8456 03c4 E9ABD09E 		.word	-1630491671
 8457 03c8 5333D8BA 		.word	-1160236205
 8458 03cc 980824CB 		.word	-886830952
 8459 03d0 3BFC71A3 		.word	-1552810949
 8460 03d4 F45568CF 		.word	-815245836
 8461 03d8 A9196C5D 		.word	1567365545
 8462 03dc 4C0492E5 		.word	-443415476
 8463 03e0 1DFEB851 		.word	1371078173
 8464 03e4 FA2AB4E7 		.word	-407622918
 8465 03e8 D40CB62E 		.word	783682772
 8466 03ec 2602C9F2 		.word	-221707738
 8467 03f0 D09E5333 		.word	861118160
 8468 03f4 D8BA9808 		.word	144227032
 8469 03f8 24CB3BFC 		.word	-63190236
 8470 03fc 71A3F455 		.word	1442095985
 8471 0400 68CFA919 		.word	430559080
 8472 0404 6C5D4C04 		.word	72113516
 8473 0408 92E51DFE 		.word	-31595118
 8474 040c B851FA2A 		.word	721047992
 8475 0410 B4E7D40C 		.word	215279540
 8476 0414 B62E2602 		.word	36056758
 8477 0418 C9F20E7F 		.word	2131686089
 8478 041c DC287D15 		.word	360523996
 8479 0420 196C5D4C 		.word	1281190937
 8480 0424 0492E51D 		.word	501584388
 8481 0428 FEB851FA 		.word	-95307522
 8482 042c 2AB4E7D4 		.word	-723012566
 8483 0430 0CB62E26 		.word	640595468
 8484 0434 02C9F20E 		.word	250792194
 8485 0438 7FDC287D 		.word	2099829887
 8486 043c 15DA736A 		.word	1785977365
 8487 0440 065B1713 		.word	320297734
 8488 0444 81647987 		.word	-2022087551
 8489 0448 3F6E94BE 		.word	-1097568705
 8490 044c 0AED3935 		.word	892988682
 8491 0450 427B4ECD 		.word	-850494654
 8492 0454 60EB6222 		.word	576908128
 8493 0458 902CEFF0 		.word	-252760944
 8494 045c C78DD257 		.word	1473416647
 8495 0460 A13DA766 		.word	1722236321
 8496 0464 B0753111 		.word	288454064
 8497 0468 489677F8 		.word	-126380472
 8498 046c E346E9AB 		.word	-1410775325
 8499 0470 D09E5333 		.word	861118160
 8500 0474 D8BA9808 		.word	144227032
ARM GAS  /tmp/cc1G6faT.s 			page 218


 8501 0478 24CB3BFC 		.word	-63190236
 8502 047c 71A3F455 		.word	1442095985
 8503 0480 8B8940B2 		.word	-1304393333
 8504 0484 BCC31F37 		.word	924828604
 8505 0488 4A5F85F6 		.word	-159031478
 8506 048c 9C9AC1D6 		.word	-691955044
 8507 0490 C5442059 		.word	1495286981
 8508 0494 DEE18F1B 		.word	462414302
 8509 0498 A5AF427B 		.word	2067967909
 8510 049c 4ECD60EB 		.word	-345977522
 8511 04a0 6222902C 		.word	747643490
 8512 04a4 EFF0C78D 		.word	-1916276497
 8513 04a8 D257A13D 		.word	1033983954
 8514 04ac A766B075 		.word	1974494887
 8515 04b0 F45568CF 		.word	-815245836
 8516 04b4 A9196C5D 		.word	1567365545
 8517 04b8 4C0492E5 		.word	-443415476
 8518 04bc 1DFEB851 		.word	1371078173
 8519 04c0 FA2AB4E7 		.word	-407622918
 8520 04c4 D40CB62E 		.word	783682772
 8521 04c8 2602C9F2 		.word	-221707738
 8522 04cc 0E7FDC28 		.word	685539086
 8523 04d0 7D15DA73 		.word	1943672189
 8524 04d4 6A065B17 		.word	391841386
 8525 04d8 13816479 		.word	2036629779
 8526 04dc 873F6E94 		.word	-1804714105
 8527 04e0 3DA766B0 		.word	-1335449795
 8528 04e4 75311148 		.word	1209086325
 8529 04e8 9677F8E3 		.word	-470255722
 8530 04ec 46E9ABD0 		.word	-794039994
 8531 04f0 9E5333D8 		.word	-667724898
 8532 04f4 BA980824 		.word	604543162
 8533 04f8 CB3BFC71 		.word	1912355787
 8534 04fc A3F45568 		.word	1750463651
 8535 0500 CFA9196C 		.word	1813621199
 8536 0504 5D4C0492 		.word	-1845212067
 8537 0508 E51DFEB8 		.word	-1191305755
 8538 050c 51FA2AB4 		.word	-1272251823
 8539 0510 66B07531 		.word	829796454
 8540 0514 11489677 		.word	2006337553
 8541 0518 F8E346E9 		.word	-381230088
 8542 051c ABD09E53 		.word	1402917035
 8543 0520 33D8BA98 		.word	-1732585421
 8544 0524 0824CB3B 		.word	1003168776
 8545 0528 FC71A3F4 		.word	-190615044
 8546 052c 5568CFA9 		.word	-1446025131
 8547 0530 196C5D4C 		.word	1281190937
 8548 0534 0492E51D 		.word	501584388
 8549 0538 FEB851FA 		.word	-95307522
 8550 053c 2AB4E7D4 		.word	-723012566
 8551 0540 AF427B4E 		.word	1316700847
 8552 0544 CD60EB62 		.word	1659592909
 8553 0548 22902CEF 		.word	-282292190
 8554 054c F0C78DD2 		.word	-762460176
 8555 0550 57A13DA7 		.word	-1489133225
 8556 0554 66B07531 		.word	829796454
 8557 0558 11489677 		.word	2006337553
ARM GAS  /tmp/cc1G6faT.s 			page 219


 8558 055c F8E346E9 		.word	-381230088
 8559 0560 ABD09E53 		.word	1402917035
 8560 0564 33D8BA98 		.word	-1732585421
 8561 0568 0824CB3B 		.word	1003168776
 8562 056c FC71A3F4 		.word	-190615044
 8563 0570 980824CB 		.word	-886830952
 8564 0574 3BFC71A3 		.word	-1552810949
 8565 0578 F45568CF 		.word	-815245836
 8566 057c A9196C5D 		.word	1567365545
 8567 0580 4C0492E5 		.word	-443415476
 8568 0584 1DFEB851 		.word	1371078173
 8569 0588 FA2AB4E7 		.word	-407622918
 8570 058c D40CB62E 		.word	783682772
 8571 0590 2602C9F2 		.word	-221707738
 8572 0594 0E7FDC28 		.word	685539086
 8573 0598 7D15DA73 		.word	1943672189
 8574 059c 6A065B17 		.word	391841386
 8575 05a0 51FA2AB4 		.word	-1272251823
 8576 05a4 E7D40CB6 		.word	-1240673049
 8577 05a8 2E2602C9 		.word	-922606034
 8578 05ac F20E7FDC 		.word	-595652878
 8579 05b0 287D15DA 		.word	-636125912
 8580 05b4 736A065B 		.word	1527147123
 8581 05b8 17138164 		.word	1686180631
 8582 05bc 79873F6E 		.word	1849657209
 8583 05c0 94BE0AED 		.word	-318062956
 8584 05c4 393583AD 		.word	-1383910087
 8585 05c8 8B8940B2 		.word	-1304393333
 8586 05cc BCC31F37 		.word	924828604
 8587 05d0 0AED3935 		.word	892988682
 8588 05d4 83AD8B89 		.word	-1987334781
 8589 05d8 40B2BCC3 		.word	-1011043776
 8590 05dc 1F374A5F 		.word	1598699295
 8591 05e0 85F69C9A 		.word	-1700989307
 8592 05e4 C1D6C544 		.word	1153816257
 8593 05e8 2059DEE1 		.word	-505521888
 8594 05ec 8F1BA5AF 		.word	-1348134001
 8595 05f0 427B4ECD 		.word	-850494654
 8596 05f4 60EB6222 		.word	576908128
 8597 05f8 902CEFF0 		.word	-252760944
 8598 05fc C78DD257 		.word	1473416647
 8599 0600 C31F374A 		.word	1245126595
 8600 0604 5F85F69C 		.word	-1661565601
 8601 0608 9AC1D6C5 		.word	-975781478
 8602 060c 442059DE 		.word	-564584380
 8603 0610 E18F1BA5 		.word	-1524920351
 8604 0614 AF427B4E 		.word	1316700847
 8605 0618 CD60EB62 		.word	1659592909
 8606 061c 22902CEF 		.word	-282292190
 8607 0620 F0C78DD2 		.word	-762460176
 8608 0624 57A13DA7 		.word	-1489133225
 8609 0628 66B07531 		.word	829796454
 8610 062c 11489677 		.word	2006337553
 8611 0630 BCC31F37 		.word	924828604
 8612 0634 4A5F85F6 		.word	-159031478
 8613 0638 9C9AC1D6 		.word	-691955044
 8614 063c C5442059 		.word	1495286981
ARM GAS  /tmp/cc1G6faT.s 			page 220


 8615 0640 DEE18F1B 		.word	462414302
 8616 0644 A5AF427B 		.word	2067967909
 8617 0648 4ECD60EB 		.word	-345977522
 8618 064c 6222902C 		.word	747643490
 8619 0650 EFF0C78D 		.word	-1916276497
 8620 0654 D257A13D 		.word	1033983954
 8621 0658 A766B075 		.word	1974494887
 8622 065c 31114896 		.word	-1773661903
 8623 0660 75311148 		.word	1209086325
 8624 0664 9677F8E3 		.word	-470255722
 8625 0668 46E9ABD0 		.word	-794039994
 8626 066c 9E5333D8 		.word	-667724898
 8627 0670 BA980824 		.word	604543162
 8628 0674 CB3BFC71 		.word	1912355787
 8629 0678 A3F45568 		.word	1750463651
 8630 067c CFA9196C 		.word	1813621199
 8631 0680 5D4C0492 		.word	-1845212067
 8632 0684 E51DFEB8 		.word	-1191305755
 8633 0688 51FA2AB4 		.word	-1272251823
 8634 068c E7D40CB6 		.word	-1240673049
 8635 0690 2E2602C9 		.word	-922606034
 8636 0694 F20E7FDC 		.word	-595652878
 8637 0698 287D15DA 		.word	-636125912
 8638 069c 736A065B 		.word	1527147123
 8639 06a0 17138164 		.word	1686180631
 8640 06a4 79873F6E 		.word	1849657209
 8641 06a8 94BE0AED 		.word	-318062956
 8642 06ac 393583AD 		.word	-1383910087
 8643 06b0 8B8940B2 		.word	-1304393333
 8644 06b4 BCC31F37 		.word	924828604
 8645 06b8 4A5F85F6 		.word	-159031478
 8646 06bc 9C9AC1D6 		.word	-691955044
 8647 06c0 E7D40CB6 		.word	-1240673049
 8648 06c4 2E2602C9 		.word	-922606034
 8649 06c8 F20E7FDC 		.word	-595652878
 8650 06cc 287D15DA 		.word	-636125912
 8651 06d0 736A065B 		.word	1527147123
 8652 06d4 17138164 		.word	1686180631
 8653 06d8 79873F6E 		.word	1849657209
 8654 06dc 94BE0AED 		.word	-318062956
 8655 06e0 393583AD 		.word	-1383910087
 8656 06e4 8B8940B2 		.word	-1304393333
 8657 06e8 BCC31F37 		.word	924828604
 8658 06ec 4A5F85F6 		.word	-159031478
 8659 06f0 60EB6222 		.word	576908128
 8660 06f4 902CEFF0 		.word	-252760944
 8661 06f8 C78DD257 		.word	1473416647
 8662 06fc A13DA766 		.word	1722236321
 8663 0700 B0753111 		.word	288454064
 8664 0704 489677F8 		.word	-126380472
 8665 0708 E346E9AB 		.word	-1410775325
 8666 070c D09E5333 		.word	861118160
 8667 0710 D8BA9808 		.word	144227032
 8668 0714 24CB3BFC 		.word	-63190236
 8669 0718 71A3F455 		.word	1442095985
 8670 071c 68CFA919 		.word	430559080
 8671 0720 A9196C5D 		.word	1567365545
ARM GAS  /tmp/cc1G6faT.s 			page 221


 8672 0724 4C0492E5 		.word	-443415476
 8673 0728 1DFEB851 		.word	1371078173
 8674 072c FA2AB4E7 		.word	-407622918
 8675 0730 D40CB62E 		.word	783682772
 8676 0734 2602C9F2 		.word	-221707738
 8677 0738 0E7FDC28 		.word	685539086
 8678 073c 7D15DA73 		.word	1943672189
 8679 0740 6A065B17 		.word	391841386
 8680 0744 13816479 		.word	2036629779
 8681 0748 873F6E94 		.word	-1804714105
 8682 074c BE0AED39 		.word	971836094
 8683 0750 F20E7FDC 		.word	-595652878
 8684 0754 287D15DA 		.word	-636125912
 8685 0758 736A065B 		.word	1527147123
 8686 075c 17138164 		.word	1686180631
 8687 0760 79873F6E 		.word	1849657209
 8688 0764 94BE0AED 		.word	-318062956
 8689 0768 393583AD 		.word	-1383910087
 8690 076c 8B8940B2 		.word	-1304393333
 8691 0770 BCC31F37 		.word	924828604
 8692 0774 4A5F85F6 		.word	-159031478
 8693 0778 9C9AC1D6 		.word	-691955044
 8694 077c C5442059 		.word	1495286981
 8695 0780 3BFC71A3 		.word	-1552810949
 8696 0784 F45568CF 		.word	-815245836
 8697 0788 A9196C5D 		.word	1567365545
 8698 078c 4C0492E5 		.word	-443415476
 8699 0790 1DFEB851 		.word	1371078173
 8700 0794 FA2AB4E7 		.word	-407622918
 8701 0798 D40CB62E 		.word	783682772
 8702 079c 2602C9F2 		.word	-221707738
 8703 07a0 0E7FDC28 		.word	685539086
 8704 07a4 7D15DA73 		.word	1943672189
 8705 07a8 6A065B17 		.word	391841386
 8706 07ac 13816479 		.word	2036629779
 8707 07b0 442059DE 		.word	-564584380
 8708 07b4 E18F1BA5 		.word	-1524920351
 8709 07b8 AF427B4E 		.word	1316700847
 8710 07bc CD60EB62 		.word	1659592909
 8711 07c0 22902CEF 		.word	-282292190
 8712 07c4 F0C78DD2 		.word	-762460176
 8713 07c8 57A13DA7 		.word	-1489133225
 8714 07cc 66B07531 		.word	829796454
 8715 07d0 11489677 		.word	2006337553
 8716 07d4 F8E346E9 		.word	-381230088
 8717 07d8 ABD09E53 		.word	1402917035
 8718 07dc 33D8BA98 		.word	-1732585421
 8719 07e0 8DD257A1 		.word	-1588079987
 8720 07e4 3DA766B0 		.word	-1335449795
 8721 07e8 75311148 		.word	1209086325
 8722 07ec 9677F8E3 		.word	-470255722
 8723 07f0 46E9ABD0 		.word	-794039994
 8724 07f4 9E5333D8 		.word	-667724898
 8725 07f8 BA980824 		.word	604543162
 8726 07fc CB3BFC71 		.word	1912355787
 8727 0800 A3F45568 		.word	1750463651
 8728 0804 CFA9196C 		.word	1813621199
ARM GAS  /tmp/cc1G6faT.s 			page 222


 8729 0808 5D4C0492 		.word	-1845212067
 8730 080c E51DFEB8 		.word	-1191305755
 8731 0810 D6C54420 		.word	541378006
 8732 0814 59DEE18F 		.word	-1881022887
 8733 0818 1BA5AF42 		.word	1118807323
 8734 081c 7B4ECD60 		.word	1624067707
 8735 0820 EB622290 		.word	-1876794645
 8736 0824 2CEFF0C7 		.word	-940511444
 8737 0828 8DD257A1 		.word	-1588079987
 8738 082c 3DA766B0 		.word	-1335449795
 8739 0830 75311148 		.word	1209086325
 8740 0834 9677F8E3 		.word	-470255722
 8741 0838 46E9ABD0 		.word	-794039994
 8742 083c 9E5333D8 		.word	-667724898
 8743 0840 1F374A5F 		.word	1598699295
 8744 0844 85F69C9A 		.word	-1700989307
 8745 0848 C1D6C544 		.word	1153816257
 8746 084c 2059DEE1 		.word	-505521888
 8747 0850 8F1BA5AF 		.word	-1348134001
 8748 0854 427B4ECD 		.word	-850494654
 8749 0858 60EB6222 		.word	576908128
 8750 085c 902CEFF0 		.word	-252760944
 8751 0860 C78DD257 		.word	1473416647
 8752 0864 A13DA766 		.word	1722236321
 8753 0868 B0753111 		.word	288454064
 8754 086c 489677F8 		.word	-126380472
 8757              	hop_interval_lut:
 8758 0870 00       		.byte	0
 8759 0871 01       		.byte	1
 8760 0872 13       		.byte	19
 8761 0873 19       		.byte	25
 8762 0874 1C       		.byte	28
 8763 0875 0F       		.byte	15
 8764 0876 1F       		.byte	31
 8765 0877 10       		.byte	16
 8766 0878 0E       		.byte	14
 8767 0879 21       		.byte	33
 8768 087a 1A       		.byte	26
 8769 087b 1B       		.byte	27
 8770 087c 22       		.byte	34
 8771 087d 14       		.byte	20
 8772 087e 08       		.byte	8
 8773 087f 05       		.byte	5
 8774 0880 07       		.byte	7
 8775 0881 18       		.byte	24
 8776 0882 23       		.byte	35
 8777 0883 02       		.byte	2
 8778 0884 0D       		.byte	13
 8779 0885 1E       		.byte	30
 8780 0886 20       		.byte	32
 8781 0887 1D       		.byte	29
 8782 0888 11       		.byte	17
 8783 0889 03       		.byte	3
 8784 088a 0A       		.byte	10
 8785 088b 0B       		.byte	11
 8786 088c 04       		.byte	4
 8787 088d 17       		.byte	23
ARM GAS  /tmp/cc1G6faT.s 			page 223


 8788 088e 15       		.byte	21
 8789 088f 06       		.byte	6
 8790 0890 16       		.byte	22
 8791 0891 09       		.byte	9
 8792 0892 0C       		.byte	12
 8793 0893 12       		.byte	18
 8794 0894 24       		.byte	36
 8795 0895 000000   		.space	3
 8796              	.LC0:
 8797 0898 01000000 		.word	1
 8798 089c 01000000 		.word	1
 8799 08a0 01000000 		.word	1
 8800 08a4 01000000 		.word	1
 8801              	.LC1:
 8802 08a8 6209     		.short	2402
 8803 08aa 7A09     		.short	2426
 8804 08ac B009     		.short	2480
 8805              	.LC2:
 8806 08ae 42       		.byte	66
 8807 08af 1D       		.byte	29
 8808 08b0 FF       		.byte	-1
 8809 08b1 FF       		.byte	-1
 8810 08b2 FF       		.byte	-1
 8811 08b3 FF       		.byte	-1
 8812 08b4 FF       		.byte	-1
 8813 08b5 FF       		.byte	-1
 8814 08b6 03       		.byte	3
 8815 08b7 03       		.byte	3
 8816 08b8 AA       		.byte	-86
 8817 08b9 FE       		.byte	-2
 8818 08ba 12       		.byte	18
 8819 08bb 16       		.byte	22
 8820 08bc AA       		.byte	-86
 8821 08bd FE       		.byte	-2
 8822 08be 10       		.byte	16
 8823 08bf 00       		.byte	0
 8824 08c0 02       		.byte	2
 8825 08c1 AA       		.byte	-86
 8826              	.LC3:
 8827 08c2 6C09     		.short	2412
 8828 08c4 8509     		.short	2437
 8829 08c6 9E09     		.short	2462
 8830              		.section	.rodata.str1.1,"aMS",%progbits,1
 8831              	.LC4:
 8832 0000 32303137 		.ascii	"2017-03-R2\000"
 8832      2D30332D 
 8832      523200
 8833              		.data
 8834              		.align	2
 8835              		.set	.LANCHOR1,. + 0
 8838              	channel:
 8839 0000 8909     		.short	2441
 8840 0002 0000     		.space	2
 8843              	le:
 8844 0004 D6BE898E 		.word	-1903575338
 8845 0008 7D6B     		.short	27517
 8846 000a 7191     		.short	-28303
ARM GAS  /tmp/cc1G6faT.s 			page 224


 8847 000c 55555500 		.word	5592405
 8848 0010 AAAAAA00 		.word	11184810
 8849 0014 00000000 		.word	0
 8850 0018 00       		.byte	0
 8851 0019 000000   		.space	3
 8852 001c 00000000 		.word	0
 8853 0020 00000000 		.space	32
 8853      00000000 
 8853      00000000 
 8853      00000000 
 8853      00000000 
 8854 0040 00000000 		.word	0
 8855 0044 00000000 		.word	0
 8858              	hop_timeout:
 8859 0048 9E00     		.short	158
 8862              	le_adv_channel:
 8863 004a 6209     		.short	2402
 8866              	low_freq:
 8867 004c 6009     		.short	2400
 8870              	high_freq:
 8871 004e B309     		.short	2483
 8874              	rssi_threshold:
 8875 0050 E2       		.byte	-30
 8876 0051 000000   		.bss
 8877              		.align	2
 8878              		.set	.LANCHOR0,. + 0
 8881              	modulation:
 8882 0000 00       		.space	1
 8885              	status:
 8886 0001 00       		.space	1
 8889              	idle_buf_clkn_high:
 8890 0002 00       		.space	1
 8891 0003 00       		.space	1
 8894              	idle_buf_clk100ns:
 8895 0004 00000000 		.space	4
 8898              	idle_buf_channel:
 8899 0008 0000     		.space	2
 8902              	hop_mode:
 8903 000a 00       		.space	1
 8906              	do_hop:
 8907 000b 00       		.space	1
 8910              	hop_direct_channel:
 8911 000c 0000     		.space	2
 8914              	requested_channel:
 8915 000e 0000     		.space	2
 8918              	dma_discard:
 8919 0010 00       		.space	1
 8922              	mode:
 8923 0011 00       		.space	1
 8926              	requested_mode:
 8927 0012 00       		.space	1
 8930              	jam_mode:
 8931 0013 00       		.space	1
 8934              	ego_mode:
 8935 0014 00       		.space	1
 8936 0015 000000   		.space	3
 8939              	packet_cb:
ARM GAS  /tmp/cc1G6faT.s 			page 225


 8940 0018 00000000 		.space	4
 8943              	le_jam_count:
 8944 001c 00000000 		.space	4
 8947              	dlen:
 8948 0020 00000000 		.space	4
 8951              	slave_mac_address:
 8952 0024 00000000 		.space	6
 8952      0000
 8953 002a 0000     		.space	2
 8956              	data_cb:
 8957 002c 00000000 		.space	4
 8960              	restart_jamming.5199:
 8961 0030 00000000 		.space	4
 8964              	first_ts.5296:
 8965 0034 00000000 		.space	4
 8968              	prev_clk.5302:
 8969 0038 00000000 		.space	4
 8970              		.text
 8971              	.Letext0:
 8972              		.file 2 "/usr/lib/gcc/arm-none-eabi/4.8.2/include/stddef.h"
 8973              		.file 3 "/usr/lib/gcc/arm-none-eabi/4.8.2/include/stdint-gcc.h"
 8974              		.file 4 "../../host/libubertooth/src/ubertooth_interface.h"
 8975              		.file 5 "../common/ubertooth.h"
 8976              		.file 6 "ubertooth_usb.h"
 8977              		.file 7 "bluetooth_le.h"
 8978              		.file 8 "ego.h"
 8979              		.file 9 "ubertooth_rssi.h"
 8980              		.file 10 "ubertooth_cs.h"
 8981              		.file 11 "ubertooth_dma.h"
 8982              		.file 12 "ubertooth_clock.h"
 8983              		.file 13 "bluetooth.h"
 8984              		.file 14 "cc2400_rangetest.h"
 8985              		.file 15 "/usr/include/newlib/string.h"
 8986              		.file 16 "/usr/include/newlib/stdlib.h"
ARM GAS  /tmp/cc1G6faT.s 			page 226


DEFINED SYMBOLS
                            *ABS*:0000000000000000 bluetooth_rxtx.c
     /tmp/cc1G6faT.s:19     .text.msleep:0000000000000000 $t
     /tmp/cc1G6faT.s:23     .text.msleep:0000000000000000 msleep
     /tmp/cc1G6faT.s:65     .text.msleep:0000000000000028 $d
                            *COM*:0000000000000004 clkn
     /tmp/cc1G6faT.s:70     .text.reverse8:0000000000000000 $t
     /tmp/cc1G6faT.s:74     .text.reverse8:0000000000000000 reverse8
     /tmp/cc1G6faT.s:122    .text.cc2400_rx:0000000000000000 $t
     /tmp/cc1G6faT.s:126    .text.cc2400_rx:0000000000000000 cc2400_rx
     /tmp/cc1G6faT.s:239    .text.cc2400_rx:0000000000000098 $d
     /tmp/cc1G6faT.s:246    .text.cc2400_rx_sync:0000000000000000 $t
     /tmp/cc1G6faT.s:250    .text.cc2400_rx_sync:0000000000000000 cc2400_rx_sync
     /tmp/cc1G6faT.s:375    .text.cc2400_rx_sync:00000000000000a4 $d
     /tmp/cc1G6faT.s:382    .text.enqueue:0000000000000000 $t
     /tmp/cc1G6faT.s:386    .text.enqueue:0000000000000000 enqueue
     /tmp/cc1G6faT.s:496    .text.enqueue:0000000000000084 $d
                            *COM*:0000000000000001 rssi_min
                            *COM*:0000000000000001 rssi_max
                            *COM*:0000000000000001 rssi_count
     /tmp/cc1G6faT.s:506    .text.le_set_access_address:0000000000000000 $t
     /tmp/cc1G6faT.s:510    .text.le_set_access_address:0000000000000000 le_set_access_address
     /tmp/cc1G6faT.s:537    .text.le_set_access_address:0000000000000014 $d
     /tmp/cc1G6faT.s:542    .text.cc2400_idle:0000000000000000 $t
     /tmp/cc1G6faT.s:546    .text.cc2400_idle:0000000000000000 cc2400_idle
     /tmp/cc1G6faT.s:660    .text.cc2400_idle:000000000000009c $d
                            *COM*:0000000000000010 target
     /tmp/cc1G6faT.s:668    .text.cb_follow_le:0000000000000000 $t
     /tmp/cc1G6faT.s:673    .text.cb_follow_le:0000000000000000 cb_follow_le
     /tmp/cc1G6faT.s:887    .text.cb_follow_le:00000000000000ec $d
                            *COM*:0000000000000320 unpacked
                            *COM*:0000000000000004 idle_rxbuf
     /tmp/cc1G6faT.s:897    .text.connection_follow_cb:0000000000000000 $t
     /tmp/cc1G6faT.s:902    .text.connection_follow_cb:0000000000000000 connection_follow_cb
     /tmp/cc1G6faT.s:1173   .text.connection_follow_cb:0000000000000164 $d
     /tmp/cc1G6faT.s:1183   .text.vendor_request_handler:0000000000000000 $t
     /tmp/cc1G6faT.s:1187   .text.vendor_request_handler:0000000000000000 vendor_request_handler
     /tmp/cc1G6faT.s:1221   .text.vendor_request_handler:000000000000001a $d
     /tmp/cc1G6faT.s:1300   .text.vendor_request_handler:00000000000000b6 $t
     /tmp/cc1G6faT.s:1586   .text.vendor_request_handler:0000000000000230 $d
                            *COM*:0000000000000005 rr
     /tmp/cc1G6faT.s:1599   .text.vendor_request_handler:000000000000025c $t
     /tmp/cc1G6faT.s:2181   .text.vendor_request_handler:000000000000054c $d
                            *COM*:0000000000000001 cs_threshold_req
                            *COM*:0000000000000004 clkn_offset
                            *COM*:0000000000000002 clk100ns_offset
                            *COM*:000000000000000a afh_map
                            *COM*:0000000000000001 used_channels
                            *COM*:0000000000000001 afh_enabled
                            *COM*:0000000000000002 clk_drift_ppm
                            *COM*:0000000000000004 clkn_next_drift_fix
                            *COM*:0000000000000002 clk_drift_correction
                            *COM*:0000000000000004 clkn_last_drift_fix
     /tmp/cc1G6faT.s:2200   .text.vendor_request_handler:000000000000058c $t
     /tmp/cc1G6faT.s:2518   .text.vendor_request_handler:00000000000006fc $d
                            *COM*:000000000000003a tx_pkt
                            *COM*:0000000000000004 slave_mac_address_data
ARM GAS  /tmp/cc1G6faT.s 			page 227


     /tmp/cc1G6faT.s:2526   .text.enqueue_with_ts:0000000000000000 $t
     /tmp/cc1G6faT.s:2531   .text.enqueue_with_ts:0000000000000000 enqueue_with_ts
     /tmp/cc1G6faT.s:2607   .text.enqueue_with_ts:0000000000000050 $d
     /tmp/cc1G6faT.s:2613   .text.TIMER0_IRQHandler:0000000000000000 $t
     /tmp/cc1G6faT.s:2618   .text.TIMER0_IRQHandler:0000000000000000 TIMER0_IRQHandler
     /tmp/cc1G6faT.s:2817   .text.TIMER0_IRQHandler:0000000000000110 $d
                            *COM*:0000000000000004 last_hop
     /tmp/cc1G6faT.s:2834   .text.EINT3_IRQHandler:0000000000000000 $t
     /tmp/cc1G6faT.s:2839   .text.EINT3_IRQHandler:0000000000000000 EINT3_IRQHandler
     /tmp/cc1G6faT.s:2870   .text.EINT3_IRQHandler:0000000000000024 $d
                            *COM*:0000000000000001 cs_trigger
     /tmp/cc1G6faT.s:2878   .text.DMA_IRQHandler:0000000000000000 $t
     /tmp/cc1G6faT.s:2883   .text.DMA_IRQHandler:0000000000000000 DMA_IRQHandler
     /tmp/cc1G6faT.s:3036   .text.DMA_IRQHandler:00000000000000d4 $d
                            *COM*:0000000000000004 active_rxbuf
                            *COM*:0000000000000004 rx_tc
                            *COM*:0000000000000004 rx_err
     /tmp/cc1G6faT.s:3054   .text.le_transmit:0000000000000000 $t
     /tmp/cc1G6faT.s:3059   .text.le_transmit:0000000000000000 le_transmit
     /tmp/cc1G6faT.s:3346   .text.le_transmit:0000000000000190 $d
     /tmp/cc1G6faT.s:3355   .text.le_jam:0000000000000000 $t
     /tmp/cc1G6faT.s:3360   .text.le_jam:0000000000000000 le_jam
     /tmp/cc1G6faT.s:3441   .text.le_jam:0000000000000074 $d
     /tmp/cc1G6faT.s:3446   .text.hop:0000000000000000 $t
     /tmp/cc1G6faT.s:3451   .text.hop:0000000000000000 hop
     /tmp/cc1G6faT.s:3698   .text.hop:0000000000000180 $d
     /tmp/cc1G6faT.s:3710   .text.bt_stream_rx:0000000000000000 $t
     /tmp/cc1G6faT.s:3715   .text.bt_stream_rx:0000000000000000 bt_stream_rx
     /tmp/cc1G6faT.s:3935   .text.bt_stream_rx:000000000000012c $d
                            *COM*:0000000000000001 cs_threshold_cur
                            *COM*:0000000000000001 cs_no_squelch
     /tmp/cc1G6faT.s:3951   .text.br_transmit:0000000000000000 $t
     /tmp/cc1G6faT.s:3956   .text.br_transmit:0000000000000000 br_transmit
     /tmp/cc1G6faT.s:4379   .text.br_transmit:000000000000025c $d
     /tmp/cc1G6faT.s:4392   .text.reset_le:0000000000000000 $t
     /tmp/cc1G6faT.s:4397   .text.reset_le:0000000000000000 reset_le
     /tmp/cc1G6faT.s:4459   .text.reset_le:0000000000000040 $d
     /tmp/cc1G6faT.s:4468   .text.reset_le_promisc:0000000000000000 $t
     /tmp/cc1G6faT.s:4473   .text.reset_le_promisc:0000000000000000 reset_le_promisc
     /tmp/cc1G6faT.s:4497   .text.reset_le_promisc:000000000000001c $d
                            *COM*:0000000000000108 le_promisc
     /tmp/cc1G6faT.s:4502   .text.bt_generic_le:0000000000000000 $t
     /tmp/cc1G6faT.s:4507   .text.bt_generic_le:0000000000000000 bt_generic_le
     /tmp/cc1G6faT.s:4846   .text.bt_generic_le:00000000000001ac $d
     /tmp/cc1G6faT.s:4865   .text.bt_le_sync:0000000000000000 $t
     /tmp/cc1G6faT.s:4870   .text.bt_le_sync:0000000000000000 bt_le_sync
     /tmp/cc1G6faT.s:5367   .text.bt_le_sync:00000000000002c4 $d
                            *COM*:0000000000000032 rxbuf1
     /tmp/cc1G6faT.s:5389   .text.bt_le_sync:0000000000000314 $t
     /tmp/cc1G6faT.s:5514   .text.bt_le_sync:00000000000003cc $d
     /tmp/cc1G6faT.s:5521   .text.bt_follow_le:0000000000000000 $t
     /tmp/cc1G6faT.s:5526   .text.bt_follow_le:0000000000000000 bt_follow_le
     /tmp/cc1G6faT.s:5556   .text.bt_follow_le:0000000000000018 $d
     /tmp/cc1G6faT.s:5562   .text.le_promisc_state:0000000000000000 $t
     /tmp/cc1G6faT.s:5567   .text.le_promisc_state:0000000000000000 le_promisc_state
     /tmp/cc1G6faT.s:5621   .text.promisc_recover_hop_increment:0000000000000000 $t
     /tmp/cc1G6faT.s:5626   .text.promisc_recover_hop_increment:0000000000000000 promisc_recover_hop_increment
ARM GAS  /tmp/cc1G6faT.s 			page 228


     /tmp/cc1G6faT.s:5779   .text.promisc_recover_hop_increment:00000000000000c8 $d
     /tmp/cc1G6faT.s:5789   .text.promisc_recover_hop_interval:0000000000000000 $t
     /tmp/cc1G6faT.s:5794   .text.promisc_recover_hop_interval:0000000000000000 promisc_recover_hop_interval
     /tmp/cc1G6faT.s:5917   .text.promisc_recover_hop_interval:0000000000000098 $d
     /tmp/cc1G6faT.s:5928   .text.promisc_follow_cb:0000000000000000 $t
     /tmp/cc1G6faT.s:5933   .text.promisc_follow_cb:0000000000000000 promisc_follow_cb
     /tmp/cc1G6faT.s:6029   .text.promisc_follow_cb:0000000000000064 $d
     /tmp/cc1G6faT.s:6040   .text.see_aa:0000000000000000 $t
     /tmp/cc1G6faT.s:6045   .text.see_aa:0000000000000000 see_aa
     /tmp/cc1G6faT.s:6124   .text.see_aa:0000000000000058 $d
     /tmp/cc1G6faT.s:6129   .text.cb_le_promisc:0000000000000000 $t
     /tmp/cc1G6faT.s:6134   .text.cb_le_promisc:0000000000000000 cb_le_promisc
     /tmp/cc1G6faT.s:6449   .text.cb_le_promisc:000000000000017c $d
     /tmp/cc1G6faT.s:6462   .text.bt_promisc_le:0000000000000000 $t
     /tmp/cc1G6faT.s:6467   .text.bt_promisc_le:0000000000000000 bt_promisc_le
     /tmp/cc1G6faT.s:6546   .text.bt_promisc_le:000000000000005c $d
     /tmp/cc1G6faT.s:6555   .text.bt_slave_le:0000000000000000 $t
     /tmp/cc1G6faT.s:6560   .text.bt_slave_le:0000000000000000 bt_slave_le
     /tmp/cc1G6faT.s:6984   .text.bt_slave_le:0000000000000248 $d
     /tmp/cc1G6faT.s:6996   .text.rx_generic_sync:0000000000000000 $t
     /tmp/cc1G6faT.s:7001   .text.rx_generic_sync:0000000000000000 rx_generic_sync
     /tmp/cc1G6faT.s:7113   .text.rx_generic_sync:0000000000000094 $d
     /tmp/cc1G6faT.s:7120   .text.rx_generic:0000000000000000 $t
     /tmp/cc1G6faT.s:7125   .text.rx_generic:0000000000000000 rx_generic
     /tmp/cc1G6faT.s:7156   .text.rx_generic:000000000000001c $d
     /tmp/cc1G6faT.s:7161   .text.tx_generic:0000000000000000 $t
     /tmp/cc1G6faT.s:7166   .text.tx_generic:0000000000000000 tx_generic
     /tmp/cc1G6faT.s:7324   .text.tx_generic:00000000000000dc $d
     /tmp/cc1G6faT.s:7334   .text.specan:0000000000000000 $t
     /tmp/cc1G6faT.s:7339   .text.specan:0000000000000000 specan
     /tmp/cc1G6faT.s:7526   .text.specan:00000000000000fc $d
     /tmp/cc1G6faT.s:7536   .text.led_specan:0000000000000000 $t
     /tmp/cc1G6faT.s:7541   .text.led_specan:0000000000000000 led_specan
     /tmp/cc1G6faT.s:7745   .text.led_specan:0000000000000114 $d
     /tmp/cc1G6faT.s:7756   .text.startup.main:0000000000000000 $t
     /tmp/cc1G6faT.s:7761   .text.startup.main:0000000000000000 main
     /tmp/cc1G6faT.s:7807   .text.startup.main:0000000000000034 $d
     /tmp/cc1G6faT.s:7834   .text.startup.main:0000000000000098 $t
     /tmp/cc1G6faT.s:8026   .text.startup.main:0000000000000168 $d
     /tmp/cc1G6faT.s:8939   .bss:0000000000000018 packet_cb
     /tmp/cc1G6faT.s:8956   .bss:000000000000002c data_cb
     /tmp/cc1G6faT.s:8943   .bss:000000000000001c le_jam_count
     /tmp/cc1G6faT.s:8843   .data:0000000000000004 le
     /tmp/cc1G6faT.s:8951   .bss:0000000000000024 slave_mac_address
     /tmp/cc1G6faT.s:8947   .bss:0000000000000020 dlen
     /tmp/cc1G6faT.s:8874   .data:0000000000000050 rssi_threshold
     /tmp/cc1G6faT.s:8870   .data:000000000000004e high_freq
     /tmp/cc1G6faT.s:8866   .data:000000000000004c low_freq
     /tmp/cc1G6faT.s:8881   .bss:0000000000000000 modulation
     /tmp/cc1G6faT.s:8934   .bss:0000000000000014 ego_mode
     /tmp/cc1G6faT.s:8930   .bss:0000000000000013 jam_mode
     /tmp/cc1G6faT.s:8926   .bss:0000000000000012 requested_mode
     /tmp/cc1G6faT.s:8922   .bss:0000000000000011 mode
     /tmp/cc1G6faT.s:8885   .bss:0000000000000001 status
     /tmp/cc1G6faT.s:8918   .bss:0000000000000010 dma_discard
     /tmp/cc1G6faT.s:8898   .bss:0000000000000008 idle_buf_channel
     /tmp/cc1G6faT.s:8894   .bss:0000000000000004 idle_buf_clk100ns
ARM GAS  /tmp/cc1G6faT.s 			page 229


     /tmp/cc1G6faT.s:8889   .bss:0000000000000002 idle_buf_clkn_high
     /tmp/cc1G6faT.s:8862   .data:000000000000004a le_adv_channel
     /tmp/cc1G6faT.s:8914   .bss:000000000000000e requested_channel
     /tmp/cc1G6faT.s:8858   .data:0000000000000048 hop_timeout
     /tmp/cc1G6faT.s:8910   .bss:000000000000000c hop_direct_channel
     /tmp/cc1G6faT.s:8838   .data:0000000000000000 channel
     /tmp/cc1G6faT.s:8906   .bss:000000000000000b do_hop
     /tmp/cc1G6faT.s:8902   .bss:000000000000000a hop_mode
     /tmp/cc1G6faT.s:8269   .rodata:00000000000000a7 compile_info
                            *COM*:0000000000000008 syncword
                            *COM*:0000000000000032 rxbuf2
     /tmp/cc1G6faT.s:8092   .rodata:0000000000000000 $d
     /tmp/cc1G6faT.s:8096   .rodata:0000000000000000 whitening_index
     /tmp/cc1G6faT.s:8139   .rodata:0000000000000028 whitening
     /tmp/cc1G6faT.s:8274   .rodata:00000000000000f0 whitening_word
     /tmp/cc1G6faT.s:8757   .rodata:0000000000000870 hop_interval_lut
     /tmp/cc1G6faT.s:8834   .data:0000000000000000 $d
     /tmp/cc1G6faT.s:8877   .bss:0000000000000000 $d
     /tmp/cc1G6faT.s:8960   .bss:0000000000000030 restart_jamming.5199
     /tmp/cc1G6faT.s:8964   .bss:0000000000000034 first_ts.5296
     /tmp/cc1G6faT.s:8968   .bss:0000000000000038 prev_clk.5302
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
cc2400_set
cs_threshold_calc_and_set
clkn_start
cc2400_status
cc2400_strobe
usb_enqueue
rssi_get_avg
memcpy
rbit
clkn_stop
dio_ssp_stop
cs_reset
rssi_reset
btle_channel_index
btle_crcgen_lut
memcmp
__aeabi_llsl
get_part_num
get_device_serial
cc2400_get
set_isp
bootloader_ctrl
strlen
precalc
dequeue
queue_init
malloc
cc2400_fifo_write
next_hop
btle_next_hop
dio_ssp_init
dma_init
dio_ssp_start
ARM GAS  /tmp/cc1G6faT.s 			page 230


cs_trigger_enable
rssi_add
handle_usb
rssi_iir_update
cs_trigger_disable
memset
dma_init_le
btle_reverse_crc
btle_calc_crc
cc2400_fifo_read
ubertooth_init
clkn_init
ubertooth_usb_init
wait
reset
cc2400_txtest
cc2400_rangetest
cc2400_repeater
ego_main
