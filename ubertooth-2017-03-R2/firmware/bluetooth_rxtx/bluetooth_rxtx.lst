ARM GAS  /tmp/ccxsBJK4.s 			page 1


   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"bluetooth_rxtx.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.reverse8,"ax",%progbits
  19              		.align	1
  20              		.thumb
  21              		.thumb_func
  23              	reverse8:
  24              	.LFB15:
  25              		.file 1 "bluetooth_rxtx.c"
   1:bluetooth_rxtx.c **** /*
   2:bluetooth_rxtx.c ****  * Copyright 2010-2013 Michael Ossmann
   3:bluetooth_rxtx.c ****  * Copyright 2011-2013 Dominic Spill
   4:bluetooth_rxtx.c ****  *
   5:bluetooth_rxtx.c ****  * This file is part of Project Ubertooth.
   6:bluetooth_rxtx.c ****  *
   7:bluetooth_rxtx.c ****  * This program is free software; you can redistribute it and/or modify
   8:bluetooth_rxtx.c ****  * it under the terms of the GNU General Public License as published by
   9:bluetooth_rxtx.c ****  * the Free Software Foundation; either version 2, or (at your option)
  10:bluetooth_rxtx.c ****  * any later version.
  11:bluetooth_rxtx.c ****  *
  12:bluetooth_rxtx.c ****  * This program is distributed in the hope that it will be useful,
  13:bluetooth_rxtx.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  14:bluetooth_rxtx.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  15:bluetooth_rxtx.c ****  * GNU General Public License for more details.
  16:bluetooth_rxtx.c ****  *
  17:bluetooth_rxtx.c ****  * You should have received a copy of the GNU General Public License
  18:bluetooth_rxtx.c ****  * along with this program; see the file COPYING.  If not, write to
  19:bluetooth_rxtx.c ****  * the Free Software Foundation, Inc., 51 Franklin Street,
  20:bluetooth_rxtx.c ****  * Boston, MA 02110-1301, USA.
  21:bluetooth_rxtx.c ****  */
  22:bluetooth_rxtx.c **** 
  23:bluetooth_rxtx.c **** #include <string.h>
  24:bluetooth_rxtx.c **** 
  25:bluetooth_rxtx.c **** #include "ubertooth.h"
  26:bluetooth_rxtx.c **** #include "ubertooth_usb.h"
  27:bluetooth_rxtx.c **** #include "ubertooth_interface.h"
  28:bluetooth_rxtx.c **** #include "ubertooth_rssi.h"
  29:bluetooth_rxtx.c **** #include "ubertooth_cs.h"
  30:bluetooth_rxtx.c **** #include "ubertooth_dma.h"
  31:bluetooth_rxtx.c **** #include "ubertooth_clock.h"
  32:bluetooth_rxtx.c **** #include "bluetooth.h"
  33:bluetooth_rxtx.c **** #include "bluetooth_le.h"
ARM GAS  /tmp/ccxsBJK4.s 			page 2


  34:bluetooth_rxtx.c **** #include "cc2400_rangetest.h"
  35:bluetooth_rxtx.c **** #include "ego.h"
  36:bluetooth_rxtx.c **** 
  37:bluetooth_rxtx.c **** #define MIN(x,y)	((x)<(y)?(x):(y))
  38:bluetooth_rxtx.c **** #define MAX(x,y)	((x)>(y)?(x):(y))
  39:bluetooth_rxtx.c **** 
  40:bluetooth_rxtx.c **** /* build info */
  41:bluetooth_rxtx.c **** const char compile_info[] =
  42:bluetooth_rxtx.c **** 	"ubertooth " GIT_REVISION " (" COMPILE_BY "@" COMPILE_HOST ") " TIMESTAMP;
  43:bluetooth_rxtx.c **** 
  44:bluetooth_rxtx.c **** /* hopping stuff */
  45:bluetooth_rxtx.c **** volatile uint8_t  hop_mode = HOP_NONE;
  46:bluetooth_rxtx.c **** volatile uint8_t  do_hop = 0;                  // set by timer interrupt
  47:bluetooth_rxtx.c **** volatile uint16_t channel = 2441;
  48:bluetooth_rxtx.c **** volatile uint16_t hop_direct_channel = 0;      // for hopping directly to a channel
  49:bluetooth_rxtx.c **** volatile uint16_t hop_timeout = 158;
  50:bluetooth_rxtx.c **** volatile uint16_t requested_channel = 0;
  51:bluetooth_rxtx.c **** volatile uint16_t le_adv_channel = 2402;
  52:bluetooth_rxtx.c **** 
  53:bluetooth_rxtx.c **** /* bulk USB stuff */
  54:bluetooth_rxtx.c **** volatile uint8_t  idle_buf_clkn_high = 0;
  55:bluetooth_rxtx.c **** volatile uint32_t idle_buf_clk100ns = 0;
  56:bluetooth_rxtx.c **** volatile uint16_t idle_buf_channel = 0;
  57:bluetooth_rxtx.c **** volatile uint8_t  dma_discard = 0;
  58:bluetooth_rxtx.c **** volatile uint8_t  status = 0;
  59:bluetooth_rxtx.c **** 
  60:bluetooth_rxtx.c **** /* operation mode */
  61:bluetooth_rxtx.c **** volatile uint8_t mode = MODE_IDLE;
  62:bluetooth_rxtx.c **** volatile uint8_t requested_mode = MODE_IDLE;
  63:bluetooth_rxtx.c **** volatile uint8_t jam_mode = JAM_NONE;
  64:bluetooth_rxtx.c **** volatile uint8_t ego_mode = EGO_FOLLOW;
  65:bluetooth_rxtx.c **** 
  66:bluetooth_rxtx.c **** volatile uint8_t modulation = MOD_BT_BASIC_RATE;
  67:bluetooth_rxtx.c **** 
  68:bluetooth_rxtx.c **** /* specan stuff */
  69:bluetooth_rxtx.c **** volatile uint16_t low_freq = 2400;
  70:bluetooth_rxtx.c **** volatile uint16_t high_freq = 2483;
  71:bluetooth_rxtx.c **** volatile int8_t rssi_threshold = -30;  // -54dBm - 30 = -84dBm
  72:bluetooth_rxtx.c **** 
  73:bluetooth_rxtx.c **** /* Generic TX stuff */
  74:bluetooth_rxtx.c **** generic_tx_packet tx_pkt;
  75:bluetooth_rxtx.c **** 
  76:bluetooth_rxtx.c **** /* le stuff */
  77:bluetooth_rxtx.c **** uint8_t slave_mac_address[6] = { 0, };
  78:bluetooth_rxtx.c **** 
  79:bluetooth_rxtx.c **** le_state_t le = {
  80:bluetooth_rxtx.c **** 	.access_address = 0x8e89bed6,           // advertising channel access address
  81:bluetooth_rxtx.c **** 	.synch = 0x6b7d,                        // bit-reversed adv channel AA
  82:bluetooth_rxtx.c **** 	.syncl = 0x9171,
  83:bluetooth_rxtx.c **** 	.crc_init  = 0x555555,                  // advertising channel CRCInit
  84:bluetooth_rxtx.c **** 	.crc_init_reversed = 0xAAAAAA,
  85:bluetooth_rxtx.c **** 	.crc_verify = 0,
  86:bluetooth_rxtx.c **** 
  87:bluetooth_rxtx.c **** 	.link_state = LINK_INACTIVE,
  88:bluetooth_rxtx.c **** 	.conn_epoch = 0,
  89:bluetooth_rxtx.c **** 	.target_set = 0,
  90:bluetooth_rxtx.c **** 	.last_packet = 0,
ARM GAS  /tmp/ccxsBJK4.s 			page 3


  91:bluetooth_rxtx.c **** };
  92:bluetooth_rxtx.c **** 
  93:bluetooth_rxtx.c **** typedef struct _le_promisc_active_aa_t {
  94:bluetooth_rxtx.c **** 	u32 aa;
  95:bluetooth_rxtx.c **** 	int count;
  96:bluetooth_rxtx.c **** } le_promisc_active_aa_t;
  97:bluetooth_rxtx.c **** 
  98:bluetooth_rxtx.c **** typedef struct _le_promisc_state_t {
  99:bluetooth_rxtx.c **** 	// LFU cache of recently seen AA's
 100:bluetooth_rxtx.c **** 	le_promisc_active_aa_t active_aa[32];
 101:bluetooth_rxtx.c **** 
 102:bluetooth_rxtx.c **** 	// recovering hop interval
 103:bluetooth_rxtx.c **** 	u32 smallest_hop_interval;
 104:bluetooth_rxtx.c **** 	int consec_intervals;
 105:bluetooth_rxtx.c **** } le_promisc_state_t;
 106:bluetooth_rxtx.c **** le_promisc_state_t le_promisc;
 107:bluetooth_rxtx.c **** #define AA_LIST_SIZE (int)(sizeof(le_promisc.active_aa) / sizeof(le_promisc_active_aa_t))
 108:bluetooth_rxtx.c **** 
 109:bluetooth_rxtx.c **** /* LE jamming */
 110:bluetooth_rxtx.c **** #define JAM_COUNT_DEFAULT 40
 111:bluetooth_rxtx.c **** int le_jam_count = 0;
 112:bluetooth_rxtx.c **** 
 113:bluetooth_rxtx.c **** /* set LE access address */
 114:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa);
 115:bluetooth_rxtx.c **** 
 116:bluetooth_rxtx.c **** typedef int (*data_cb_t)(char *);
 117:bluetooth_rxtx.c **** data_cb_t data_cb = NULL;
 118:bluetooth_rxtx.c **** 
 119:bluetooth_rxtx.c **** typedef void (*packet_cb_t)(u8 *);
 120:bluetooth_rxtx.c **** packet_cb_t packet_cb = NULL;
 121:bluetooth_rxtx.c **** 
 122:bluetooth_rxtx.c **** /* Unpacked symbol buffers (two rxbufs) */
 123:bluetooth_rxtx.c **** char unpacked[DMA_SIZE*8*2];
 124:bluetooth_rxtx.c **** 
 125:bluetooth_rxtx.c **** static int enqueue(uint8_t type, uint8_t* buf)
 126:bluetooth_rxtx.c **** {
 127:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 128:bluetooth_rxtx.c **** 
 129:bluetooth_rxtx.c **** 	/* fail if queue is full */
 130:bluetooth_rxtx.c **** 	if (f == NULL) {
 131:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 132:bluetooth_rxtx.c **** 		return 0;
 133:bluetooth_rxtx.c **** 	}
 134:bluetooth_rxtx.c **** 
 135:bluetooth_rxtx.c **** 	f->pkt_type = type;
 136:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 137:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 138:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 139:bluetooth_rxtx.c **** 	} else {
 140:bluetooth_rxtx.c **** 		f->clkn_high = idle_buf_clkn_high;
 141:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 142:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
 143:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 144:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
 145:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 146:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 147:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/ccxsBJK4.s 			page 4


 148:bluetooth_rxtx.c **** 
 149:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
 150:bluetooth_rxtx.c **** 
 151:bluetooth_rxtx.c **** 	f->status = status;
 152:bluetooth_rxtx.c **** 	status = 0;
 153:bluetooth_rxtx.c **** 
 154:bluetooth_rxtx.c **** 	return 1;
 155:bluetooth_rxtx.c **** }
 156:bluetooth_rxtx.c **** 
 157:bluetooth_rxtx.c **** int enqueue_with_ts(uint8_t type, uint8_t* buf, uint32_t ts)
 158:bluetooth_rxtx.c **** {
 159:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 160:bluetooth_rxtx.c **** 
 161:bluetooth_rxtx.c **** 	/* fail if queue is full */
 162:bluetooth_rxtx.c **** 	if (f == NULL) {
 163:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 164:bluetooth_rxtx.c **** 		return 0;
 165:bluetooth_rxtx.c **** 	}
 166:bluetooth_rxtx.c **** 
 167:bluetooth_rxtx.c **** 	f->pkt_type = type;
 168:bluetooth_rxtx.c **** 
 169:bluetooth_rxtx.c **** 	f->clkn_high = 0;
 170:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 171:bluetooth_rxtx.c **** 
 172:bluetooth_rxtx.c **** 	f->channel = (uint8_t)((channel - 2402) & 0xff);
 173:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 174:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 175:bluetooth_rxtx.c **** 
 176:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
 177:bluetooth_rxtx.c **** 
 178:bluetooth_rxtx.c **** 	f->status = status;
 179:bluetooth_rxtx.c **** 	status = 0;
 180:bluetooth_rxtx.c **** 
 181:bluetooth_rxtx.c **** 	return 1;
 182:bluetooth_rxtx.c **** }
 183:bluetooth_rxtx.c **** 
 184:bluetooth_rxtx.c **** static int vendor_request_handler(uint8_t request, uint16_t* request_params, uint8_t* data, int* da
 185:bluetooth_rxtx.c **** {
 186:bluetooth_rxtx.c **** 	uint32_t clock;
 187:bluetooth_rxtx.c **** 	size_t length; // string length
 188:bluetooth_rxtx.c **** 	usb_pkt_rx* p = NULL;
 189:bluetooth_rxtx.c **** 	uint16_t reg_val;
 190:bluetooth_rxtx.c **** 	uint8_t i;
 191:bluetooth_rxtx.c **** 
 192:bluetooth_rxtx.c **** 	switch (request) {
 193:bluetooth_rxtx.c **** 
 194:bluetooth_rxtx.c **** 	case UBERTOOTH_PING:
 195:bluetooth_rxtx.c **** 		*data_len = 0;
 196:bluetooth_rxtx.c **** 		break;
 197:bluetooth_rxtx.c **** 
 198:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_SYMBOLS:
 199:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_SYMBOLS;
 200:bluetooth_rxtx.c **** 		*data_len = 0;
 201:bluetooth_rxtx.c **** 		break;
 202:bluetooth_rxtx.c **** 
 203:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_SYMBOLS:
 204:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
ARM GAS  /tmp/ccxsBJK4.s 			page 5


 205:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 206:bluetooth_rxtx.c **** 		*data_len = 0;
 207:bluetooth_rxtx.c **** 		break;
 208:bluetooth_rxtx.c **** 
 209:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_USRLED:
 210:bluetooth_rxtx.c **** 		data[0] = (USRLED) ? 1 : 0;
 211:bluetooth_rxtx.c **** 		*data_len = 1;
 212:bluetooth_rxtx.c **** 		break;
 213:bluetooth_rxtx.c **** 
 214:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_USRLED:
 215:bluetooth_rxtx.c **** 		if (request_params[0])
 216:bluetooth_rxtx.c **** 			USRLED_SET;
 217:bluetooth_rxtx.c **** 		else
 218:bluetooth_rxtx.c **** 			USRLED_CLR;
 219:bluetooth_rxtx.c **** 		break;
 220:bluetooth_rxtx.c **** 
 221:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_RXLED:
 222:bluetooth_rxtx.c **** 		data[0] = (RXLED) ? 1 : 0;
 223:bluetooth_rxtx.c **** 		*data_len = 1;
 224:bluetooth_rxtx.c **** 		break;
 225:bluetooth_rxtx.c **** 
 226:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_RXLED:
 227:bluetooth_rxtx.c **** 		if (request_params[0])
 228:bluetooth_rxtx.c **** 			RXLED_SET;
 229:bluetooth_rxtx.c **** 		else
 230:bluetooth_rxtx.c **** 			RXLED_CLR;
 231:bluetooth_rxtx.c **** 		break;
 232:bluetooth_rxtx.c **** 
 233:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_TXLED:
 234:bluetooth_rxtx.c **** 		data[0] = (TXLED) ? 1 : 0;
 235:bluetooth_rxtx.c **** 		*data_len = 1;
 236:bluetooth_rxtx.c **** 		break;
 237:bluetooth_rxtx.c **** 
 238:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_TXLED:
 239:bluetooth_rxtx.c **** 		if (request_params[0])
 240:bluetooth_rxtx.c **** 			TXLED_SET;
 241:bluetooth_rxtx.c **** 		else
 242:bluetooth_rxtx.c **** 			TXLED_CLR;
 243:bluetooth_rxtx.c **** 		break;
 244:bluetooth_rxtx.c **** 
 245:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_1V8:
 246:bluetooth_rxtx.c **** 		data[0] = (CC1V8) ? 1 : 0;
 247:bluetooth_rxtx.c **** 		*data_len = 1;
 248:bluetooth_rxtx.c **** 		break;
 249:bluetooth_rxtx.c **** 
 250:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_1V8:
 251:bluetooth_rxtx.c **** 		if (request_params[0])
 252:bluetooth_rxtx.c **** 			CC1V8_SET;
 253:bluetooth_rxtx.c **** 		else
 254:bluetooth_rxtx.c **** 			CC1V8_CLR;
 255:bluetooth_rxtx.c **** 		break;
 256:bluetooth_rxtx.c **** 
 257:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PARTNUM:
 258:bluetooth_rxtx.c **** 		get_part_num(data, data_len);
 259:bluetooth_rxtx.c **** 		break;
 260:bluetooth_rxtx.c **** 
 261:bluetooth_rxtx.c **** 	case UBERTOOTH_RESET:
ARM GAS  /tmp/ccxsBJK4.s 			page 6


 262:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 263:bluetooth_rxtx.c **** 		break;
 264:bluetooth_rxtx.c **** 
 265:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SERIAL:
 266:bluetooth_rxtx.c **** 		get_device_serial(data, data_len);
 267:bluetooth_rxtx.c **** 		break;
 268:bluetooth_rxtx.c **** 
 269:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 270:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PAEN:
 271:bluetooth_rxtx.c **** 		data[0] = (PAEN) ? 1 : 0;
 272:bluetooth_rxtx.c **** 		*data_len = 1;
 273:bluetooth_rxtx.c **** 		break;
 274:bluetooth_rxtx.c **** 
 275:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PAEN:
 276:bluetooth_rxtx.c **** 		if (request_params[0])
 277:bluetooth_rxtx.c **** 			PAEN_SET;
 278:bluetooth_rxtx.c **** 		else
 279:bluetooth_rxtx.c **** 			PAEN_CLR;
 280:bluetooth_rxtx.c **** 		break;
 281:bluetooth_rxtx.c **** 
 282:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_HGM:
 283:bluetooth_rxtx.c **** 		data[0] = (HGM) ? 1 : 0;
 284:bluetooth_rxtx.c **** 		*data_len = 1;
 285:bluetooth_rxtx.c **** 		break;
 286:bluetooth_rxtx.c **** 
 287:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_HGM:
 288:bluetooth_rxtx.c **** 		if (request_params[0])
 289:bluetooth_rxtx.c **** 			HGM_SET;
 290:bluetooth_rxtx.c **** 		else
 291:bluetooth_rxtx.c **** 			HGM_CLR;
 292:bluetooth_rxtx.c **** 		break;
 293:bluetooth_rxtx.c **** #endif
 294:bluetooth_rxtx.c **** 
 295:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 296:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_TEST:
 297:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_TEST;
 298:bluetooth_rxtx.c **** 		break;
 299:bluetooth_rxtx.c **** 
 300:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PALEVEL:
 301:bluetooth_rxtx.c **** 		data[0] = cc2400_get(FREND) & 0x7;
 302:bluetooth_rxtx.c **** 		*data_len = 1;
 303:bluetooth_rxtx.c **** 		break;
 304:bluetooth_rxtx.c **** 
 305:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PALEVEL:
 306:bluetooth_rxtx.c **** 		if( request_params[0] < 8 ) {
 307:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 308:bluetooth_rxtx.c **** 		} else {
 309:bluetooth_rxtx.c **** 			return 0;
 310:bluetooth_rxtx.c **** 		}
 311:bluetooth_rxtx.c **** 		break;
 312:bluetooth_rxtx.c **** 
 313:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_TEST:
 314:bluetooth_rxtx.c **** 		requested_mode = MODE_RANGE_TEST;
 315:bluetooth_rxtx.c **** 		break;
 316:bluetooth_rxtx.c **** 
 317:bluetooth_rxtx.c **** 	case UBERTOOTH_REPEATER:
 318:bluetooth_rxtx.c **** 		requested_mode = MODE_REPEATER;
ARM GAS  /tmp/ccxsBJK4.s 			page 7


 319:bluetooth_rxtx.c **** 		break;
 320:bluetooth_rxtx.c **** #endif
 321:bluetooth_rxtx.c **** 
 322:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_CHECK:
 323:bluetooth_rxtx.c **** 		data[0] = rr.valid;
 324:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 325:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 326:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 327:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 328:bluetooth_rxtx.c **** 		*data_len = 5;
 329:bluetooth_rxtx.c **** 		break;
 330:bluetooth_rxtx.c **** 
 331:bluetooth_rxtx.c **** 	case UBERTOOTH_STOP:
 332:bluetooth_rxtx.c **** 		requested_mode = MODE_IDLE;
 333:bluetooth_rxtx.c **** 		break;
 334:bluetooth_rxtx.c **** 
 335:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_MOD:
 336:bluetooth_rxtx.c **** 		data[0] = modulation;
 337:bluetooth_rxtx.c **** 		*data_len = 1;
 338:bluetooth_rxtx.c **** 		break;
 339:bluetooth_rxtx.c **** 
 340:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_MOD:
 341:bluetooth_rxtx.c **** 		modulation = request_params[0];
 342:bluetooth_rxtx.c **** 		break;
 343:bluetooth_rxtx.c **** 
 344:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CHANNEL:
 345:bluetooth_rxtx.c **** 		data[0] = channel & 0xFF;
 346:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
 347:bluetooth_rxtx.c **** 		*data_len = 2;
 348:bluetooth_rxtx.c **** 		break;
 349:bluetooth_rxtx.c **** 
 350:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CHANNEL:
 351:bluetooth_rxtx.c **** 		requested_channel = request_params[0];
 352:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 353:bluetooth_rxtx.c **** 		if (requested_channel > MAX_FREQ) {
 354:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 355:bluetooth_rxtx.c **** 			requested_channel = 2402;
 356:bluetooth_rxtx.c **** 		}
 357:bluetooth_rxtx.c **** 		/* fixed channel mode, can be outside bluetooth band */
 358:bluetooth_rxtx.c **** 		else {
 359:bluetooth_rxtx.c **** 			hop_mode = HOP_NONE;
 360:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 361:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 362:bluetooth_rxtx.c **** 		}
 363:bluetooth_rxtx.c **** 
 364:bluetooth_rxtx.c **** 		le_adv_channel = requested_channel;
 365:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 366:bluetooth_rxtx.c **** 			channel = requested_channel;
 367:bluetooth_rxtx.c **** 			requested_channel = 0;
 368:bluetooth_rxtx.c **** 
 369:bluetooth_rxtx.c **** 			/* CS threshold is mode-dependent. Update it after
 370:bluetooth_rxtx.c **** 			 * possible mode change. TODO - kludgy. */
 371:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
 372:bluetooth_rxtx.c **** 		}
 373:bluetooth_rxtx.c **** 		break;
 374:bluetooth_rxtx.c **** 
 375:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ISP:
ARM GAS  /tmp/ccxsBJK4.s 			page 8


 376:bluetooth_rxtx.c **** 		set_isp();
 377:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 378:bluetooth_rxtx.c **** 		break;
 379:bluetooth_rxtx.c **** 
 380:bluetooth_rxtx.c **** 	case UBERTOOTH_FLASH:
 381:bluetooth_rxtx.c **** 		bootloader_ctrl = DFU_MODE;
 382:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 383:bluetooth_rxtx.c **** 		break;
 384:bluetooth_rxtx.c **** 
 385:bluetooth_rxtx.c **** 	case UBERTOOTH_SPECAN:
 386:bluetooth_rxtx.c **** 		if (request_params[0] < 2049 || request_params[0] > 3072 ||
 387:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 388:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 389:bluetooth_rxtx.c **** 			return 0;
 390:bluetooth_rxtx.c **** 		low_freq = request_params[0];
 391:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 392:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 393:bluetooth_rxtx.c **** 		*data_len = 0;
 394:bluetooth_rxtx.c **** 		break;
 395:bluetooth_rxtx.c **** 
 396:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_GENERIC:
 397:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_GENERIC;
 398:bluetooth_rxtx.c **** 		*data_len = 0;
 399:bluetooth_rxtx.c **** 		break;
 400:bluetooth_rxtx.c **** 
 401:bluetooth_rxtx.c **** 	case UBERTOOTH_LED_SPECAN:
 402:bluetooth_rxtx.c **** 		if (request_params[0] > 256)
 403:bluetooth_rxtx.c **** 			return 0;
 404:bluetooth_rxtx.c **** 		rssi_threshold = 54 - request_params[0];
 405:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 406:bluetooth_rxtx.c **** 		*data_len = 0;
 407:bluetooth_rxtx.c **** 		break;
 408:bluetooth_rxtx.c **** 
 409:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_REV_NUM:
 410:bluetooth_rxtx.c **** 		data[0] = 0x00;
 411:bluetooth_rxtx.c **** 		data[1] = 0x00;
 412:bluetooth_rxtx.c **** 
 413:bluetooth_rxtx.c **** 		length = (u8)strlen(GIT_REVISION);
 414:bluetooth_rxtx.c **** 		data[2] = length;
 415:bluetooth_rxtx.c **** 
 416:bluetooth_rxtx.c **** 		memcpy(&data[3], GIT_REVISION, length);
 417:bluetooth_rxtx.c **** 
 418:bluetooth_rxtx.c **** 		*data_len = 2 + 1 + length;
 419:bluetooth_rxtx.c **** 		break;
 420:bluetooth_rxtx.c **** 
 421:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_COMPILE_INFO:
 422:bluetooth_rxtx.c **** 		length = (u8)strlen(compile_info);
 423:bluetooth_rxtx.c **** 		data[0] = length;
 424:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 425:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 426:bluetooth_rxtx.c **** 		break;
 427:bluetooth_rxtx.c **** 
 428:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_BOARD_ID:
 429:bluetooth_rxtx.c **** 		data[0] = BOARD_ID;
 430:bluetooth_rxtx.c **** 		*data_len = 1;
 431:bluetooth_rxtx.c **** 		break;
 432:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccxsBJK4.s 			page 9


 433:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_SQUELCH:
 434:bluetooth_rxtx.c **** 		cs_threshold_req = (int8_t)request_params[0];
 435:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 436:bluetooth_rxtx.c **** 		break;
 437:bluetooth_rxtx.c **** 
 438:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SQUELCH:
 439:bluetooth_rxtx.c **** 		data[0] = cs_threshold_req;
 440:bluetooth_rxtx.c **** 		*data_len = 1;
 441:bluetooth_rxtx.c **** 		break;
 442:bluetooth_rxtx.c **** 
 443:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_BDADDR:
 444:bluetooth_rxtx.c **** 		target.address = 0;
 445:bluetooth_rxtx.c **** 		target.syncword = 0;
 446:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 447:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 448:bluetooth_rxtx.c **** 		}
 449:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 450:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 451:bluetooth_rxtx.c **** 		}
 452:bluetooth_rxtx.c **** 		precalc();
 453:bluetooth_rxtx.c **** 		break;
 454:bluetooth_rxtx.c **** 
 455:bluetooth_rxtx.c **** 	case UBERTOOTH_START_HOPPING:
 456:bluetooth_rxtx.c **** 		clkn_offset = 0;
 457:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 458:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 459:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
 460:bluetooth_rxtx.c **** 		}
 461:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
 462:bluetooth_rxtx.c **** 		dma_discard = 1;
 463:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 464:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 465:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 466:bluetooth_rxtx.c **** 		break;
 467:bluetooth_rxtx.c **** 
 468:bluetooth_rxtx.c **** 	case UBERTOOTH_AFH:
 469:bluetooth_rxtx.c **** 		hop_mode = HOP_AFH;
 470:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 471:bluetooth_rxtx.c **** 
 472:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 473:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 474:bluetooth_rxtx.c **** 		}
 475:bluetooth_rxtx.c **** 		used_channels = 0;
 476:bluetooth_rxtx.c **** 		afh_enabled = 1;
 477:bluetooth_rxtx.c **** 		break;
 478:bluetooth_rxtx.c **** 
 479:bluetooth_rxtx.c **** 	case UBERTOOTH_HOP:
 480:bluetooth_rxtx.c **** 		do_hop = 1;
 481:bluetooth_rxtx.c **** 		break;
 482:bluetooth_rxtx.c **** 
 483:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CLOCK:
 484:bluetooth_rxtx.c **** 		clock = data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24;
 485:bluetooth_rxtx.c **** 		clkn = clock;
 486:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 487:bluetooth_rxtx.c **** 		break;
 488:bluetooth_rxtx.c **** 
 489:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_AFHMAP:
ARM GAS  /tmp/ccxsBJK4.s 			page 10


 490:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 491:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 492:bluetooth_rxtx.c **** 		}
 493:bluetooth_rxtx.c **** 		afh_enabled = 1;
 494:bluetooth_rxtx.c **** 		*data_len = 10;
 495:bluetooth_rxtx.c **** 		break;
 496:bluetooth_rxtx.c **** 
 497:bluetooth_rxtx.c **** 	case UBERTOOTH_CLEAR_AFHMAP:
 498:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 499:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 500:bluetooth_rxtx.c **** 		}
 501:bluetooth_rxtx.c **** 		afh_enabled = 0;
 502:bluetooth_rxtx.c **** 		*data_len = 10;
 503:bluetooth_rxtx.c **** 		break;
 504:bluetooth_rxtx.c **** 
 505:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CLOCK:
 506:bluetooth_rxtx.c **** 		clock = clkn;
 507:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 508:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 509:bluetooth_rxtx.c **** 		}
 510:bluetooth_rxtx.c **** 		*data_len = 4;
 511:bluetooth_rxtx.c **** 		break;
 512:bluetooth_rxtx.c **** 
 513:bluetooth_rxtx.c **** 	case UBERTOOTH_TRIM_CLOCK:
 514:bluetooth_rxtx.c **** 		clk100ns_offset = (data[0] << 8) | (data[1] << 0);
 515:bluetooth_rxtx.c **** 		break;
 516:bluetooth_rxtx.c **** 
 517:bluetooth_rxtx.c **** 	case UBERTOOTH_FIX_CLOCK_DRIFT:
 518:bluetooth_rxtx.c **** 		clk_drift_ppm += (int16_t)(data[0] << 8) | (data[1] << 0);
 519:bluetooth_rxtx.c **** 
 520:bluetooth_rxtx.c **** 		// Too slow
 521:bluetooth_rxtx.c **** 		if (clk_drift_ppm < 0) {
 522:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 523:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 524:bluetooth_rxtx.c **** 		}
 525:bluetooth_rxtx.c **** 		// Too fast
 526:bluetooth_rxtx.c **** 		else if (clk_drift_ppm > 0) {
 527:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
 528:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 529:bluetooth_rxtx.c **** 		}
 530:bluetooth_rxtx.c **** 		// Don't trim
 531:bluetooth_rxtx.c **** 		else {
 532:bluetooth_rxtx.c **** 			clk_drift_correction = 0;
 533:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
 534:bluetooth_rxtx.c **** 		}
 535:bluetooth_rxtx.c **** 
 536:bluetooth_rxtx.c **** 		break;
 537:bluetooth_rxtx.c **** 
 538:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SNIFFING:
 539:bluetooth_rxtx.c **** 		*data_len = 0;
 540:bluetooth_rxtx.c **** 
 541:bluetooth_rxtx.c **** 		do_hop = 0;
 542:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 543:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 544:bluetooth_rxtx.c **** 
 545:bluetooth_rxtx.c **** 		queue_init();
 546:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
ARM GAS  /tmp/ccxsBJK4.s 			page 11


 547:bluetooth_rxtx.c **** 		break;
 548:bluetooth_rxtx.c **** 
 549:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_ACCESS_ADDRESS:
 550:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 551:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 552:bluetooth_rxtx.c **** 		}
 553:bluetooth_rxtx.c **** 		*data_len = 4;
 554:bluetooth_rxtx.c **** 		break;
 555:bluetooth_rxtx.c **** 
 556:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ACCESS_ADDRESS:
 557:bluetooth_rxtx.c **** 		le_set_access_address(data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24);
 558:bluetooth_rxtx.c **** 		le.target_set = 1;
 559:bluetooth_rxtx.c **** 		break;
 560:bluetooth_rxtx.c **** 
 561:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING:
 562:bluetooth_rxtx.c **** 		// do something! just don't commit anything here
 563:bluetooth_rxtx.c **** 		break;
 564:bluetooth_rxtx.c **** 
 565:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING_REPLY:
 566:bluetooth_rxtx.c **** 		// after you do something, tell me what you did!
 567:bluetooth_rxtx.c **** 		// don't commit here please
 568:bluetooth_rxtx.c **** 		data[0] = 0x13;
 569:bluetooth_rxtx.c **** 		data[1] = 0x37;
 570:bluetooth_rxtx.c **** 		*data_len = 2;
 571:bluetooth_rxtx.c **** 		break;
 572:bluetooth_rxtx.c **** 
 573:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CRC_VERIFY:
 574:bluetooth_rxtx.c **** 		data[0] = le.crc_verify ? 1 : 0;
 575:bluetooth_rxtx.c **** 		*data_len = 1;
 576:bluetooth_rxtx.c **** 		break;
 577:bluetooth_rxtx.c **** 
 578:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CRC_VERIFY:
 579:bluetooth_rxtx.c **** 		le.crc_verify = request_params[0] ? 1 : 0;
 580:bluetooth_rxtx.c **** 		break;
 581:bluetooth_rxtx.c **** 
 582:bluetooth_rxtx.c **** 	case UBERTOOTH_POLL:
 583:bluetooth_rxtx.c **** 		p = dequeue();
 584:bluetooth_rxtx.c **** 		if (p != NULL) {
 585:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 586:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 587:bluetooth_rxtx.c **** 		} else {
 588:bluetooth_rxtx.c **** 			data[0] = 0;
 589:bluetooth_rxtx.c **** 			*data_len = 1;
 590:bluetooth_rxtx.c **** 		}
 591:bluetooth_rxtx.c **** 		break;
 592:bluetooth_rxtx.c **** 
 593:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_PROMISC:
 594:bluetooth_rxtx.c **** 		*data_len = 0;
 595:bluetooth_rxtx.c **** 
 596:bluetooth_rxtx.c **** 		hop_mode = HOP_NONE;
 597:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 598:bluetooth_rxtx.c **** 
 599:bluetooth_rxtx.c **** 		queue_init();
 600:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 601:bluetooth_rxtx.c **** 		break;
 602:bluetooth_rxtx.c **** 
 603:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_REGISTER:
ARM GAS  /tmp/ccxsBJK4.s 			page 12


 604:bluetooth_rxtx.c **** 		reg_val = cc2400_get(request_params[0]);
 605:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 606:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 607:bluetooth_rxtx.c **** 		*data_len = 2;
 608:bluetooth_rxtx.c **** 		break;
 609:bluetooth_rxtx.c **** 
 610:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTER:
 611:bluetooth_rxtx.c **** 		cc2400_set(request_params[0] & 0xff, request_params[1]);
 612:bluetooth_rxtx.c **** 		break;
 613:bluetooth_rxtx.c **** 
 614:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTERS:
 615:bluetooth_rxtx.c **** 		for(i=0; i<request_params[0]; i++) {
 616:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 617:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
 618:bluetooth_rxtx.c **** 		}
 619:bluetooth_rxtx.c **** 		break;
 620:bluetooth_rxtx.c **** 
 621:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_ALL_REGISTERS:
 622:bluetooth_rxtx.c **** 		#define MAX_READ_REG 0x2d
 623:bluetooth_rxtx.c **** 		for(i=0; i<=MAX_READ_REG; i++) {
 624:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 625:bluetooth_rxtx.c **** 			data[i*3] = i;
 626:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
 627:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 628:bluetooth_rxtx.c **** 		}
 629:bluetooth_rxtx.c **** 		*data_len = MAX_READ_REG*3;
 630:bluetooth_rxtx.c **** 		break;
 631:bluetooth_rxtx.c **** 
 632:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_GENERIC_PACKET:
 633:bluetooth_rxtx.c **** 		i = 7 + data[6];
 634:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 635:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 636:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_GENERIC;
 637:bluetooth_rxtx.c **** 		*data_len = 0;
 638:bluetooth_rxtx.c **** 		break;
 639:bluetooth_rxtx.c **** 
 640:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE:
 641:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, 6);
 642:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 643:bluetooth_rxtx.c **** 		break;
 644:bluetooth_rxtx.c **** 	
 645:bluetooth_rxtx.c **** 	// WJHUR Power control
 646:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P0:
 647:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, 6);
 648:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P0;
 649:bluetooth_rxtx.c **** 		break;
 650:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P1:
 651:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, 6);
 652:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P1;
 653:bluetooth_rxtx.c **** 		break;
 654:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P2:
 655:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, 6);
 656:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P2;
 657:bluetooth_rxtx.c **** 		break;
 658:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P3:
 659:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, 6);
 660:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P3;
ARM GAS  /tmp/ccxsBJK4.s 			page 13


 661:bluetooth_rxtx.c **** 		break;
 662:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P4:
 663:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, 6);
 664:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P4;
 665:bluetooth_rxtx.c **** 		break;
 666:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P5:
 667:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, 6);
 668:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P5;
 669:bluetooth_rxtx.c **** 		break;
 670:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P6:
 671:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, 6);
 672:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P6;
 673:bluetooth_rxtx.c **** 		break;
 674:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE_P7:
 675:bluetooth_rxtx.c **** 		memcpy(slave_mac_address, data, 6);
 676:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P7;
 677:bluetooth_rxtx.c **** 		break;
 678:bluetooth_rxtx.c **** 
 679:bluetooth_rxtx.c **** 
 680:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SET_TARGET:
 681:bluetooth_rxtx.c **** 		// Addresses appear in packets in reverse-octet order.
 682:bluetooth_rxtx.c **** 		// Store the target address in reverse order so that we can do a simple memcmp later
 683:bluetooth_rxtx.c **** 		le.target[0] = data[5];
 684:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 685:bluetooth_rxtx.c **** 		le.target[2] = data[3];
 686:bluetooth_rxtx.c **** 		le.target[3] = data[2];
 687:bluetooth_rxtx.c **** 		le.target[4] = data[1];
 688:bluetooth_rxtx.c **** 		le.target[5] = data[0];
 689:bluetooth_rxtx.c **** 		le.target_set = 1;
 690:bluetooth_rxtx.c **** 		break;
 691:bluetooth_rxtx.c **** 
 692:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 693:bluetooth_rxtx.c **** 	case UBERTOOTH_JAM_MODE:
 694:bluetooth_rxtx.c **** 		jam_mode = request_params[0];
 695:bluetooth_rxtx.c **** 		break;
 696:bluetooth_rxtx.c **** #endif
 697:bluetooth_rxtx.c **** 
 698:bluetooth_rxtx.c **** 	case UBERTOOTH_EGO:
 699:bluetooth_rxtx.c **** #ifndef TX_ENABLE
 700:bluetooth_rxtx.c **** 		if (ego_mode == EGO_JAM)
 701:bluetooth_rxtx.c **** 			return 0;
 702:bluetooth_rxtx.c **** #endif
 703:bluetooth_rxtx.c **** 		requested_mode = MODE_EGO;
 704:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 705:bluetooth_rxtx.c **** 		break;
 706:bluetooth_rxtx.c **** 
 707:bluetooth_rxtx.c **** 	default:
 708:bluetooth_rxtx.c **** 		return 0;
 709:bluetooth_rxtx.c **** 	}
 710:bluetooth_rxtx.c **** 	return 1;
 711:bluetooth_rxtx.c **** }
 712:bluetooth_rxtx.c **** 
 713:bluetooth_rxtx.c **** /* Update CLKN. */
 714:bluetooth_rxtx.c **** void TIMER0_IRQHandler()
 715:bluetooth_rxtx.c **** {
 716:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 717:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccxsBJK4.s 			page 14


 718:bluetooth_rxtx.c **** 		clkn += clkn_offset + 1;
 719:bluetooth_rxtx.c **** 		clkn_offset = 0;
 720:bluetooth_rxtx.c **** 
 721:bluetooth_rxtx.c **** 		uint32_t le_clk = (clkn - le.conn_epoch) & 0x03;
 722:bluetooth_rxtx.c **** 
 723:bluetooth_rxtx.c **** 		/* Trigger hop based on mode */
 724:bluetooth_rxtx.c **** 
 725:bluetooth_rxtx.c **** 		/* NONE or SWEEP -> 25 Hz */
 726:bluetooth_rxtx.c **** 		if (hop_mode == HOP_NONE || hop_mode == HOP_SWEEP) {
 727:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 728:bluetooth_rxtx.c **** 				do_hop = 1;
 729:bluetooth_rxtx.c **** 		}
 730:bluetooth_rxtx.c **** 		/* BLUETOOTH -> 1600 Hz */
 731:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BLUETOOTH) {
 732:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 733:bluetooth_rxtx.c **** 				do_hop = 1;
 734:bluetooth_rxtx.c **** 		}
 735:bluetooth_rxtx.c **** 		/* BLUETOOTH Low Energy -> 7.5ms - 4.0s in multiples of 1.25 ms */
 736:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BTLE) {
 737:bluetooth_rxtx.c **** 			// Only hop if connected
 738:bluetooth_rxtx.c **** 			if (le.link_state == LINK_CONNECTED && le_clk == 0) {
 739:bluetooth_rxtx.c **** 				--le.interval_timer;
 740:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 741:bluetooth_rxtx.c **** 					do_hop = 1;
 742:bluetooth_rxtx.c **** 					++le.conn_count;
 743:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 744:bluetooth_rxtx.c **** 				} else {
 745:bluetooth_rxtx.c **** 					TXLED_CLR; // hack!
 746:bluetooth_rxtx.c **** 				}
 747:bluetooth_rxtx.c **** 			}
 748:bluetooth_rxtx.c **** 		}
 749:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_AFH) {
 750:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
 751:bluetooth_rxtx.c **** 				do_hop = 1;
 752:bluetooth_rxtx.c **** 			}
 753:bluetooth_rxtx.c **** 		}
 754:bluetooth_rxtx.c **** 
 755:bluetooth_rxtx.c **** 		// Fix linear clock drift deviation
 756:bluetooth_rxtx.c **** 		if(clkn_next_drift_fix != 0 && clk100ns_offset == 0) {
 757:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 758:bluetooth_rxtx.c **** 
 759:bluetooth_rxtx.c **** 				// Too fast
 760:bluetooth_rxtx.c **** 				if(clk_drift_ppm >= 0) {
 761:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 762:bluetooth_rxtx.c **** 				}
 763:bluetooth_rxtx.c **** 
 764:bluetooth_rxtx.c **** 				// Too slow
 765:bluetooth_rxtx.c **** 				else {
 766:bluetooth_rxtx.c **** 					clk100ns_offset = 6249;
 767:bluetooth_rxtx.c **** 				}
 768:bluetooth_rxtx.c **** 				clkn_last_drift_fix = clkn;
 769:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 770:bluetooth_rxtx.c **** 			}
 771:bluetooth_rxtx.c **** 		}
 772:bluetooth_rxtx.c **** 
 773:bluetooth_rxtx.c **** 		// Negative clock correction
 774:bluetooth_rxtx.c **** 		if(clk100ns_offset > 3124)
ARM GAS  /tmp/ccxsBJK4.s 			page 15


 775:bluetooth_rxtx.c **** 			clkn += 2;
 776:bluetooth_rxtx.c **** 
 777:bluetooth_rxtx.c **** 		T0MR0 = 3124 + clk100ns_offset;
 778:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
 779:bluetooth_rxtx.c **** 
 780:bluetooth_rxtx.c **** 		/* Ack interrupt */
 781:bluetooth_rxtx.c **** 		T0IR = TIR_MR0_Interrupt;
 782:bluetooth_rxtx.c **** 	}
 783:bluetooth_rxtx.c **** }
 784:bluetooth_rxtx.c **** 
 785:bluetooth_rxtx.c **** /* EINT3 handler is also defined in ubertooth.c for TC13BADGE. */
 786:bluetooth_rxtx.c **** #ifndef TC13BADGE
 787:bluetooth_rxtx.c **** void EINT3_IRQHandler()
 788:bluetooth_rxtx.c **** {
 789:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 790:bluetooth_rxtx.c **** 	IO2IntClr   = PIN_GIO6; // clear interrupt
 791:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 792:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 793:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 794:bluetooth_rxtx.c **** 		dma_discard = 0;
 795:bluetooth_rxtx.c **** 
 796:bluetooth_rxtx.c **** }
 797:bluetooth_rxtx.c **** #endif // TC13BADGE
 798:bluetooth_rxtx.c **** 
 799:bluetooth_rxtx.c **** /*
 800:bluetooth_rxtx.c ****  * Sleep (busy wait) for 'millis' milliseconds
 801:bluetooth_rxtx.c ****  * Needs clkn. Be sure to call clkn_init() before using it.
 802:bluetooth_rxtx.c ****  */
 803:bluetooth_rxtx.c **** static void msleep(uint32_t millis)
 804:bluetooth_rxtx.c **** {
 805:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
 806:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
 807:bluetooth_rxtx.c **** 
 808:bluetooth_rxtx.c **** 	// handle clkn overflow
 809:bluetooth_rxtx.c **** 	if (stop_at >= ((uint32_t)1<<28)) {
 810:bluetooth_rxtx.c **** 		stop_at -= ((uint32_t)1<<28);
 811:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) >= now || (clkn & 0xffffff) < stop_at);
 812:bluetooth_rxtx.c **** 	} else {
 813:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) < stop_at);
 814:bluetooth_rxtx.c **** 	}
 815:bluetooth_rxtx.c **** }
 816:bluetooth_rxtx.c **** 
 817:bluetooth_rxtx.c **** void DMA_IRQHandler()
 818:bluetooth_rxtx.c **** {
 819:bluetooth_rxtx.c **** 	if ( mode == MODE_RX_SYMBOLS
 820:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
 821:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 822:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 823:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 824:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
 825:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P0
 826:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P1
 827:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P2
 828:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P3
 829:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P4
 830:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P5
 831:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P6
ARM GAS  /tmp/ccxsBJK4.s 			page 16


 832:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P7
 833:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 834:bluetooth_rxtx.c **** 	{
 835:bluetooth_rxtx.c **** 		/* interrupt on channel 0 */
 836:bluetooth_rxtx.c **** 		if (DMACIntStat & (1 << 0)) {
 837:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 838:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 839:bluetooth_rxtx.c **** 
 840:bluetooth_rxtx.c **** 				if (hop_mode == HOP_BLUETOOTH)
 841:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 842:bluetooth_rxtx.c **** 
 843:bluetooth_rxtx.c **** 				idle_buf_clk100ns  = CLK100NS;
 844:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 845:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 846:bluetooth_rxtx.c **** 
 847:bluetooth_rxtx.c **** 				/* Keep buffer swapping in sync with DMA. */
 848:bluetooth_rxtx.c **** 				volatile uint8_t* tmp = active_rxbuf;
 849:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 850:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 851:bluetooth_rxtx.c **** 
 852:bluetooth_rxtx.c **** 				++rx_tc;
 853:bluetooth_rxtx.c **** 			}
 854:bluetooth_rxtx.c **** 			if (DMACIntErrStat & (1 << 0)) {
 855:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 856:bluetooth_rxtx.c **** 				++rx_err;
 857:bluetooth_rxtx.c **** 			}
 858:bluetooth_rxtx.c **** 		}
 859:bluetooth_rxtx.c **** 	}
 860:bluetooth_rxtx.c **** }
 861:bluetooth_rxtx.c **** 
 862:bluetooth_rxtx.c **** static void cc2400_idle()
 863:bluetooth_rxtx.c **** {
 864:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 865:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 866:bluetooth_rxtx.c **** 
 867:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 868:bluetooth_rxtx.c **** 	PAEN_CLR;
 869:bluetooth_rxtx.c **** 	HGM_CLR;
 870:bluetooth_rxtx.c **** #endif
 871:bluetooth_rxtx.c **** 
 872:bluetooth_rxtx.c **** 	RXLED_CLR;
 873:bluetooth_rxtx.c **** 	TXLED_CLR;
 874:bluetooth_rxtx.c **** 	USRLED_CLR;
 875:bluetooth_rxtx.c **** 
 876:bluetooth_rxtx.c **** 	clkn_stop();
 877:bluetooth_rxtx.c **** 	dio_ssp_stop();
 878:bluetooth_rxtx.c **** 	cs_reset();
 879:bluetooth_rxtx.c **** 	rssi_reset();
 880:bluetooth_rxtx.c **** 
 881:bluetooth_rxtx.c **** 	/* hopping stuff */
 882:bluetooth_rxtx.c **** 	hop_mode = HOP_NONE;
 883:bluetooth_rxtx.c **** 	do_hop = 0;
 884:bluetooth_rxtx.c **** 	channel = 2441;
 885:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 886:bluetooth_rxtx.c **** 	hop_timeout = 158;
 887:bluetooth_rxtx.c **** 	requested_channel = 0;
 888:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
ARM GAS  /tmp/ccxsBJK4.s 			page 17


 889:bluetooth_rxtx.c **** 
 890:bluetooth_rxtx.c **** 
 891:bluetooth_rxtx.c **** 	/* bulk USB stuff */
 892:bluetooth_rxtx.c **** 	idle_buf_clkn_high = 0;
 893:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 894:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 895:bluetooth_rxtx.c **** 	dma_discard = 0;
 896:bluetooth_rxtx.c **** 	status = 0;
 897:bluetooth_rxtx.c **** 
 898:bluetooth_rxtx.c **** 	/* operation mode */
 899:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 900:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 901:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 902:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 903:bluetooth_rxtx.c **** 
 904:bluetooth_rxtx.c **** 	modulation = MOD_BT_BASIC_RATE;
 905:bluetooth_rxtx.c **** 
 906:bluetooth_rxtx.c **** 	/* specan stuff */
 907:bluetooth_rxtx.c **** 	low_freq = 2400;
 908:bluetooth_rxtx.c **** 	high_freq = 2483;
 909:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 910:bluetooth_rxtx.c **** 
 911:bluetooth_rxtx.c **** 	target.address = 0;
 912:bluetooth_rxtx.c **** 	target.syncword = 0;
 913:bluetooth_rxtx.c **** }
 914:bluetooth_rxtx.c **** 
 915:bluetooth_rxtx.c **** /* start un-buffered rx */
 916:bluetooth_rxtx.c **** static void cc2400_rx()
 917:bluetooth_rxtx.c **** {
 918:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
 919:bluetooth_rxtx.c **** 
 920:bluetooth_rxtx.c **** 	if((modulation == MOD_BT_BASIC_RATE) || (modulation == MOD_BT_LOW_ENERGY)) {
 921:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
 922:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
 923:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
 924:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
 925:bluetooth_rxtx.c **** 		}
 926:bluetooth_rxtx.c **** 		cc2400_set(MANAND,  0x7fff);
 927:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
 928:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG
 929:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 930:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
 931:bluetooth_rxtx.c **** 		//      |  | |   |  +--------> CRC off
 932:bluetooth_rxtx.c **** 		//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
 933:bluetooth_rxtx.c **** 		//      |  | +---------------> 2 preamble bytes of 01010101
 934:bluetooth_rxtx.c **** 		//      |  +-----------------> not packet mode
 935:bluetooth_rxtx.c **** 			//      +--------------------> un-buffered mode
 936:bluetooth_rxtx.c **** 		cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
 937:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
 938:bluetooth_rxtx.c **** 	}
 939:bluetooth_rxtx.c **** 
 940:bluetooth_rxtx.c **** 	// Set up CS register
 941:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
 942:bluetooth_rxtx.c **** 
 943:bluetooth_rxtx.c **** 	clkn_start();
 944:bluetooth_rxtx.c **** 
 945:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
ARM GAS  /tmp/ccxsBJK4.s 			page 18


 946:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 947:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 948:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 949:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 950:bluetooth_rxtx.c **** 	PAEN_SET;
 951:bluetooth_rxtx.c **** 	HGM_SET;
 952:bluetooth_rxtx.c **** #endif
 953:bluetooth_rxtx.c **** }
 954:bluetooth_rxtx.c **** 
 955:bluetooth_rxtx.c **** /* start un-buffered rx */
 956:bluetooth_rxtx.c **** static void cc2400_rx_sync(u32 sync)
 957:bluetooth_rxtx.c **** {
 958:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 959:bluetooth_rxtx.c **** 
 960:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
 961:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 962:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
 963:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
 964:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
 965:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
 966:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 0 preamble bytes of 01010101
 967:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
 968:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
 969:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
 970:bluetooth_rxtx.c **** 
 971:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 972:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 973:bluetooth_rxtx.c **** 		grmdm = 0x0561; // un-buffered mode, packet w/ sync word detection
 974:bluetooth_rxtx.c **** 		// 0 00 00 1 010 11 0 00 0 1
 975:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
 976:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
 977:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 2 preamble bytes of 01010101
 978:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
 979:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
 980:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
 981:bluetooth_rxtx.c **** 
 982:bluetooth_rxtx.c **** 	} else {
 983:bluetooth_rxtx.c **** 		/* oops */
 984:bluetooth_rxtx.c **** 		return;
 985:bluetooth_rxtx.c **** 	}
 986:bluetooth_rxtx.c **** 
 987:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
 988:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 989:bluetooth_rxtx.c **** 
 990:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x124b);
 991:bluetooth_rxtx.c **** 	// 1      2      4b
 992:bluetooth_rxtx.c **** 	// 00 0 1 0 0 10 01001011
 993:bluetooth_rxtx.c **** 	//    | | | | |  +---------> AFC_DELTA = ??
 994:bluetooth_rxtx.c **** 	//    | | | | +------------> AFC settling = 4 pairs (8 bit preamble)
 995:bluetooth_rxtx.c **** 	//    | | | +--------------> no AFC adjust on packet
 996:bluetooth_rxtx.c **** 	//    | | +----------------> do not invert data
 997:bluetooth_rxtx.c **** 	//    | +------------------> TX IF freq 1 0Hz
 998:bluetooth_rxtx.c **** 	//    +--------------------> PRNG off
 999:bluetooth_rxtx.c **** 	//
1000:bluetooth_rxtx.c **** 	// ref: CC2400 datasheet page 67
1001:bluetooth_rxtx.c **** 	// AFC settling explained page 41/42
1002:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccxsBJK4.s 			page 19


1003:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   grmdm);
1004:bluetooth_rxtx.c **** 
1005:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1006:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1007:bluetooth_rxtx.c **** 
1008:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
1009:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
1010:bluetooth_rxtx.c **** 
1011:bluetooth_rxtx.c **** 	// Set up CS register
1012:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
1013:bluetooth_rxtx.c **** 
1014:bluetooth_rxtx.c **** 	clkn_start();
1015:bluetooth_rxtx.c **** 
1016:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1017:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1018:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1019:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
1020:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1021:bluetooth_rxtx.c **** 	PAEN_SET;
1022:bluetooth_rxtx.c **** 	HGM_SET;
1023:bluetooth_rxtx.c **** #endif
1024:bluetooth_rxtx.c **** }
1025:bluetooth_rxtx.c **** 
1026:bluetooth_rxtx.c **** /* start buffered tx */
1027:bluetooth_rxtx.c **** static void cc2400_tx_sync(uint32_t sync)
1028:bluetooth_rxtx.c **** {
1029:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1030:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1031:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1032:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1033:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
1034:bluetooth_rxtx.c **** 
1035:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1036:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1037:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1038:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1039:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1040:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1041:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1042:bluetooth_rxtx.c **** 
1043:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1044:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1045:bluetooth_rxtx.c **** 
1046:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel);
1047:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1048:bluetooth_rxtx.c **** 
1049:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
1050:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
1051:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
1052:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1053:bluetooth_rxtx.c **** 	} else {
1054:bluetooth_rxtx.c **** 		/* oops */
1055:bluetooth_rxtx.c **** 		return;
1056:bluetooth_rxtx.c **** 	}
1057:bluetooth_rxtx.c **** 
1058:bluetooth_rxtx.c **** 	clkn_start();
1059:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccxsBJK4.s 			page 20


1060:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1061:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1062:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1063:bluetooth_rxtx.c **** 
1064:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1065:bluetooth_rxtx.c **** 	PAEN_SET;
1066:bluetooth_rxtx.c **** #endif
1067:bluetooth_rxtx.c **** 
1068:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1069:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1070:bluetooth_rxtx.c **** 
1071:bluetooth_rxtx.c **** #endif
1072:bluetooth_rxtx.c **** }
1073:bluetooth_rxtx.c **** 
1074:bluetooth_rxtx.c **** /*
1075:bluetooth_rxtx.c ****  * Transmit a BTLE packet with the specified access address.
1076:bluetooth_rxtx.c ****  *
1077:bluetooth_rxtx.c ****  * All modulation parameters are set within this function. The data
1078:bluetooth_rxtx.c ****  * should not be pre-whitened, but the CRC should be calculated and
1079:bluetooth_rxtx.c ****  * included in the data length.
1080:bluetooth_rxtx.c ****  */
1081:bluetooth_rxtx.c **** void le_transmit(u32 aa, u8 len, u8 *data, u16 tx_pwr)
1082:bluetooth_rxtx.c **** {
1083:bluetooth_rxtx.c **** 	unsigned i, j;
1084:bluetooth_rxtx.c **** 	int bit;
1085:bluetooth_rxtx.c **** 	u8 txbuf[64];
1086:bluetooth_rxtx.c **** 	u8 tx_len;
1087:bluetooth_rxtx.c **** 	u8 byte;
1088:bluetooth_rxtx.c **** 	u16 gio_save;
1089:bluetooth_rxtx.c **** 	//JWHUR tx power control
1090:bluetooth_rxtx.c **** 	tx_pwr = (tx_pwr & 0x000f);
1091:bluetooth_rxtx.c **** 
1092:bluetooth_rxtx.c **** 	// first four bytes: AA
1093:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
1094:bluetooth_rxtx.c **** 		byte = aa & 0xff;
1095:bluetooth_rxtx.c **** 		aa >>= 8;
1096:bluetooth_rxtx.c **** 		txbuf[i] = 0;
1097:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
1098:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
1099:bluetooth_rxtx.c **** 			byte >>= 1;
1100:bluetooth_rxtx.c **** 		}
1101:bluetooth_rxtx.c **** 	}
1102:bluetooth_rxtx.c **** 
1103:bluetooth_rxtx.c **** 	// whiten the data and copy it into the txbuf
1104:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(channel-2402)];
1105:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
1106:bluetooth_rxtx.c **** 		byte = data[i];
1107:bluetooth_rxtx.c **** 		txbuf[i+4] = 0;
1108:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
1109:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
1110:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
1111:bluetooth_rxtx.c **** 			byte >>= 1;
1112:bluetooth_rxtx.c **** 			txbuf[i+4] |= bit << (7 - j);
1113:bluetooth_rxtx.c **** 		}
1114:bluetooth_rxtx.c **** 	}
1115:bluetooth_rxtx.c **** 
1116:bluetooth_rxtx.c **** 	len += 4; // include the AA in len
ARM GAS  /tmp/ccxsBJK4.s 			page 21


1117:bluetooth_rxtx.c **** 
1118:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1119:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1120:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1121:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
1122:bluetooth_rxtx.c **** 
1123:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1124:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1125:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1126:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1127:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1128:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1129:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1130:bluetooth_rxtx.c **** 
1131:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel);
1132:bluetooth_rxtx.c **** 	// JWHUR cc2400 data sheet about power control
1133:bluetooth_rxtx.c **** 	// lsb 3 bit : dbm
1134:bluetooth_rxtx.c **** 	// 000 : -25
1135:bluetooth_rxtx.c **** 	// 001 : -15
1136:bluetooth_rxtx.c **** 	// 010 : -10
1137:bluetooth_rxtx.c **** 	// 011 : -7
1138:bluetooth_rxtx.c **** 	// 100 : -4.6
1139:bluetooth_rxtx.c **** 	// 101 : -2.8
1140:bluetooth_rxtx.c **** 	// 110 : -1.3
1141:bluetooth_rxtx.c **** 	// 111 : 0
1142:bluetooth_rxtx.c **** 	cc2400_set(FREND, tx_pwr);
1143:bluetooth_rxtx.c **** 	//cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1144:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1145:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1146:bluetooth_rxtx.c **** 
1147:bluetooth_rxtx.c **** 	// sync byte depends on the first transmitted bit of the AA
1148:bluetooth_rxtx.c **** 	if (aa & 1)
1149:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0xaaaa);
1150:bluetooth_rxtx.c **** 	else
1151:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0x5555);
1152:bluetooth_rxtx.c **** 
1153:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1154:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
1155:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
1156:bluetooth_rxtx.c **** 
1157:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1158:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1159:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1160:bluetooth_rxtx.c **** 	TXLED_SET;
1161:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1162:bluetooth_rxtx.c **** 	PAEN_SET;
1163:bluetooth_rxtx.c **** #endif
1164:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1165:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1166:bluetooth_rxtx.c **** 
1167:bluetooth_rxtx.c **** 	// put the packet into the FIFO
1168:bluetooth_rxtx.c **** 	/*
1169:bluetooth_rxtx.c **** 	for (i = 0; i < len; i += 16) {
1170:bluetooth_rxtx.c **** 		while (GIO6) ; // wait for the FIFO to drain (FIFO_FULL false)
1171:bluetooth_rxtx.c **** 		tx_len = len - i;
1172:bluetooth_rxtx.c **** 		if (tx_len >16)
1173:bluetooth_rxtx.c **** 			tx_len = 16;
ARM GAS  /tmp/ccxsBJK4.s 			page 22


1174:bluetooth_rxtx.c **** 		cc2400_fifo_write(tx_len, txbuf + i);
1175:bluetooth_rxtx.c **** 	}*/
1176:bluetooth_rxtx.c **** 
1177:bluetooth_rxtx.c **** 	//JWHUR cc2400 fifo write
1178:bluetooth_rxtx.c **** 	while (GIO6) ;
1179:bluetooth_rxtx.c **** 	cc2400_fifo_write(len, txbuf);
1180:bluetooth_rxtx.c **** 
1181:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1182:bluetooth_rxtx.c **** 	TXLED_CLR;
1183:bluetooth_rxtx.c **** 
1184:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1185:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
1186:bluetooth_rxtx.c **** 
1187:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1188:bluetooth_rxtx.c **** 	PAEN_CLR;
1189:bluetooth_rxtx.c **** #endif
1190:bluetooth_rxtx.c **** 
1191:bluetooth_rxtx.c **** 	// reset GIO
1192:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
1193:bluetooth_rxtx.c **** }
1194:bluetooth_rxtx.c **** 
1195:bluetooth_rxtx.c **** void le_jam(void) {
1196:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1197:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1198:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1199:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
1200:bluetooth_rxtx.c **** 
1201:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1202:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1203:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1204:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1205:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1206:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1207:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1208:bluetooth_rxtx.c **** 
1209:bluetooth_rxtx.c **** 	// cc2400_set(FSDIV,   channel);
1210:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1211:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1212:bluetooth_rxtx.c **** 
1213:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1214:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1215:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1216:bluetooth_rxtx.c **** 	TXLED_SET;
1217:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1218:bluetooth_rxtx.c **** 	PAEN_SET;
1219:bluetooth_rxtx.c **** #endif
1220:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1221:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1222:bluetooth_rxtx.c **** #endif
1223:bluetooth_rxtx.c **** }
1224:bluetooth_rxtx.c **** 
1225:bluetooth_rxtx.c **** /* TODO - return whether hop happened, or should caller have to keep
1226:bluetooth_rxtx.c ****  * track of this? */
1227:bluetooth_rxtx.c **** void hop(void)
1228:bluetooth_rxtx.c **** {
1229:bluetooth_rxtx.c **** 	do_hop = 0;
1230:bluetooth_rxtx.c **** 	last_hop = clkn;
ARM GAS  /tmp/ccxsBJK4.s 			page 23


1231:bluetooth_rxtx.c **** 
1232:bluetooth_rxtx.c **** 	// No hopping, if channel is set correctly, do nothing
1233:bluetooth_rxtx.c **** 	if (hop_mode == HOP_NONE) {
1234:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
1235:bluetooth_rxtx.c **** 			return;
1236:bluetooth_rxtx.c **** 	}
1237:bluetooth_rxtx.c **** 	/* Slow sweep (100 hops/sec)
1238:bluetooth_rxtx.c **** 	 * only hop to currently used channels if AFH is enabled
1239:bluetooth_rxtx.c **** 	 */
1240:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_SWEEP) {
1241:bluetooth_rxtx.c **** 		do {
1242:bluetooth_rxtx.c **** 			channel += 32;
1243:bluetooth_rxtx.c **** 			if (channel > 2480)
1244:bluetooth_rxtx.c **** 				channel -= 79;
1245:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
1246:bluetooth_rxtx.c **** 	}
1247:bluetooth_rxtx.c **** 
1248:bluetooth_rxtx.c **** 	/* AFH detection
1249:bluetooth_rxtx.c **** 	 * only hop to currently unused channesl
1250:bluetooth_rxtx.c **** 	 */
1251:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_AFH) {
1252:bluetooth_rxtx.c **** 		do {
1253:bluetooth_rxtx.c **** 			channel += 32;
1254:bluetooth_rxtx.c **** 			if (channel > 2480)
1255:bluetooth_rxtx.c **** 				channel -= 79;
1256:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
1257:bluetooth_rxtx.c **** 	}
1258:bluetooth_rxtx.c **** 
1259:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BLUETOOTH) {
1260:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
1261:bluetooth_rxtx.c **** 	}
1262:bluetooth_rxtx.c **** 
1263:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BTLE) {
1264:bluetooth_rxtx.c **** 		channel = btle_next_hop(&le);
1265:bluetooth_rxtx.c **** 	}
1266:bluetooth_rxtx.c **** 
1267:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_DIRECT) {
1268:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
1269:bluetooth_rxtx.c **** 	}
1270:bluetooth_rxtx.c **** 	/* IDLE mode, but leave amp on, so don't call cc2400_idle(). */
1271:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1272:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1273:bluetooth_rxtx.c **** 
1274:bluetooth_rxtx.c **** 	/* Retune */
1275:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1276:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
1277:bluetooth_rxtx.c **** 	else
1278:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel - 1);
1279:bluetooth_rxtx.c **** 
1280:bluetooth_rxtx.c **** 	/* Update CS register if hopping.  */
1281:bluetooth_rxtx.c **** 	if (hop_mode > 0) {
1282:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
1283:bluetooth_rxtx.c **** 	}
1284:bluetooth_rxtx.c **** 
1285:bluetooth_rxtx.c **** 	/* Wait for lock */
1286:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1287:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
ARM GAS  /tmp/ccxsBJK4.s 			page 24


1288:bluetooth_rxtx.c **** 
1289:bluetooth_rxtx.c **** 	dma_discard = 1;
1290:bluetooth_rxtx.c **** 
1291:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1292:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1293:bluetooth_rxtx.c **** 	else
1294:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
1295:bluetooth_rxtx.c **** }
1296:bluetooth_rxtx.c **** 
1297:bluetooth_rxtx.c **** /* Bluetooth packet monitoring */
1298:bluetooth_rxtx.c **** void bt_stream_rx()
1299:bluetooth_rxtx.c **** {
1300:bluetooth_rxtx.c **** 	int8_t rssi;
1301:bluetooth_rxtx.c **** 	int8_t rssi_at_trigger;
1302:bluetooth_rxtx.c **** 
1303:bluetooth_rxtx.c **** 	RXLED_CLR;
1304:bluetooth_rxtx.c **** 
1305:bluetooth_rxtx.c **** 	queue_init();
1306:bluetooth_rxtx.c **** 	dio_ssp_init();
1307:bluetooth_rxtx.c **** 	dma_init();
1308:bluetooth_rxtx.c **** 	dio_ssp_start();
1309:bluetooth_rxtx.c **** 
1310:bluetooth_rxtx.c **** 	cc2400_rx();
1311:bluetooth_rxtx.c **** 
1312:bluetooth_rxtx.c **** 	cs_trigger_enable();
1313:bluetooth_rxtx.c **** 
1314:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_RX_SYMBOLS || requested_mode == MODE_BT_FOLLOW )
1315:bluetooth_rxtx.c **** 	{
1316:bluetooth_rxtx.c **** 
1317:bluetooth_rxtx.c **** 		RXLED_CLR;
1318:bluetooth_rxtx.c **** 
1319:bluetooth_rxtx.c **** 		/* Wait for DMA transfer. TODO - need more work on
1320:bluetooth_rxtx.c **** 		 * RSSI. Should send RSSI indications to host even
1321:bluetooth_rxtx.c **** 		 * when not transferring data. That would also keep
1322:bluetooth_rxtx.c **** 		 * the USB stream going. This loop runs 50-80 times
1323:bluetooth_rxtx.c **** 		 * while waiting for DMA, but RSSI sampling does not
1324:bluetooth_rxtx.c **** 		 * cover all the symbols in a DMA transfer. Can not do
1325:bluetooth_rxtx.c **** 		 * RSSI sampling in CS interrupt, but could log time
1326:bluetooth_rxtx.c **** 		 * at multiple trigger points there. The MAX() below
1327:bluetooth_rxtx.c **** 		 * helps with statistics in the case that cs_trigger
1328:bluetooth_rxtx.c **** 		 * happened before the loop started. */
1329:bluetooth_rxtx.c **** 		rssi_reset();
1330:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
1331:bluetooth_rxtx.c **** 		while (!rx_tc) {
1332:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1333:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1334:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1335:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
1336:bluetooth_rxtx.c **** 			}
1337:bluetooth_rxtx.c **** 			rssi_add(rssi);
1338:bluetooth_rxtx.c **** 
1339:bluetooth_rxtx.c **** 			handle_usb(clkn);
1340:bluetooth_rxtx.c **** 
1341:bluetooth_rxtx.c **** 			/* If timer says time to hop, do it. */
1342:bluetooth_rxtx.c **** 			if (do_hop) {
1343:bluetooth_rxtx.c **** 				hop();
1344:bluetooth_rxtx.c **** 			} else {
ARM GAS  /tmp/ccxsBJK4.s 			page 25


1345:bluetooth_rxtx.c **** 				TXLED_CLR;
1346:bluetooth_rxtx.c **** 			}
1347:bluetooth_rxtx.c **** 			/* TODO - set per-channel carrier sense threshold.
1348:bluetooth_rxtx.c **** 			 * Set by firmware or host. */
1349:bluetooth_rxtx.c **** 		}
1350:bluetooth_rxtx.c **** 
1351:bluetooth_rxtx.c **** 		RXLED_SET;
1352:bluetooth_rxtx.c **** 
1353:bluetooth_rxtx.c **** 		if (rx_err) {
1354:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1355:bluetooth_rxtx.c **** 		}
1356:bluetooth_rxtx.c **** 
1357:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1358:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1359:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1360:bluetooth_rxtx.c **** 
1361:bluetooth_rxtx.c **** 		if (dma_discard) {
1362:bluetooth_rxtx.c **** 			status |= DISCARD;
1363:bluetooth_rxtx.c **** 			dma_discard = 0;
1364:bluetooth_rxtx.c **** 		}
1365:bluetooth_rxtx.c **** 
1366:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1367:bluetooth_rxtx.c **** 
1368:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1369:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1370:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1371:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1372:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1373:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1374:bluetooth_rxtx.c **** 			cs_trigger = 0;
1375:bluetooth_rxtx.c **** 		}
1376:bluetooth_rxtx.c **** 
1377:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1378:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1379:bluetooth_rxtx.c **** 		}
1380:bluetooth_rxtx.c **** 
1381:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, (uint8_t*)idle_rxbuf);
1382:bluetooth_rxtx.c **** 
1383:bluetooth_rxtx.c **** 		handle_usb(clkn);
1384:bluetooth_rxtx.c **** 		rx_tc = 0;
1385:bluetooth_rxtx.c **** 		rx_err = 0;
1386:bluetooth_rxtx.c **** 	}
1387:bluetooth_rxtx.c **** 
1388:bluetooth_rxtx.c **** 	/* This call is a nop so far. Since bt_rx_stream() starts the
1389:bluetooth_rxtx.c **** 	 * stream, it makes sense that it would stop it. TODO - how
1390:bluetooth_rxtx.c **** 	 * should setup/teardown be handled? Should every new mode be
1391:bluetooth_rxtx.c **** 	 * starting from scratch? */
1392:bluetooth_rxtx.c **** 	dio_ssp_stop();
1393:bluetooth_rxtx.c **** 	cs_trigger_disable();
1394:bluetooth_rxtx.c **** }
1395:bluetooth_rxtx.c **** 
1396:bluetooth_rxtx.c **** static uint8_t reverse8(uint8_t data)
1397:bluetooth_rxtx.c **** {
  26              		.loc 1 1397 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 0
  29              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/ccxsBJK4.s 			page 26


  30              	.LVL0:
  31 0000 10B5     		push	{r4, lr}
  32              		.cfi_def_cfa_offset 8
  33              		.cfi_offset 4, -8
  34              		.cfi_offset 14, -4
  35              	.LVL1:
  36              	.LBB4:
1398:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
1399:bluetooth_rxtx.c **** 
1400:bluetooth_rxtx.c **** 	for(size_t i=0; i<8; i++)
  37              		.loc 1 1400 0
  38 0002 0023     		movs	r3, #0
  39              	.LBE4:
1398:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
  40              		.loc 1 1398 0
  41 0004 1A46     		mov	r2, r3
  42              	.LVL2:
  43              	.L3:
  44              	.LBB5:
1401:bluetooth_rxtx.c **** 	{
1402:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (7-i);
  45              		.loc 1 1402 0 discriminator 2
  46 0006 40FA03F1 		asr	r1, r0, r3
  47 000a C3F10704 		rsb	r4, r3, #7
  48 000e 01F00101 		and	r1, r1, #1
  49 0012 A140     		lsls	r1, r1, r4
1400:bluetooth_rxtx.c **** 	{
  50              		.loc 1 1400 0 discriminator 2
  51 0014 0133     		adds	r3, r3, #1
  52              	.LVL3:
  53              		.loc 1 1402 0 discriminator 2
  54 0016 0A43     		orrs	r2, r2, r1
  55              	.LVL4:
1400:bluetooth_rxtx.c **** 	{
  56              		.loc 1 1400 0 discriminator 2
  57 0018 082B     		cmp	r3, #8
  58              		.loc 1 1402 0 discriminator 2
  59 001a D2B2     		uxtb	r2, r2
  60              	.LVL5:
1400:bluetooth_rxtx.c **** 	{
  61              		.loc 1 1400 0 discriminator 2
  62 001c F3D1     		bne	.L3
  63              	.LBE5:
1403:bluetooth_rxtx.c **** 	}
1404:bluetooth_rxtx.c **** 
1405:bluetooth_rxtx.c **** 	return reversed;
1406:bluetooth_rxtx.c **** }
  64              		.loc 1 1406 0
  65 001e 1046     		mov	r0, r2
  66              	.LVL6:
  67 0020 10BD     		pop	{r4, pc}
  68              		.cfi_endproc
  69              	.LFE15:
  71              		.section	.text.cc2400_rx,"ax",%progbits
  72              		.align	1
  73              		.thumb
  74              		.thumb_func
ARM GAS  /tmp/ccxsBJK4.s 			page 27


  76              	cc2400_rx:
  77              	.LFB8:
 917:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
  78              		.loc 1 917 0
  79              		.cfi_startproc
  80              		@ args = 0, pretend = 0, frame = 0
  81              		@ frame_needed = 0, uses_anonymous_args = 0
  82 0000 38B5     		push	{r3, r4, r5, lr}
  83              		.cfi_def_cfa_offset 16
  84              		.cfi_offset 3, -16
  85              		.cfi_offset 4, -12
  86              		.cfi_offset 5, -8
  87              		.cfi_offset 14, -4
  88              	.LVL7:
 920:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
  89              		.loc 1 920 0
  90 0002 254B     		ldr	r3, .L19
  91 0004 254C     		ldr	r4, .L19+4
  92 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
  93 0008 12B1     		cbz	r2, .L7
 920:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
  94              		.loc 1 920 0 is_stmt 0 discriminator 1
  95 000a 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
  96 000c 012A     		cmp	r2, #1
  97 000e 28D1     		bne	.L8
  98              	.L7:
 921:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
  99              		.loc 1 921 0 is_stmt 1
 100 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 101 0012 33B1     		cbz	r3, .L14
 923:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
 102              		.loc 1 923 0
 103 0014 204B     		ldr	r3, .L19
 104 0016 1D78     		ldrb	r5, [r3]	@ zero_extendqisi2
 918:bluetooth_rxtx.c **** 
 105              		.loc 1 918 0
 106 0018 012D     		cmp	r5, #1
 107 001a 0CBF     		ite	eq
 108 001c 4025     		moveq	r5, #64
 109 001e 0025     		movne	r5, #0
 110 0020 00E0     		b	.L9
 111              	.L14:
 922:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
 112              		.loc 1 922 0
 113 0022 2925     		movs	r5, #41
 114              	.L9:
 115              	.LVL8:
 926:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
 116              		.loc 1 926 0
 117 0024 0D20     		movs	r0, #13
 118 0026 47F6FF71 		movw	r1, #32767
 119 002a FFF7FEFF 		bl	cc2400_set
 120              	.LVL9:
 927:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG
 121              		.loc 1 927 0
 122 002e 1220     		movs	r0, #18
 123 0030 42F62231 		movw	r1, #11042
ARM GAS  /tmp/ccxsBJK4.s 			page 28


 124 0034 FFF7FEFF 		bl	cc2400_set
 125              	.LVL10:
 928:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 126              		.loc 1 928 0
 127 0038 1420     		movs	r0, #20
 128 003a 41F24B31 		movw	r1, #4939
 129 003e FFF7FEFF 		bl	cc2400_set
 130              	.LVL11:
 929:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
 131              		.loc 1 929 0
 132 0042 2020     		movs	r0, #32
 133 0044 40F20111 		movw	r1, #257
 134 0048 FFF7FEFF 		bl	cc2400_set
 135              	.LVL12:
 936:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
 136              		.loc 1 936 0
 137 004c 2188     		ldrh	r1, [r4]
 138 004e 0220     		movs	r0, #2
 139 0050 89B2     		uxth	r1, r1
 140 0052 0139     		subs	r1, r1, #1
 141 0054 89B2     		uxth	r1, r1
 142 0056 FFF7FEFF 		bl	cc2400_set
 143              	.LVL13:
 937:bluetooth_rxtx.c **** 	}
 144              		.loc 1 937 0
 145 005a 0320     		movs	r0, #3
 146 005c 2946     		mov	r1, r5
 147 005e FFF7FEFF 		bl	cc2400_set
 148              	.LVL14:
 149              	.L8:
 941:bluetooth_rxtx.c **** 
 150              		.loc 1 941 0
 151 0062 2088     		ldrh	r0, [r4]
 152 0064 80B2     		uxth	r0, r0
 153 0066 FFF7FEFF 		bl	cs_threshold_calc_and_set
 154              	.LVL15:
 943:bluetooth_rxtx.c **** 
 155              		.loc 1 943 0
 156 006a FFF7FEFF 		bl	clkn_start
 157              	.LVL16:
 158              	.L11:
 945:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 159              		.loc 1 945 0 discriminator 1
 160 006e FFF7FEFF 		bl	cc2400_status
 161              	.LVL17:
 162 0072 4206     		lsls	r2, r0, #25
 163 0074 FBD5     		bpl	.L11
 946:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 164              		.loc 1 946 0
 165 0076 6120     		movs	r0, #97
 166 0078 FFF7FEFF 		bl	cc2400_strobe
 167              	.LVL18:
 168              	.L13:
 947:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 169              		.loc 1 947 0 discriminator 1
 170 007c FFF7FEFF 		bl	cc2400_status
 171              	.LVL19:
ARM GAS  /tmp/ccxsBJK4.s 			page 29


 172 0080 4307     		lsls	r3, r0, #29
 173 0082 FBD5     		bpl	.L13
 948:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 174              		.loc 1 948 0
 175 0084 6220     		movs	r0, #98
 176 0086 FFF7FEFF 		bl	cc2400_strobe
 177              	.LVL20:
 950:bluetooth_rxtx.c **** 	HGM_SET;
 178              		.loc 1 950 0
 179 008a 054B     		ldr	r3, .L19+8
 180 008c 8022     		movs	r2, #128
 181 008e 1A60     		str	r2, [r3]
 951:bluetooth_rxtx.c **** #endif
 182              		.loc 1 951 0
 183 0090 4FF48072 		mov	r2, #256
 184 0094 1A60     		str	r2, [r3]
 185 0096 38BD     		pop	{r3, r4, r5, pc}
 186              	.L20:
 187              		.align	2
 188              	.L19:
 189 0098 00000000 		.word	.LANCHOR0
 190 009c 00000000 		.word	.LANCHOR1
 191 00a0 58C00920 		.word	537509976
 192              		.cfi_endproc
 193              	.LFE8:
 195              		.section	.text.cc2400_rx_sync,"ax",%progbits
 196              		.align	1
 197              		.thumb
 198              		.thumb_func
 200              	cc2400_rx_sync:
 201              	.LFB9:
 957:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 202              		.loc 1 957 0
 203              		.cfi_startproc
 204              		@ args = 0, pretend = 0, frame = 0
 205              		@ frame_needed = 0, uses_anonymous_args = 0
 206              	.LVL21:
 207 0000 70B5     		push	{r4, r5, r6, lr}
 208              		.cfi_def_cfa_offset 16
 209              		.cfi_offset 4, -16
 210              		.cfi_offset 5, -12
 211              		.cfi_offset 6, -8
 212              		.cfi_offset 14, -4
 960:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 213              		.loc 1 960 0
 214 0002 284B     		ldr	r3, .L29
 957:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 215              		.loc 1 957 0
 216 0004 0446     		mov	r4, r0
 960:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 217              		.loc 1 960 0
 218 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 219 0008 32B1     		cbz	r2, .L28
 971:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 220              		.loc 1 971 0
 221 000a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 222 000c 012B     		cmp	r3, #1
ARM GAS  /tmp/ccxsBJK4.s 			page 30


 223 000e 47D1     		bne	.L21
 972:bluetooth_rxtx.c **** 		grmdm = 0x0561; // un-buffered mode, packet w/ sync word detection
 224              		.loc 1 972 0
 225 0010 4025     		movs	r5, #64
 973:bluetooth_rxtx.c **** 		// 0 00 00 1 010 11 0 00 0 1
 226              		.loc 1 973 0
 227 0012 40F26156 		movw	r6, #1377
 228 0016 02E0     		b	.L22
 229              	.L28:
 961:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
 230              		.loc 1 961 0
 231 0018 2925     		movs	r5, #41
 962:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
 232              		.loc 1 962 0
 233 001a 40F26146 		movw	r6, #1121
 234              	.L22:
 235              	.LVL22:
 987:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 236              		.loc 1 987 0
 237 001e 0D20     		movs	r0, #13
 238              	.LVL23:
 239 0020 47F6FF71 		movw	r1, #32767
 240 0024 FFF7FEFF 		bl	cc2400_set
 241              	.LVL24:
 988:bluetooth_rxtx.c **** 
 242              		.loc 1 988 0
 243 0028 1220     		movs	r0, #18
 244 002a 42F62231 		movw	r1, #11042
 245 002e FFF7FEFF 		bl	cc2400_set
 246              	.LVL25:
 990:bluetooth_rxtx.c **** 	// 1      2      4b
 247              		.loc 1 990 0
 248 0032 1420     		movs	r0, #20
 249 0034 41F24B21 		movw	r1, #4683
 250 0038 FFF7FEFF 		bl	cc2400_set
 251              	.LVL26:
1003:bluetooth_rxtx.c **** 
 252              		.loc 1 1003 0
 253 003c 2020     		movs	r0, #32
 254 003e 3146     		mov	r1, r6
 255 0040 FFF7FEFF 		bl	cc2400_set
 256              	.LVL27:
1005:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 257              		.loc 1 1005 0
 258 0044 A1B2     		uxth	r1, r4
 259 0046 2C20     		movs	r0, #44
 260 0048 FFF7FEFF 		bl	cc2400_set
 261              	.LVL28:
1006:bluetooth_rxtx.c **** 
 262              		.loc 1 1006 0
 263 004c 210C     		lsrs	r1, r4, #16
1008:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 264              		.loc 1 1008 0
 265 004e 164C     		ldr	r4, .L29+4
 266              	.LVL29:
1006:bluetooth_rxtx.c **** 
 267              		.loc 1 1006 0
ARM GAS  /tmp/ccxsBJK4.s 			page 31


 268 0050 2D20     		movs	r0, #45
 269 0052 FFF7FEFF 		bl	cc2400_set
 270              	.LVL30:
1008:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 271              		.loc 1 1008 0
 272 0056 2188     		ldrh	r1, [r4]
 273 0058 0220     		movs	r0, #2
 274 005a 89B2     		uxth	r1, r1
 275 005c 0139     		subs	r1, r1, #1
 276 005e 89B2     		uxth	r1, r1
 277 0060 FFF7FEFF 		bl	cc2400_set
 278              	.LVL31:
1009:bluetooth_rxtx.c **** 
 279              		.loc 1 1009 0
 280 0064 0320     		movs	r0, #3
 281 0066 2946     		mov	r1, r5
 282 0068 FFF7FEFF 		bl	cc2400_set
 283              	.LVL32:
1012:bluetooth_rxtx.c **** 
 284              		.loc 1 1012 0
 285 006c 2088     		ldrh	r0, [r4]
 286 006e 80B2     		uxth	r0, r0
 287 0070 FFF7FEFF 		bl	cs_threshold_calc_and_set
 288              	.LVL33:
1014:bluetooth_rxtx.c **** 
 289              		.loc 1 1014 0
 290 0074 FFF7FEFF 		bl	clkn_start
 291              	.LVL34:
 292              	.L25:
1016:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 293              		.loc 1 1016 0 discriminator 1
 294 0078 FFF7FEFF 		bl	cc2400_status
 295              	.LVL35:
 296 007c 4006     		lsls	r0, r0, #25
 297 007e FBD5     		bpl	.L25
1017:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 298              		.loc 1 1017 0
 299 0080 6120     		movs	r0, #97
 300 0082 FFF7FEFF 		bl	cc2400_strobe
 301              	.LVL36:
 302              	.L27:
1018:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 303              		.loc 1 1018 0 discriminator 1
 304 0086 FFF7FEFF 		bl	cc2400_status
 305              	.LVL37:
 306 008a 4107     		lsls	r1, r0, #29
 307 008c FBD5     		bpl	.L27
1019:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 308              		.loc 1 1019 0
 309 008e 6220     		movs	r0, #98
 310 0090 FFF7FEFF 		bl	cc2400_strobe
 311              	.LVL38:
1021:bluetooth_rxtx.c **** 	HGM_SET;
 312              		.loc 1 1021 0
 313 0094 054B     		ldr	r3, .L29+8
 314 0096 8022     		movs	r2, #128
 315 0098 1A60     		str	r2, [r3]
ARM GAS  /tmp/ccxsBJK4.s 			page 32


1022:bluetooth_rxtx.c **** #endif
 316              		.loc 1 1022 0
 317 009a 4FF48072 		mov	r2, #256
 318 009e 1A60     		str	r2, [r3]
 319              	.LVL39:
 320              	.L21:
 321 00a0 70BD     		pop	{r4, r5, r6, pc}
 322              	.L30:
 323 00a2 00BF     		.align	2
 324              	.L29:
 325 00a4 00000000 		.word	.LANCHOR0
 326 00a8 00000000 		.word	.LANCHOR1
 327 00ac 58C00920 		.word	537509976
 328              		.cfi_endproc
 329              	.LFE9:
 331              		.section	.text.enqueue,"ax",%progbits
 332              		.align	1
 333              		.thumb
 334              		.thumb_func
 336              	enqueue:
 337              	.LFB0:
 126:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 338              		.loc 1 126 0
 339              		.cfi_startproc
 340              		@ args = 0, pretend = 0, frame = 0
 341              		@ frame_needed = 0, uses_anonymous_args = 0
 342              	.LVL40:
 343 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 344              		.cfi_def_cfa_offset 24
 345              		.cfi_offset 3, -24
 346              		.cfi_offset 4, -20
 347              		.cfi_offset 5, -16
 348              		.cfi_offset 6, -12
 349              		.cfi_offset 7, -8
 350              		.cfi_offset 14, -4
 126:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 351              		.loc 1 126 0
 352 0002 0646     		mov	r6, r0
 353 0004 0F46     		mov	r7, r1
 127:bluetooth_rxtx.c **** 
 354              		.loc 1 127 0
 355 0006 FFF7FEFF 		bl	usb_enqueue
 356              	.LVL41:
 357 000a 1E4D     		ldr	r5, .L36
 130:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 358              		.loc 1 130 0
 359 000c 0446     		mov	r4, r0
 360 000e 20B9     		cbnz	r0, .L32
 131:bluetooth_rxtx.c **** 		return 0;
 361              		.loc 1 131 0
 362 0010 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 363 0012 43F00403 		orr	r3, r3, #4
 364 0016 6B70     		strb	r3, [r5, #1]
 132:bluetooth_rxtx.c **** 	}
 365              		.loc 1 132 0
 366 0018 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 367              	.LVL42:
ARM GAS  /tmp/ccxsBJK4.s 			page 33


 368              	.L32:
 136:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 369              		.loc 1 136 0
 370 001a 042E     		cmp	r6, #4
 135:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 371              		.loc 1 135 0
 372 001c 0670     		strb	r6, [r0]
 136:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 373              		.loc 1 136 0
 374 001e 0ED1     		bne	.L34
 137:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 375              		.loc 1 137 0
 376 0020 194B     		ldr	r3, .L36+4
 138:bluetooth_rxtx.c **** 	} else {
 377              		.loc 1 138 0
 378 0022 40F63541 		movw	r1, #3125
 137:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 379              		.loc 1 137 0
 380 0026 1A68     		ldr	r2, [r3]
 381 0028 120D     		lsrs	r2, r2, #20
 382 002a C270     		strb	r2, [r0, #3]
 138:bluetooth_rxtx.c **** 	} else {
 383              		.loc 1 138 0
 384 002c 174A     		ldr	r2, .L36+8
 385 002e 1B68     		ldr	r3, [r3]
 386 0030 1268     		ldr	r2, [r2]
 387 0032 C3F31303 		ubfx	r3, r3, #0, #20
 388 0036 01FB0323 		mla	r3, r1, r3, r2
 389 003a 4360     		str	r3, [r0, #4]
 390 003c 15E0     		b	.L35
 391              	.L34:
 140:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 392              		.loc 1 140 0
 393 003e AB78     		ldrb	r3, [r5, #2]	@ zero_extendqisi2
 394 0040 C370     		strb	r3, [r0, #3]
 141:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
 395              		.loc 1 141 0
 396 0042 6B68     		ldr	r3, [r5, #4]
 397 0044 4360     		str	r3, [r0, #4]
 142:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 398              		.loc 1 142 0
 399 0046 2B89     		ldrh	r3, [r5, #8]
 400 0048 9BB2     		uxth	r3, r3
 401 004a 623B     		subs	r3, r3, #98
 402 004c 8370     		strb	r3, [r0, #2]
 143:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
 403              		.loc 1 143 0
 404 004e 104B     		ldr	r3, .L36+12
 405 0050 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 406 0052 4372     		strb	r3, [r0, #9]
 144:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 407              		.loc 1 144 0
 408 0054 0F4B     		ldr	r3, .L36+16
 409 0056 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 410 0058 0372     		strb	r3, [r0, #8]
 145:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 411              		.loc 1 145 0
ARM GAS  /tmp/ccxsBJK4.s 			page 34


 412 005a 2889     		ldrh	r0, [r5, #8]
 413              	.LVL43:
 414 005c 80B2     		uxth	r0, r0
 415 005e FFF7FEFF 		bl	rssi_get_avg
 416              	.LVL44:
 146:bluetooth_rxtx.c **** 	}
 417              		.loc 1 146 0
 418 0062 0D4B     		ldr	r3, .L36+20
 145:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 419              		.loc 1 145 0
 420 0064 A072     		strb	r0, [r4, #10]
 146:bluetooth_rxtx.c **** 	}
 421              		.loc 1 146 0
 422 0066 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 423 0068 E372     		strb	r3, [r4, #11]
 424              	.L35:
 149:bluetooth_rxtx.c **** 
 425              		.loc 1 149 0
 426 006a 04F10E00 		add	r0, r4, #14
 427 006e 3946     		mov	r1, r7
 428 0070 3222     		movs	r2, #50
 429 0072 FFF7FEFF 		bl	memcpy
 430              	.LVL45:
 151:bluetooth_rxtx.c **** 	status = 0;
 431              		.loc 1 151 0
 432 0076 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 154:bluetooth_rxtx.c **** }
 433              		.loc 1 154 0
 434 0078 0120     		movs	r0, #1
 151:bluetooth_rxtx.c **** 	status = 0;
 435              		.loc 1 151 0
 436 007a 6370     		strb	r3, [r4, #1]
 152:bluetooth_rxtx.c **** 
 437              		.loc 1 152 0
 438 007c 0023     		movs	r3, #0
 439 007e 6B70     		strb	r3, [r5, #1]
 155:bluetooth_rxtx.c **** 
 440              		.loc 1 155 0
 441 0080 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 442              	.LVL46:
 443              	.L37:
 444 0082 00BF     		.align	2
 445              	.L36:
 446 0084 00000000 		.word	.LANCHOR0
 447 0088 00000000 		.word	clkn
 448 008c 08400040 		.word	1073758216
 449 0090 00000000 		.word	rssi_min
 450 0094 00000000 		.word	rssi_max
 451 0098 00000000 		.word	rssi_count
 452              		.cfi_endproc
 453              	.LFE0:
 455              		.section	.text.le_set_access_address,"ax",%progbits
 456              		.align	1
 457              		.thumb
 458              		.thumb_func
 460              	le_set_access_address:
 461              	.LFB18:
ARM GAS  /tmp/ccxsBJK4.s 			page 35


1407:bluetooth_rxtx.c **** 
1408:bluetooth_rxtx.c **** static uint16_t reverse16(uint16_t data)
1409:bluetooth_rxtx.c **** {
1410:bluetooth_rxtx.c **** 	uint16_t reversed = 0;
1411:bluetooth_rxtx.c **** 
1412:bluetooth_rxtx.c **** 	for(size_t i=0; i<16; i++)
1413:bluetooth_rxtx.c **** 	{
1414:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (15-i);
1415:bluetooth_rxtx.c **** 	}
1416:bluetooth_rxtx.c **** 
1417:bluetooth_rxtx.c **** 	return reversed;
1418:bluetooth_rxtx.c **** }
1419:bluetooth_rxtx.c **** 
1420:bluetooth_rxtx.c **** /*
1421:bluetooth_rxtx.c ****  * Transmit a BTBR packet with the specified access code.
1422:bluetooth_rxtx.c ****  *
1423:bluetooth_rxtx.c ****  * All modulation parameters are set within this function.
1424:bluetooth_rxtx.c ****  */
1425:bluetooth_rxtx.c **** void br_transmit()
1426:bluetooth_rxtx.c **** {
1427:bluetooth_rxtx.c **** 	uint16_t gio_save;
1428:bluetooth_rxtx.c **** 
1429:bluetooth_rxtx.c **** 	uint32_t clkn_saved = 0;
1430:bluetooth_rxtx.c **** 
1431:bluetooth_rxtx.c **** 	uint16_t preamble = (target.syncword & 1) == 1 ? 0x5555 : 0xaaaa;
1432:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
1433:bluetooth_rxtx.c **** 
1434:bluetooth_rxtx.c **** 	uint8_t data[16] = {
1435:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
1436:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
1437:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
1438:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
1439:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
1440:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
1441:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
1442:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
1443:bluetooth_rxtx.c **** 		reverse8(trailer),
1444:bluetooth_rxtx.c **** 		reverse8(0x77),
1445:bluetooth_rxtx.c **** 		reverse8(0x66),
1446:bluetooth_rxtx.c **** 		reverse8(0x55),
1447:bluetooth_rxtx.c **** 		reverse8(0x44),
1448:bluetooth_rxtx.c **** 		reverse8(0x33),
1449:bluetooth_rxtx.c **** 		reverse8(0x22),
1450:bluetooth_rxtx.c **** 		reverse8(0x11)
1451:bluetooth_rxtx.c **** 	};
1452:bluetooth_rxtx.c **** 
1453:bluetooth_rxtx.c **** 	cc2400_tx_sync(reverse16(preamble));
1454:bluetooth_rxtx.c **** 
1455:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1456:bluetooth_rxtx.c **** 
1457:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1458:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
1459:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
1460:bluetooth_rxtx.c **** 
1461:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_TX_SYMBOLS )
1462:bluetooth_rxtx.c **** 	{
1463:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccxsBJK4.s 			page 36


1464:bluetooth_rxtx.c **** 		while ((clkn >> 1) == (clkn_saved >> 1) || T0TC < 2250) {
1465:bluetooth_rxtx.c **** 
1466:bluetooth_rxtx.c **** 			// If timer says time to hop, do it.
1467:bluetooth_rxtx.c **** 			if (do_hop) {
1468:bluetooth_rxtx.c **** 				hop();
1469:bluetooth_rxtx.c **** 			}
1470:bluetooth_rxtx.c **** 		}
1471:bluetooth_rxtx.c **** 
1472:bluetooth_rxtx.c **** 		clkn_saved = clkn;
1473:bluetooth_rxtx.c **** 
1474:bluetooth_rxtx.c **** 		TXLED_SET;
1475:bluetooth_rxtx.c **** 
1476:bluetooth_rxtx.c **** 		cc2400_fifo_write(16, data);
1477:bluetooth_rxtx.c **** 
1478:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1479:bluetooth_rxtx.c **** 		TXLED_CLR;
1480:bluetooth_rxtx.c **** 
1481:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
1482:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
1483:bluetooth_rxtx.c **** 
1484:bluetooth_rxtx.c **** 		while (!(cc2400_status() & XOSC16M_STABLE));
1485:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1486:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
1487:bluetooth_rxtx.c **** 
1488:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1489:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1490:bluetooth_rxtx.c **** 
1491:bluetooth_rxtx.c **** 		handle_usb(clkn);
1492:bluetooth_rxtx.c **** 	}
1493:bluetooth_rxtx.c **** 
1494:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1495:bluetooth_rxtx.c **** 	PAEN_CLR;
1496:bluetooth_rxtx.c **** #endif
1497:bluetooth_rxtx.c **** 
1498:bluetooth_rxtx.c **** 	// reset GIO
1499:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
1500:bluetooth_rxtx.c **** }
1501:bluetooth_rxtx.c **** 
1502:bluetooth_rxtx.c **** /* set LE access address */
1503:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa) {
 462              		.loc 1 1503 0
 463              		.cfi_startproc
 464              		@ args = 0, pretend = 0, frame = 0
 465              		@ frame_needed = 0, uses_anonymous_args = 0
 466              	.LVL47:
 467 0000 10B5     		push	{r4, lr}
 468              		.cfi_def_cfa_offset 8
 469              		.cfi_offset 4, -8
 470              		.cfi_offset 14, -4
1504:bluetooth_rxtx.c **** 	u32 aa_rev;
1505:bluetooth_rxtx.c **** 
1506:bluetooth_rxtx.c **** 	le.access_address = aa;
 471              		.loc 1 1506 0
 472 0002 044C     		ldr	r4, .L39
 473 0004 6060     		str	r0, [r4, #4]
1507:bluetooth_rxtx.c **** 	aa_rev = rbit(aa);
 474              		.loc 1 1507 0
ARM GAS  /tmp/ccxsBJK4.s 			page 37


 475 0006 FFF7FEFF 		bl	rbit
 476              	.LVL48:
1508:bluetooth_rxtx.c **** 	le.syncl = aa_rev & 0xffff;
 477              		.loc 1 1508 0
 478 000a 6081     		strh	r0, [r4, #10]	@ movhi
1509:bluetooth_rxtx.c **** 	le.synch = aa_rev >> 16;
 479              		.loc 1 1509 0
 480 000c 000C     		lsrs	r0, r0, #16
 481              	.LVL49:
 482 000e 2081     		strh	r0, [r4, #8]	@ movhi
 483 0010 10BD     		pop	{r4, pc}
 484              	.L40:
 485 0012 00BF     		.align	2
 486              	.L39:
 487 0014 00000000 		.word	.LANCHOR1
 488              		.cfi_endproc
 489              	.LFE18:
 491              		.section	.text.cc2400_idle,"ax",%progbits
 492              		.align	1
 493              		.thumb
 494              		.thumb_func
 496              	cc2400_idle:
 497              	.LFB7:
 863:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 498              		.loc 1 863 0
 499              		.cfi_startproc
 500              		@ args = 0, pretend = 0, frame = 0
 501              		@ frame_needed = 0, uses_anonymous_args = 0
 502 0000 10B5     		push	{r4, lr}
 503              		.cfi_def_cfa_offset 8
 504              		.cfi_offset 4, -8
 505              		.cfi_offset 14, -4
 864:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 506              		.loc 1 864 0
 507 0002 6420     		movs	r0, #100
 508 0004 FFF7FEFF 		bl	cc2400_strobe
 509              	.LVL50:
 510              	.L43:
 865:bluetooth_rxtx.c **** 
 511              		.loc 1 865 0 discriminator 1
 512 0008 FFF7FEFF 		bl	cc2400_status
 513              	.LVL51:
 514 000c 00F00400 		and	r0, r0, #4
 515 0010 00F0FF04 		and	r4, r0, #255
 516 0014 0028     		cmp	r0, #0
 517 0016 F7D1     		bne	.L43
 868:bluetooth_rxtx.c **** 	HGM_CLR;
 518              		.loc 1 868 0
 519 0018 204B     		ldr	r3, .L44
 520 001a 8022     		movs	r2, #128
 521 001c 1A60     		str	r2, [r3]
 872:bluetooth_rxtx.c **** 	TXLED_CLR;
 522              		.loc 1 872 0
 523 001e 1021     		movs	r1, #16
 869:bluetooth_rxtx.c **** #endif
 524              		.loc 1 869 0
 525 0020 4FF48072 		mov	r2, #256
ARM GAS  /tmp/ccxsBJK4.s 			page 38


 526 0024 1A60     		str	r2, [r3]
 872:bluetooth_rxtx.c **** 	TXLED_CLR;
 527              		.loc 1 872 0
 528 0026 43F8201C 		str	r1, [r3, #-32]
 873:bluetooth_rxtx.c **** 	USRLED_CLR;
 529              		.loc 1 873 0
 530 002a 43F8202C 		str	r2, [r3, #-32]
 874:bluetooth_rxtx.c **** 
 531              		.loc 1 874 0
 532 002e 0222     		movs	r2, #2
 533 0030 43F8202C 		str	r2, [r3, #-32]
 876:bluetooth_rxtx.c **** 	dio_ssp_stop();
 534              		.loc 1 876 0
 535 0034 FFF7FEFF 		bl	clkn_stop
 536              	.LVL52:
 877:bluetooth_rxtx.c **** 	cs_reset();
 537              		.loc 1 877 0
 538 0038 FFF7FEFF 		bl	dio_ssp_stop
 539              	.LVL53:
 878:bluetooth_rxtx.c **** 	rssi_reset();
 540              		.loc 1 878 0
 541 003c FFF7FEFF 		bl	cs_reset
 542              	.LVL54:
 879:bluetooth_rxtx.c **** 
 543              		.loc 1 879 0
 544 0040 FFF7FEFF 		bl	rssi_reset
 545              	.LVL55:
 882:bluetooth_rxtx.c **** 	do_hop = 0;
 546              		.loc 1 882 0
 547 0044 164B     		ldr	r3, .L44+4
 884:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 548              		.loc 1 884 0
 549 0046 174A     		ldr	r2, .L44+8
 550 0048 40F68911 		movw	r1, #2441
 882:bluetooth_rxtx.c **** 	do_hop = 0;
 551              		.loc 1 882 0
 552 004c 9C72     		strb	r4, [r3, #10]
 883:bluetooth_rxtx.c **** 	channel = 2441;
 553              		.loc 1 883 0
 554 004e DC72     		strb	r4, [r3, #11]
 884:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 555              		.loc 1 884 0
 556 0050 1180     		strh	r1, [r2]	@ movhi
 886:bluetooth_rxtx.c **** 	requested_channel = 0;
 557              		.loc 1 886 0
 558 0052 9E21     		movs	r1, #158
 885:bluetooth_rxtx.c **** 	hop_timeout = 158;
 559              		.loc 1 885 0
 560 0054 9C81     		strh	r4, [r3, #12]	@ movhi
 886:bluetooth_rxtx.c **** 	requested_channel = 0;
 561              		.loc 1 886 0
 562 0056 A2F84810 		strh	r1, [r2, #72]	@ movhi
 888:bluetooth_rxtx.c **** 
 563              		.loc 1 888 0
 564 005a 40F66211 		movw	r1, #2402
 887:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
 565              		.loc 1 887 0
ARM GAS  /tmp/ccxsBJK4.s 			page 39


 566 005e DC81     		strh	r4, [r3, #14]	@ movhi
 888:bluetooth_rxtx.c **** 
 567              		.loc 1 888 0
 568 0060 A2F84A10 		strh	r1, [r2, #74]	@ movhi
 892:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 569              		.loc 1 892 0
 570 0064 9C70     		strb	r4, [r3, #2]
 893:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 571              		.loc 1 893 0
 572 0066 5C60     		str	r4, [r3, #4]
 894:bluetooth_rxtx.c **** 	dma_discard = 0;
 573              		.loc 1 894 0
 574 0068 1C81     		strh	r4, [r3, #8]	@ movhi
 895:bluetooth_rxtx.c **** 	status = 0;
 575              		.loc 1 895 0
 576 006a 1C74     		strb	r4, [r3, #16]
 896:bluetooth_rxtx.c **** 
 577              		.loc 1 896 0
 578 006c 5C70     		strb	r4, [r3, #1]
 899:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 579              		.loc 1 899 0
 580 006e 5C74     		strb	r4, [r3, #17]
 900:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 581              		.loc 1 900 0
 582 0070 9C74     		strb	r4, [r3, #18]
 901:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 583              		.loc 1 901 0
 584 0072 DC74     		strb	r4, [r3, #19]
 902:bluetooth_rxtx.c **** 
 585              		.loc 1 902 0
 586 0074 1C75     		strb	r4, [r3, #20]
 904:bluetooth_rxtx.c **** 
 587              		.loc 1 904 0
 588 0076 1C70     		strb	r4, [r3]
 907:bluetooth_rxtx.c **** 	high_freq = 2483;
 589              		.loc 1 907 0
 590 0078 4FF41663 		mov	r3, #2400
 591 007c A2F84C30 		strh	r3, [r2, #76]	@ movhi
 908:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 592              		.loc 1 908 0
 593 0080 5333     		adds	r3, r3, #83
 594 0082 A2F84E30 		strh	r3, [r2, #78]	@ movhi
 911:bluetooth_rxtx.c **** 	target.syncword = 0;
 595              		.loc 1 911 0
 596 0086 0849     		ldr	r1, .L44+12
 909:bluetooth_rxtx.c **** 
 597              		.loc 1 909 0
 598 0088 E223     		movs	r3, #226
 599 008a 82F85030 		strb	r3, [r2, #80]
 911:bluetooth_rxtx.c **** 	target.syncword = 0;
 600              		.loc 1 911 0
 601 008e 0022     		movs	r2, #0
 602 0090 0023     		movs	r3, #0
 603 0092 C1E90023 		strd	r2, [r1]
 912:bluetooth_rxtx.c **** }
 604              		.loc 1 912 0
 605 0096 C1E90223 		strd	r2, [r1, #8]
ARM GAS  /tmp/ccxsBJK4.s 			page 40


 606 009a 10BD     		pop	{r4, pc}
 607              	.L45:
 608              		.align	2
 609              	.L44:
 610 009c 5CC00920 		.word	537509980
 611 00a0 00000000 		.word	.LANCHOR0
 612 00a4 00000000 		.word	.LANCHOR1
 613 00a8 00000000 		.word	target
 614              		.cfi_endproc
 615              	.LFE7:
 617              		.section	.text.cb_follow_le,"ax",%progbits
 618              		.align	1
 619              		.global	cb_follow_le
 620              		.thumb
 621              		.thumb_func
 623              	cb_follow_le:
 624              	.LFB23:
1510:bluetooth_rxtx.c **** }
1511:bluetooth_rxtx.c **** 
1512:bluetooth_rxtx.c **** /* reset le state, called by bt_generic_le and bt_follow_le() */
1513:bluetooth_rxtx.c **** void reset_le() {
1514:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
1515:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
1516:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
1517:bluetooth_rxtx.c **** 	le.crc_verify = 0;
1518:bluetooth_rxtx.c **** 	le.last_packet = 0;
1519:bluetooth_rxtx.c **** 
1520:bluetooth_rxtx.c **** 	le.link_state = LINK_INACTIVE;
1521:bluetooth_rxtx.c **** 
1522:bluetooth_rxtx.c **** 	le.channel_idx = 0;
1523:bluetooth_rxtx.c **** 	le.channel_increment = 0;
1524:bluetooth_rxtx.c **** 
1525:bluetooth_rxtx.c **** 	le.conn_epoch = 0;
1526:bluetooth_rxtx.c **** 	le.interval_timer = 0;
1527:bluetooth_rxtx.c **** 	le.conn_interval = 0;
1528:bluetooth_rxtx.c **** 	le.conn_interval = 0;
1529:bluetooth_rxtx.c **** 	le.conn_count = 0;
1530:bluetooth_rxtx.c **** 
1531:bluetooth_rxtx.c **** 	le.win_size = 0;
1532:bluetooth_rxtx.c **** 	le.win_offset = 0;
1533:bluetooth_rxtx.c **** 
1534:bluetooth_rxtx.c **** 	le.update_pending = 0;
1535:bluetooth_rxtx.c **** 	le.update_instant = 0;
1536:bluetooth_rxtx.c **** 	le.interval_update = 0;
1537:bluetooth_rxtx.c **** 	le.win_size_update = 0;
1538:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
1539:bluetooth_rxtx.c **** 
1540:bluetooth_rxtx.c **** 	do_hop = 0;
1541:bluetooth_rxtx.c **** }
1542:bluetooth_rxtx.c **** 
1543:bluetooth_rxtx.c **** // reset LE Promisc state
1544:bluetooth_rxtx.c **** void reset_le_promisc(void) {
1545:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
1546:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
1547:bluetooth_rxtx.c **** }
1548:bluetooth_rxtx.c **** 
1549:bluetooth_rxtx.c **** /* generic le mode */
ARM GAS  /tmp/ccxsBJK4.s 			page 41


1550:bluetooth_rxtx.c **** void bt_generic_le(u8 active_mode)
1551:bluetooth_rxtx.c **** {
1552:bluetooth_rxtx.c **** 	u8 hold;
1553:bluetooth_rxtx.c **** 	int i, j;
1554:bluetooth_rxtx.c **** 	int8_t rssi, rssi_at_trigger;
1555:bluetooth_rxtx.c **** 
1556:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1557:bluetooth_rxtx.c **** 	mode = active_mode;
1558:bluetooth_rxtx.c **** 
1559:bluetooth_rxtx.c **** 	reset_le();
1560:bluetooth_rxtx.c **** 
1561:bluetooth_rxtx.c **** 	// enable USB interrupts
1562:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1563:bluetooth_rxtx.c **** 
1564:bluetooth_rxtx.c **** 	RXLED_CLR;
1565:bluetooth_rxtx.c **** 
1566:bluetooth_rxtx.c **** 	queue_init();
1567:bluetooth_rxtx.c **** 	dio_ssp_init();
1568:bluetooth_rxtx.c **** 	dma_init();
1569:bluetooth_rxtx.c **** 	dio_ssp_start();
1570:bluetooth_rxtx.c **** 	cc2400_rx();
1571:bluetooth_rxtx.c **** 
1572:bluetooth_rxtx.c **** 	cs_trigger_enable();
1573:bluetooth_rxtx.c **** 
1574:bluetooth_rxtx.c **** 	hold = 0;
1575:bluetooth_rxtx.c **** 
1576:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1577:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1578:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1579:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1580:bluetooth_rxtx.c **** 
1581:bluetooth_rxtx.c **** 			/* Retune */
1582:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1583:bluetooth_rxtx.c **** 
1584:bluetooth_rxtx.c **** 			/* Wait for lock */
1585:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1586:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1587:bluetooth_rxtx.c **** 
1588:bluetooth_rxtx.c **** 			/* RX mode */
1589:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1590:bluetooth_rxtx.c **** 
1591:bluetooth_rxtx.c **** 			requested_channel = 0;
1592:bluetooth_rxtx.c **** 		}
1593:bluetooth_rxtx.c **** 
1594:bluetooth_rxtx.c **** 		if (do_hop) {
1595:bluetooth_rxtx.c **** 			hop();
1596:bluetooth_rxtx.c **** 		} else {
1597:bluetooth_rxtx.c **** 			TXLED_CLR;
1598:bluetooth_rxtx.c **** 		}
1599:bluetooth_rxtx.c **** 
1600:bluetooth_rxtx.c **** 		RXLED_CLR;
1601:bluetooth_rxtx.c **** 
1602:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1603:bluetooth_rxtx.c **** 		rssi_reset();
1604:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
1605:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
1606:bluetooth_rxtx.c **** 		{
ARM GAS  /tmp/ccxsBJK4.s 			page 42


1607:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1608:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1609:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1610:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
1611:bluetooth_rxtx.c **** 			}
1612:bluetooth_rxtx.c **** 			rssi_add(rssi);
1613:bluetooth_rxtx.c **** 		}
1614:bluetooth_rxtx.c **** 
1615:bluetooth_rxtx.c **** 		if (rx_err) {
1616:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1617:bluetooth_rxtx.c **** 		}
1618:bluetooth_rxtx.c **** 
1619:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1620:bluetooth_rxtx.c **** 		if (!rx_tc)
1621:bluetooth_rxtx.c **** 			goto rx_continue;
1622:bluetooth_rxtx.c **** 
1623:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1624:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1625:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1626:bluetooth_rxtx.c **** 
1627:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1628:bluetooth_rxtx.c **** 
1629:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1630:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1631:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1632:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1633:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1634:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1635:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1636:bluetooth_rxtx.c **** 			cs_trigger = 0;
1637:bluetooth_rxtx.c **** 		}
1638:bluetooth_rxtx.c **** 
1639:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1640:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1641:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1642:bluetooth_rxtx.c **** 		}
1643:bluetooth_rxtx.c **** 
1644:bluetooth_rxtx.c **** 		/* Hold expired? Ignore data. */
1645:bluetooth_rxtx.c **** 		if (hold == 0) {
1646:bluetooth_rxtx.c **** 			goto rx_continue;
1647:bluetooth_rxtx.c **** 		}
1648:bluetooth_rxtx.c **** 		hold--;
1649:bluetooth_rxtx.c **** 
1650:bluetooth_rxtx.c **** 		// copy the previously unpacked symbols to the front of the buffer
1651:bluetooth_rxtx.c **** 		memcpy(unpacked, unpacked + DMA_SIZE*8, DMA_SIZE*8);
1652:bluetooth_rxtx.c **** 
1653:bluetooth_rxtx.c **** 		// unpack the new packet to the end of the buffer
1654:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; ++i) {
1655:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
1656:bluetooth_rxtx.c **** 			for (j = 0; j < 8; ++j) {
1657:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
1658:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
1659:bluetooth_rxtx.c **** 			}
1660:bluetooth_rxtx.c **** 		}
1661:bluetooth_rxtx.c **** 
1662:bluetooth_rxtx.c **** 		int ret = data_cb(unpacked);
1663:bluetooth_rxtx.c **** 		if (!ret) break;
ARM GAS  /tmp/ccxsBJK4.s 			page 43


1664:bluetooth_rxtx.c **** 
1665:bluetooth_rxtx.c **** 	rx_continue:
1666:bluetooth_rxtx.c **** 		rx_tc = 0;
1667:bluetooth_rxtx.c **** 		rx_err = 0;
1668:bluetooth_rxtx.c **** 	}
1669:bluetooth_rxtx.c **** 
1670:bluetooth_rxtx.c **** 	// disable USB interrupts
1671:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1672:bluetooth_rxtx.c **** 
1673:bluetooth_rxtx.c **** 	// reset the radio completely
1674:bluetooth_rxtx.c **** 	cc2400_idle();
1675:bluetooth_rxtx.c **** 	dio_ssp_stop();
1676:bluetooth_rxtx.c **** 	cs_trigger_disable();
1677:bluetooth_rxtx.c **** }
1678:bluetooth_rxtx.c **** 
1679:bluetooth_rxtx.c **** 
1680:bluetooth_rxtx.c **** void bt_le_sync(u8 active_mode)
1681:bluetooth_rxtx.c **** {
1682:bluetooth_rxtx.c **** 	int i;
1683:bluetooth_rxtx.c **** 	int8_t rssi;
1684:bluetooth_rxtx.c **** 	static int restart_jamming = 0;
1685:bluetooth_rxtx.c **** 
1686:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1687:bluetooth_rxtx.c **** 	mode = active_mode;
1688:bluetooth_rxtx.c **** 
1689:bluetooth_rxtx.c **** 	le.link_state = LINK_LISTENING;
1690:bluetooth_rxtx.c **** 
1691:bluetooth_rxtx.c **** 	// enable USB interrupts
1692:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1693:bluetooth_rxtx.c **** 
1694:bluetooth_rxtx.c **** 	RXLED_CLR;
1695:bluetooth_rxtx.c **** 
1696:bluetooth_rxtx.c **** 	queue_init();
1697:bluetooth_rxtx.c **** 	dio_ssp_init();
1698:bluetooth_rxtx.c **** 	dma_init_le();
1699:bluetooth_rxtx.c **** 	dio_ssp_start();
1700:bluetooth_rxtx.c **** 
1701:bluetooth_rxtx.c **** 	cc2400_rx_sync(rbit(le.access_address)); // bit-reversed access address
1702:bluetooth_rxtx.c **** 
1703:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1704:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1705:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1706:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1707:bluetooth_rxtx.c **** 
1708:bluetooth_rxtx.c **** 			/* Retune */
1709:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1710:bluetooth_rxtx.c **** 
1711:bluetooth_rxtx.c **** 			/* Wait for lock */
1712:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1713:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1714:bluetooth_rxtx.c **** 
1715:bluetooth_rxtx.c **** 			/* RX mode */
1716:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1717:bluetooth_rxtx.c **** 
1718:bluetooth_rxtx.c **** 			requested_channel = 0;
1719:bluetooth_rxtx.c **** 		}
1720:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccxsBJK4.s 			page 44


1721:bluetooth_rxtx.c **** 		RXLED_CLR;
1722:bluetooth_rxtx.c **** 
1723:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1724:bluetooth_rxtx.c **** 		rssi_reset();
1725:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)
1726:bluetooth_rxtx.c **** 			;
1727:bluetooth_rxtx.c **** 
1728:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1729:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
1730:bluetooth_rxtx.c **** 
1731:bluetooth_rxtx.c **** 		if (requested_mode != active_mode) {
1732:bluetooth_rxtx.c **** 			goto cleanup;
1733:bluetooth_rxtx.c **** 		}
1734:bluetooth_rxtx.c **** 
1735:bluetooth_rxtx.c **** 		if (rx_err) {
1736:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1737:bluetooth_rxtx.c **** 		}
1738:bluetooth_rxtx.c **** 
1739:bluetooth_rxtx.c **** 		if (do_hop)
1740:bluetooth_rxtx.c **** 			goto rx_flush;
1741:bluetooth_rxtx.c **** 
1742:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1743:bluetooth_rxtx.c **** 		if (!rx_tc)
1744:bluetooth_rxtx.c **** 			continue;
1745:bluetooth_rxtx.c **** 
1746:bluetooth_rxtx.c **** 		/////////////////////
1747:bluetooth_rxtx.c **** 		// process the packet
1748:bluetooth_rxtx.c **** 
1749:bluetooth_rxtx.c **** 		uint32_t packet[48/4+1] = { 0, };
1750:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
1751:bluetooth_rxtx.c **** 		packet[0] = le.access_address;
1752:bluetooth_rxtx.c **** 
1753:bluetooth_rxtx.c **** 		const uint32_t *whit = whitening_word[btle_channel_index(channel-2402)];
1754:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
1755:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
1756:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1757:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1758:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1759:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
1760:bluetooth_rxtx.c **** 		}
1761:bluetooth_rxtx.c **** 
1762:bluetooth_rxtx.c **** 		unsigned len = (p[5] & 0x3f) + 2;
1763:bluetooth_rxtx.c **** 		if (len > 39)
1764:bluetooth_rxtx.c **** 			goto rx_flush;
1765:bluetooth_rxtx.c **** 
1766:bluetooth_rxtx.c **** 		// transfer the minimum number of bytes from the CC2400
1767:bluetooth_rxtx.c **** 		// this allows us enough time to resume RX for subsequent packets on the same channel
1768:bluetooth_rxtx.c **** 		unsigned total_transfers = ((len + 3) + 4 - 1) / 4;
1769:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
1770:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
1771:bluetooth_rxtx.c **** 				;
1772:bluetooth_rxtx.c **** 		} else { // max transfers? just wait till DMA's done
1773:bluetooth_rxtx.c **** 			while (DMACC0Config & DMACCxConfig_E && rx_err == 0)
1774:bluetooth_rxtx.c **** 				;
1775:bluetooth_rxtx.c **** 		}
1776:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1777:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccxsBJK4.s 			page 45


1778:bluetooth_rxtx.c **** 		// strobe SFSON to allow the resync to occur while we process the packet
1779:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1780:bluetooth_rxtx.c **** 
1781:bluetooth_rxtx.c **** 		// unwhiten the rest of the packet
1782:bluetooth_rxtx.c **** 		for (i = 4; i < 44; i += 4) {
1783:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
1784:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1785:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1786:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1787:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
1788:bluetooth_rxtx.c **** 		}
1789:bluetooth_rxtx.c **** 
1790:bluetooth_rxtx.c **** 		if (le.crc_verify) {
1791:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
1792:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
1793:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
1794:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
1795:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
1796:bluetooth_rxtx.c **** 				goto rx_flush;
1797:bluetooth_rxtx.c **** 		}
1798:bluetooth_rxtx.c **** 
1799:bluetooth_rxtx.c **** 
1800:bluetooth_rxtx.c **** 		RXLED_SET;
1801:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
1802:bluetooth_rxtx.c **** 
1803:bluetooth_rxtx.c **** 		// disable USB interrupts while we touch USB data structures
1804:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
1805:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
1806:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
1807:bluetooth_rxtx.c **** 
1808:bluetooth_rxtx.c **** 		le.last_packet = CLK100NS;
1809:bluetooth_rxtx.c **** 
1810:bluetooth_rxtx.c **** 	rx_flush:
1811:bluetooth_rxtx.c **** 		// this might happen twice, but it's safe to do so
1812:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1813:bluetooth_rxtx.c **** 
1814:bluetooth_rxtx.c **** 		// flush any excess bytes from the SSP's buffer
1815:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1816:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
1817:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
1818:bluetooth_rxtx.c **** 		}
1819:bluetooth_rxtx.c **** 
1820:bluetooth_rxtx.c **** 		// timeout - FIXME this is an ugly hack
1821:bluetooth_rxtx.c **** 		u32 now = CLK100NS;
1822:bluetooth_rxtx.c **** 		if (now < le.last_packet)
1823:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
1824:bluetooth_rxtx.c **** 		if  ( // timeout
1825:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
1826:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
1827:bluetooth_rxtx.c **** 			// jam finished
1828:bluetooth_rxtx.c **** 			|| (le_jam_count == 1)
1829:bluetooth_rxtx.c **** 			)
1830:bluetooth_rxtx.c **** 		{
1831:bluetooth_rxtx.c **** 			reset_le();
1832:bluetooth_rxtx.c **** 			le_jam_count = 0;
1833:bluetooth_rxtx.c **** 			TXLED_CLR;
1834:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccxsBJK4.s 			page 46


1835:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
1836:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
1837:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
1838:bluetooth_rxtx.c **** 				goto cleanup;
1839:bluetooth_rxtx.c **** 			}
1840:bluetooth_rxtx.c **** 
1841:bluetooth_rxtx.c **** 			// go back to promisc if the connection dies
1842:bluetooth_rxtx.c **** 			if (active_mode == MODE_BT_PROMISC_LE)
1843:bluetooth_rxtx.c **** 				goto cleanup;
1844:bluetooth_rxtx.c **** 
1845:bluetooth_rxtx.c **** 			le.link_state = LINK_LISTENING;
1846:bluetooth_rxtx.c **** 
1847:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1848:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
1849:bluetooth_rxtx.c **** 
1850:bluetooth_rxtx.c **** 			/* Retune */
1851:bluetooth_rxtx.c **** 			channel = le_adv_channel != 0 ? le_adv_channel : 2402;
1852:bluetooth_rxtx.c **** 			restart_jamming = 1;
1853:bluetooth_rxtx.c **** 		}
1854:bluetooth_rxtx.c **** 
1855:bluetooth_rxtx.c **** 		cc2400_set(SYNCL, le.syncl);
1856:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
1857:bluetooth_rxtx.c **** 
1858:bluetooth_rxtx.c **** 		if (do_hop)
1859:bluetooth_rxtx.c **** 			hop();
1860:bluetooth_rxtx.c **** 
1861:bluetooth_rxtx.c **** 		//  you can jam but you keep turning off the light 
1862:bluetooth_rxtx.c **** 		if (le_jam_count > 0) {
1863:bluetooth_rxtx.c **** 			le_jam();
1864:bluetooth_rxtx.c **** 			--le_jam_count;
1865:bluetooth_rxtx.c **** 		} else {
1866:bluetooth_rxtx.c **** 			/* RX mode */
1867:bluetooth_rxtx.c **** 			dma_init_le();
1868:bluetooth_rxtx.c **** 			dio_ssp_start();
1869:bluetooth_rxtx.c **** 
1870:bluetooth_rxtx.c **** 			if (restart_jamming) {
1871:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
1872:bluetooth_rxtx.c **** 				restart_jamming = 0;
1873:bluetooth_rxtx.c **** 			} else {
1874:bluetooth_rxtx.c **** 				// wait till we're in FSLOCK before strobing RX
1875:bluetooth_rxtx.c **** 				while (!(cc2400_status() & FS_LOCK));
1876:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
1877:bluetooth_rxtx.c **** 			}
1878:bluetooth_rxtx.c **** 		}
1879:bluetooth_rxtx.c **** 
1880:bluetooth_rxtx.c **** 		rx_tc = 0;
1881:bluetooth_rxtx.c **** 		rx_err = 0;
1882:bluetooth_rxtx.c **** 	}
1883:bluetooth_rxtx.c **** 
1884:bluetooth_rxtx.c **** cleanup:
1885:bluetooth_rxtx.c **** 
1886:bluetooth_rxtx.c **** 	// disable USB interrupts
1887:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1888:bluetooth_rxtx.c **** 
1889:bluetooth_rxtx.c **** 	// reset the radio completely
1890:bluetooth_rxtx.c **** 	cc2400_idle();
1891:bluetooth_rxtx.c **** 	dio_ssp_stop();
ARM GAS  /tmp/ccxsBJK4.s 			page 47


1892:bluetooth_rxtx.c **** 	cs_trigger_disable();
1893:bluetooth_rxtx.c **** }
1894:bluetooth_rxtx.c **** 
1895:bluetooth_rxtx.c **** 
1896:bluetooth_rxtx.c **** 
1897:bluetooth_rxtx.c **** /* low energy connection following
1898:bluetooth_rxtx.c ****  * follows a known AA around */
1899:bluetooth_rxtx.c **** int cb_follow_le() {
 625              		.loc 1 1899 0
 626              		.cfi_startproc
 627              		@ args = 0, pretend = 0, frame = 0
 628              		@ frame_needed = 0, uses_anonymous_args = 0
 629 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 630              		.cfi_def_cfa_offset 32
 631              		.cfi_offset 3, -32
 632              		.cfi_offset 4, -28
 633              		.cfi_offset 5, -24
 634              		.cfi_offset 6, -20
 635              		.cfi_offset 7, -16
 636              		.cfi_offset 8, -12
 637              		.cfi_offset 9, -8
 638              		.cfi_offset 14, -4
1900:bluetooth_rxtx.c **** 	int i, j, k;
1901:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(channel-2402)];
 639              		.loc 1 1901 0
 640 0004 394C     		ldr	r4, .L67
 641 0006 2088     		ldrh	r0, [r4]
 642 0008 2646     		mov	r6, r4
 643 000a 80B2     		uxth	r0, r0
 644 000c 6238     		subs	r0, r0, #98
 645 000e C0B2     		uxtb	r0, r0
 646 0010 FFF7FEFF 		bl	btle_channel_index
 647              	.LVL56:
 648 0014 3649     		ldr	r1, .L67+4
1902:bluetooth_rxtx.c **** 
1903:bluetooth_rxtx.c **** 	u32 access_address = 0;
 649              		.loc 1 1903 0
 650 0016 0022     		movs	r2, #0
1901:bluetooth_rxtx.c **** 
 651              		.loc 1 1901 0
 652 0018 0D5C     		ldrb	r5, [r1, r0]	@ zero_extendqisi2
 653              	.LVL57:
1904:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 654              		.loc 1 1904 0
 655 001a 1346     		mov	r3, r2
 656 001c 8C46     		mov	ip, r1
 657              	.LVL58:
 658              	.L48:
1905:bluetooth_rxtx.c **** 		access_address >>= 1;
1906:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
 659              		.loc 1 1906 0 discriminator 2
 660 001e 354F     		ldr	r7, .L67+8
 661 0020 D95D     		ldrb	r1, [r3, r7]	@ zero_extendqisi2
1904:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 662              		.loc 1 1904 0 discriminator 2
 663 0022 0133     		adds	r3, r3, #1
 664              	.LVL59:
ARM GAS  /tmp/ccxsBJK4.s 			page 48


 665              		.loc 1 1906 0 discriminator 2
 666 0024 C907     		lsls	r1, r1, #31
1904:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 667              		.loc 1 1904 0 discriminator 2
 668 0026 1F2B     		cmp	r3, #31
 669              		.loc 1 1906 0 discriminator 2
 670 0028 41EA5202 		orr	r2, r1, r2, lsr #1
 671              	.LVL60:
1904:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 672              		.loc 1 1904 0 discriminator 2
 673 002c F7D1     		bne	.L48
1907:bluetooth_rxtx.c **** 	}
1908:bluetooth_rxtx.c **** 
1909:bluetooth_rxtx.c **** 	for (i = 31; i < DMA_SIZE * 8 + 32; i++) {
1910:bluetooth_rxtx.c **** 		access_address >>= 1;
1911:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
1912:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 674              		.loc 1 1912 0
 675 002e 7168     		ldr	r1, [r6, #4]
 676              	.L60:
 677              	.LVL61:
1911:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 678              		.loc 1 1911 0
 679 0030 F85C     		ldrb	r0, [r7, r3]	@ zero_extendqisi2
 680 0032 C007     		lsls	r0, r0, #31
 681 0034 40EA5202 		orr	r2, r0, r2, lsr #1
 682              	.LVL62:
 683              		.loc 1 1912 0
 684 0038 8A42     		cmp	r2, r1
 685 003a 4FD1     		bne	.L49
 686 003c 0022     		movs	r2, #0
 687              	.LVL63:
 688              	.L50:
 689 003e 07EB0308 		add	r8, r7, r3
1904:bluetooth_rxtx.c **** 		access_address >>= 1;
 690              		.loc 1 1904 0 discriminator 1
 691 0042 0020     		movs	r0, #0
 692 0044 08EBC208 		add	r8, r8, r2, lsl #3
 693 0048 0146     		mov	r1, r0
 694              	.LVL64:
 695              	.L55:
 696 004a 08EB0104 		add	r4, r8, r1
 697              	.LBB6:
 698              	.LBB7:
1913:bluetooth_rxtx.c **** 			for (j = 0; j < 46; ++j) {
1914:bluetooth_rxtx.c **** 				u8 byte = 0;
1915:bluetooth_rxtx.c **** 				for (k = 0; k < 8; k++) {
1916:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
1917:bluetooth_rxtx.c **** 					if (offset >= DMA_SIZE*8*2) break;
1918:bluetooth_rxtx.c **** 					int bit = unpacked[offset];
1919:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 699              		.loc 1 1919 0
 700 004e 032A     		cmp	r2, #3
1918:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 701              		.loc 1 1918 0
 702 0050 14F81F4C 		ldrb	r4, [r4, #-31]	@ zero_extendqisi2
 703              	.LVL65:
ARM GAS  /tmp/ccxsBJK4.s 			page 49


 704              		.loc 1 1919 0
 705 0054 0CDD     		ble	.L52
1920:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 706              		.loc 1 1920 0
 707 0056 0CEB050E 		add	lr, ip, r5
 708 005a 9EF828E0 		ldrb	lr, [lr, #40]	@ zero_extendqisi2
1921:bluetooth_rxtx.c **** 						idx = (idx + 1) % sizeof(whitening);
 709              		.loc 1 1921 0
 710 005e 0135     		adds	r5, r5, #1
 711              	.LVL66:
1920:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 712              		.loc 1 1920 0
 713 0060 84EA0E04 		eor	r4, r4, lr
 714              	.LVL67:
 715              		.loc 1 1921 0
 716 0064 4FF07F0E 		mov	lr, #127
 717 0068 B5FBFEF9 		udiv	r9, r5, lr
 718 006c 0EFB1955 		mls	r5, lr, r9, r5
 719              	.LVL68:
 720              	.L52:
1922:bluetooth_rxtx.c **** 					}
1923:bluetooth_rxtx.c **** 					byte |= bit << k;
 721              		.loc 1 1923 0
 722 0070 8C40     		lsls	r4, r4, r1
 723              	.LVL69:
 724              	.LBE7:
1915:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 725              		.loc 1 1915 0
 726 0072 0131     		adds	r1, r1, #1
 727              	.LVL70:
 728              	.LBB8:
 729              		.loc 1 1923 0
 730 0074 2043     		orrs	r0, r0, r4
 731              	.LVL71:
 732              	.LBE8:
1915:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 733              		.loc 1 1915 0
 734 0076 0829     		cmp	r1, #8
 735              	.LBB9:
 736              		.loc 1 1923 0
 737 0078 C0B2     		uxtb	r0, r0
 738              	.LVL72:
 739              	.LBE9:
1915:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 740              		.loc 1 1915 0
 741 007a E6D1     		bne	.L55
1924:bluetooth_rxtx.c **** 				}
1925:bluetooth_rxtx.c **** 				idle_rxbuf[j] = byte;
 742              		.loc 1 1925 0
 743 007c 1E4C     		ldr	r4, .L67+12
 744 007e 2168     		ldr	r1, [r4]
 745              	.LVL73:
 746 0080 8854     		strb	r0, [r1, r2]
 747              	.LBE6:
1913:bluetooth_rxtx.c **** 				u8 byte = 0;
 748              		.loc 1 1913 0
 749 0082 0132     		adds	r2, r2, #1
ARM GAS  /tmp/ccxsBJK4.s 			page 50


 750              	.LVL74:
 751 0084 2E2A     		cmp	r2, #46
 752 0086 DAD1     		bne	.L50
1926:bluetooth_rxtx.c **** 			}
1927:bluetooth_rxtx.c **** 
1928:bluetooth_rxtx.c **** 			// verify CRC
1929:bluetooth_rxtx.c **** 			if (le.crc_verify) {
 753              		.loc 1 1929 0
 754 0088 7369     		ldr	r3, [r6, #20]
 755              	.LVL75:
 756 008a 5BB9     		cbnz	r3, .L56
 757              	.LVL76:
 758              	.L58:
1930:bluetooth_rxtx.c **** 				int len		 = (idle_rxbuf[5] & 0x3f) + 2;
1931:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
1932:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
1933:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
1934:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
1935:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
1936:bluetooth_rxtx.c **** 					break;
1937:bluetooth_rxtx.c **** 			}
1938:bluetooth_rxtx.c **** 
1939:bluetooth_rxtx.c **** 			// send to PC
1940:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
 759              		.loc 1 1940 0
 760 008c 2168     		ldr	r1, [r4]
 761 008e 0120     		movs	r0, #1
 762 0090 FFF7FEFF 		bl	enqueue
 763              	.LVL77:
1941:bluetooth_rxtx.c **** 			RXLED_SET;
 764              		.loc 1 1941 0
 765 0094 194B     		ldr	r3, .L67+16
 766 0096 1022     		movs	r2, #16
 767 0098 1A60     		str	r2, [r3]
1942:bluetooth_rxtx.c **** 
1943:bluetooth_rxtx.c **** 			packet_cb((uint8_t*)idle_rxbuf);
 768              		.loc 1 1943 0
 769 009a 194B     		ldr	r3, .L67+20
 770 009c 2068     		ldr	r0, [r4]
 771 009e 9B69     		ldr	r3, [r3, #24]
 772 00a0 9847     		blx	r3
 773              	.LVL78:
1944:bluetooth_rxtx.c **** 
1945:bluetooth_rxtx.c **** 			break;
 774              		.loc 1 1945 0
 775 00a2 1FE0     		b	.L57
 776              	.LVL79:
 777              	.L56:
 778              	.LBB10:
1930:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
 779              		.loc 1 1930 0
 780 00a4 2368     		ldr	r3, [r4]
 781 00a6 5D79     		ldrb	r5, [r3, #5]	@ zero_extendqisi2
 782              	.LVL80:
1931:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 783              		.loc 1 1931 0
 784 00a8 104B     		ldr	r3, .L67
ARM GAS  /tmp/ccxsBJK4.s 			page 51


 785 00aa 2168     		ldr	r1, [r4]
1930:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
 786              		.loc 1 1930 0
 787 00ac 05F03F05 		and	r5, r5, #63
 788              	.LVL81:
1931:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 789              		.loc 1 1931 0
 790 00b0 AA1C     		adds	r2, r5, #2
 791              	.LVL82:
 792 00b2 1869     		ldr	r0, [r3, #16]
 793              	.LVL83:
 794 00b4 0431     		adds	r1, r1, #4
 795 00b6 FFF7FEFF 		bl	btle_crcgen_lut
 796              	.LVL84:
1932:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
 797              		.loc 1 1932 0
 798 00ba 2268     		ldr	r2, [r4]
 799 00bc 05F10803 		add	r3, r5, #8
 800 00c0 D15C     		ldrb	r1, [r2, r3]	@ zero_extendqisi2
1933:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 801              		.loc 1 1933 0
 802 00c2 2268     		ldr	r2, [r4]
 803 00c4 EB1D     		adds	r3, r5, #7
 804 00c6 D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
1934:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 805              		.loc 1 1934 0
 806 00c8 2268     		ldr	r2, [r4]
 807 00ca 0635     		adds	r5, r5, #6
 808              	.LVL85:
 809 00cc 525D     		ldrb	r2, [r2, r5]	@ zero_extendqisi2
 810              	.LVL86:
1933:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 811              		.loc 1 1933 0
 812 00ce 1B02     		lsls	r3, r3, #8
 813              	.LVL87:
 814 00d0 43EA0143 		orr	r3, r3, r1, lsl #16
1934:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 815              		.loc 1 1934 0
 816 00d4 1343     		orrs	r3, r3, r2
1935:bluetooth_rxtx.c **** 					break;
 817              		.loc 1 1935 0
 818 00d6 9842     		cmp	r0, r3
 819 00d8 04D1     		bne	.L57
 820 00da D7E7     		b	.L58
 821              	.LVL88:
 822              	.L49:
 823              	.LBE10:
1909:bluetooth_rxtx.c **** 		access_address >>= 1;
 824              		.loc 1 1909 0
 825 00dc 0133     		adds	r3, r3, #1
 826              	.LVL89:
 827 00de B3F5D87F 		cmp	r3, #432
 828 00e2 A5D1     		bne	.L60
 829              	.LVL90:
 830              	.L57:
1946:bluetooth_rxtx.c **** 		}
1947:bluetooth_rxtx.c **** 	}
ARM GAS  /tmp/ccxsBJK4.s 			page 52


1948:bluetooth_rxtx.c **** 
1949:bluetooth_rxtx.c **** 	return 1;
1950:bluetooth_rxtx.c **** }
 831              		.loc 1 1950 0
 832 00e4 0120     		movs	r0, #1
 833 00e6 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 834              	.L68:
 835 00ea 00BF     		.align	2
 836              	.L67:
 837 00ec 00000000 		.word	.LANCHOR1
 838 00f0 00000000 		.word	.LANCHOR2
 839 00f4 00000000 		.word	unpacked
 840 00f8 00000000 		.word	idle_rxbuf
 841 00fc 38C00920 		.word	537509944
 842 0100 00000000 		.word	.LANCHOR0
 843              		.cfi_endproc
 844              	.LFE23:
 846              		.section	.text.connection_follow_cb,"ax",%progbits
 847              		.align	1
 848              		.global	connection_follow_cb
 849              		.thumb
 850              		.thumb_func
 852              	connection_follow_cb:
 853              	.LFB24:
1951:bluetooth_rxtx.c **** 
1952:bluetooth_rxtx.c **** /**
1953:bluetooth_rxtx.c ****  * Called when we receive a packet in connection following mode.
1954:bluetooth_rxtx.c ****  */
1955:bluetooth_rxtx.c **** void connection_follow_cb(u8 *packet) {
 854              		.loc 1 1955 0
 855              		.cfi_startproc
 856              		@ args = 0, pretend = 0, frame = 0
 857              		@ frame_needed = 0, uses_anonymous_args = 0
 858              	.LVL91:
 859 0000 38B5     		push	{r3, r4, r5, lr}
 860              		.cfi_def_cfa_offset 16
 861              		.cfi_offset 3, -16
 862              		.cfi_offset 4, -12
 863              		.cfi_offset 5, -8
 864              		.cfi_offset 14, -4
 865              	.LVL92:
1956:bluetooth_rxtx.c **** 	int i;
1957:bluetooth_rxtx.c **** 	u32 aa = 0;
1958:bluetooth_rxtx.c **** 
1959:bluetooth_rxtx.c **** #define ADV_ADDRESS_IDX 0
1960:bluetooth_rxtx.c **** #define HEADER_IDX 4
1961:bluetooth_rxtx.c **** #define DATA_LEN_IDX 5
1962:bluetooth_rxtx.c **** #define DATA_START_IDX 6
1963:bluetooth_rxtx.c **** 
1964:bluetooth_rxtx.c **** 	// u8 *adv_addr = &packet[ADV_ADDRESS_IDX];
1965:bluetooth_rxtx.c **** 	u8 header = packet[HEADER_IDX];
1966:bluetooth_rxtx.c **** 	u8 *data_len = &packet[DATA_LEN_IDX];
1967:bluetooth_rxtx.c **** 	u8 *data = &packet[DATA_START_IDX];
1968:bluetooth_rxtx.c **** 	// u8 *crc = &packet[DATA_START_IDX + *data_len];
1969:bluetooth_rxtx.c **** 
1970:bluetooth_rxtx.c **** 	if (le.link_state == LINK_CONN_PENDING) {
 866              		.loc 1 1970 0
ARM GAS  /tmp/ccxsBJK4.s 			page 53


 867 0002 584B     		ldr	r3, .L87
1955:bluetooth_rxtx.c **** 	int i;
 868              		.loc 1 1955 0
 869 0004 0546     		mov	r5, r0
 870              		.loc 1 1970 0
 871 0006 1A7E     		ldrb	r2, [r3, #24]	@ zero_extendqisi2
1965:bluetooth_rxtx.c **** 	u8 *data_len = &packet[DATA_LEN_IDX];
 872              		.loc 1 1965 0
 873 0008 0179     		ldrb	r1, [r0, #4]	@ zero_extendqisi2
 874              	.LVL93:
 875              		.loc 1 1970 0
 876 000a 022A     		cmp	r2, #2
 877 000c 1C46     		mov	r4, r3
 878 000e 13D1     		bne	.L70
1971:bluetooth_rxtx.c **** 		// We received a packet in the connection pending state, so now the device *should* be connected
1972:bluetooth_rxtx.c **** 		le.link_state = LINK_CONNECTED;
 879              		.loc 1 1972 0
 880 0010 0322     		movs	r2, #3
 881 0012 1A76     		strb	r2, [r3, #24]
 882              	.LVL94:
1973:bluetooth_rxtx.c **** 		le.conn_epoch = clkn;
 883              		.loc 1 1973 0
 884 0014 544A     		ldr	r2, .L87+4
 885 0016 1268     		ldr	r2, [r2]
 886 0018 DA61     		str	r2, [r3, #28]
1974:bluetooth_rxtx.c **** 		le.interval_timer = le.conn_interval - 1;
 887              		.loc 1 1974 0
 888 001a 5A8C     		ldrh	r2, [r3, #34]
 889 001c 013A     		subs	r2, r2, #1
 890 001e 92B2     		uxth	r2, r2
 891 0020 1A84     		strh	r2, [r3, #32]	@ movhi
1975:bluetooth_rxtx.c **** 		le.conn_count = 0;
 892              		.loc 1 1975 0
 893 0022 0022     		movs	r2, #0
 894 0024 9A84     		strh	r2, [r3, #36]	@ movhi
1976:bluetooth_rxtx.c **** 		le.update_pending = 0;
 895              		.loc 1 1976 0
 896 0026 DA62     		str	r2, [r3, #44]
1977:bluetooth_rxtx.c **** 
1978:bluetooth_rxtx.c **** 		// hue hue hue
1979:bluetooth_rxtx.c **** 		if (jam_mode != JAM_NONE)
 897              		.loc 1 1979 0
 898 0028 504B     		ldr	r3, .L87+8
 899 002a DA7C     		ldrb	r2, [r3, #19]	@ zero_extendqisi2
 900 002c 002A     		cmp	r2, #0
 901 002e 00F09880 		beq	.L69
1980:bluetooth_rxtx.c **** 			le_jam_count = JAM_COUNT_DEFAULT;
 902              		.loc 1 1980 0
 903 0032 2822     		movs	r2, #40
 904 0034 DA61     		str	r2, [r3, #28]
 905 0036 38BD     		pop	{r3, r4, r5, pc}
 906              	.LVL95:
 907              	.L70:
1981:bluetooth_rxtx.c **** 
1982:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_CONNECTED) {
 908              		.loc 1 1982 0
 909 0038 032A     		cmp	r2, #3
ARM GAS  /tmp/ccxsBJK4.s 			page 54


 910 003a 3BD1     		bne	.L73
 911              	.LBB11:
1983:bluetooth_rxtx.c **** 		u8 llid =  header & 0x03;
1984:bluetooth_rxtx.c **** 
1985:bluetooth_rxtx.c **** 		// Apply any connection parameter update if necessary
1986:bluetooth_rxtx.c **** 		if (le.update_pending && le.conn_count == le.update_instant) {
 912              		.loc 1 1986 0
 913 003c DB6A     		ldr	r3, [r3, #44]
1983:bluetooth_rxtx.c **** 		u8 llid =  header & 0x03;
 914              		.loc 1 1983 0
 915 003e 01F00301 		and	r1, r1, #3
 916              	.LVL96:
 917              		.loc 1 1986 0
 918 0042 A3B1     		cbz	r3, .L74
 919              		.loc 1 1986 0 is_stmt 0 discriminator 1
 920 0044 A38C     		ldrh	r3, [r4, #36]
 921 0046 228E     		ldrh	r2, [r4, #48]
 922 0048 9BB2     		uxth	r3, r3
 923 004a 9A42     		cmp	r2, r3
 924 004c 0FD1     		bne	.L74
1987:bluetooth_rxtx.c **** 			// This is the first packet received in the connection interval for which the new parameters app
1988:bluetooth_rxtx.c **** 			le.conn_epoch = clkn;
 925              		.loc 1 1988 0 is_stmt 1
 926 004e 464B     		ldr	r3, .L87+4
 927 0050 1B68     		ldr	r3, [r3]
 928 0052 E361     		str	r3, [r4, #28]
 929              	.LVL97:
1989:bluetooth_rxtx.c **** 			le.conn_interval = le.interval_update;
 930              		.loc 1 1989 0
 931 0054 638E     		ldrh	r3, [r4, #50]
 932 0056 6384     		strh	r3, [r4, #34]	@ movhi
1990:bluetooth_rxtx.c **** 			le.interval_timer = le.interval_update - 1;
 933              		.loc 1 1990 0
 934 0058 013B     		subs	r3, r3, #1
 935 005a 9BB2     		uxth	r3, r3
 936 005c 2384     		strh	r3, [r4, #32]	@ movhi
1991:bluetooth_rxtx.c **** 			le.win_size = le.win_size_update;
 937              		.loc 1 1991 0
 938 005e 94F83430 		ldrb	r3, [r4, #52]	@ zero_extendqisi2
 939 0062 84F82630 		strb	r3, [r4, #38]
1992:bluetooth_rxtx.c **** 			le.win_offset = le.win_offset_update;
 940              		.loc 1 1992 0
 941 0066 E38E     		ldrh	r3, [r4, #54]
 942 0068 2385     		strh	r3, [r4, #40]	@ movhi
1993:bluetooth_rxtx.c **** 			le.update_pending = 0;
 943              		.loc 1 1993 0
 944 006a 0023     		movs	r3, #0
 945 006c E362     		str	r3, [r4, #44]
 946              	.L74:
1994:bluetooth_rxtx.c **** 		}
1995:bluetooth_rxtx.c **** 
1996:bluetooth_rxtx.c **** 		if (llid == 0x03 && data[0] == 0x00) {
 947              		.loc 1 1996 0
 948 006e 0329     		cmp	r1, #3
 949 0070 77D1     		bne	.L69
 950              		.loc 1 1996 0 is_stmt 0 discriminator 1
 951 0072 AB79     		ldrb	r3, [r5, #6]	@ zero_extendqisi2
ARM GAS  /tmp/ccxsBJK4.s 			page 55


 952 0074 002B     		cmp	r3, #0
 953 0076 74D1     		bne	.L69
1997:bluetooth_rxtx.c **** 			// This is a CONNECTION_UPDATE_REQ.
1998:bluetooth_rxtx.c **** 			// The host is changing the connection parameters.
1999:bluetooth_rxtx.c **** 			le.win_size_update = packet[7];
 954              		.loc 1 1999 0 is_stmt 1
 955 0078 EB79     		ldrb	r3, [r5, #7]	@ zero_extendqisi2
 956 007a 84F83430 		strb	r3, [r4, #52]
2000:bluetooth_rxtx.c **** 			le.win_offset_update = packet[8] + ((u16)packet[9] << 8);
 957              		.loc 1 2000 0
 958 007e 6A7A     		ldrb	r2, [r5, #9]	@ zero_extendqisi2
 959 0080 2B7A     		ldrb	r3, [r5, #8]	@ zero_extendqisi2
 960 0082 03EB0223 		add	r3, r3, r2, lsl #8
 961 0086 E386     		strh	r3, [r4, #54]	@ movhi
2001:bluetooth_rxtx.c **** 			le.interval_update = packet[10] + ((u16)packet[11] << 8);
 962              		.loc 1 2001 0
 963 0088 EA7A     		ldrb	r2, [r5, #11]	@ zero_extendqisi2
 964 008a AB7A     		ldrb	r3, [r5, #10]	@ zero_extendqisi2
 965 008c 03EB0223 		add	r3, r3, r2, lsl #8
 966 0090 6386     		strh	r3, [r4, #50]	@ movhi
2002:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 967              		.loc 1 2002 0
 968 0092 6A7C     		ldrb	r2, [r5, #17]	@ zero_extendqisi2
 969 0094 2B7C     		ldrb	r3, [r5, #16]	@ zero_extendqisi2
 970 0096 03EB0223 		add	r3, r3, r2, lsl #8
2003:bluetooth_rxtx.c **** 			if (le.update_instant - le.conn_count < 32767)
 971              		.loc 1 2003 0
 972 009a A28C     		ldrh	r2, [r4, #36]
2002:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 973              		.loc 1 2002 0
 974 009c 9BB2     		uxth	r3, r3
 975              		.loc 1 2003 0
 976 009e 92B2     		uxth	r2, r2
2002:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 977              		.loc 1 2002 0
 978 00a0 2386     		strh	r3, [r4, #48]	@ movhi
 979              		.loc 1 2003 0
 980 00a2 9B1A     		subs	r3, r3, r2
 981 00a4 47F6FE72 		movw	r2, #32766
 982 00a8 9342     		cmp	r3, r2
 983 00aa 5ADC     		bgt	.L69
2004:bluetooth_rxtx.c **** 				le.update_pending = 1;
 984              		.loc 1 2004 0
 985 00ac 2D4B     		ldr	r3, .L87
 986 00ae 0122     		movs	r2, #1
 987 00b0 DA62     		str	r2, [r3, #44]
 988 00b2 38BD     		pop	{r3, r4, r5, pc}
 989              	.LVL98:
 990              	.L73:
 991              	.LBE11:
2005:bluetooth_rxtx.c **** 		}
2006:bluetooth_rxtx.c **** 
2007:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_LISTENING) {
 992              		.loc 1 2007 0
 993 00b4 012A     		cmp	r2, #1
 994 00b6 54D1     		bne	.L69
 995              	.LVL99:
ARM GAS  /tmp/ccxsBJK4.s 			page 56


 996              	.LBB12:
2008:bluetooth_rxtx.c **** 		u8 pkt_type = packet[4] & 0x0F;
2009:bluetooth_rxtx.c **** 		if (pkt_type == 0x05) {
 997              		.loc 1 2009 0
 998 00b8 01F00F01 		and	r1, r1, #15
 999              	.LVL100:
 1000 00bc 0529     		cmp	r1, #5
 1001 00be 50D1     		bne	.L69
 1002              	.LBB13:
2010:bluetooth_rxtx.c **** 			uint16_t conn_interval;
2011:bluetooth_rxtx.c **** 
2012:bluetooth_rxtx.c **** 			// ignore packets with incorrect length
2013:bluetooth_rxtx.c **** 			if (*data_len != 34)
 1003              		.loc 1 2013 0
 1004 00c0 4379     		ldrb	r3, [r0, #5]	@ zero_extendqisi2
 1005 00c2 222B     		cmp	r3, #34
 1006 00c4 4DD1     		bne	.L69
 1007              	.LVL101:
2014:bluetooth_rxtx.c **** 				return;
2015:bluetooth_rxtx.c **** 
2016:bluetooth_rxtx.c **** 			// conn interval must be [7.5 ms, 4.0s] in units of 1.25 ms
2017:bluetooth_rxtx.c **** 			conn_interval = (packet[29] << 8) | packet[28];
 1008              		.loc 1 2017 0
 1009 00c6 037F     		ldrb	r3, [r0, #28]	@ zero_extendqisi2
 1010 00c8 427F     		ldrb	r2, [r0, #29]	@ zero_extendqisi2
 1011 00ca 43EA0222 		orr	r2, r3, r2, lsl #8
2018:bluetooth_rxtx.c **** 			if (conn_interval < 6 || conn_interval > 3200)
 1012              		.loc 1 2018 0
 1013 00ce 063A     		subs	r2, r2, #6
 1014 00d0 92B2     		uxth	r2, r2
 1015 00d2 40F67A43 		movw	r3, #3194
 1016 00d6 9A42     		cmp	r2, r3
 1017 00d8 43D8     		bhi	.L69
2019:bluetooth_rxtx.c **** 				return;
2020:bluetooth_rxtx.c **** 
2021:bluetooth_rxtx.c **** 			// This is a connect packet
2022:bluetooth_rxtx.c **** 			// if we have a target, see if InitA or AdvA matches
2023:bluetooth_rxtx.c **** 			if (le.target_set &&
 1018              		.loc 1 2023 0
 1019 00da 236C     		ldr	r3, [r4, #64]
 1020 00dc 2BB9     		cbnz	r3, .L76
 1021              	.LVL102:
 1022              	.L78:
2024:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
2025:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
2026:bluetooth_rxtx.c **** 				return;
2027:bluetooth_rxtx.c **** 			}
2028:bluetooth_rxtx.c **** 
2029:bluetooth_rxtx.c **** 			le.link_state = LINK_CONN_PENDING;
 1023              		.loc 1 2029 0
 1024 00de 0223     		movs	r3, #2
2030:bluetooth_rxtx.c **** 			le.crc_verify = 0; // we will drop many packets if we attempt to filter by CRC
 1025              		.loc 1 2030 0
 1026 00e0 0020     		movs	r0, #0
2029:bluetooth_rxtx.c **** 			le.crc_verify = 0; // we will drop many packets if we attempt to filter by CRC
 1027              		.loc 1 2029 0
 1028 00e2 2376     		strb	r3, [r4, #24]
ARM GAS  /tmp/ccxsBJK4.s 			page 57


 1029              		.loc 1 2030 0
 1030 00e4 6061     		str	r0, [r4, #20]
 1031              	.LVL103:
2031:bluetooth_rxtx.c **** 
2032:bluetooth_rxtx.c **** 			for (i = 0; i < 4; ++i)
 1032              		.loc 1 2032 0
 1033 00e6 0346     		mov	r3, r0
 1034 00e8 11E0     		b	.L77
 1035              	.LVL104:
 1036              	.L76:
2024:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
 1037              		.loc 1 2024 0 discriminator 1
 1038 00ea 04F13800 		add	r0, r4, #56
 1039              	.LVL105:
 1040 00ee A91D     		adds	r1, r5, #6
 1041 00f0 0622     		movs	r2, #6
 1042 00f2 FFF7FEFF 		bl	memcmp
 1043              	.LVL106:
2023:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
 1044              		.loc 1 2023 0 discriminator 1
 1045 00f6 0028     		cmp	r0, #0
 1046 00f8 F1D0     		beq	.L78
2025:bluetooth_rxtx.c **** 				return;
 1047              		.loc 1 2025 0
 1048 00fa 04F13800 		add	r0, r4, #56
 1049 00fe 05F10C01 		add	r1, r5, #12
 1050 0102 0622     		movs	r2, #6
 1051 0104 FFF7FEFF 		bl	memcmp
 1052              	.LVL107:
2024:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
 1053              		.loc 1 2024 0
 1054 0108 0028     		cmp	r0, #0
 1055 010a E8D0     		beq	.L78
 1056 010c 38BD     		pop	{r3, r4, r5, pc}
 1057              	.LVL108:
 1058              	.L77:
 1059 010e EA18     		adds	r2, r5, r3
2033:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1060              		.loc 1 2033 0 discriminator 2
 1061 0110 917C     		ldrb	r1, [r2, #18]	@ zero_extendqisi2
 1062 0112 DA00     		lsls	r2, r3, #3
 1063 0114 01FA02F2 		lsl	r2, r1, r2
2032:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1064              		.loc 1 2032 0 discriminator 2
 1065 0118 0133     		adds	r3, r3, #1
 1066              	.LVL109:
 1067 011a 042B     		cmp	r3, #4
 1068              		.loc 1 2033 0 discriminator 2
 1069 011c 40EA0200 		orr	r0, r0, r2
 1070              	.LVL110:
2032:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1071              		.loc 1 2032 0 discriminator 2
 1072 0120 F5D1     		bne	.L77
2034:bluetooth_rxtx.c **** 			le_set_access_address(aa);
 1073              		.loc 1 2034 0
 1074 0122 FFF7FEFF 		bl	le_set_access_address
 1075              	.LVL111:
ARM GAS  /tmp/ccxsBJK4.s 			page 58


2035:bluetooth_rxtx.c **** 
2036:bluetooth_rxtx.c **** #define CRC_INIT (2+4+6+6+4)
2037:bluetooth_rxtx.c **** 			le.crc_init = (packet[CRC_INIT+2] << 16)
2038:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1076              		.loc 1 2038 0
 1077 0126 E87D     		ldrb	r0, [r5, #23]	@ zero_extendqisi2
2037:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1078              		.loc 1 2037 0
 1079 0128 2B7E     		ldrb	r3, [r5, #24]	@ zero_extendqisi2
 1080              		.loc 1 2038 0
 1081 012a 0002     		lsls	r0, r0, #8
 1082 012c 40EA0340 		orr	r0, r0, r3, lsl #16
2039:bluetooth_rxtx.c **** 						|  packet[CRC_INIT+0];
 1083              		.loc 1 2039 0
 1084 0130 AB7D     		ldrb	r3, [r5, #22]	@ zero_extendqisi2
 1085 0132 1843     		orrs	r0, r0, r3
2037:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1086              		.loc 1 2037 0
 1087 0134 E060     		str	r0, [r4, #12]
2040:bluetooth_rxtx.c **** 			le.crc_init_reversed = rbit(le.crc_init);
 1088              		.loc 1 2040 0
 1089 0136 FFF7FEFF 		bl	rbit
 1090              	.LVL112:
2041:bluetooth_rxtx.c **** 
2042:bluetooth_rxtx.c **** #define WIN_SIZE (2+4+6+6+4+3)
2043:bluetooth_rxtx.c **** 			le.win_size = packet[WIN_SIZE];
 1091              		.loc 1 2043 0
 1092 013a 6B7E     		ldrb	r3, [r5, #25]	@ zero_extendqisi2
2040:bluetooth_rxtx.c **** 			le.crc_init_reversed = rbit(le.crc_init);
 1093              		.loc 1 2040 0
 1094 013c 2061     		str	r0, [r4, #16]
 1095              		.loc 1 2043 0
 1096 013e 84F82630 		strb	r3, [r4, #38]
2044:bluetooth_rxtx.c **** 
2045:bluetooth_rxtx.c **** #define WIN_OFFSET (2+4+6+6+4+3+1)
2046:bluetooth_rxtx.c **** 			le.win_offset = packet[WIN_OFFSET];
 1097              		.loc 1 2046 0
 1098 0142 AB7E     		ldrb	r3, [r5, #26]	@ zero_extendqisi2
 1099 0144 2385     		strh	r3, [r4, #40]	@ movhi
2047:bluetooth_rxtx.c **** 
2048:bluetooth_rxtx.c **** #define CONN_INTERVAL (2+4+6+6+4+3+1+2)
2049:bluetooth_rxtx.c **** 			le.conn_interval = (packet[CONN_INTERVAL+1] << 8)
 1100              		.loc 1 2049 0
 1101 0146 6A7F     		ldrb	r2, [r5, #29]	@ zero_extendqisi2
 1102 0148 2B7F     		ldrb	r3, [r5, #28]	@ zero_extendqisi2
 1103 014a 43EA0223 		orr	r3, r3, r2, lsl #8
 1104 014e 6384     		strh	r3, [r4, #34]	@ movhi
2050:bluetooth_rxtx.c **** 							 |  packet[CONN_INTERVAL+0];
2051:bluetooth_rxtx.c **** 
2052:bluetooth_rxtx.c **** #define CHANNEL_INC (2+4+6+6+4+3+1+2+2+2+2+5)
2053:bluetooth_rxtx.c **** 			le.channel_increment = packet[CHANNEL_INC] & 0x1f;
 1105              		.loc 1 2053 0
 1106 0150 95F82730 		ldrb	r3, [r5, #39]	@ zero_extendqisi2
2054:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
2055:bluetooth_rxtx.c **** 
2056:bluetooth_rxtx.c **** 			// Hop to the initial channel immediately
2057:bluetooth_rxtx.c **** 			do_hop = 1;
ARM GAS  /tmp/ccxsBJK4.s 			page 59


 1107              		.loc 1 2057 0
 1108 0154 0122     		movs	r2, #1
2053:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
 1109              		.loc 1 2053 0
 1110 0156 03F01F03 		and	r3, r3, #31
 1111 015a A376     		strb	r3, [r4, #26]
2054:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
 1112              		.loc 1 2054 0
 1113 015c 6376     		strb	r3, [r4, #25]
 1114              		.loc 1 2057 0
 1115 015e 034B     		ldr	r3, .L87+8
 1116 0160 DA72     		strb	r2, [r3, #11]
 1117              	.L69:
 1118 0162 38BD     		pop	{r3, r4, r5, pc}
 1119              	.LVL113:
 1120              	.L88:
 1121              		.align	2
 1122              	.L87:
 1123 0164 00000000 		.word	.LANCHOR1
 1124 0168 00000000 		.word	clkn
 1125 016c 00000000 		.word	.LANCHOR0
 1126              	.LBE13:
 1127              	.LBE12:
 1128              		.cfi_endproc
 1129              	.LFE24:
 1131              		.global	__aeabi_llsl
 1132              		.section	.text.vendor_request_handler,"ax",%progbits
 1133              		.align	1
 1134              		.thumb
 1135              		.thumb_func
 1137              	vendor_request_handler:
 1138              	.LFB2:
 185:bluetooth_rxtx.c **** 	uint32_t clock;
 1139              		.loc 1 185 0
 1140              		.cfi_startproc
 1141              		@ args = 0, pretend = 0, frame = 0
 1142              		@ frame_needed = 0, uses_anonymous_args = 0
 1143              	.LVL114:
 1144 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1145              		.cfi_def_cfa_offset 24
 1146              		.cfi_offset 4, -24
 1147              		.cfi_offset 5, -20
 1148              		.cfi_offset 6, -16
 1149              		.cfi_offset 7, -12
 1150              		.cfi_offset 8, -8
 1151              		.cfi_offset 14, -4
 1152              	.LVL115:
 185:bluetooth_rxtx.c **** 	uint32_t clock;
 1153              		.loc 1 185 0
 1154 0004 0D46     		mov	r5, r1
 1155 0006 1646     		mov	r6, r2
 1156 0008 1C46     		mov	r4, r3
 192:bluetooth_rxtx.c **** 
 1157              		.loc 1 192 0
 1158 000a 4D28     		cmp	r0, #77
 1159 000c 00F26D83 		bhi	.L209
 1160 0010 DFE810F0 		tbh	[pc, r0, lsl #1]
ARM GAS  /tmp/ccxsBJK4.s 			page 60


 1161              	.LVL116:
 1162              	.L92:
 1163 0014 0801     		.2byte	(.L228-.L92)/2
 1164 0016 5000     		.2byte	(.L93-.L92)/2
 1165 0018 5500     		.2byte	(.L94-.L92)/2
 1166 001a 5900     		.2byte	(.L95-.L92)/2
 1167 001c 5E00     		.2byte	(.L96-.L92)/2
 1168 001e 6100     		.2byte	(.L97-.L92)/2
 1169 0020 6600     		.2byte	(.L98-.L92)/2
 1170 0022 6900     		.2byte	(.L99-.L92)/2
 1171 0024 6B00     		.2byte	(.L100-.L92)/2
 1172 0026 6F00     		.2byte	(.L101-.L92)/2
 1173 0028 7400     		.2byte	(.L102-.L92)/2
 1174 002a C900     		.2byte	(.L103-.L92)/2
 1175 002c D000     		.2byte	(.L104-.L92)/2
 1176 002e 0D01     		.2byte	(.L243-.L92)/2
 1177 0030 8200     		.2byte	(.L106-.L92)/2
 1178 0032 7D00     		.2byte	(.L107-.L92)/2
 1179 0034 8700     		.2byte	(.L108-.L92)/2
 1180 0036 8C00     		.2byte	(.L109-.L92)/2
 1181 0038 8F00     		.2byte	(.L110-.L92)/2
 1182 003a 9400     		.2byte	(.L111-.L92)/2
 1183 003c 9C00     		.2byte	(.L112-.L92)/2
 1184 003e C100     		.2byte	(.L113-.L92)/2
 1185 0040 C300     		.2byte	(.L114-.L92)/2
 1186 0042 C500     		.2byte	(.L115-.L92)/2
 1187 0044 0601     		.2byte	(.L116-.L92)/2
 1188 0046 0A01     		.2byte	(.L117-.L92)/2
 1189 0048 6B03     		.2byte	(.L209-.L92)/2
 1190 004a 0F01     		.2byte	(.L118-.L92)/2
 1191 004c A000     		.2byte	(.L119-.L92)/2
 1192 004e A700     		.2byte	(.L120-.L92)/2
 1193 0050 B100     		.2byte	(.L121-.L92)/2
 1194 0052 AF00     		.2byte	(.L122-.L92)/2
 1195 0054 B300     		.2byte	(.L123-.L92)/2
 1196 0056 3C01     		.2byte	(.L124-.L92)/2
 1197 0058 2D01     		.2byte	(.L125-.L92)/2
 1198 005a 5901     		.2byte	(.L126-.L92)/2
 1199 005c 5C01     		.2byte	(.L127-.L92)/2
 1200 005e 6001     		.2byte	(.L128-.L92)/2
 1201 0060 6401     		.2byte	(.L129-.L92)/2
 1202 0062 B601     		.2byte	(.L130-.L92)/2
 1203 0064 EE01     		.2byte	(.L131-.L92)/2
 1204 0066 1202     		.2byte	(.L132-.L92)/2
 1205 0068 5202     		.2byte	(.L133-.L92)/2
 1206 006a 5A02     		.2byte	(.L134-.L92)/2
 1207 006c 6502     		.2byte	(.L135-.L92)/2
 1208 006e 6803     		.2byte	(.L202-.L92)/2
 1209 0070 7402     		.2byte	(.L137-.L92)/2
 1210 0072 7902     		.2byte	(.L138-.L92)/2
 1211 0074 7F02     		.2byte	(.L139-.L92)/2
 1212 0076 8602     		.2byte	(.L140-.L92)/2
 1213 0078 9502     		.2byte	(.L141-.L92)/2
 1214 007a FB01     		.2byte	(.L142-.L92)/2
 1215 007c 0802     		.2byte	(.L143-.L92)/2
 1216 007e A302     		.2byte	(.L144-.L92)/2
 1217 0080 DA02     		.2byte	(.L145-.L92)/2
ARM GAS  /tmp/ccxsBJK4.s 			page 61


 1218 0082 4B01     		.2byte	(.L146-.L92)/2
 1219 0084 4803     		.2byte	(.L147-.L92)/2
 1220 0086 6B03     		.2byte	(.L209-.L92)/2
 1221 0088 AB02     		.2byte	(.L148-.L92)/2
 1222 008a 5F03     		.2byte	(.L149-.L92)/2
 1223 008c 6303     		.2byte	(.L150-.L92)/2
 1224 008e D601     		.2byte	(.L151-.L92)/2
 1225 0090 E901     		.2byte	(.L152-.L92)/2
 1226 0092 1D02     		.2byte	(.L153-.L92)/2
 1227 0094 6B03     		.2byte	(.L209-.L92)/2
 1228 0096 4E00     		.2byte	(.L154-.L92)/2
 1229 0098 C102     		.2byte	(.L155-.L92)/2
 1230 009a 2B01     		.2byte	(.L156-.L92)/2
 1231 009c D102     		.2byte	(.L157-.L92)/2
 1232 009e 2402     		.2byte	(.L158-.L92)/2
 1233 00a0 E302     		.2byte	(.L159-.L92)/2
 1234 00a2 EC02     		.2byte	(.L160-.L92)/2
 1235 00a4 F502     		.2byte	(.L161-.L92)/2
 1236 00a6 FE02     		.2byte	(.L162-.L92)/2
 1237 00a8 0703     		.2byte	(.L163-.L92)/2
 1238 00aa 2C03     		.2byte	(.L164-.L92)/2
 1239 00ac 3503     		.2byte	(.L165-.L92)/2
 1240 00ae 3E03     		.2byte	(.L166-.L92)/2
 1241              	.L154:
 1242 00b0 0024     		movs	r4, #0
 1243              	.LVL117:
 1244 00b2 5FE2     		b	.L167
 1245              	.LVL118:
 1246              	.L93:
 199:bluetooth_rxtx.c **** 		*data_len = 0;
 1247              		.loc 1 199 0
 1248 00b4 A34B     		ldr	r3, .L252
 1249 00b6 0120     		movs	r0, #1
 1250              	.LVL119:
 1251 00b8 9874     		strb	r0, [r3, #18]
 200:bluetooth_rxtx.c **** 		break;
 1252              		.loc 1 200 0
 1253 00ba 0023     		movs	r3, #0
 1254 00bc AFE1     		b	.L219
 1255              	.LVL120:
 1256              	.L94:
 204:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 1257              		.loc 1 204 0
 1258 00be A14B     		ldr	r3, .L252
 1259 00c0 0222     		movs	r2, #2
 1260              	.LVL121:
 1261 00c2 9A72     		strb	r2, [r3, #10]
 1262 00c4 E0E0     		b	.L244
 1263              	.LVL122:
 1264              	.L95:
 210:bluetooth_rxtx.c **** 		*data_len = 1;
 1265              		.loc 1 210 0
 1266 00c6 A04B     		ldr	r3, .L252+4
 1267 00c8 1B68     		ldr	r3, [r3]
 1268 00ca C3F34003 		ubfx	r3, r3, #1, #1
 1269 00ce 03E1     		b	.L221
 1270              	.L96:
ARM GAS  /tmp/ccxsBJK4.s 			page 62


 215:bluetooth_rxtx.c **** 			USRLED_SET;
 1271              		.loc 1 215 0
 1272 00d0 0A88     		ldrh	r2, [r1]
 1273              	.LVL123:
 1274 00d2 0223     		movs	r3, #2
 1275 00d4 15E0     		b	.L240
 1276              	.LVL124:
 1277              	.L97:
 222:bluetooth_rxtx.c **** 		*data_len = 1;
 1278              		.loc 1 222 0
 1279 00d6 9C4B     		ldr	r3, .L252+4
 1280 00d8 1B68     		ldr	r3, [r3]
 1281 00da C3F30013 		ubfx	r3, r3, #4, #1
 1282 00de FBE0     		b	.L221
 1283              	.L98:
 227:bluetooth_rxtx.c **** 			RXLED_SET;
 1284              		.loc 1 227 0
 1285 00e0 0A88     		ldrh	r2, [r1]
 1286              	.LVL125:
 1287 00e2 1023     		movs	r3, #16
 1288 00e4 0DE0     		b	.L240
 1289              	.LVL126:
 1290              	.L99:
 234:bluetooth_rxtx.c **** 		*data_len = 1;
 1291              		.loc 1 234 0
 1292 00e6 984B     		ldr	r3, .L252+4
 1293 00e8 24E0     		b	.L247
 1294              	.L100:
 239:bluetooth_rxtx.c **** 			TXLED_SET;
 1295              		.loc 1 239 0
 1296 00ea 0A88     		ldrh	r2, [r1]
 1297              	.LVL127:
 1298 00ec 4FF48073 		mov	r3, #256
 1299 00f0 07E0     		b	.L240
 1300              	.LVL128:
 1301              	.L101:
 246:bluetooth_rxtx.c **** 		*data_len = 1;
 1302              		.loc 1 246 0
 1303 00f2 954B     		ldr	r3, .L252+4
 1304 00f4 1B68     		ldr	r3, [r3]
 1305 00f6 C3F34023 		ubfx	r3, r3, #9, #1
 1306 00fa EDE0     		b	.L221
 1307              	.L102:
 251:bluetooth_rxtx.c **** 			CC1V8_SET;
 1308              		.loc 1 251 0
 1309 00fc 0A88     		ldrh	r2, [r1]
 1310              	.LVL129:
 1311 00fe 4FF40073 		mov	r3, #512
 1312              	.L240:
 1313 0102 12B9     		cbnz	r2, .L251
 242:bluetooth_rxtx.c **** 		break;
 1314              		.loc 1 242 0
 1315 0104 914A     		ldr	r2, .L252+8
 1316              	.L223:
 1317 0106 1360     		str	r3, [r2]
 1318 0108 ECE2     		b	.L202
 1319              	.L251:
ARM GAS  /tmp/ccxsBJK4.s 			page 63


 252:bluetooth_rxtx.c **** 		else
 1320              		.loc 1 252 0
 1321 010a 914A     		ldr	r2, .L252+12
 1322 010c FBE7     		b	.L223
 1323              	.LVL130:
 1324              	.L107:
 258:bluetooth_rxtx.c **** 		break;
 1325              		.loc 1 258 0
 1326 010e 1046     		mov	r0, r2
 1327              	.LVL131:
 1328 0110 2146     		mov	r1, r4
 1329              	.LVL132:
 1330 0112 FFF7FEFF 		bl	get_part_num
 1331              	.LVL133:
 1332 0116 E5E2     		b	.L202
 1333              	.LVL134:
 1334              	.L106:
 266:bluetooth_rxtx.c **** 		break;
 1335              		.loc 1 266 0
 1336 0118 1046     		mov	r0, r2
 1337              	.LVL135:
 1338 011a 2146     		mov	r1, r4
 1339              	.LVL136:
 1340 011c FFF7FEFF 		bl	get_device_serial
 1341              	.LVL137:
 1342 0120 E0E2     		b	.L202
 1343              	.LVL138:
 1344              	.L108:
 271:bluetooth_rxtx.c **** 		*data_len = 1;
 1345              		.loc 1 271 0
 1346 0122 8C4B     		ldr	r3, .L252+16
 1347 0124 1B68     		ldr	r3, [r3]
 1348 0126 C3F3C013 		ubfx	r3, r3, #7, #1
 1349 012a D5E0     		b	.L221
 1350              	.L109:
 276:bluetooth_rxtx.c **** 			PAEN_SET;
 1351              		.loc 1 276 0
 1352 012c 0A88     		ldrh	r2, [r1]
 1353              	.LVL139:
 1354 012e 8023     		movs	r3, #128
 1355 0130 07E0     		b	.L242
 1356              	.LVL140:
 1357              	.L110:
 283:bluetooth_rxtx.c **** 		*data_len = 1;
 1358              		.loc 1 283 0
 1359 0132 884B     		ldr	r3, .L252+16
 1360              	.L247:
 1361 0134 1B68     		ldr	r3, [r3]
 1362 0136 C3F30023 		ubfx	r3, r3, #8, #1
 1363 013a CDE0     		b	.L221
 1364              	.L111:
 288:bluetooth_rxtx.c **** 			HGM_SET;
 1365              		.loc 1 288 0
 1366 013c 0A88     		ldrh	r2, [r1]
 1367              	.LVL141:
 1368 013e 4FF48073 		mov	r3, #256
 1369              	.L242:
ARM GAS  /tmp/ccxsBJK4.s 			page 64


 1370 0142 0AB1     		cbz	r2, .L173
 289:bluetooth_rxtx.c **** 		else
 1371              		.loc 1 289 0
 1372 0144 844A     		ldr	r2, .L252+20
 1373 0146 DEE7     		b	.L223
 1374              	.L173:
 291:bluetooth_rxtx.c **** 		break;
 1375              		.loc 1 291 0
 1376 0148 844A     		ldr	r2, .L252+24
 1377 014a DCE7     		b	.L223
 1378              	.LVL142:
 1379              	.L112:
 297:bluetooth_rxtx.c **** 		break;
 1380              		.loc 1 297 0
 1381 014c 0322     		movs	r2, #3
 1382              	.LVL143:
 1383              	.L226:
 1384 014e 7D4B     		ldr	r3, .L252
 1385 0150 9A74     		strb	r2, [r3, #18]
 1386 0152 C7E2     		b	.L202
 1387              	.LVL144:
 1388              	.L119:
 301:bluetooth_rxtx.c **** 		*data_len = 1;
 1389              		.loc 1 301 0
 1390 0154 0520     		movs	r0, #5
 1391              	.LVL145:
 1392 0156 FFF7FEFF 		bl	cc2400_get
 1393              	.LVL146:
 1394 015a 00F00700 		and	r0, r0, #7
 1395 015e 3070     		strb	r0, [r6]
 1396 0160 E9E1     		b	.L216
 1397              	.LVL147:
 1398              	.L120:
 306:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 1399              		.loc 1 306 0
 1400 0162 0988     		ldrh	r1, [r1]
 1401              	.LVL148:
 1402 0164 0729     		cmp	r1, #7
 1403 0166 00F2C082 		bhi	.L209
 307:bluetooth_rxtx.c **** 		} else {
 1404              		.loc 1 307 0
 1405 016a 0520     		movs	r0, #5
 1406              	.LVL149:
 1407 016c 41F00801 		orr	r1, r1, #8
 1408 0170 FDE1     		b	.L232
 1409              	.LVL150:
 1410              	.L122:
 314:bluetooth_rxtx.c **** 		break;
 1411              		.loc 1 314 0
 1412 0172 0522     		movs	r2, #5
 1413              	.LVL151:
 1414 0174 EBE7     		b	.L226
 1415              	.LVL152:
 1416              	.L121:
 318:bluetooth_rxtx.c **** 		break;
 1417              		.loc 1 318 0
 1418 0176 0622     		movs	r2, #6
ARM GAS  /tmp/ccxsBJK4.s 			page 65


 1419              	.LVL153:
 1420 0178 E9E7     		b	.L226
 1421              	.LVL154:
 1422              	.L123:
 323:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 1423              		.loc 1 323 0
 1424 017a 794B     		ldr	r3, .L252+28
 1425 017c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1426              	.LVL155:
 1427 017e 3270     		strb	r2, [r6]
 324:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 1428              		.loc 1 324 0
 1429 0180 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 1430 0182 7270     		strb	r2, [r6, #1]
 325:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 1431              		.loc 1 325 0
 1432 0184 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 1433 0186 B270     		strb	r2, [r6, #2]
 326:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 1434              		.loc 1 326 0
 1435 0188 DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 1436 018a F270     		strb	r2, [r6, #3]
 327:bluetooth_rxtx.c **** 		*data_len = 5;
 1437              		.loc 1 327 0
 1438 018c 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 1439 018e 3371     		strb	r3, [r6, #4]
 328:bluetooth_rxtx.c **** 		break;
 1440              		.loc 1 328 0
 1441 0190 0523     		movs	r3, #5
 1442              	.LVL156:
 1443              	.L230:
 1444 0192 2360     		str	r3, [r4]
 1445 0194 A6E2     		b	.L202
 1446              	.LVL157:
 1447              	.L113:
 332:bluetooth_rxtx.c **** 		break;
 1448              		.loc 1 332 0
 1449 0196 0022     		movs	r2, #0
 1450              	.LVL158:
 1451 0198 D9E7     		b	.L226
 1452              	.LVL159:
 1453              	.L114:
 336:bluetooth_rxtx.c **** 		*data_len = 1;
 1454              		.loc 1 336 0
 1455 019a 6A4B     		ldr	r3, .L252
 1456 019c 9BE0     		b	.L220
 1457              	.L115:
 341:bluetooth_rxtx.c **** 		break;
 1458              		.loc 1 341 0
 1459 019e 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 1460              	.LVL160:
 1461 01a0 684B     		ldr	r3, .L252
 1462 01a2 1A70     		strb	r2, [r3]
 1463 01a4 9EE2     		b	.L202
 1464              	.LVL161:
 1465              	.L103:
 345:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
ARM GAS  /tmp/ccxsBJK4.s 			page 66


 1466              		.loc 1 345 0
 1467 01a6 6F4B     		ldr	r3, .L252+32
 1468 01a8 1A88     		ldrh	r2, [r3]
 1469              	.LVL162:
 1470 01aa 3270     		strb	r2, [r6]
 346:bluetooth_rxtx.c **** 		*data_len = 2;
 1471              		.loc 1 346 0
 1472 01ac 1B88     		ldrh	r3, [r3]
 1473 01ae C3F30723 		ubfx	r3, r3, #8, #8
 1474 01b2 A6E1     		b	.L250
 1475              	.LVL163:
 1476              	.L104:
 351:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 1477              		.loc 1 351 0
 1478 01b4 0A88     		ldrh	r2, [r1]
 1479              	.LVL164:
 1480 01b6 634B     		ldr	r3, .L252
 1481 01b8 DA81     		strh	r2, [r3, #14]	@ movhi
 353:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 1482              		.loc 1 353 0
 1483 01ba D989     		ldrh	r1, [r3, #14]
 1484              	.LVL165:
 1485 01bc 40F6EA22 		movw	r2, #2794
 1486 01c0 89B2     		uxth	r1, r1
 1487 01c2 9142     		cmp	r1, r2
 1488 01c4 04D9     		bls	.L174
 354:bluetooth_rxtx.c **** 			requested_channel = 2402;
 1489              		.loc 1 354 0
 1490 01c6 0122     		movs	r2, #1
 1491 01c8 9A72     		strb	r2, [r3, #10]
 355:bluetooth_rxtx.c **** 		}
 1492              		.loc 1 355 0
 1493 01ca 40F66212 		movw	r2, #2402
 1494 01ce 15E0     		b	.L177
 1495              	.L174:
 359:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 1496              		.loc 1 359 0
 1497 01d0 0022     		movs	r2, #0
 1498 01d2 9A72     		strb	r2, [r3, #10]
 360:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 1499              		.loc 1 360 0
 1500 01d4 D989     		ldrh	r1, [r3, #14]
 1501 01d6 40F6DC02 		movw	r2, #2268
 1502 01da 89B2     		uxth	r1, r1
 1503 01dc 9142     		cmp	r1, r2
 1504 01de 84BF     		itt	hi
 1505 01e0 DA89     		ldrhhi	r2, [r3, #14]
 1506 01e2 92B2     		uxthhi	r2, r2
 1507 01e4 DA81     		strh	r2, [r3, #14]	@ movhi
 361:bluetooth_rxtx.c **** 		}
 1508              		.loc 1 361 0
 1509 01e6 D989     		ldrh	r1, [r3, #14]
 1510 01e8 40F6E922 		movw	r2, #2793
 1511 01ec 89B2     		uxth	r1, r1
 1512 01ee 9142     		cmp	r1, r2
 1513 01f0 97BF     		itett	ls
 1514 01f2 544A     		ldrls	r2, .L252
ARM GAS  /tmp/ccxsBJK4.s 			page 67


 1515 01f4 40F6EA22 		movwhi	r2, #2794
 1516 01f8 D289     		ldrhls	r2, [r2, #14]
 1517 01fa 92B2     		uxthls	r2, r2
 1518              	.L177:
 361:bluetooth_rxtx.c **** 		}
 1519              		.loc 1 361 0 is_stmt 0 discriminator 3
 1520 01fc DA81     		strh	r2, [r3, #14]	@ movhi
 364:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 1521              		.loc 1 364 0 is_stmt 1 discriminator 3
 1522 01fe D889     		ldrh	r0, [r3, #14]
 1523              	.LVL166:
 1524 0200 584A     		ldr	r2, .L252+32
 1525 0202 80B2     		uxth	r0, r0
 1526 0204 A2F84A00 		strh	r0, [r2, #74]	@ movhi
 365:bluetooth_rxtx.c **** 			channel = requested_channel;
 1527              		.loc 1 365 0 discriminator 3
 1528 0208 5B7C     		ldrb	r3, [r3, #17]	@ zero_extendqisi2
 364:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 1529              		.loc 1 364 0 discriminator 3
 1530 020a 4E49     		ldr	r1, .L252
 365:bluetooth_rxtx.c **** 			channel = requested_channel;
 1531              		.loc 1 365 0 discriminator 3
 1532 020c 092B     		cmp	r3, #9
 1533 020e 00F06982 		beq	.L202
 366:bluetooth_rxtx.c **** 			requested_channel = 0;
 1534              		.loc 1 366 0
 1535 0212 CB89     		ldrh	r3, [r1, #14]
 1536 0214 9BB2     		uxth	r3, r3
 1537 0216 1380     		strh	r3, [r2]	@ movhi
 367:bluetooth_rxtx.c **** 
 1538              		.loc 1 367 0
 1539 0218 0023     		movs	r3, #0
 1540 021a CB81     		strh	r3, [r1, #14]	@ movhi
 371:bluetooth_rxtx.c **** 		}
 1541              		.loc 1 371 0
 1542 021c 1088     		ldrh	r0, [r2]
 1543 021e 98E1     		b	.L234
 1544              	.LVL167:
 1545              	.L116:
 376:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 1546              		.loc 1 376 0
 1547 0220 FFF7FEFF 		bl	set_isp
 1548              	.LVL168:
 1549              	.L228:
 377:bluetooth_rxtx.c **** 		break;
 1550              		.loc 1 377 0
 1551 0224 0023     		movs	r3, #0
 1552 0226 B4E7     		b	.L230
 1553              	.LVL169:
 1554              	.L117:
 381:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 1555              		.loc 1 381 0
 1556 0228 4F4A     		ldr	r2, .L252+36
 1557              	.LVL170:
 1558 022a 504B     		ldr	r3, .L252+40
 1559 022c 1A60     		str	r2, [r3]
 1560              	.L243:
ARM GAS  /tmp/ccxsBJK4.s 			page 68


 382:bluetooth_rxtx.c **** 		break;
 1561              		.loc 1 382 0
 1562 022e 0B22     		movs	r2, #11
 1563 0230 8DE7     		b	.L226
 1564              	.LVL171:
 1565              	.L118:
 386:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 1566              		.loc 1 386 0
 1567 0232 0A88     		ldrh	r2, [r1]
 1568              	.LVL172:
 1569 0234 6FF40066 		mvn	r6, #2048
 1570              	.LVL173:
 1571 0238 9319     		adds	r3, r2, r6
 1572 023a 40F2FF31 		movw	r1, #1023
 1573              	.LVL174:
 1574 023e 9BB2     		uxth	r3, r3
 1575 0240 8B42     		cmp	r3, r1
 1576 0242 00F25282 		bhi	.L209
 387:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1577              		.loc 1 387 0 discriminator 1
 1578 0246 6B88     		ldrh	r3, [r5, #2]
 386:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 1579              		.loc 1 386 0 discriminator 1
 1580 0248 6FF40065 		mvn	r5, #2048
 1581              	.LVL175:
 1582 024c 5819     		adds	r0, r3, r5
 1583              	.LVL176:
 1584 024e 80B2     		uxth	r0, r0
 1585 0250 8842     		cmp	r0, r1
 1586 0252 00F24A82 		bhi	.L209
 387:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1587              		.loc 1 387 0 discriminator 1
 1588 0256 9342     		cmp	r3, r2
 1589 0258 C0F04782 		bcc	.L209
 390:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 1590              		.loc 1 390 0
 1591 025c 4149     		ldr	r1, .L252+32
 1592 025e A1F84C20 		strh	r2, [r1, #76]	@ movhi
 391:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 1593              		.loc 1 391 0
 1594 0262 A1F84E30 		strh	r3, [r1, #78]	@ movhi
 392:bluetooth_rxtx.c **** 		*data_len = 0;
 1595              		.loc 1 392 0
 1596 0266 0422     		movs	r2, #4
 1597 0268 0DE0     		b	.L245
 1598              	.LVL177:
 1599              	.L156:
 397:bluetooth_rxtx.c **** 		*data_len = 0;
 1600              		.loc 1 397 0
 1601 026a 0F22     		movs	r2, #15
 1602              	.LVL178:
 1603 026c 0BE0     		b	.L245
 1604              	.LVL179:
 1605              	.L125:
 402:bluetooth_rxtx.c **** 			return 0;
 1606              		.loc 1 402 0
 1607 026e 0B88     		ldrh	r3, [r1]
ARM GAS  /tmp/ccxsBJK4.s 			page 69


 1608 0270 B3F5807F 		cmp	r3, #256
 1609 0274 00F23982 		bhi	.L209
 404:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 1610              		.loc 1 404 0
 1611 0278 3A4A     		ldr	r2, .L252+32
 1612              	.LVL180:
 1613 027a C3F13603 		rsb	r3, r3, #54
 1614 027e DBB2     		uxtb	r3, r3
 1615 0280 82F85030 		strb	r3, [r2, #80]
 405:bluetooth_rxtx.c **** 		*data_len = 0;
 1616              		.loc 1 405 0
 1617 0284 0722     		movs	r2, #7
 1618              	.LVL181:
 1619              	.L245:
 1620 0286 2F4B     		ldr	r3, .L252
 1621              	.L244:
 1622 0288 9A74     		strb	r2, [r3, #18]
 1623 028a CBE7     		b	.L228
 1624              	.LVL182:
 1625              	.L124:
 410:bluetooth_rxtx.c **** 		data[1] = 0x00;
 1626              		.loc 1 410 0
 1627 028c 0023     		movs	r3, #0
 1628 028e 1370     		strb	r3, [r2]
 411:bluetooth_rxtx.c **** 
 1629              		.loc 1 411 0
 1630 0290 5370     		strb	r3, [r2, #1]
 413:bluetooth_rxtx.c **** 		data[2] = length;
 1631              		.loc 1 413 0
 1632 0292 3748     		ldr	r0, .L252+44
 1633              	.LVL183:
 1634 0294 FFF7FEFF 		bl	strlen
 1635              	.LVL184:
 1636 0298 C5B2     		uxtb	r5, r0
 1637              	.LVL185:
 414:bluetooth_rxtx.c **** 
 1638              		.loc 1 414 0
 1639 029a B570     		strb	r5, [r6, #2]
 416:bluetooth_rxtx.c **** 
 1640              		.loc 1 416 0
 1641 029c 2A46     		mov	r2, r5
 1642 029e F01C     		adds	r0, r6, #3
 1643 02a0 3349     		ldr	r1, .L252+44
 1644 02a2 FFF7FEFF 		bl	memcpy
 1645              	.LVL186:
 418:bluetooth_rxtx.c **** 		break;
 1646              		.loc 1 418 0
 1647 02a6 0335     		adds	r5, r5, #3
 1648              	.LVL187:
 1649 02a8 0BE0     		b	.L233
 1650              	.LVL188:
 1651              	.L146:
 422:bluetooth_rxtx.c **** 		data[0] = length;
 1652              		.loc 1 422 0
 1653 02aa 3248     		ldr	r0, .L252+48
 1654              	.LVL189:
 1655 02ac FFF7FEFF 		bl	strlen
ARM GAS  /tmp/ccxsBJK4.s 			page 70


 1656              	.LVL190:
 1657 02b0 C5B2     		uxtb	r5, r0
 1658              	.LVL191:
 423:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 1659              		.loc 1 423 0
 1660 02b2 3046     		mov	r0, r6
 1661 02b4 00F8015B 		strb	r5, [r0], #1
 424:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 1662              		.loc 1 424 0
 1663 02b8 2A46     		mov	r2, r5
 1664 02ba 2E49     		ldr	r1, .L252+48
 1665 02bc FFF7FEFF 		bl	memcpy
 1666              	.LVL192:
 425:bluetooth_rxtx.c **** 		break;
 1667              		.loc 1 425 0
 1668 02c0 0135     		adds	r5, r5, #1
 1669              	.LVL193:
 1670              	.L233:
 1671 02c2 2560     		str	r5, [r4]
 1672 02c4 0EE2     		b	.L202
 1673              	.LVL194:
 1674              	.L126:
 429:bluetooth_rxtx.c **** 		*data_len = 1;
 1675              		.loc 1 429 0
 1676 02c6 0120     		movs	r0, #1
 1677              	.LVL195:
 1678 02c8 1070     		strb	r0, [r2]
 1679 02ca 35E1     		b	.L217
 1680              	.LVL196:
 1681              	.L127:
 434:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1682              		.loc 1 434 0
 1683 02cc 0A88     		ldrh	r2, [r1]
 1684              	.LVL197:
 1685 02ce 2A4B     		ldr	r3, .L252+52
 1686 02d0 1A70     		strb	r2, [r3]
 1687 02d2 3CE1     		b	.L231
 1688              	.LVL198:
 1689              	.L128:
 439:bluetooth_rxtx.c **** 		*data_len = 1;
 1690              		.loc 1 439 0
 1691 02d4 284B     		ldr	r3, .L252+52
 1692              	.L220:
 1693 02d6 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1694              	.L221:
 1695 02d8 3370     		strb	r3, [r6]
 1696 02da 2CE1     		b	.L216
 1697              	.L129:
 444:bluetooth_rxtx.c **** 		target.syncword = 0;
 1698              		.loc 1 444 0
 1699 02dc 274F     		ldr	r7, .L252+56
 1700 02de 0024     		movs	r4, #0
 1701              	.LVL199:
 1702 02e0 0025     		movs	r5, #0
 1703 02e2 C7E90045 		strd	r4, [r7]
 445:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 1704              		.loc 1 445 0
ARM GAS  /tmp/ccxsBJK4.s 			page 71


 1705 02e6 C7E90245 		strd	r4, [r7, #8]
 1706              	.LVL200:
 1707              	.LBB14:
 446:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1708              		.loc 1 446 0
 1709 02ea 4FF00008 		mov	r8, #0
 1710              	.LVL201:
 1711              	.L180:
 447:bluetooth_rxtx.c **** 		}
 1712              		.loc 1 447 0 discriminator 2
 1713 02ee 16F80800 		ldrb	r0, [r6, r8]	@ zero_extendqisi2
 1714 02f2 4FEAC802 		lsl	r2, r8, #3
 1715 02f6 0021     		movs	r1, #0
 1716 02f8 FFF7FEFF 		bl	__aeabi_llsl
 1717              	.LVL202:
 1718 02fc D7E90045 		ldrd	r4, [r7]
 446:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1719              		.loc 1 446 0 discriminator 2
 1720 0300 08F10108 		add	r8, r8, #1
 1721              	.LVL203:
 447:bluetooth_rxtx.c **** 		}
 1722              		.loc 1 447 0 discriminator 2
 1723 0304 2043     		orrs	r0, r0, r4
 1724 0306 2943     		orrs	r1, r1, r5
 446:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1725              		.loc 1 446 0 discriminator 2
 1726 0308 B8F1080F 		cmp	r8, #8
 447:bluetooth_rxtx.c **** 		}
 1727              		.loc 1 447 0 discriminator 2
 1728 030c C7E90001 		strd	r0, [r7]
 446:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1729              		.loc 1 446 0 discriminator 2
 1730 0310 EDD1     		bne	.L180
 446:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1731              		.loc 1 446 0 is_stmt 0
 1732 0312 4FF00008 		mov	r8, #0
 1733              	.LVL204:
 1734              	.L182:
 1735 0316 06EB0803 		add	r3, r6, r8
 1736              	.LBE14:
 1737              	.LBB15:
 450:bluetooth_rxtx.c **** 		}
 1738              		.loc 1 450 0 is_stmt 1 discriminator 2
 1739 031a 187A     		ldrb	r0, [r3, #8]	@ zero_extendqisi2
 1740 031c 4FEAC802 		lsl	r2, r8, #3
 1741 0320 0021     		movs	r1, #0
 1742 0322 FFF7FEFF 		bl	__aeabi_llsl
 1743              	.LVL205:
 1744 0326 D7E90245 		ldrd	r4, [r7, #8]
 449:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1745              		.loc 1 449 0 discriminator 2
 1746 032a 08F10108 		add	r8, r8, #1
 1747              	.LVL206:
 450:bluetooth_rxtx.c **** 		}
 1748              		.loc 1 450 0 discriminator 2
 1749 032e 2043     		orrs	r0, r0, r4
 1750 0330 2943     		orrs	r1, r1, r5
ARM GAS  /tmp/ccxsBJK4.s 			page 72


 449:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1751              		.loc 1 449 0 discriminator 2
 1752 0332 B8F1080F 		cmp	r8, #8
 450:bluetooth_rxtx.c **** 		}
 1753              		.loc 1 450 0 discriminator 2
 1754 0336 C7E90201 		strd	r0, [r7, #8]
 449:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1755              		.loc 1 449 0 discriminator 2
 1756 033a ECD1     		bne	.L182
 1757              	.LBE15:
 452:bluetooth_rxtx.c **** 		break;
 1758              		.loc 1 452 0
 1759 033c FFF7FEFF 		bl	precalc
 1760              	.LVL207:
 1761 0340 D0E1     		b	.L202
 1762              	.L253:
 1763 0342 00BF     		.align	2
 1764              	.L252:
 1765 0344 00000000 		.word	.LANCHOR0
 1766 0348 34C00920 		.word	537509940
 1767 034c 3CC00920 		.word	537509948
 1768 0350 38C00920 		.word	537509944
 1769 0354 54C00920 		.word	537509972
 1770 0358 58C00920 		.word	537509976
 1771 035c 5CC00920 		.word	537509980
 1772 0360 00000000 		.word	rr
 1773 0364 00000000 		.word	.LANCHOR1
 1774 0368 21BB0543 		.word	1124449057
 1775 036c 00000000 		.word	bootloader_ctrl
 1776 0370 00000000 		.word	.LC3
 1777 0374 A7000000 		.word	.LANCHOR2+167
 1778 0378 00000000 		.word	cs_threshold_req
 1779 037c 00000000 		.word	target
 1780              	.LVL208:
 1781              	.L130:
 456:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 1782              		.loc 1 456 0
 1783 0380 AC4A     		ldr	r2, .L254
 1784              	.LVL209:
 1785 0382 0023     		movs	r3, #0
 1786 0384 1360     		str	r3, [r2]
 1787              	.LVL210:
 1788              	.L184:
 1789              	.LBB16:
 458:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
 1790              		.loc 1 458 0 discriminator 2
 1791 0386 1168     		ldr	r1, [r2]
 1792 0388 0902     		lsls	r1, r1, #8
 1793 038a 1160     		str	r1, [r2]
 459:bluetooth_rxtx.c **** 		}
 1794              		.loc 1 459 0 discriminator 2
 1795 038c F05C     		ldrb	r0, [r6, r3]	@ zero_extendqisi2
 1796 038e 1168     		ldr	r1, [r2]
 457:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1797              		.loc 1 457 0 discriminator 2
 1798 0390 0133     		adds	r3, r3, #1
 1799              	.LVL211:
ARM GAS  /tmp/ccxsBJK4.s 			page 73


 459:bluetooth_rxtx.c **** 		}
 1800              		.loc 1 459 0 discriminator 2
 1801 0392 0143     		orrs	r1, r1, r0
 457:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1802              		.loc 1 457 0 discriminator 2
 1803 0394 042B     		cmp	r3, #4
 459:bluetooth_rxtx.c **** 		}
 1804              		.loc 1 459 0 discriminator 2
 1805 0396 1160     		str	r1, [r2]
 457:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1806              		.loc 1 457 0 discriminator 2
 1807 0398 F5D1     		bne	.L184
 1808              	.LBE16:
 461:bluetooth_rxtx.c **** 		dma_discard = 1;
 1809              		.loc 1 461 0
 1810 039a A74B     		ldr	r3, .L254+4
 1811              	.LVL212:
 1812 039c 0222     		movs	r2, #2
 1813 039e 9A72     		strb	r2, [r3, #10]
 463:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1814              		.loc 1 463 0
 1815 03a0 A64A     		ldr	r2, .L254+8
 462:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1816              		.loc 1 462 0
 1817 03a2 0120     		movs	r0, #1
 463:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1818              		.loc 1 463 0
 1819 03a4 4FF08051 		mov	r1, #268435456
 462:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1820              		.loc 1 462 0
 1821 03a8 1874     		strb	r0, [r3, #16]
 463:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1822              		.loc 1 463 0
 1823 03aa 1160     		str	r1, [r2]
 464:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 1824              		.loc 1 464 0
 1825 03ac 7279     		ldrb	r2, [r6, #5]	@ zero_extendqisi2
 1826 03ae 3179     		ldrb	r1, [r6, #4]	@ zero_extendqisi2
 1827 03b0 42EA0121 		orr	r1, r2, r1, lsl #8
 1828 03b4 A24A     		ldr	r2, .L254+12
 1829 03b6 1180     		strh	r1, [r2]	@ movhi
 465:bluetooth_rxtx.c **** 		break;
 1830              		.loc 1 465 0
 1831 03b8 0822     		movs	r2, #8
 1832 03ba 9A74     		strb	r2, [r3, #18]
 466:bluetooth_rxtx.c **** 
 1833              		.loc 1 466 0
 1834 03bc BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1835              	.LVL213:
 1836              	.L151:
 469:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 1837              		.loc 1 469 0
 1838 03c0 9D4B     		ldr	r3, .L254+4
 1839 03c2 0522     		movs	r2, #5
 1840              	.LVL214:
 1841 03c4 9A72     		strb	r2, [r3, #10]
 470:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccxsBJK4.s 			page 74


 1842              		.loc 1 470 0
 1843 03c6 0E22     		movs	r2, #14
 1844 03c8 9A74     		strb	r2, [r3, #18]
 1845              	.LVL215:
 1846              	.LBB17:
 472:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1847              		.loc 1 472 0
 1848 03ca 0023     		movs	r3, #0
 1849              	.LVL216:
 1850              	.L186:
 473:bluetooth_rxtx.c **** 		}
 1851              		.loc 1 473 0 discriminator 2
 1852 03cc 9D49     		ldr	r1, .L254+16
 1853 03ce 0022     		movs	r2, #0
 1854 03d0 5A54     		strb	r2, [r3, r1]
 472:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1855              		.loc 1 472 0 discriminator 2
 1856 03d2 0133     		adds	r3, r3, #1
 1857              	.LVL217:
 1858 03d4 0A2B     		cmp	r3, #10
 1859 03d6 F9D1     		bne	.L186
 1860              	.LBE17:
 475:bluetooth_rxtx.c **** 		afh_enabled = 1;
 1861              		.loc 1 475 0
 1862 03d8 9B4B     		ldr	r3, .L254+20
 1863              	.LVL218:
 476:bluetooth_rxtx.c **** 		break;
 1864              		.loc 1 476 0
 1865 03da 0120     		movs	r0, #1
 1866              	.LVL219:
 475:bluetooth_rxtx.c **** 		afh_enabled = 1;
 1867              		.loc 1 475 0
 1868 03dc 1A70     		strb	r2, [r3]
 476:bluetooth_rxtx.c **** 		break;
 1869              		.loc 1 476 0
 1870 03de 9B4B     		ldr	r3, .L254+24
 1871 03e0 1870     		strb	r0, [r3]
 477:bluetooth_rxtx.c **** 
 1872              		.loc 1 477 0
 1873 03e2 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1874              	.LVL220:
 1875              	.L152:
 480:bluetooth_rxtx.c **** 		break;
 1876              		.loc 1 480 0
 1877 03e6 944B     		ldr	r3, .L254+4
 1878 03e8 0120     		movs	r0, #1
 1879              	.LVL221:
 1880 03ea D872     		strb	r0, [r3, #11]
 481:bluetooth_rxtx.c **** 
 1881              		.loc 1 481 0
 1882 03ec BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1883              	.LVL222:
 1884              	.L131:
 484:bluetooth_rxtx.c **** 		clkn = clock;
 1885              		.loc 1 484 0
 1886 03f0 5378     		ldrb	r3, [r2, #1]	@ zero_extendqisi2
 1887 03f2 9278     		ldrb	r2, [r2, #2]	@ zero_extendqisi2
ARM GAS  /tmp/ccxsBJK4.s 			page 75


 1888              	.LVL223:
 1889 03f4 1204     		lsls	r2, r2, #16
 1890 03f6 42EA0322 		orr	r2, r2, r3, lsl #8
 1891 03fa 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 1892 03fc 1A43     		orrs	r2, r2, r3
 1893 03fe F378     		ldrb	r3, [r6, #3]	@ zero_extendqisi2
 1894 0400 42EA0362 		orr	r2, r2, r3, lsl #24
 1895              	.LVL224:
 485:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1896              		.loc 1 485 0
 1897 0404 924B     		ldr	r3, .L254+28
 1898 0406 1A60     		str	r2, [r3]
 1899 0408 A1E0     		b	.L231
 1900              	.LVL225:
 1901              	.L142:
 192:bluetooth_rxtx.c **** 
 1902              		.loc 1 192 0
 1903 040a 0023     		movs	r3, #0
 1904              	.LVL226:
 1905              	.L188:
 1906              	.LBB18:
 491:bluetooth_rxtx.c **** 		}
 1907              		.loc 1 491 0 discriminator 2
 1908 040c F15C     		ldrb	r1, [r6, r3]	@ zero_extendqisi2
 1909 040e 8D4A     		ldr	r2, .L254+16
 1910 0410 9954     		strb	r1, [r3, r2]
 490:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 1911              		.loc 1 490 0 discriminator 2
 1912 0412 0133     		adds	r3, r3, #1
 1913              	.LVL227:
 1914 0414 0A2B     		cmp	r3, #10
 1915 0416 F9D1     		bne	.L188
 1916              	.LBE18:
 493:bluetooth_rxtx.c **** 		*data_len = 10;
 1917              		.loc 1 493 0
 1918 0418 8C4A     		ldr	r2, .L254+24
 1919 041a 0120     		movs	r0, #1
 1920              	.LVL228:
 1921 041c 1070     		strb	r0, [r2]
 1922              	.LVL229:
 1923              	.L219:
 494:bluetooth_rxtx.c **** 		break;
 1924              		.loc 1 494 0
 1925 041e 2360     		str	r3, [r4]
 495:bluetooth_rxtx.c **** 
 1926              		.loc 1 495 0
 1927 0420 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1928              	.LVL230:
 1929              	.L143:
 192:bluetooth_rxtx.c **** 
 1930              		.loc 1 192 0
 1931 0424 0023     		movs	r3, #0
 1932              	.LVL231:
 1933              	.L190:
 1934              	.LBB19:
 499:bluetooth_rxtx.c **** 		}
 1935              		.loc 1 499 0 discriminator 2
ARM GAS  /tmp/ccxsBJK4.s 			page 76


 1936 0426 8749     		ldr	r1, .L254+16
 1937 0428 0022     		movs	r2, #0
 1938 042a 5A54     		strb	r2, [r3, r1]
 498:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1939              		.loc 1 498 0 discriminator 2
 1940 042c 0133     		adds	r3, r3, #1
 1941              	.LVL232:
 1942 042e 0A2B     		cmp	r3, #10
 1943 0430 F9D1     		bne	.L190
 1944              	.LBE19:
 501:bluetooth_rxtx.c **** 		*data_len = 10;
 1945              		.loc 1 501 0
 1946 0432 8649     		ldr	r1, .L254+24
 1947 0434 0A70     		strb	r2, [r1]
 1948 0436 ACE6     		b	.L230
 1949              	.LVL233:
 1950              	.L132:
 506:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 1951              		.loc 1 506 0
 1952 0438 854B     		ldr	r3, .L254+28
 1953 043a 1968     		ldr	r1, [r3]
 1954              	.LVL234:
 1955              	.LBB20:
 507:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1956              		.loc 1 507 0
 1957 043c 0023     		movs	r3, #0
 1958              	.LVL235:
 1959              	.L192:
 1960 043e DA00     		lsls	r2, r3, #3
 508:bluetooth_rxtx.c **** 		}
 1961              		.loc 1 508 0 discriminator 2
 1962 0440 21FA02F2 		lsr	r2, r1, r2
 1963 0444 F254     		strb	r2, [r6, r3]
 507:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1964              		.loc 1 507 0 discriminator 2
 1965 0446 0133     		adds	r3, r3, #1
 1966              	.LVL236:
 1967 0448 042B     		cmp	r3, #4
 1968 044a F8D1     		bne	.L192
 1969 044c A1E6     		b	.L230
 1970              	.LVL237:
 1971              	.L153:
 1972              	.LBE20:
 514:bluetooth_rxtx.c **** 		break;
 1973              		.loc 1 514 0
 1974 044e 7378     		ldrb	r3, [r6, #1]	@ zero_extendqisi2
 1975 0450 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 1976              	.LVL238:
 1977 0452 43EA0222 		orr	r2, r3, r2, lsl #8
 1978 0456 7A4B     		ldr	r3, .L254+12
 1979 0458 1A80     		strh	r2, [r3]	@ movhi
 1980 045a 43E1     		b	.L202
 1981              	.LVL239:
 1982              	.L158:
 518:bluetooth_rxtx.c **** 
 1983              		.loc 1 518 0
 1984 045c 7D4B     		ldr	r3, .L254+32
ARM GAS  /tmp/ccxsBJK4.s 			page 77


 1985 045e 1078     		ldrb	r0, [r2]	@ zero_extendqisi2
 1986              	.LVL240:
 1987 0460 1988     		ldrh	r1, [r3]
 1988              	.LVL241:
 1989 0462 5278     		ldrb	r2, [r2, #1]	@ zero_extendqisi2
 1990              	.LVL242:
 1991 0464 89B2     		uxth	r1, r1
 1992 0466 42EA0022 		orr	r2, r2, r0, lsl #8
 1993 046a 0A44     		add	r2, r2, r1
 1994 046c 92B2     		uxth	r2, r2
 1995 046e 1A80     		strh	r2, [r3]	@ movhi
 521:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 1996              		.loc 1 521 0
 1997 0470 1A88     		ldrh	r2, [r3]
 1998 0472 7949     		ldr	r1, .L254+36
 1999 0474 12B2     		sxth	r2, r2
 2000 0476 002A     		cmp	r2, #0
 2001 0478 784A     		ldr	r2, .L254+40
 2002 047a 07DA     		bge	.L193
 522:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2003              		.loc 1 522 0
 2004 047c 1B88     		ldrh	r3, [r3]
 2005 047e 4FF4A070 		mov	r0, #320
 2006 0482 5B42     		negs	r3, r3
 2007 0484 9BB2     		uxth	r3, r3
 2008 0486 90FBF3F3 		sdiv	r3, r0, r3
 2009 048a 0AE0     		b	.L248
 2010              	.L193:
 526:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
 2011              		.loc 1 526 0
 2012 048c 1888     		ldrh	r0, [r3]
 2013 048e 00B2     		sxth	r0, r0
 2014 0490 0028     		cmp	r0, #0
 2015 0492 0DDD     		ble	.L194
 527:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2016              		.loc 1 527 0
 2017 0494 1B88     		ldrh	r3, [r3]
 2018 0496 4FF4A070 		mov	r0, #320
 2019 049a 1BB2     		sxth	r3, r3
 2020 049c 90FBF3F3 		sdiv	r3, r0, r3
 2021 04a0 9BB2     		uxth	r3, r3
 2022              	.L248:
 2023 04a2 1380     		strh	r3, [r2]	@ movhi
 528:bluetooth_rxtx.c **** 		}
 2024              		.loc 1 528 0
 2025 04a4 6E4B     		ldr	r3, .L254+44
 2026 04a6 1868     		ldr	r0, [r3]
 2027 04a8 1388     		ldrh	r3, [r2]
 2028 04aa 9BB2     		uxth	r3, r3
 2029 04ac 0344     		add	r3, r3, r0
 2030 04ae 01E0     		b	.L224
 2031              	.L194:
 532:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
 2032              		.loc 1 532 0
 2033 04b0 0023     		movs	r3, #0
 2034 04b2 1380     		strh	r3, [r2]	@ movhi
 2035              	.L224:
ARM GAS  /tmp/ccxsBJK4.s 			page 78


 533:bluetooth_rxtx.c **** 		}
 2036              		.loc 1 533 0
 2037 04b4 0B60     		str	r3, [r1]
 2038 04b6 15E1     		b	.L202
 2039              	.LVL243:
 2040              	.L133:
 541:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 2041              		.loc 1 541 0
 2042 04b8 5F4B     		ldr	r3, .L254+4
 539:bluetooth_rxtx.c **** 
 2043              		.loc 1 539 0
 2044 04ba 0022     		movs	r2, #0
 2045              	.LVL244:
 2046 04bc 2260     		str	r2, [r4]
 541:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 2047              		.loc 1 541 0
 2048 04be DA72     		strb	r2, [r3, #11]
 542:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 2049              		.loc 1 542 0
 2050 04c0 0322     		movs	r2, #3
 2051 04c2 9A72     		strb	r2, [r3, #10]
 543:bluetooth_rxtx.c **** 
 2052              		.loc 1 543 0
 2053 04c4 0922     		movs	r2, #9
 2054 04c6 3FE0     		b	.L229
 2055              	.LVL245:
 2056              	.L134:
 192:bluetooth_rxtx.c **** 
 2057              		.loc 1 192 0
 2058 04c8 0023     		movs	r3, #0
 2059              	.LVL246:
 2060              	.L196:
 2061              	.LBB21:
 551:bluetooth_rxtx.c **** 		}
 2062              		.loc 1 551 0 discriminator 2
 2063 04ca 6649     		ldr	r1, .L254+48
 2064 04cc DA00     		lsls	r2, r3, #3
 2065 04ce 4968     		ldr	r1, [r1, #4]
 2066 04d0 21FA02F2 		lsr	r2, r1, r2
 2067 04d4 F254     		strb	r2, [r6, r3]
 550:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 2068              		.loc 1 550 0 discriminator 2
 2069 04d6 0133     		adds	r3, r3, #1
 2070              	.LVL247:
 2071 04d8 042B     		cmp	r3, #4
 2072 04da F6D1     		bne	.L196
 2073 04dc 59E6     		b	.L230
 2074              	.LVL248:
 2075              	.L135:
 2076              	.LBE21:
 557:bluetooth_rxtx.c **** 		le.target_set = 1;
 2077              		.loc 1 557 0
 2078 04de B378     		ldrb	r3, [r6, #2]	@ zero_extendqisi2
 2079 04e0 5278     		ldrb	r2, [r2, #1]	@ zero_extendqisi2
 2080              	.LVL249:
 2081 04e2 1B04     		lsls	r3, r3, #16
 2082 04e4 43EA0223 		orr	r3, r3, r2, lsl #8
ARM GAS  /tmp/ccxsBJK4.s 			page 79


 2083 04e8 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 2084 04ea F078     		ldrb	r0, [r6, #3]	@ zero_extendqisi2
 2085              	.LVL250:
 2086 04ec 1343     		orrs	r3, r3, r2
 2087 04ee 43EA0060 		orr	r0, r3, r0, lsl #24
 2088 04f2 FFF7FEFF 		bl	le_set_access_address
 2089              	.LVL251:
 558:bluetooth_rxtx.c **** 		break;
 2090              		.loc 1 558 0
 2091 04f6 0120     		movs	r0, #1
 2092 04f8 5A4B     		ldr	r3, .L254+48
 2093 04fa E7E0     		b	.L218
 2094              	.LVL252:
 2095              	.L137:
 568:bluetooth_rxtx.c **** 		data[1] = 0x37;
 2096              		.loc 1 568 0
 2097 04fc 1323     		movs	r3, #19
 2098 04fe 1370     		strb	r3, [r2]
 569:bluetooth_rxtx.c **** 		*data_len = 2;
 2099              		.loc 1 569 0
 2100 0500 3723     		movs	r3, #55
 2101              	.LVL253:
 2102              	.L250:
 2103 0502 7370     		strb	r3, [r6, #1]
 2104 0504 2FE0     		b	.L246
 2105              	.LVL254:
 2106              	.L138:
 574:bluetooth_rxtx.c **** 		*data_len = 1;
 2107              		.loc 1 574 0
 2108 0506 574B     		ldr	r3, .L254+48
 2109 0508 5B69     		ldr	r3, [r3, #20]
 2110 050a 0033     		adds	r3, r3, #0
 2111 050c 18BF     		it	ne
 2112 050e 0123     		movne	r3, #1
 2113 0510 E2E6     		b	.L221
 2114              	.L139:
 579:bluetooth_rxtx.c **** 		break;
 2115              		.loc 1 579 0
 2116 0512 0A88     		ldrh	r2, [r1]
 2117              	.LVL255:
 2118 0514 534B     		ldr	r3, .L254+48
 2119 0516 0032     		adds	r2, r2, #0
 2120 0518 18BF     		it	ne
 2121 051a 0122     		movne	r2, #1
 2122 051c 5A61     		str	r2, [r3, #20]
 2123 051e E1E0     		b	.L202
 2124              	.LVL256:
 2125              	.L140:
 583:bluetooth_rxtx.c **** 		if (p != NULL) {
 2126              		.loc 1 583 0
 2127 0520 FFF7FEFF 		bl	dequeue
 2128              	.LVL257:
 584:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 2129              		.loc 1 584 0
 2130 0524 0146     		mov	r1, r0
 2131 0526 28B1     		cbz	r0, .L197
 585:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
ARM GAS  /tmp/ccxsBJK4.s 			page 80


 2132              		.loc 1 585 0
 2133 0528 3046     		mov	r0, r6
 2134              	.LVL258:
 2135 052a 4022     		movs	r2, #64
 2136 052c FFF7FEFF 		bl	memcpy
 2137              	.LVL259:
 586:bluetooth_rxtx.c **** 		} else {
 2138              		.loc 1 586 0
 2139 0530 4023     		movs	r3, #64
 2140 0532 2EE6     		b	.L230
 2141              	.LVL260:
 2142              	.L197:
 588:bluetooth_rxtx.c **** 			*data_len = 1;
 2143              		.loc 1 588 0
 2144 0534 3070     		strb	r0, [r6]
 2145              	.LVL261:
 2146              	.L216:
 589:bluetooth_rxtx.c **** 		}
 2147              		.loc 1 589 0
 2148 0536 0120     		movs	r0, #1
 2149              	.L217:
 2150 0538 2060     		str	r0, [r4]
 2151 053a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2152              	.LVL262:
 2153              	.L141:
 596:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 2154              		.loc 1 596 0
 2155 053e 3E4B     		ldr	r3, .L254+4
 594:bluetooth_rxtx.c **** 
 2156              		.loc 1 594 0
 2157 0540 0022     		movs	r2, #0
 2158              	.LVL263:
 2159 0542 2260     		str	r2, [r4]
 596:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 2160              		.loc 1 596 0
 2161 0544 9A72     		strb	r2, [r3, #10]
 597:bluetooth_rxtx.c **** 
 2162              		.loc 1 597 0
 2163 0546 0A22     		movs	r2, #10
 2164              	.L229:
 2165 0548 9A74     		strb	r2, [r3, #18]
 599:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 2166              		.loc 1 599 0
 2167 054a FFF7FEFF 		bl	queue_init
 2168              	.LVL264:
 2169              	.L231:
 600:bluetooth_rxtx.c **** 		break;
 2170              		.loc 1 600 0
 2171 054e 454B     		ldr	r3, .L254+48
 2172 0550 1888     		ldrh	r0, [r3]
 2173              	.L234:
 2174 0552 80B2     		uxth	r0, r0
 2175 0554 FFF7FEFF 		bl	cs_threshold_calc_and_set
 2176              	.LVL265:
 2177 0558 C4E0     		b	.L202
 2178              	.LVL266:
 2179              	.L144:
ARM GAS  /tmp/ccxsBJK4.s 			page 81


 604:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 2180              		.loc 1 604 0
 2181 055a 0878     		ldrb	r0, [r1]	@ zero_extendqisi2
 2182              	.LVL267:
 2183 055c FFF7FEFF 		bl	cc2400_get
 2184              	.LVL268:
 605:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 2185              		.loc 1 605 0
 2186 0560 030A     		lsrs	r3, r0, #8
 2187 0562 3370     		strb	r3, [r6]
 606:bluetooth_rxtx.c **** 		*data_len = 2;
 2188              		.loc 1 606 0
 2189 0564 7070     		strb	r0, [r6, #1]
 2190              	.LVL269:
 2191              	.L246:
 607:bluetooth_rxtx.c **** 		break;
 2192              		.loc 1 607 0
 2193 0566 0223     		movs	r3, #2
 2194 0568 13E6     		b	.L230
 2195              	.LVL270:
 2196              	.L148:
 611:bluetooth_rxtx.c **** 		break;
 2197              		.loc 1 611 0
 2198 056a 0878     		ldrb	r0, [r1]	@ zero_extendqisi2
 2199              	.LVL271:
 2200 056c 4988     		ldrh	r1, [r1, #2]
 2201              	.LVL272:
 2202              	.L232:
 2203 056e FFF7FEFF 		bl	cc2400_set
 2204              	.LVL273:
 2205 0572 B7E0     		b	.L202
 2206              	.LVL274:
 2207              	.L167:
 615:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2208              		.loc 1 615 0 discriminator 1
 2209 0574 2B88     		ldrh	r3, [r5]
 2210 0576 A342     		cmp	r3, r4
 2211 0578 40F2B480 		bls	.L202
 616:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
 2212              		.loc 1 616 0 discriminator 2
 2213 057c 0323     		movs	r3, #3
 2214 057e 6343     		muls	r3, r4, r3
 2215              	.LVL275:
 2216 0580 F218     		adds	r2, r6, r3
 2217              	.LVL276:
 2218 0582 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
 2219 0584 9278     		ldrb	r2, [r2, #2]	@ zero_extendqisi2
 2220              	.LVL277:
 617:bluetooth_rxtx.c **** 		}
 2221              		.loc 1 617 0 discriminator 2
 2222 0586 F05C     		ldrb	r0, [r6, r3]	@ zero_extendqisi2
 2223 0588 42EA0121 		orr	r1, r2, r1, lsl #8
 615:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2224              		.loc 1 615 0 discriminator 2
 2225 058c 0134     		adds	r4, r4, #1
 2226              	.LVL278:
 617:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccxsBJK4.s 			page 82


 2227              		.loc 1 617 0 discriminator 2
 2228 058e FFF7FEFF 		bl	cc2400_set
 2229              	.LVL279:
 615:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2230              		.loc 1 615 0 discriminator 2
 2231 0592 E4B2     		uxtb	r4, r4
 2232              	.LVL280:
 2233 0594 EEE7     		b	.L167
 2234              	.LVL281:
 2235              	.L155:
 192:bluetooth_rxtx.c **** 
 2236              		.loc 1 192 0
 2237 0596 0025     		movs	r5, #0
 2238              	.LVL282:
 2239              	.L201:
 624:bluetooth_rxtx.c **** 			data[i*3] = i;
 2240              		.loc 1 624 0 discriminator 2
 2241 0598 2846     		mov	r0, r5
 2242 059a FFF7FEFF 		bl	cc2400_get
 2243              	.LVL283:
 625:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
 2244              		.loc 1 625 0 discriminator 2
 2245 059e 3570     		strb	r5, [r6]
 623:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2246              		.loc 1 623 0 discriminator 2
 2247 05a0 0135     		adds	r5, r5, #1
 2248              	.LVL284:
 2249 05a2 EDB2     		uxtb	r5, r5
 2250              	.LVL285:
 626:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2251              		.loc 1 626 0 discriminator 2
 2252 05a4 030A     		lsrs	r3, r0, #8
 623:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2253              		.loc 1 623 0 discriminator 2
 2254 05a6 2E2D     		cmp	r5, #46
 626:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2255              		.loc 1 626 0 discriminator 2
 2256 05a8 7370     		strb	r3, [r6, #1]
 627:bluetooth_rxtx.c **** 		}
 2257              		.loc 1 627 0 discriminator 2
 2258 05aa B070     		strb	r0, [r6, #2]
 2259 05ac 06F10306 		add	r6, r6, #3
 623:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2260              		.loc 1 623 0 discriminator 2
 2261 05b0 F2D1     		bne	.L201
 629:bluetooth_rxtx.c **** 		break;
 2262              		.loc 1 629 0
 2263 05b2 8723     		movs	r3, #135
 2264 05b4 EDE5     		b	.L230
 2265              	.LVL286:
 2266              	.L157:
 633:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2267              		.loc 1 633 0
 2268 05b6 9279     		ldrb	r2, [r2, #6]	@ zero_extendqisi2
 2269              	.LVL287:
 634:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2270              		.loc 1 634 0
ARM GAS  /tmp/ccxsBJK4.s 			page 83


 2271 05b8 2B48     		ldr	r0, .L254+52
 2272              	.LVL288:
 633:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2273              		.loc 1 633 0
 2274 05ba 0732     		adds	r2, r2, #7
 634:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2275              		.loc 1 634 0
 2276 05bc D2B2     		uxtb	r2, r2
 2277 05be 3146     		mov	r1, r6
 2278              	.LVL289:
 2279 05c0 FFF7FEFF 		bl	memcpy
 2280              	.LVL290:
 636:bluetooth_rxtx.c **** 		*data_len = 0;
 2281              		.loc 1 636 0
 2282 05c4 1022     		movs	r2, #16
 2283 05c6 5EE6     		b	.L245
 2284              	.LVL291:
 2285              	.L145:
 641:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 2286              		.loc 1 641 0
 2287 05c8 1B4C     		ldr	r4, .L254+4
 2288              	.LVL292:
 2289 05ca 1146     		mov	r1, r2
 2290              	.LVL293:
 2291 05cc 04F12000 		add	r0, r4, #32
 2292              	.LVL294:
 2293 05d0 0622     		movs	r2, #6
 2294              	.LVL295:
 2295 05d2 FFF7FEFF 		bl	memcpy
 2296              	.LVL296:
 642:bluetooth_rxtx.c **** 		break;
 2297              		.loc 1 642 0
 2298 05d6 0C23     		movs	r3, #12
 2299 05d8 62E0     		b	.L227
 2300              	.LVL297:
 2301              	.L159:
 647:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P0;
 2302              		.loc 1 647 0
 2303 05da 174C     		ldr	r4, .L254+4
 2304              	.LVL298:
 2305 05dc 1146     		mov	r1, r2
 2306              	.LVL299:
 2307 05de 04F12000 		add	r0, r4, #32
 2308              	.LVL300:
 2309 05e2 0622     		movs	r2, #6
 2310              	.LVL301:
 2311 05e4 FFF7FEFF 		bl	memcpy
 2312              	.LVL302:
 648:bluetooth_rxtx.c **** 		break;
 2313              		.loc 1 648 0
 2314 05e8 1123     		movs	r3, #17
 2315 05ea 59E0     		b	.L227
 2316              	.LVL303:
 2317              	.L160:
 651:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P1;
 2318              		.loc 1 651 0
 2319 05ec 124C     		ldr	r4, .L254+4
ARM GAS  /tmp/ccxsBJK4.s 			page 84


 2320              	.LVL304:
 2321 05ee 1146     		mov	r1, r2
 2322              	.LVL305:
 2323 05f0 04F12000 		add	r0, r4, #32
 2324              	.LVL306:
 2325 05f4 0622     		movs	r2, #6
 2326              	.LVL307:
 2327 05f6 FFF7FEFF 		bl	memcpy
 2328              	.LVL308:
 652:bluetooth_rxtx.c **** 		break;
 2329              		.loc 1 652 0
 2330 05fa 1223     		movs	r3, #18
 2331 05fc 50E0     		b	.L227
 2332              	.LVL309:
 2333              	.L161:
 655:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P2;
 2334              		.loc 1 655 0
 2335 05fe 0E4C     		ldr	r4, .L254+4
 2336              	.LVL310:
 2337 0600 1146     		mov	r1, r2
 2338              	.LVL311:
 2339 0602 04F12000 		add	r0, r4, #32
 2340              	.LVL312:
 2341 0606 0622     		movs	r2, #6
 2342              	.LVL313:
 2343 0608 FFF7FEFF 		bl	memcpy
 2344              	.LVL314:
 656:bluetooth_rxtx.c **** 		break;
 2345              		.loc 1 656 0
 2346 060c 1323     		movs	r3, #19
 2347 060e 47E0     		b	.L227
 2348              	.LVL315:
 2349              	.L162:
 659:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P3;
 2350              		.loc 1 659 0
 2351 0610 094C     		ldr	r4, .L254+4
 2352              	.LVL316:
 2353 0612 1146     		mov	r1, r2
 2354              	.LVL317:
 2355 0614 04F12000 		add	r0, r4, #32
 2356              	.LVL318:
 2357 0618 0622     		movs	r2, #6
 2358              	.LVL319:
 2359 061a FFF7FEFF 		bl	memcpy
 2360              	.LVL320:
 660:bluetooth_rxtx.c **** 		break;
 2361              		.loc 1 660 0
 2362 061e 1423     		movs	r3, #20
 2363 0620 3EE0     		b	.L227
 2364              	.LVL321:
 2365              	.L163:
 663:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P4;
 2366              		.loc 1 663 0
 2367 0622 054C     		ldr	r4, .L254+4
 2368              	.LVL322:
 2369 0624 1146     		mov	r1, r2
 2370              	.LVL323:
ARM GAS  /tmp/ccxsBJK4.s 			page 85


 2371 0626 04F12000 		add	r0, r4, #32
 2372              	.LVL324:
 2373 062a 0622     		movs	r2, #6
 2374              	.LVL325:
 2375 062c FFF7FEFF 		bl	memcpy
 2376              	.LVL326:
 664:bluetooth_rxtx.c **** 		break;
 2377              		.loc 1 664 0
 2378 0630 1523     		movs	r3, #21
 2379 0632 35E0     		b	.L227
 2380              	.L255:
 2381              		.align	2
 2382              	.L254:
 2383 0634 00000000 		.word	clkn_offset
 2384 0638 00000000 		.word	.LANCHOR0
 2385 063c 98C00920 		.word	537510040
 2386 0640 00000000 		.word	clk100ns_offset
 2387 0644 00000000 		.word	afh_map
 2388 0648 00000000 		.word	used_channels
 2389 064c 00000000 		.word	afh_enabled
 2390 0650 00000000 		.word	clkn
 2391 0654 00000000 		.word	clk_drift_ppm
 2392 0658 00000000 		.word	clkn_next_drift_fix
 2393 065c 00000000 		.word	clk_drift_correction
 2394 0660 00000000 		.word	clkn_last_drift_fix
 2395 0664 00000000 		.word	.LANCHOR1
 2396 0668 00000000 		.word	tx_pkt
 2397              	.LVL327:
 2398              	.L164:
 667:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P5;
 2399              		.loc 1 667 0
 2400 066c 204C     		ldr	r4, .L256
 2401              	.LVL328:
 2402 066e 1146     		mov	r1, r2
 2403              	.LVL329:
 2404 0670 04F12000 		add	r0, r4, #32
 2405              	.LVL330:
 2406 0674 0622     		movs	r2, #6
 2407              	.LVL331:
 2408 0676 FFF7FEFF 		bl	memcpy
 2409              	.LVL332:
 668:bluetooth_rxtx.c **** 		break;
 2410              		.loc 1 668 0
 2411 067a 1623     		movs	r3, #22
 2412 067c 10E0     		b	.L227
 2413              	.LVL333:
 2414              	.L165:
 671:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P6;
 2415              		.loc 1 671 0
 2416 067e 1C4C     		ldr	r4, .L256
 2417              	.LVL334:
 2418 0680 1146     		mov	r1, r2
 2419              	.LVL335:
 2420 0682 04F12000 		add	r0, r4, #32
 2421              	.LVL336:
 2422 0686 0622     		movs	r2, #6
 2423              	.LVL337:
ARM GAS  /tmp/ccxsBJK4.s 			page 86


 2424 0688 FFF7FEFF 		bl	memcpy
 2425              	.LVL338:
 672:bluetooth_rxtx.c **** 		break;
 2426              		.loc 1 672 0
 2427 068c 1723     		movs	r3, #23
 2428 068e 07E0     		b	.L227
 2429              	.LVL339:
 2430              	.L166:
 675:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE_P7;
 2431              		.loc 1 675 0
 2432 0690 174C     		ldr	r4, .L256
 2433              	.LVL340:
 2434 0692 1146     		mov	r1, r2
 2435              	.LVL341:
 2436 0694 04F12000 		add	r0, r4, #32
 2437              	.LVL342:
 2438 0698 0622     		movs	r2, #6
 2439              	.LVL343:
 2440 069a FFF7FEFF 		bl	memcpy
 2441              	.LVL344:
 676:bluetooth_rxtx.c **** 		break;
 2442              		.loc 1 676 0
 2443 069e 1823     		movs	r3, #24
 2444              	.L227:
 2445 06a0 A374     		strb	r3, [r4, #18]
 2446 06a2 1FE0     		b	.L202
 2447              	.LVL345:
 2448              	.L147:
 683:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 2449              		.loc 1 683 0
 2450 06a4 5279     		ldrb	r2, [r2, #5]	@ zero_extendqisi2
 2451              	.LVL346:
 2452 06a6 134B     		ldr	r3, .L256+4
 689:bluetooth_rxtx.c **** 		break;
 2453              		.loc 1 689 0
 2454 06a8 0120     		movs	r0, #1
 2455              	.LVL347:
 683:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 2456              		.loc 1 683 0
 2457 06aa 83F83820 		strb	r2, [r3, #56]
 684:bluetooth_rxtx.c **** 		le.target[2] = data[3];
 2458              		.loc 1 684 0
 2459 06ae 3279     		ldrb	r2, [r6, #4]	@ zero_extendqisi2
 2460 06b0 83F83920 		strb	r2, [r3, #57]
 685:bluetooth_rxtx.c **** 		le.target[3] = data[2];
 2461              		.loc 1 685 0
 2462 06b4 F278     		ldrb	r2, [r6, #3]	@ zero_extendqisi2
 2463 06b6 83F83A20 		strb	r2, [r3, #58]
 686:bluetooth_rxtx.c **** 		le.target[4] = data[1];
 2464              		.loc 1 686 0
 2465 06ba B278     		ldrb	r2, [r6, #2]	@ zero_extendqisi2
 2466 06bc 83F83B20 		strb	r2, [r3, #59]
 687:bluetooth_rxtx.c **** 		le.target[5] = data[0];
 2467              		.loc 1 687 0
 2468 06c0 7278     		ldrb	r2, [r6, #1]	@ zero_extendqisi2
 2469 06c2 83F83C20 		strb	r2, [r3, #60]
 688:bluetooth_rxtx.c **** 		le.target_set = 1;
ARM GAS  /tmp/ccxsBJK4.s 			page 87


 2470              		.loc 1 688 0
 2471 06c6 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 2472 06c8 83F83D20 		strb	r2, [r3, #61]
 2473              	.LVL348:
 2474              	.L218:
 689:bluetooth_rxtx.c **** 		break;
 2475              		.loc 1 689 0
 2476 06cc 1864     		str	r0, [r3, #64]
 690:bluetooth_rxtx.c **** 
 2477              		.loc 1 690 0
 2478 06ce BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2479              	.LVL349:
 2480              	.L149:
 694:bluetooth_rxtx.c **** 		break;
 2481              		.loc 1 694 0
 2482 06d2 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 2483              	.LVL350:
 2484 06d4 064B     		ldr	r3, .L256
 2485 06d6 DA74     		strb	r2, [r3, #19]
 2486 06d8 04E0     		b	.L202
 2487              	.LVL351:
 2488              	.L150:
 703:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 2489              		.loc 1 703 0
 2490 06da 054B     		ldr	r3, .L256
 2491 06dc 0D22     		movs	r2, #13
 2492              	.LVL352:
 2493 06de 9A74     		strb	r2, [r3, #18]
 704:bluetooth_rxtx.c **** 		break;
 2494              		.loc 1 704 0
 2495 06e0 0A78     		ldrb	r2, [r1]	@ zero_extendqisi2
 2496 06e2 1A75     		strb	r2, [r3, #20]
 2497              	.LVL353:
 2498              	.L202:
 710:bluetooth_rxtx.c **** }
 2499              		.loc 1 710 0
 2500 06e4 0120     		movs	r0, #1
 2501 06e6 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2502              	.LVL354:
 2503              	.L209:
 309:bluetooth_rxtx.c **** 		}
 2504              		.loc 1 309 0
 2505 06ea 0020     		movs	r0, #0
 711:bluetooth_rxtx.c **** 
 2506              		.loc 1 711 0
 2507 06ec BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2508              	.LVL355:
 2509              	.L257:
 2510              		.align	2
 2511              	.L256:
 2512 06f0 00000000 		.word	.LANCHOR0
 2513 06f4 00000000 		.word	.LANCHOR1
 2514              		.cfi_endproc
 2515              	.LFE2:
 2517              		.section	.text.enqueue_with_ts,"ax",%progbits
 2518              		.align	1
 2519              		.global	enqueue_with_ts
ARM GAS  /tmp/ccxsBJK4.s 			page 88


 2520              		.thumb
 2521              		.thumb_func
 2523              	enqueue_with_ts:
 2524              	.LFB1:
 158:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2525              		.loc 1 158 0
 2526              		.cfi_startproc
 2527              		@ args = 0, pretend = 0, frame = 0
 2528              		@ frame_needed = 0, uses_anonymous_args = 0
 2529              	.LVL356:
 2530 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2531              		.cfi_def_cfa_offset 24
 2532              		.cfi_offset 4, -24
 2533              		.cfi_offset 5, -20
 2534              		.cfi_offset 6, -16
 2535              		.cfi_offset 7, -12
 2536              		.cfi_offset 8, -8
 2537              		.cfi_offset 14, -4
 158:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2538              		.loc 1 158 0
 2539 0004 0646     		mov	r6, r0
 2540 0006 0F46     		mov	r7, r1
 2541 0008 9046     		mov	r8, r2
 159:bluetooth_rxtx.c **** 
 2542              		.loc 1 159 0
 2543 000a FFF7FEFF 		bl	usb_enqueue
 2544              	.LVL357:
 2545 000e 104D     		ldr	r5, .L261
 162:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 2546              		.loc 1 162 0
 2547 0010 0446     		mov	r4, r0
 2548 0012 28B9     		cbnz	r0, .L259
 163:bluetooth_rxtx.c **** 		return 0;
 2549              		.loc 1 163 0
 2550 0014 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 2551 0016 43F00403 		orr	r3, r3, #4
 2552 001a 6B70     		strb	r3, [r5, #1]
 164:bluetooth_rxtx.c **** 	}
 2553              		.loc 1 164 0
 2554 001c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2555              	.LVL358:
 2556              	.L259:
 172:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2557              		.loc 1 172 0
 2558 0020 0C4B     		ldr	r3, .L261+4
 167:bluetooth_rxtx.c **** 
 2559              		.loc 1 167 0
 2560 0022 0670     		strb	r6, [r0]
 172:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2561              		.loc 1 172 0
 2562 0024 1B88     		ldrh	r3, [r3]
 169:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2563              		.loc 1 169 0
 2564 0026 0026     		movs	r6, #0
 172:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2565              		.loc 1 172 0
 2566 0028 9BB2     		uxth	r3, r3
ARM GAS  /tmp/ccxsBJK4.s 			page 89


 2567 002a 623B     		subs	r3, r3, #98
 169:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2568              		.loc 1 169 0
 2569 002c C670     		strb	r6, [r0, #3]
 170:bluetooth_rxtx.c **** 
 2570              		.loc 1 170 0
 2571 002e C0F80480 		str	r8, [r0, #4]
 172:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2572              		.loc 1 172 0
 2573 0032 8370     		strb	r3, [r0, #2]
 173:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 2574              		.loc 1 173 0
 2575 0034 8672     		strb	r6, [r0, #10]
 174:bluetooth_rxtx.c **** 
 2576              		.loc 1 174 0
 2577 0036 C672     		strb	r6, [r0, #11]
 176:bluetooth_rxtx.c **** 
 2578              		.loc 1 176 0
 2579 0038 3946     		mov	r1, r7
 2580 003a 3222     		movs	r2, #50
 2581 003c 0E30     		adds	r0, r0, #14
 2582              	.LVL359:
 2583 003e FFF7FEFF 		bl	memcpy
 2584              	.LVL360:
 178:bluetooth_rxtx.c **** 	status = 0;
 2585              		.loc 1 178 0
 2586 0042 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 179:bluetooth_rxtx.c **** 
 2587              		.loc 1 179 0
 2588 0044 6E70     		strb	r6, [r5, #1]
 178:bluetooth_rxtx.c **** 	status = 0;
 2589              		.loc 1 178 0
 2590 0046 6370     		strb	r3, [r4, #1]
 181:bluetooth_rxtx.c **** }
 2591              		.loc 1 181 0
 2592 0048 0120     		movs	r0, #1
 182:bluetooth_rxtx.c **** 
 2593              		.loc 1 182 0
 2594 004a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2595              	.LVL361:
 2596              	.L262:
 2597 004e 00BF     		.align	2
 2598              	.L261:
 2599 0050 00000000 		.word	.LANCHOR0
 2600 0054 00000000 		.word	.LANCHOR1
 2601              		.cfi_endproc
 2602              	.LFE1:
 2604              		.section	.text.TIMER0_IRQHandler,"ax",%progbits
 2605              		.align	1
 2606              		.global	TIMER0_IRQHandler
 2607              		.thumb
 2608              		.thumb_func
 2610              	TIMER0_IRQHandler:
 2611              	.LFB3:
 715:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 2612              		.loc 1 715 0
 2613              		.cfi_startproc
ARM GAS  /tmp/ccxsBJK4.s 			page 90


 2614              		@ args = 0, pretend = 0, frame = 0
 2615              		@ frame_needed = 0, uses_anonymous_args = 0
 2616 0000 70B5     		push	{r4, r5, r6, lr}
 2617              		.cfi_def_cfa_offset 16
 2618              		.cfi_offset 4, -16
 2619              		.cfi_offset 5, -12
 2620              		.cfi_offset 6, -8
 2621              		.cfi_offset 14, -4
 716:bluetooth_rxtx.c **** 
 2622              		.loc 1 716 0
 2623 0002 4FF04023 		mov	r3, #1073758208
 2624 0006 1B68     		ldr	r3, [r3]
 2625 0008 DB07     		lsls	r3, r3, #31
 2626 000a 7FD5     		bpl	.L263
 2627              	.LBB22:
 718:bluetooth_rxtx.c **** 		clkn_offset = 0;
 2628              		.loc 1 718 0
 2629 000c 4049     		ldr	r1, .L286
 2630 000e 414B     		ldr	r3, .L286+4
 2631 0010 0868     		ldr	r0, [r1]
 2632 0012 1A68     		ldr	r2, [r3]
 2633 0014 0244     		add	r2, r2, r0
 2634 0016 0132     		adds	r2, r2, #1
 2635 0018 0A60     		str	r2, [r1]
 719:bluetooth_rxtx.c **** 
 2636              		.loc 1 719 0
 2637 001a 0022     		movs	r2, #0
 2638 001c 1A60     		str	r2, [r3]
 726:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2639              		.loc 1 726 0
 2640 001e 3E4A     		ldr	r2, .L286+8
 721:bluetooth_rxtx.c **** 
 2641              		.loc 1 721 0
 2642 0020 0C68     		ldr	r4, [r1]
 2643 0022 3E4B     		ldr	r3, .L286+12
 726:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2644              		.loc 1 726 0
 2645 0024 967A     		ldrb	r6, [r2, #10]	@ zero_extendqisi2
 721:bluetooth_rxtx.c **** 
 2646              		.loc 1 721 0
 2647 0026 D869     		ldr	r0, [r3, #28]
 2648              	.LVL362:
 2649 0028 1546     		mov	r5, r2
 726:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2650              		.loc 1 726 0
 2651 002a 16B1     		cbz	r6, .L265
 726:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2652              		.loc 1 726 0 is_stmt 0 discriminator 1
 2653 002c 967A     		ldrb	r6, [r2, #10]	@ zero_extendqisi2
 2654 002e 012E     		cmp	r6, #1
 2655 0030 05D1     		bne	.L266
 2656              	.L265:
 727:bluetooth_rxtx.c **** 				do_hop = 1;
 2657              		.loc 1 727 0 is_stmt 1
 2658 0032 0B68     		ldr	r3, [r1]
 2659 0034 5E06     		lsls	r6, r3, #25
 2660 0036 37D1     		bne	.L267
ARM GAS  /tmp/ccxsBJK4.s 			page 91


 728:bluetooth_rxtx.c **** 		}
 2661              		.loc 1 728 0
 2662 0038 0123     		movs	r3, #1
 2663 003a EB72     		strb	r3, [r5, #11]
 2664 003c 34E0     		b	.L267
 2665              	.L266:
 731:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 2666              		.loc 1 731 0
 2667 003e 957A     		ldrb	r5, [r2, #10]	@ zero_extendqisi2
 2668 0040 022D     		cmp	r5, #2
 2669 0042 03D1     		bne	.L268
 732:bluetooth_rxtx.c **** 				do_hop = 1;
 2670              		.loc 1 732 0
 2671 0044 0B68     		ldr	r3, [r1]
 2672 0046 DC07     		lsls	r4, r3, #31
 2673              	.LVL363:
 2674 0048 2ED4     		bmi	.L267
 2675 004a 2BE0     		b	.L284
 2676              	.LVL364:
 2677              	.L268:
 736:bluetooth_rxtx.c **** 			// Only hop if connected
 2678              		.loc 1 736 0
 2679 004c 957A     		ldrb	r5, [r2, #10]	@ zero_extendqisi2
 2680 004e 032D     		cmp	r5, #3
 2681 0050 1CD1     		bne	.L269
 738:bluetooth_rxtx.c **** 				--le.interval_timer;
 2682              		.loc 1 738 0
 2683 0052 1D7E     		ldrb	r5, [r3, #24]	@ zero_extendqisi2
 2684 0054 032D     		cmp	r5, #3
 2685 0056 27D1     		bne	.L267
 721:bluetooth_rxtx.c **** 
 2686              		.loc 1 721 0 discriminator 1
 2687 0058 201A     		subs	r0, r4, r0
 2688              	.LVL365:
 738:bluetooth_rxtx.c **** 				--le.interval_timer;
 2689              		.loc 1 738 0 discriminator 1
 2690 005a 8007     		lsls	r0, r0, #30
 2691 005c 24D1     		bne	.L267
 739:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 2692              		.loc 1 739 0
 2693 005e 188C     		ldrh	r0, [r3, #32]
 2694 0060 80B2     		uxth	r0, r0
 2695 0062 0138     		subs	r0, r0, #1
 2696 0064 80B2     		uxth	r0, r0
 2697 0066 1884     		strh	r0, [r3, #32]	@ movhi
 740:bluetooth_rxtx.c **** 					do_hop = 1;
 2698              		.loc 1 740 0
 2699 0068 188C     		ldrh	r0, [r3, #32]
 2700 006a 80B2     		uxth	r0, r0
 2701 006c 48B9     		cbnz	r0, .L270
 741:bluetooth_rxtx.c **** 					++le.conn_count;
 2702              		.loc 1 741 0
 2703 006e 0120     		movs	r0, #1
 2704 0070 D072     		strb	r0, [r2, #11]
 742:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 2705              		.loc 1 742 0
 2706 0072 9A8C     		ldrh	r2, [r3, #36]
ARM GAS  /tmp/ccxsBJK4.s 			page 92


 2707 0074 92B2     		uxth	r2, r2
 2708 0076 0244     		add	r2, r2, r0
 2709 0078 92B2     		uxth	r2, r2
 2710 007a 9A84     		strh	r2, [r3, #36]	@ movhi
 743:bluetooth_rxtx.c **** 				} else {
 2711              		.loc 1 743 0
 2712 007c 5A8C     		ldrh	r2, [r3, #34]
 2713 007e 1A84     		strh	r2, [r3, #32]	@ movhi
 2714 0080 12E0     		b	.L267
 2715              	.L270:
 745:bluetooth_rxtx.c **** 				}
 2716              		.loc 1 745 0
 2717 0082 274B     		ldr	r3, .L286+16
 2718 0084 4FF48072 		mov	r2, #256
 2719 0088 1A60     		str	r2, [r3]
 2720 008a 0DE0     		b	.L267
 2721              	.LVL366:
 2722              	.L269:
 749:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
 2723              		.loc 1 749 0
 2724 008c 907A     		ldrb	r0, [r2, #10]	@ zero_extendqisi2
 2725              	.LVL367:
 2726 008e 0528     		cmp	r0, #5
 2727 0090 0AD1     		bne	.L267
 750:bluetooth_rxtx.c **** 				do_hop = 1;
 2728              		.loc 1 750 0
 2729 0092 2448     		ldr	r0, .L286+20
 2730 0094 0468     		ldr	r4, [r0]
 2731              	.LVL368:
 2732 0096 B3F84800 		ldrh	r0, [r3, #72]
 2733 009a 0B68     		ldr	r3, [r1]
 2734 009c 80B2     		uxth	r0, r0
 2735 009e 2044     		add	r0, r0, r4
 2736 00a0 9842     		cmp	r0, r3
 2737 00a2 01D1     		bne	.L267
 2738              	.L284:
 751:bluetooth_rxtx.c **** 			}
 2739              		.loc 1 751 0
 2740 00a4 0123     		movs	r3, #1
 2741 00a6 D372     		strb	r3, [r2, #11]
 2742              	.L267:
 756:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2743              		.loc 1 756 0
 2744 00a8 1F4A     		ldr	r2, .L286+24
 2745 00aa 204B     		ldr	r3, .L286+28
 2746 00ac 1068     		ldr	r0, [r2]
 2747 00ae C0B1     		cbz	r0, .L271
 756:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2748              		.loc 1 756 0 is_stmt 0 discriminator 1
 2749 00b0 1888     		ldrh	r0, [r3]
 2750 00b2 80B2     		uxth	r0, r0
 2751 00b4 A8B9     		cbnz	r0, .L271
 757:bluetooth_rxtx.c **** 
 2752              		.loc 1 757 0 is_stmt 1
 2753 00b6 0C68     		ldr	r4, [r1]
 2754 00b8 1068     		ldr	r0, [r2]
 2755 00ba 8442     		cmp	r4, r0
ARM GAS  /tmp/ccxsBJK4.s 			page 93


 2756 00bc 11D3     		bcc	.L271
 760:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 2757              		.loc 1 760 0
 2758 00be 1C48     		ldr	r0, .L286+32
 2759 00c0 0088     		ldrh	r0, [r0]
 2760 00c2 00B2     		sxth	r0, r0
 2761 00c4 0028     		cmp	r0, #0
 761:bluetooth_rxtx.c **** 				}
 2762              		.loc 1 761 0
 2763 00c6 ACBF     		ite	ge
 2764 00c8 0120     		movge	r0, #1
 766:bluetooth_rxtx.c **** 				}
 2765              		.loc 1 766 0
 2766 00ca 41F66900 		movwlt	r0, #6249
 2767 00ce 1880     		strh	r0, [r3]	@ movhi
 768:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2768              		.loc 1 768 0
 2769 00d0 0C68     		ldr	r4, [r1]
 2770 00d2 1848     		ldr	r0, .L286+36
 2771 00d4 0460     		str	r4, [r0]
 769:bluetooth_rxtx.c **** 			}
 2772              		.loc 1 769 0
 2773 00d6 0468     		ldr	r4, [r0]
 2774 00d8 1748     		ldr	r0, .L286+40
 2775 00da 0088     		ldrh	r0, [r0]
 2776 00dc 80B2     		uxth	r0, r0
 2777 00de 2044     		add	r0, r0, r4
 2778 00e0 1060     		str	r0, [r2]
 2779              	.L271:
 774:bluetooth_rxtx.c **** 			clkn += 2;
 2780              		.loc 1 774 0
 2781 00e2 1888     		ldrh	r0, [r3]
 2782 00e4 40F63442 		movw	r2, #3124
 2783 00e8 80B2     		uxth	r0, r0
 2784 00ea 9042     		cmp	r0, r2
 2785 00ec 02D9     		bls	.L274
 775:bluetooth_rxtx.c **** 
 2786              		.loc 1 775 0
 2787 00ee 0A68     		ldr	r2, [r1]
 2788 00f0 0232     		adds	r2, r2, #2
 2789 00f2 0A60     		str	r2, [r1]
 2790              	.L274:
 777:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
 2791              		.loc 1 777 0
 2792 00f4 1988     		ldrh	r1, [r3]
 2793 00f6 114A     		ldr	r2, .L286+44
 2794 00f8 89B2     		uxth	r1, r1
 2795 00fa 01F63441 		addw	r1, r1, #3124
 2796 00fe 1160     		str	r1, [r2]
 778:bluetooth_rxtx.c **** 
 2797              		.loc 1 778 0
 2798 0100 0022     		movs	r2, #0
 2799 0102 1A80     		strh	r2, [r3]	@ movhi
 781:bluetooth_rxtx.c **** 	}
 2800              		.loc 1 781 0
 2801 0104 0122     		movs	r2, #1
 2802 0106 4FF04023 		mov	r3, #1073758208
ARM GAS  /tmp/ccxsBJK4.s 			page 94


 2803 010a 1A60     		str	r2, [r3]
 2804              	.L263:
 2805 010c 70BD     		pop	{r4, r5, r6, pc}
 2806              	.L287:
 2807 010e 00BF     		.align	2
 2808              	.L286:
 2809 0110 00000000 		.word	clkn
 2810 0114 00000000 		.word	clkn_offset
 2811 0118 00000000 		.word	.LANCHOR0
 2812 011c 00000000 		.word	.LANCHOR1
 2813 0120 3CC00920 		.word	537509948
 2814 0124 00000000 		.word	last_hop
 2815 0128 00000000 		.word	clkn_next_drift_fix
 2816 012c 00000000 		.word	clk100ns_offset
 2817 0130 00000000 		.word	clk_drift_ppm
 2818 0134 00000000 		.word	clkn_last_drift_fix
 2819 0138 00000000 		.word	clk_drift_correction
 2820 013c 18400040 		.word	1073758232
 2821              	.LBE22:
 2822              		.cfi_endproc
 2823              	.LFE3:
 2825              		.section	.text.EINT3_IRQHandler,"ax",%progbits
 2826              		.align	1
 2827              		.global	EINT3_IRQHandler
 2828              		.thumb
 2829              		.thumb_func
 2831              	EINT3_IRQHandler:
 2832              	.LFB4:
 788:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 2833              		.loc 1 788 0
 2834              		.cfi_startproc
 2835              		@ args = 0, pretend = 0, frame = 0
 2836              		@ frame_needed = 0, uses_anonymous_args = 0
 2837              		@ link register save eliminated.
 790:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 2838              		.loc 1 790 0
 2839 0000 084B     		ldr	r3, .L290
 2840 0002 0422     		movs	r2, #4
 2841 0004 1A60     		str	r2, [r3]
 791:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 2842              		.loc 1 791 0
 2843 0006 084B     		ldr	r3, .L290+4
 2844 0008 4FF08052 		mov	r2, #268435456
 2845 000c 1A60     		str	r2, [r3]
 792:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 2846              		.loc 1 792 0
 2847 000e 074B     		ldr	r3, .L290+8
 2848 0010 0122     		movs	r2, #1
 2849 0012 1A70     		strb	r2, [r3]
 793:bluetooth_rxtx.c **** 		dma_discard = 0;
 2850              		.loc 1 793 0
 2851 0014 064B     		ldr	r3, .L290+12
 2852 0016 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 2853 0018 022A     		cmp	r2, #2
 794:bluetooth_rxtx.c **** 
 2854              		.loc 1 794 0
 2855 001a 04BF     		itt	eq
ARM GAS  /tmp/ccxsBJK4.s 			page 95


 2856 001c 0022     		moveq	r2, #0
 2857 001e 1A74     		strbeq	r2, [r3, #16]
 2858 0020 7047     		bx	lr
 2859              	.L291:
 2860 0022 00BF     		.align	2
 2861              	.L290:
 2862 0024 AC800240 		.word	1073905836
 2863 0028 9CC00920 		.word	537510044
 2864 002c 00000000 		.word	cs_trigger
 2865 0030 00000000 		.word	.LANCHOR0
 2866              		.cfi_endproc
 2867              	.LFE4:
 2869              		.section	.text.DMA_IRQHandler,"ax",%progbits
 2870              		.align	1
 2871              		.global	DMA_IRQHandler
 2872              		.thumb
 2873              		.thumb_func
 2875              	DMA_IRQHandler:
 2876              	.LFB6:
 818:bluetooth_rxtx.c **** 	if ( mode == MODE_RX_SYMBOLS
 2877              		.loc 1 818 0
 2878              		.cfi_startproc
 2879              		@ args = 0, pretend = 0, frame = 0
 2880              		@ frame_needed = 0, uses_anonymous_args = 0
 2881 0000 10B5     		push	{r4, lr}
 2882              		.cfi_def_cfa_offset 8
 2883              		.cfi_offset 4, -8
 2884              		.cfi_offset 14, -4
 819:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
 2885              		.loc 1 819 0
 2886 0002 344B     		ldr	r3, .L352
 2887 0004 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2888 0006 012A     		cmp	r2, #1
 2889 0008 29D0     		beq	.L293
 820:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 2890              		.loc 1 820 0
 2891 000a 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2892 000c 082A     		cmp	r2, #8
 2893 000e 26D0     		beq	.L293
 821:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 2894              		.loc 1 821 0
 2895 0010 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2896 0012 042A     		cmp	r2, #4
 2897 0014 23D0     		beq	.L293
 822:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 2898              		.loc 1 822 0
 2899 0016 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2900 0018 092A     		cmp	r2, #9
 2901 001a 20D0     		beq	.L293
 823:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
 2902              		.loc 1 823 0
 2903 001c 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2904 001e 0A2A     		cmp	r2, #10
 2905 0020 1DD0     		beq	.L293
 824:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P0
 2906              		.loc 1 824 0
 2907 0022 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
ARM GAS  /tmp/ccxsBJK4.s 			page 96


 2908 0024 0C2A     		cmp	r2, #12
 2909 0026 1AD0     		beq	.L293
 825:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P1
 2910              		.loc 1 825 0
 2911 0028 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2912 002a 112A     		cmp	r2, #17
 2913 002c 17D0     		beq	.L293
 826:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P2
 2914              		.loc 1 826 0
 2915 002e 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2916 0030 122A     		cmp	r2, #18
 2917 0032 14D0     		beq	.L293
 827:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P3
 2918              		.loc 1 827 0
 2919 0034 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2920 0036 132A     		cmp	r2, #19
 2921 0038 11D0     		beq	.L293
 828:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P4
 2922              		.loc 1 828 0
 2923 003a 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2924 003c 142A     		cmp	r2, #20
 2925 003e 0ED0     		beq	.L293
 829:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P5
 2926              		.loc 1 829 0
 2927 0040 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2928 0042 1529     		cmp	r1, #21
 2929 0044 0BD0     		beq	.L293
 830:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P6
 2930              		.loc 1 830 0
 2931 0046 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2932 0048 1629     		cmp	r1, #22
 2933 004a 08D0     		beq	.L293
 831:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE_P7
 2934              		.loc 1 831 0
 2935 004c 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2936 004e 1729     		cmp	r1, #23
 2937 0050 05D0     		beq	.L293
 832:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 2938              		.loc 1 832 0
 2939 0052 597C     		ldrb	r1, [r3, #17]	@ zero_extendqisi2
 2940 0054 1829     		cmp	r1, #24
 2941 0056 02D0     		beq	.L293
 833:bluetooth_rxtx.c **** 	{
 2942              		.loc 1 833 0
 2943 0058 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2944 005a 0F2A     		cmp	r2, #15
 2945 005c 39D1     		bne	.L292
 2946              	.L293:
 836:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 2947              		.loc 1 836 0
 2948 005e 1E4A     		ldr	r2, .L352+4
 2949 0060 1268     		ldr	r2, [r2]
 2950 0062 D007     		lsls	r0, r2, #31
 2951 0064 35D5     		bpl	.L292
 837:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 2952              		.loc 1 837 0
 2953 0066 1D4A     		ldr	r2, .L352+8
ARM GAS  /tmp/ccxsBJK4.s 			page 97


 2954 0068 1268     		ldr	r2, [r2]
 2955 006a D107     		lsls	r1, r2, #31
 2956 006c 26D5     		bpl	.L296
 2957              	.LBB23:
 838:bluetooth_rxtx.c **** 
 2958              		.loc 1 838 0
 2959 006e 1C4A     		ldr	r2, .L352+12
 2960 0070 0121     		movs	r1, #1
 2961 0072 1160     		str	r1, [r2]
 840:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 2962              		.loc 1 840 0
 2963 0074 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 2964 0076 022A     		cmp	r2, #2
 2965 0078 03D1     		bne	.L297
 841:bluetooth_rxtx.c **** 
 2966              		.loc 1 841 0
 2967 007a 1A4A     		ldr	r2, .L352+16
 2968 007c 4FF08051 		mov	r1, #268435456
 2969 0080 1160     		str	r1, [r2]
 2970              	.L297:
 843:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 2971              		.loc 1 843 0
 2972 0082 194A     		ldr	r2, .L352+20
 2973 0084 1948     		ldr	r0, .L352+24
 2974 0086 1168     		ldr	r1, [r2]
 2975 0088 0068     		ldr	r0, [r0]
 2976 008a C1F31301 		ubfx	r1, r1, #0, #20
 2977 008e 40F63544 		movw	r4, #3125
 2978 0092 04FB0101 		mla	r1, r4, r1, r0
 2979 0096 5960     		str	r1, [r3, #4]
 844:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 2980              		.loc 1 844 0
 2981 0098 1268     		ldr	r2, [r2]
 2982 009a C2F30752 		ubfx	r2, r2, #20, #8
 2983 009e 9A70     		strb	r2, [r3, #2]
 845:bluetooth_rxtx.c **** 
 2984              		.loc 1 845 0
 2985 00a0 134A     		ldr	r2, .L352+28
 2986 00a2 1288     		ldrh	r2, [r2]
 2987 00a4 92B2     		uxth	r2, r2
 2988 00a6 1A81     		strh	r2, [r3, #8]	@ movhi
 848:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 2989              		.loc 1 848 0
 2990 00a8 124A     		ldr	r2, .L352+32
 849:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 2991              		.loc 1 849 0
 2992 00aa 134B     		ldr	r3, .L352+36
 848:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 2993              		.loc 1 848 0
 2994 00ac 1168     		ldr	r1, [r2]
 2995              	.LVL369:
 849:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 2996              		.loc 1 849 0
 2997 00ae 1868     		ldr	r0, [r3]
 2998 00b0 1060     		str	r0, [r2]
 850:bluetooth_rxtx.c **** 
 2999              		.loc 1 850 0
ARM GAS  /tmp/ccxsBJK4.s 			page 98


 3000 00b2 1960     		str	r1, [r3]
 852:bluetooth_rxtx.c **** 			}
 3001              		.loc 1 852 0
 3002 00b4 114B     		ldr	r3, .L352+40
 3003 00b6 1A68     		ldr	r2, [r3]
 3004 00b8 0132     		adds	r2, r2, #1
 3005 00ba 1A60     		str	r2, [r3]
 3006              	.LVL370:
 3007              	.L296:
 3008              	.LBE23:
 854:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 3009              		.loc 1 854 0
 3010 00bc 104B     		ldr	r3, .L352+44
 3011 00be 1B68     		ldr	r3, [r3]
 3012 00c0 DA07     		lsls	r2, r3, #31
 3013 00c2 06D5     		bpl	.L292
 855:bluetooth_rxtx.c **** 				++rx_err;
 3014              		.loc 1 855 0
 3015 00c4 0F4B     		ldr	r3, .L352+48
 3016 00c6 0122     		movs	r2, #1
 3017 00c8 1A60     		str	r2, [r3]
 856:bluetooth_rxtx.c **** 			}
 3018              		.loc 1 856 0
 3019 00ca 0F4B     		ldr	r3, .L352+52
 3020 00cc 1A68     		ldr	r2, [r3]
 3021 00ce 0132     		adds	r2, r2, #1
 3022 00d0 1A60     		str	r2, [r3]
 3023              	.L292:
 3024 00d2 10BD     		pop	{r4, pc}
 3025              	.L353:
 3026              		.align	2
 3027              	.L352:
 3028 00d4 00000000 		.word	.LANCHOR0
 3029 00d8 00400050 		.word	1342193664
 3030 00dc 04400050 		.word	1342193668
 3031 00e0 08400050 		.word	1342193672
 3032 00e4 98C00920 		.word	537510040
 3033 00e8 00000000 		.word	clkn
 3034 00ec 08400040 		.word	1073758216
 3035 00f0 00000000 		.word	.LANCHOR1
 3036 00f4 00000000 		.word	active_rxbuf
 3037 00f8 00000000 		.word	idle_rxbuf
 3038 00fc 00000000 		.word	rx_tc
 3039 0100 0C400050 		.word	1342193676
 3040 0104 10400050 		.word	1342193680
 3041 0108 00000000 		.word	rx_err
 3042              		.cfi_endproc
 3043              	.LFE6:
 3045              		.section	.text.le_transmit,"ax",%progbits
 3046              		.align	1
 3047              		.global	le_transmit
 3048              		.thumb
 3049              		.thumb_func
 3051              	le_transmit:
 3052              	.LFB11:
1082:bluetooth_rxtx.c **** 	unsigned i, j;
 3053              		.loc 1 1082 0
ARM GAS  /tmp/ccxsBJK4.s 			page 99


 3054              		.cfi_startproc
 3055              		@ args = 0, pretend = 0, frame = 64
 3056              		@ frame_needed = 0, uses_anonymous_args = 0
 3057              	.LVL371:
 3058 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 3059              		.cfi_def_cfa_offset 36
 3060              		.cfi_offset 4, -36
 3061              		.cfi_offset 5, -32
 3062              		.cfi_offset 6, -28
 3063              		.cfi_offset 7, -24
 3064              		.cfi_offset 8, -20
 3065              		.cfi_offset 9, -16
 3066              		.cfi_offset 10, -12
 3067              		.cfi_offset 11, -8
 3068              		.cfi_offset 14, -4
 3069 0004 91B0     		sub	sp, sp, #68
 3070              		.cfi_def_cfa_offset 104
1082:bluetooth_rxtx.c **** 	unsigned i, j;
 3071              		.loc 1 1082 0
 3072 0006 8946     		mov	r9, r1
 3073 0008 0546     		mov	r5, r0
 3074 000a 9246     		mov	r10, r2
1090:bluetooth_rxtx.c **** 
 3075              		.loc 1 1090 0
 3076 000c 03F00F08 		and	r8, r3, #15
 3077              	.LVL372:
 3078 0010 0DF1FF34 		add	r4, sp, #-1
 3079 0014 0DF10301 		add	r1, sp, #3
 3080              	.LVL373:
 3081              	.L358:
1096:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 3082              		.loc 1 1096 0
 3083 0018 0022     		movs	r2, #0
1094:bluetooth_rxtx.c **** 		aa >>= 8;
 3084              		.loc 1 1094 0
 3085 001a EBB2     		uxtb	r3, r5
 3086              	.LVL374:
1096:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 3087              		.loc 1 1096 0
 3088 001c 6270     		strb	r2, [r4, #1]
1095:bluetooth_rxtx.c **** 		txbuf[i] = 0;
 3089              		.loc 1 1095 0
 3090 001e 2D0A     		lsrs	r5, r5, #8
 3091              	.LVL375:
1096:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 3092              		.loc 1 1096 0
 3093 0020 0726     		movs	r6, #7
 3094              	.LVL376:
 3095              	.L356:
1098:bluetooth_rxtx.c **** 			byte >>= 1;
 3096              		.loc 1 1098 0 discriminator 2
 3097 0022 03F00100 		and	r0, r3, #1
 3098 0026 B040     		lsls	r0, r0, r6
1097:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
 3099              		.loc 1 1097 0 discriminator 2
 3100 0028 16F1FF36 		adds	r6, r6, #-1
 3101              	.LVL377:
ARM GAS  /tmp/ccxsBJK4.s 			page 100


1098:bluetooth_rxtx.c **** 			byte >>= 1;
 3102              		.loc 1 1098 0 discriminator 2
 3103 002c 40EA0202 		orr	r2, r0, r2
 3104 0030 D2B2     		uxtb	r2, r2
1099:bluetooth_rxtx.c **** 		}
 3105              		.loc 1 1099 0 discriminator 2
 3106 0032 4FEA5303 		lsr	r3, r3, #1
 3107              	.LVL378:
1097:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
 3108              		.loc 1 1097 0 discriminator 2
 3109 0036 F4D2     		bcs	.L356
 3110 0038 04F8012F 		strb	r2, [r4, #1]!
 3111              	.LVL379:
1093:bluetooth_rxtx.c **** 		byte = aa & 0xff;
 3112              		.loc 1 1093 0
 3113 003c 8C42     		cmp	r4, r1
 3114 003e EBD1     		bne	.L358
1104:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
 3115              		.loc 1 1104 0
 3116 0040 544E     		ldr	r6, .L382
1105:bluetooth_rxtx.c **** 		byte = data[i];
 3117              		.loc 1 1105 0
 3118 0042 0024     		movs	r4, #0
 3119              	.LVL380:
1104:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
 3120              		.loc 1 1104 0
 3121 0044 3088     		ldrh	r0, [r6]
 3122 0046 B346     		mov	fp, r6
 3123 0048 80B2     		uxth	r0, r0
 3124 004a 6238     		subs	r0, r0, #98
 3125 004c C0B2     		uxtb	r0, r0
 3126 004e FFF7FEFF 		bl	btle_channel_index
 3127              	.LVL381:
 3128 0052 514B     		ldr	r3, .L382+4
 3129 0054 1F5C     		ldrb	r7, [r3, r0]	@ zero_extendqisi2
 3130              	.LVL382:
 3131              	.L359:
1105:bluetooth_rxtx.c **** 		byte = data[i];
 3132              		.loc 1 1105 0 discriminator 1
 3133 0056 4C45     		cmp	r4, r9
 3134 0058 1FD2     		bcs	.L381
 3135 005a 00A9     		add	r1, sp, #0
1106:bluetooth_rxtx.c **** 		txbuf[i+4] = 0;
 3136              		.loc 1 1106 0
 3137 005c 1AF804E0 		ldrb	lr, [r10, r4]	@ zero_extendqisi2
 3138              	.LVL383:
 3139 0060 2144     		add	r1, r1, r4
 3140              	.LVL384:
 3141 0062 0726     		movs	r6, #7
 3142 0064 0023     		movs	r3, #0
 3143              	.LVL385:
 3144              	.L361:
1109:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 3145              		.loc 1 1109 0 discriminator 2
 3146 0066 4C4A     		ldr	r2, .L382+4
 3147 0068 0EF00100 		and	r0, lr, #1
 3148 006c 3A44     		add	r2, r2, r7
ARM GAS  /tmp/ccxsBJK4.s 			page 101


 3149 006e 92F82820 		ldrb	r2, [r2, #40]	@ zero_extendqisi2
1110:bluetooth_rxtx.c **** 			byte >>= 1;
 3150              		.loc 1 1110 0 discriminator 2
 3151 0072 0137     		adds	r7, r7, #1
 3152              	.LVL386:
1109:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 3153              		.loc 1 1109 0 discriminator 2
 3154 0074 5040     		eors	r0, r0, r2
 3155              	.LVL387:
1110:bluetooth_rxtx.c **** 			byte >>= 1;
 3156              		.loc 1 1110 0 discriminator 2
 3157 0076 7F22     		movs	r2, #127
 3158 0078 B7FBF2FC 		udiv	ip, r7, r2
 3159 007c 02FB1C77 		mls	r7, r2, ip, r7
 3160              	.LVL388:
1112:bluetooth_rxtx.c **** 		}
 3161              		.loc 1 1112 0 discriminator 2
 3162 0080 00FA06F2 		lsl	r2, r0, r6
1108:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 3163              		.loc 1 1108 0 discriminator 2
 3164 0084 16F1FF36 		adds	r6, r6, #-1
 3165              	.LVL389:
1112:bluetooth_rxtx.c **** 		}
 3166              		.loc 1 1112 0 discriminator 2
 3167 0088 42EA0303 		orr	r3, r2, r3
1111:bluetooth_rxtx.c **** 			txbuf[i+4] |= bit << (7 - j);
 3168              		.loc 1 1111 0 discriminator 2
 3169 008c 4FEA5E0E 		lsr	lr, lr, #1
 3170              	.LVL390:
1112:bluetooth_rxtx.c **** 		}
 3171              		.loc 1 1112 0 discriminator 2
 3172 0090 DBB2     		uxtb	r3, r3
 3173              	.LVL391:
1108:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 3174              		.loc 1 1108 0 discriminator 2
 3175 0092 E8D2     		bcs	.L361
 3176 0094 0B71     		strb	r3, [r1, #4]
1105:bluetooth_rxtx.c **** 		byte = data[i];
 3177              		.loc 1 1105 0
 3178 0096 0134     		adds	r4, r4, #1
 3179              	.LVL392:
 3180 0098 DDE7     		b	.L359
 3181              	.LVL393:
 3182              	.L381:
1119:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3183              		.loc 1 1119 0
 3184 009a 0D20     		movs	r0, #13
 3185 009c 47F6FF71 		movw	r1, #32767
 3186 00a0 FFF7FEFF 		bl	cc2400_set
 3187              	.LVL394:
1120:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 3188              		.loc 1 1120 0
 3189 00a4 1220     		movs	r0, #18
 3190 00a6 42F62231 		movw	r1, #11042
 3191 00aa FFF7FEFF 		bl	cc2400_set
 3192              	.LVL395:
1121:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccxsBJK4.s 			page 102


 3193              		.loc 1 1121 0
 3194 00ae 1420     		movs	r0, #20
 3195 00b0 41F24B31 		movw	r1, #4939
 3196 00b4 FFF7FEFF 		bl	cc2400_set
 3197              	.LVL396:
1123:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 3198              		.loc 1 1123 0
 3199 00b8 2020     		movs	r0, #32
 3200 00ba 40F60141 		movw	r1, #3073
 3201 00be FFF7FEFF 		bl	cc2400_set
 3202              	.LVL397:
1131:bluetooth_rxtx.c **** 	// JWHUR cc2400 data sheet about power control
 3203              		.loc 1 1131 0
 3204 00c2 BBF80010 		ldrh	r1, [fp]
 3205 00c6 0220     		movs	r0, #2
 3206 00c8 89B2     		uxth	r1, r1
 3207 00ca FFF7FEFF 		bl	cc2400_set
 3208              	.LVL398:
1142:bluetooth_rxtx.c **** 	//cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 3209              		.loc 1 1142 0
 3210 00ce 0520     		movs	r0, #5
 3211 00d0 4146     		mov	r1, r8
 3212 00d2 FFF7FEFF 		bl	cc2400_set
 3213              	.LVL399:
1144:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
 3214              		.loc 1 1144 0
 3215 00d6 0320     		movs	r0, #3
 3216 00d8 4021     		movs	r1, #64
 3217 00da FFF7FEFF 		bl	cc2400_set
 3218              	.LVL400:
1145:bluetooth_rxtx.c **** 
 3219              		.loc 1 1145 0
 3220 00de 1421     		movs	r1, #20
 3221 00e0 2320     		movs	r0, #35
 3222 00e2 FFF7FEFF 		bl	cc2400_set
 3223              	.LVL401:
1148:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0xaaaa);
 3224              		.loc 1 1148 0
 3225 00e6 EA07     		lsls	r2, r5, #31
1149:bluetooth_rxtx.c **** 	else
 3226              		.loc 1 1149 0
 3227 00e8 4CBF     		ite	mi
 3228 00ea 4AF6AA21 		movwmi	r1, #43690
1151:bluetooth_rxtx.c **** 
 3229              		.loc 1 1151 0
 3230 00ee 45F25551 		movwpl	r1, #21845
1149:bluetooth_rxtx.c **** 	else
 3231              		.loc 1 1149 0
 3232 00f2 2D20     		movs	r0, #45
1151:bluetooth_rxtx.c **** 
 3233              		.loc 1 1151 0
 3234 00f4 FFF7FEFF 		bl	cc2400_set
 3235              	.LVL402:
1154:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 3236              		.loc 1 1154 0
 3237 00f8 0820     		movs	r0, #8
 3238 00fa FFF7FEFF 		bl	cc2400_get
ARM GAS  /tmp/ccxsBJK4.s 			page 103


 3239              	.LVL403:
1155:bluetooth_rxtx.c **** 
 3240              		.loc 1 1155 0
 3241 00fe C0F30801 		ubfx	r1, r0, #0, #9
1116:bluetooth_rxtx.c **** 
 3242              		.loc 1 1116 0
 3243 0102 09F10409 		add	r9, r9, #4
1154:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 3244              		.loc 1 1154 0
 3245 0106 0446     		mov	r4, r0
 3246              	.LVL404:
1155:bluetooth_rxtx.c **** 
 3247              		.loc 1 1155 0
 3248 0108 41F49C41 		orr	r1, r1, #19968
 3249 010c 0820     		movs	r0, #8
1116:bluetooth_rxtx.c **** 
 3250              		.loc 1 1116 0
 3251 010e 5FFA89F9 		uxtb	r9, r9
 3252              	.LVL405:
1155:bluetooth_rxtx.c **** 
 3253              		.loc 1 1155 0
 3254 0112 FFF7FEFF 		bl	cc2400_set
 3255              	.LVL406:
 3256              	.L366:
1157:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3257              		.loc 1 1157 0 discriminator 1
 3258 0116 FFF7FEFF 		bl	cc2400_status
 3259              	.LVL407:
 3260 011a 4306     		lsls	r3, r0, #25
 3261 011c FBD5     		bpl	.L366
1158:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3262              		.loc 1 1158 0
 3263 011e 6120     		movs	r0, #97
 3264 0120 FFF7FEFF 		bl	cc2400_strobe
 3265              	.LVL408:
 3266              	.L368:
1159:bluetooth_rxtx.c **** 	TXLED_SET;
 3267              		.loc 1 1159 0 discriminator 1
 3268 0124 FFF7FEFF 		bl	cc2400_status
 3269              	.LVL409:
 3270 0128 4707     		lsls	r7, r0, #29
 3271 012a FBD5     		bpl	.L368
1160:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 3272              		.loc 1 1160 0
 3273 012c 1B4B     		ldr	r3, .L382+8
 3274 012e 4FF48072 		mov	r2, #256
 3275 0132 1A60     		str	r2, [r3]
1162:bluetooth_rxtx.c **** #endif
 3276              		.loc 1 1162 0
 3277 0134 8022     		movs	r2, #128
 3278 0136 1A62     		str	r2, [r3, #32]
 3279              	.L370:
1164:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3280              		.loc 1 1164 0 discriminator 1
 3281 0138 0E20     		movs	r0, #14
 3282 013a FFF7FEFF 		bl	cc2400_get
 3283              	.LVL410:
ARM GAS  /tmp/ccxsBJK4.s 			page 104


 3284 013e 00F01F00 		and	r0, r0, #31
 3285 0142 0F28     		cmp	r0, #15
 3286 0144 F8D1     		bne	.L370
1165:bluetooth_rxtx.c **** 
 3287              		.loc 1 1165 0
 3288 0146 6320     		movs	r0, #99
 3289 0148 FFF7FEFF 		bl	cc2400_strobe
 3290              	.LVL411:
 3291              	.L372:
1178:bluetooth_rxtx.c **** 	cc2400_fifo_write(len, txbuf);
 3292              		.loc 1 1178 0 discriminator 1
 3293 014c 144B     		ldr	r3, .L382+12
 3294 014e 1B68     		ldr	r3, [r3]
 3295 0150 5E07     		lsls	r6, r3, #29
 3296 0152 FBD4     		bmi	.L372
1179:bluetooth_rxtx.c **** 
 3297              		.loc 1 1179 0
 3298 0154 4846     		mov	r0, r9
 3299 0156 6946     		mov	r1, sp
 3300 0158 FFF7FEFF 		bl	cc2400_fifo_write
 3301              	.LVL412:
 3302              	.L374:
1181:bluetooth_rxtx.c **** 	TXLED_CLR;
 3303              		.loc 1 1181 0 discriminator 1
 3304 015c 0E20     		movs	r0, #14
 3305 015e FFF7FEFF 		bl	cc2400_get
 3306              	.LVL413:
 3307 0162 00F01F00 		and	r0, r0, #31
 3308 0166 0F28     		cmp	r0, #15
 3309 0168 F8D1     		bne	.L374
1182:bluetooth_rxtx.c **** 
 3310              		.loc 1 1182 0
 3311 016a 0E4B     		ldr	r3, .L382+16
 3312 016c 4FF48072 		mov	r2, #256
 3313 0170 1A60     		str	r2, [r3]
1184:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 3314              		.loc 1 1184 0
 3315 0172 6420     		movs	r0, #100
 3316 0174 FFF7FEFF 		bl	cc2400_strobe
 3317              	.LVL414:
 3318              	.L376:
1185:bluetooth_rxtx.c **** 
 3319              		.loc 1 1185 0 discriminator 1
 3320 0178 FFF7FEFF 		bl	cc2400_status
 3321              	.LVL415:
 3322 017c 4507     		lsls	r5, r0, #29
 3323 017e FBD4     		bmi	.L376
1188:bluetooth_rxtx.c **** #endif
 3324              		.loc 1 1188 0
 3325 0180 094B     		ldr	r3, .L382+20
 3326 0182 8022     		movs	r2, #128
 3327 0184 1A60     		str	r2, [r3]
1192:bluetooth_rxtx.c **** }
 3328              		.loc 1 1192 0
 3329 0186 0820     		movs	r0, #8
 3330 0188 2146     		mov	r1, r4
 3331 018a FFF7FEFF 		bl	cc2400_set
ARM GAS  /tmp/ccxsBJK4.s 			page 105


 3332              	.LVL416:
1193:bluetooth_rxtx.c **** 
 3333              		.loc 1 1193 0
 3334 018e 11B0     		add	sp, sp, #68
 3335              		@ sp needed
 3336 0190 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 3337              	.LVL417:
 3338              	.L383:
 3339              		.align	2
 3340              	.L382:
 3341 0194 00000000 		.word	.LANCHOR1
 3342 0198 00000000 		.word	.LANCHOR2
 3343 019c 38C00920 		.word	537509944
 3344 01a0 54C00920 		.word	537509972
 3345 01a4 3CC00920 		.word	537509948
 3346 01a8 5CC00920 		.word	537509980
 3347              		.cfi_endproc
 3348              	.LFE11:
 3350              		.section	.text.le_jam,"ax",%progbits
 3351              		.align	1
 3352              		.global	le_jam
 3353              		.thumb
 3354              		.thumb_func
 3356              	le_jam:
 3357              	.LFB12:
1195:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 3358              		.loc 1 1195 0
 3359              		.cfi_startproc
 3360              		@ args = 0, pretend = 0, frame = 0
 3361              		@ frame_needed = 0, uses_anonymous_args = 0
 3362 0000 08B5     		push	{r3, lr}
 3363              		.cfi_def_cfa_offset 8
 3364              		.cfi_offset 3, -8
 3365              		.cfi_offset 14, -4
1197:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3366              		.loc 1 1197 0
 3367 0002 0D20     		movs	r0, #13
 3368 0004 47F6FF71 		movw	r1, #32767
 3369 0008 FFF7FEFF 		bl	cc2400_set
 3370              	.LVL418:
1198:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
 3371              		.loc 1 1198 0
 3372 000c 1220     		movs	r0, #18
 3373 000e 42F62231 		movw	r1, #11042
 3374 0012 FFF7FEFF 		bl	cc2400_set
 3375              	.LVL419:
1199:bluetooth_rxtx.c **** 
 3376              		.loc 1 1199 0
 3377 0016 1420     		movs	r0, #20
 3378 0018 42F24B31 		movw	r1, #9035
 3379 001c FFF7FEFF 		bl	cc2400_set
 3380              	.LVL420:
1201:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 3381              		.loc 1 1201 0
 3382 0020 2020     		movs	r0, #32
 3383 0022 40F60141 		movw	r1, #3073
 3384 0026 FFF7FEFF 		bl	cc2400_set
ARM GAS  /tmp/ccxsBJK4.s 			page 106


 3385              	.LVL421:
1210:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 3386              		.loc 1 1210 0
 3387 002a 0520     		movs	r0, #5
 3388 002c 0B21     		movs	r1, #11
 3389 002e FFF7FEFF 		bl	cc2400_set
 3390              	.LVL422:
1211:bluetooth_rxtx.c **** 
 3391              		.loc 1 1211 0
 3392 0032 0320     		movs	r0, #3
 3393 0034 4021     		movs	r1, #64
 3394 0036 FFF7FEFF 		bl	cc2400_set
 3395              	.LVL423:
 3396              	.L386:
1213:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3397              		.loc 1 1213 0 discriminator 1
 3398 003a FFF7FEFF 		bl	cc2400_status
 3399              	.LVL424:
 3400 003e 4006     		lsls	r0, r0, #25
 3401 0040 FBD5     		bpl	.L386
1214:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3402              		.loc 1 1214 0
 3403 0042 6120     		movs	r0, #97
 3404 0044 FFF7FEFF 		bl	cc2400_strobe
 3405              	.LVL425:
 3406              	.L388:
1215:bluetooth_rxtx.c **** 	TXLED_SET;
 3407              		.loc 1 1215 0 discriminator 1
 3408 0048 FFF7FEFF 		bl	cc2400_status
 3409              	.LVL426:
 3410 004c 4107     		lsls	r1, r0, #29
 3411 004e FBD5     		bpl	.L388
1216:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 3412              		.loc 1 1216 0
 3413 0050 084B     		ldr	r3, .L391
 3414 0052 4FF48072 		mov	r2, #256
 3415 0056 1A60     		str	r2, [r3]
1218:bluetooth_rxtx.c **** #endif
 3416              		.loc 1 1218 0
 3417 0058 8022     		movs	r2, #128
 3418 005a 1A62     		str	r2, [r3, #32]
 3419              	.L390:
1220:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3420              		.loc 1 1220 0 discriminator 1
 3421 005c 0E20     		movs	r0, #14
 3422 005e FFF7FEFF 		bl	cc2400_get
 3423              	.LVL427:
 3424 0062 00F01F00 		and	r0, r0, #31
 3425 0066 0F28     		cmp	r0, #15
 3426 0068 F8D1     		bne	.L390
1221:bluetooth_rxtx.c **** #endif
 3427              		.loc 1 1221 0
 3428 006a 6320     		movs	r0, #99
1223:bluetooth_rxtx.c **** 
 3429              		.loc 1 1223 0
 3430 006c BDE80840 		pop	{r3, lr}
1221:bluetooth_rxtx.c **** #endif
ARM GAS  /tmp/ccxsBJK4.s 			page 107


 3431              		.loc 1 1221 0
 3432 0070 FFF7FEBF 		b	cc2400_strobe
 3433              	.LVL428:
 3434              	.L392:
 3435              		.align	2
 3436              	.L391:
 3437 0074 38C00920 		.word	537509944
 3438              		.cfi_endproc
 3439              	.LFE12:
 3441              		.section	.text.hop,"ax",%progbits
 3442              		.align	1
 3443              		.global	hop
 3444              		.thumb
 3445              		.thumb_func
 3447              	hop:
 3448              	.LFB13:
1228:bluetooth_rxtx.c **** 	do_hop = 0;
 3449              		.loc 1 1228 0
 3450              		.cfi_startproc
 3451              		@ args = 0, pretend = 0, frame = 0
 3452              		@ frame_needed = 0, uses_anonymous_args = 0
 3453 0000 38B5     		push	{r3, r4, r5, lr}
 3454              		.cfi_def_cfa_offset 16
 3455              		.cfi_offset 3, -16
 3456              		.cfi_offset 4, -12
 3457              		.cfi_offset 5, -8
 3458              		.cfi_offset 14, -4
1229:bluetooth_rxtx.c **** 	last_hop = clkn;
 3459              		.loc 1 1229 0
 3460 0002 5F4C     		ldr	r4, .L433
 3461 0004 0023     		movs	r3, #0
 3462 0006 E372     		strb	r3, [r4, #11]
1230:bluetooth_rxtx.c **** 
 3463              		.loc 1 1230 0
 3464 0008 5E4B     		ldr	r3, .L433+4
 3465 000a 5F4A     		ldr	r2, .L433+8
 3466 000c 1968     		ldr	r1, [r3]
 3467 000e 1160     		str	r1, [r2]
1233:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
 3468              		.loc 1 1233 0
 3469 0010 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3470 0012 4AB9     		cbnz	r2, .L394
1234:bluetooth_rxtx.c **** 			return;
 3471              		.loc 1 1234 0
 3472 0014 0220     		movs	r0, #2
 3473 0016 FFF7FEFF 		bl	cc2400_get
 3474              	.LVL429:
 3475 001a 5C4B     		ldr	r3, .L433+12
 3476 001c 1B88     		ldrh	r3, [r3]
 3477 001e 9BB2     		uxth	r3, r3
 3478 0020 013B     		subs	r3, r3, #1
 3479 0022 9842     		cmp	r0, r3
 3480 0024 7FD1     		bne	.L396
 3481 0026 38BD     		pop	{r3, r4, r5, pc}
 3482              	.L394:
1240:bluetooth_rxtx.c **** 		do {
 3483              		.loc 1 1240 0
ARM GAS  /tmp/ccxsBJK4.s 			page 108


 3484 0028 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3485 002a 012A     		cmp	r2, #1
 3486 002c 31D1     		bne	.L397
1245:bluetooth_rxtx.c **** 	}
 3487              		.loc 1 1245 0
 3488 002e 584B     		ldr	r3, .L433+16
 3489 0030 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 3490 0032 584B     		ldr	r3, .L433+20
 3491 0034 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 3492              	.L401:
1242:bluetooth_rxtx.c **** 			if (channel > 2480)
 3493              		.loc 1 1242 0
 3494 0036 554B     		ldr	r3, .L433+12
 3495 0038 1A88     		ldrh	r2, [r3]
 3496 003a 92B2     		uxth	r2, r2
 3497 003c 2032     		adds	r2, r2, #32
 3498 003e 92B2     		uxth	r2, r2
 3499 0040 1A80     		strh	r2, [r3]	@ movhi
1243:bluetooth_rxtx.c **** 				channel -= 79;
 3500              		.loc 1 1243 0
 3501 0042 1A88     		ldrh	r2, [r3]
 3502 0044 92B2     		uxth	r2, r2
 3503 0046 B2F51B6F 		cmp	r2, #2480
 3504 004a 04D9     		bls	.L398
1244:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
 3505              		.loc 1 1244 0
 3506 004c 1A88     		ldrh	r2, [r3]
 3507 004e 92B2     		uxth	r2, r2
 3508 0050 4F3A     		subs	r2, r2, #79
 3509 0052 92B2     		uxth	r2, r2
 3510 0054 1A80     		strh	r2, [r3]	@ movhi
 3511              	.L398:
1245:bluetooth_rxtx.c **** 	}
 3512              		.loc 1 1245 0
 3513 0056 0029     		cmp	r1, #0
 3514 0058 65D0     		beq	.L396
1245:bluetooth_rxtx.c **** 	}
 3515              		.loc 1 1245 0 is_stmt 0 discriminator 1
 3516 005a 0028     		cmp	r0, #0
 3517 005c 63D0     		beq	.L396
 3518 005e 1A88     		ldrh	r2, [r3]
 3519 0060 1D88     		ldrh	r5, [r3]
 3520 0062 92B2     		uxth	r2, r2
 3521 0064 A2F66213 		subw	r3, r2, #2402
 3522 0068 0822     		movs	r2, #8
 3523 006a 93FBF2F3 		sdiv	r3, r3, r2
 3524 006e 4A4A     		ldr	r2, .L433+24
 3525 0070 ADB2     		uxth	r5, r5
 3526 0072 D25C     		ldrb	r2, [r2, r3]	@ zero_extendqisi2
 3527 0074 494B     		ldr	r3, .L433+28
 3528 0076 A5F66215 		subw	r5, r5, #2402
 3529 007a 2B40     		ands	r3, r3, r5
 3530 007c 002B     		cmp	r3, #0
 3531 007e 03DA     		bge	.L400
 3532 0080 013B     		subs	r3, r3, #1
 3533 0082 63F00703 		orn	r3, r3, #7
 3534 0086 0133     		adds	r3, r3, #1
ARM GAS  /tmp/ccxsBJK4.s 			page 109


 3535              	.L400:
 3536 0088 42FA03F3 		asr	r3, r2, r3
 3537 008c DD07     		lsls	r5, r3, #31
 3538 008e D2D5     		bpl	.L401
 3539 0090 49E0     		b	.L396
 3540              	.L397:
1251:bluetooth_rxtx.c **** 		do {
 3541              		.loc 1 1251 0 is_stmt 1
 3542 0092 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3543 0094 052A     		cmp	r2, #5
 3544 0096 2DD1     		bne	.L402
1256:bluetooth_rxtx.c **** 	}
 3545              		.loc 1 1256 0
 3546 0098 3D4B     		ldr	r3, .L433+16
 3547 009a 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 3548              	.L405:
1253:bluetooth_rxtx.c **** 			if (channel > 2480)
 3549              		.loc 1 1253 0
 3550 009c 3B4B     		ldr	r3, .L433+12
 3551 009e 1A88     		ldrh	r2, [r3]
 3552 00a0 92B2     		uxth	r2, r2
 3553 00a2 2032     		adds	r2, r2, #32
 3554 00a4 92B2     		uxth	r2, r2
 3555 00a6 1A80     		strh	r2, [r3]	@ movhi
1254:bluetooth_rxtx.c **** 				channel -= 79;
 3556              		.loc 1 1254 0
 3557 00a8 1A88     		ldrh	r2, [r3]
 3558 00aa 92B2     		uxth	r2, r2
 3559 00ac B2F51B6F 		cmp	r2, #2480
 3560 00b0 04D9     		bls	.L403
1255:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
 3561              		.loc 1 1255 0
 3562 00b2 1A88     		ldrh	r2, [r3]
 3563 00b4 92B2     		uxth	r2, r2
 3564 00b6 4F3A     		subs	r2, r2, #79
 3565 00b8 92B2     		uxth	r2, r2
 3566 00ba 1A80     		strh	r2, [r3]	@ movhi
 3567              	.L403:
1256:bluetooth_rxtx.c **** 	}
 3568              		.loc 1 1256 0
 3569 00bc 4F29     		cmp	r1, #79
 3570 00be 32D0     		beq	.L396
1256:bluetooth_rxtx.c **** 	}
 3571              		.loc 1 1256 0 is_stmt 0 discriminator 1
 3572 00c0 1A88     		ldrh	r2, [r3]
 3573 00c2 1888     		ldrh	r0, [r3]
 3574 00c4 92B2     		uxth	r2, r2
 3575 00c6 A2F66213 		subw	r3, r2, #2402
 3576 00ca 0822     		movs	r2, #8
 3577 00cc 93FBF2F3 		sdiv	r3, r3, r2
 3578 00d0 314A     		ldr	r2, .L433+24
 3579 00d2 80B2     		uxth	r0, r0
 3580 00d4 D25C     		ldrb	r2, [r2, r3]	@ zero_extendqisi2
 3581 00d6 314B     		ldr	r3, .L433+28
 3582 00d8 A0F66210 		subw	r0, r0, #2402
 3583 00dc 0340     		ands	r3, r3, r0
 3584 00de 002B     		cmp	r3, #0
ARM GAS  /tmp/ccxsBJK4.s 			page 110


 3585 00e0 03DA     		bge	.L404
 3586 00e2 013B     		subs	r3, r3, #1
 3587 00e4 63F00703 		orn	r3, r3, #7
 3588 00e8 0133     		adds	r3, r3, #1
 3589              	.L404:
 3590 00ea 42FA03F3 		asr	r3, r2, r3
 3591 00ee DA07     		lsls	r2, r3, #31
 3592 00f0 D4D4     		bmi	.L405
 3593 00f2 18E0     		b	.L396
 3594              	.L402:
1259:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
 3595              		.loc 1 1259 0 is_stmt 1
 3596 00f4 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3597 00f6 022A     		cmp	r2, #2
 3598 00f8 05D1     		bne	.L406
1260:bluetooth_rxtx.c **** 	}
 3599              		.loc 1 1260 0
 3600 00fa 1868     		ldr	r0, [r3]
 3601 00fc FFF7FEFF 		bl	next_hop
 3602              	.LVL430:
 3603 0100 224B     		ldr	r3, .L433+12
 3604 0102 1880     		strh	r0, [r3]	@ movhi
 3605 0104 0FE0     		b	.L396
 3606              	.L406:
1263:bluetooth_rxtx.c **** 		channel = btle_next_hop(&le);
 3607              		.loc 1 1263 0
 3608 0106 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3609 0108 032B     		cmp	r3, #3
 3610 010a 05D1     		bne	.L407
1264:bluetooth_rxtx.c **** 	}
 3611              		.loc 1 1264 0
 3612 010c 1F4D     		ldr	r5, .L433+12
 3613 010e 281D     		adds	r0, r5, #4
 3614 0110 FFF7FEFF 		bl	btle_next_hop
 3615              	.LVL431:
 3616 0114 2880     		strh	r0, [r5]	@ movhi
 3617 0116 06E0     		b	.L396
 3618              	.L407:
1267:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
 3619              		.loc 1 1267 0
 3620 0118 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3621 011a 042B     		cmp	r3, #4
 3622 011c 03D1     		bne	.L396
1268:bluetooth_rxtx.c **** 	}
 3623              		.loc 1 1268 0
 3624 011e A289     		ldrh	r2, [r4, #12]
 3625 0120 1A4B     		ldr	r3, .L433+12
 3626 0122 92B2     		uxth	r2, r2
 3627 0124 1A80     		strh	r2, [r3]	@ movhi
 3628              	.L396:
1271:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 3629              		.loc 1 1271 0
 3630 0126 6420     		movs	r0, #100
 3631 0128 FFF7FEFF 		bl	cc2400_strobe
 3632              	.LVL432:
 3633              	.L409:
1272:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccxsBJK4.s 			page 111


 3634              		.loc 1 1272 0 discriminator 1
 3635 012c FFF7FEFF 		bl	cc2400_status
 3636              	.LVL433:
 3637 0130 4307     		lsls	r3, r0, #29
 3638 0132 FBD4     		bmi	.L409
 3639 0134 154D     		ldr	r5, .L433+12
1275:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3640              		.loc 1 1275 0
 3641 0136 607C     		ldrb	r0, [r4, #17]	@ zero_extendqisi2
1276:bluetooth_rxtx.c **** 	else
 3642              		.loc 1 1276 0
 3643 0138 2988     		ldrh	r1, [r5]
1275:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3644              		.loc 1 1275 0
 3645 013a C0B2     		uxtb	r0, r0
 3646 013c 0228     		cmp	r0, #2
1276:bluetooth_rxtx.c **** 	else
 3647              		.loc 1 1276 0
 3648 013e 89B2     		uxth	r1, r1
1278:bluetooth_rxtx.c **** 
 3649              		.loc 1 1278 0
 3650 0140 1EBF     		ittt	ne
 3651 0142 01F1FF31 		addne	r1, r1, #-1
 3652 0146 0220     		movne	r0, #2
 3653 0148 89B2     		uxthne	r1, r1
 3654 014a FFF7FEFF 		bl	cc2400_set
 3655              	.LVL434:
1281:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 3656              		.loc 1 1281 0
 3657 014e A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3658 0150 1BB1     		cbz	r3, .L412
1282:bluetooth_rxtx.c **** 	}
 3659              		.loc 1 1282 0
 3660 0152 2888     		ldrh	r0, [r5]
 3661 0154 80B2     		uxth	r0, r0
 3662 0156 FFF7FEFF 		bl	cs_threshold_calc_and_set
 3663              	.LVL435:
 3664              	.L412:
1286:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3665              		.loc 1 1286 0
 3666 015a 6120     		movs	r0, #97
 3667 015c FFF7FEFF 		bl	cc2400_strobe
 3668              	.LVL436:
 3669              	.L414:
1287:bluetooth_rxtx.c **** 
 3670              		.loc 1 1287 0 discriminator 1
 3671 0160 FFF7FEFF 		bl	cc2400_status
 3672              	.LVL437:
 3673 0164 4507     		lsls	r5, r0, #29
 3674 0166 FBD5     		bpl	.L414
1289:bluetooth_rxtx.c **** 
 3675              		.loc 1 1289 0
 3676 0168 0123     		movs	r3, #1
 3677 016a 2374     		strb	r3, [r4, #16]
1291:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 3678              		.loc 1 1291 0
 3679 016c 637C     		ldrb	r3, [r4, #17]	@ zero_extendqisi2
ARM GAS  /tmp/ccxsBJK4.s 			page 112


 3680 016e 022B     		cmp	r3, #2
1292:bluetooth_rxtx.c **** 	else
 3681              		.loc 1 1292 0
 3682 0170 0CBF     		ite	eq
 3683 0172 6320     		moveq	r0, #99
1294:bluetooth_rxtx.c **** }
 3684              		.loc 1 1294 0
 3685 0174 6220     		movne	r0, #98
1295:bluetooth_rxtx.c **** 
 3686              		.loc 1 1295 0
 3687 0176 BDE83840 		pop	{r3, r4, r5, lr}
1294:bluetooth_rxtx.c **** }
 3688              		.loc 1 1294 0
 3689 017a FFF7FEBF 		b	cc2400_strobe
 3690              	.LVL438:
 3691              	.L434:
 3692 017e 00BF     		.align	2
 3693              	.L433:
 3694 0180 00000000 		.word	.LANCHOR0
 3695 0184 00000000 		.word	clkn
 3696 0188 00000000 		.word	last_hop
 3697 018c 00000000 		.word	.LANCHOR1
 3698 0190 00000000 		.word	used_channels
 3699 0194 00000000 		.word	afh_enabled
 3700 0198 00000000 		.word	afh_map
 3701 019c 07000080 		.word	-2147483641
 3702              		.cfi_endproc
 3703              	.LFE13:
 3705              		.section	.text.bt_stream_rx,"ax",%progbits
 3706              		.align	1
 3707              		.global	bt_stream_rx
 3708              		.thumb
 3709              		.thumb_func
 3711              	bt_stream_rx:
 3712              	.LFB14:
1299:bluetooth_rxtx.c **** 	int8_t rssi;
 3713              		.loc 1 1299 0
 3714              		.cfi_startproc
 3715              		@ args = 0, pretend = 0, frame = 0
 3716              		@ frame_needed = 0, uses_anonymous_args = 0
 3717 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 3718              		.cfi_def_cfa_offset 32
 3719              		.cfi_offset 3, -32
 3720              		.cfi_offset 4, -28
 3721              		.cfi_offset 5, -24
 3722              		.cfi_offset 6, -20
 3723              		.cfi_offset 7, -16
 3724              		.cfi_offset 8, -12
 3725              		.cfi_offset 9, -8
 3726              		.cfi_offset 14, -4
1303:bluetooth_rxtx.c **** 
 3727              		.loc 1 1303 0
 3728 0004 494B     		ldr	r3, .L469
 3729 0006 1022     		movs	r2, #16
 3730 0008 1A60     		str	r2, [r3]
1305:bluetooth_rxtx.c **** 	dio_ssp_init();
 3731              		.loc 1 1305 0
ARM GAS  /tmp/ccxsBJK4.s 			page 113


 3732 000a FFF7FEFF 		bl	queue_init
 3733              	.LVL439:
1306:bluetooth_rxtx.c **** 	dma_init();
 3734              		.loc 1 1306 0
 3735 000e FFF7FEFF 		bl	dio_ssp_init
 3736              	.LVL440:
1307:bluetooth_rxtx.c **** 	dio_ssp_start();
 3737              		.loc 1 1307 0
 3738 0012 FFF7FEFF 		bl	dma_init
 3739              	.LVL441:
1308:bluetooth_rxtx.c **** 
 3740              		.loc 1 1308 0
 3741 0016 FFF7FEFF 		bl	dio_ssp_start
 3742              	.LVL442:
1310:bluetooth_rxtx.c **** 
 3743              		.loc 1 1310 0
 3744 001a FFF7FEFF 		bl	cc2400_rx
 3745              	.LVL443:
1312:bluetooth_rxtx.c **** 
 3746              		.loc 1 1312 0
 3747 001e FFF7FEFF 		bl	cs_trigger_enable
 3748              	.LVL444:
 3749              	.L436:
1314:bluetooth_rxtx.c **** 	{
 3750              		.loc 1 1314 0 discriminator 1
 3751 0022 434C     		ldr	r4, .L469+4
 3752 0024 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 3753 0026 A146     		mov	r9, r4
 3754 0028 012B     		cmp	r3, #1
 3755 002a 75D1     		bne	.L467
 3756              	.L448:
1317:bluetooth_rxtx.c **** 
 3757              		.loc 1 1317 0
 3758 002c 3F4B     		ldr	r3, .L469
 3759 002e 1022     		movs	r2, #16
 3760 0030 1A60     		str	r2, [r3]
1329:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 3761              		.loc 1 1329 0
 3762 0032 FFF7FEFF 		bl	rssi_reset
 3763              	.LVL445:
1330:bluetooth_rxtx.c **** 		while (!rx_tc) {
 3764              		.loc 1 1330 0
 3765 0036 8025     		movs	r5, #128
 3766              	.LVL446:
 3767              	.L437:
1331:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 3768              		.loc 1 1331 0 discriminator 1
 3769 0038 3E4F     		ldr	r7, .L469+8
 3770 003a 3F4E     		ldr	r6, .L469+12
 3771 003c 3B68     		ldr	r3, [r7]
 3772 003e DFF81881 		ldr	r8, .L469+44
 3773 0042 2BBB     		cbnz	r3, .L468
1332:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 3774              		.loc 1 1332 0
 3775 0044 0620     		movs	r0, #6
 3776 0046 FFF7FEFF 		bl	cc2400_get
 3777              	.LVL447:
ARM GAS  /tmp/ccxsBJK4.s 			page 114


1333:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3778              		.loc 1 1333 0
 3779 004a 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
1332:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 3780              		.loc 1 1332 0
 3781 004c C0F30720 		ubfx	r0, r0, #8, #8
 3782              	.LVL448:
1333:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3783              		.loc 1 1333 0
 3784 0050 63B1     		cbz	r3, .L438
1333:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3785              		.loc 1 1333 0 is_stmt 0 discriminator 1
 3786 0052 6BB2     		sxtb	r3, r5
 3787 0054 8033     		adds	r3, r3, #128
 3788 0056 09D1     		bne	.L438
1334:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 3789              		.loc 1 1334 0 is_stmt 1
 3790 0058 384B     		ldr	r3, .L469+16
 3791 005a 40B2     		sxtb	r0, r0
 3792              	.LVL449:
 3793 005c 93F90050 		ldrsb	r5, [r3]
 3794              	.LVL450:
 3795 0060 3635     		adds	r5, r5, #54
 3796 0062 A842     		cmp	r0, r5
 3797 0064 A8BF     		it	ge
 3798 0066 0546     		movge	r5, r0
 3799 0068 EDB2     		uxtb	r5, r5
1335:bluetooth_rxtx.c **** 			}
 3800              		.loc 1 1335 0
 3801 006a 2846     		mov	r0, r5
 3802              	.L438:
 3803              	.LVL451:
1337:bluetooth_rxtx.c **** 
 3804              		.loc 1 1337 0
 3805 006c 40B2     		sxtb	r0, r0
 3806              	.LVL452:
 3807 006e FFF7FEFF 		bl	rssi_add
 3808              	.LVL453:
1339:bluetooth_rxtx.c **** 
 3809              		.loc 1 1339 0
 3810 0072 D8F80000 		ldr	r0, [r8]
 3811 0076 FFF7FEFF 		bl	handle_usb
 3812              	.LVL454:
1342:bluetooth_rxtx.c **** 				hop();
 3813              		.loc 1 1342 0
 3814 007a 99F80B30 		ldrb	r3, [r9, #11]	@ zero_extendqisi2
 3815 007e 13B1     		cbz	r3, .L439
1343:bluetooth_rxtx.c **** 			} else {
 3816              		.loc 1 1343 0
 3817 0080 FFF7FEFF 		bl	hop
 3818              	.LVL455:
 3819 0084 D8E7     		b	.L437
 3820              	.L439:
1345:bluetooth_rxtx.c **** 			}
 3821              		.loc 1 1345 0
 3822 0086 294B     		ldr	r3, .L469
 3823 0088 4FF48072 		mov	r2, #256
ARM GAS  /tmp/ccxsBJK4.s 			page 115


 3824 008c 1A60     		str	r2, [r3]
 3825 008e D3E7     		b	.L437
 3826              	.L468:
1351:bluetooth_rxtx.c **** 
 3827              		.loc 1 1351 0
 3828 0090 2B4B     		ldr	r3, .L469+20
 3829 0092 1022     		movs	r2, #16
1353:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 3830              		.loc 1 1353 0
 3831 0094 2B4D     		ldr	r5, .L469+24
 3832              	.LVL456:
1351:bluetooth_rxtx.c **** 
 3833              		.loc 1 1351 0
 3834 0096 1A60     		str	r2, [r3]
1353:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 3835              		.loc 1 1353 0
 3836 0098 2B68     		ldr	r3, [r5]
 3837 009a 1BB1     		cbz	r3, .L442
1354:bluetooth_rxtx.c **** 		}
 3838              		.loc 1 1354 0
 3839 009c 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3840 009e 43F00203 		orr	r3, r3, #2
 3841 00a2 6370     		strb	r3, [r4, #1]
 3842              	.L442:
1358:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 3843              		.loc 1 1358 0
 3844 00a4 3B68     		ldr	r3, [r7]
 3845 00a6 012B     		cmp	r3, #1
 3846 00a8 03D9     		bls	.L443
1359:bluetooth_rxtx.c **** 
 3847              		.loc 1 1359 0
 3848 00aa 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3849 00ac 43F00103 		orr	r3, r3, #1
 3850 00b0 6370     		strb	r3, [r4, #1]
 3851              	.L443:
1361:bluetooth_rxtx.c **** 			status |= DISCARD;
 3852              		.loc 1 1361 0
 3853 00b2 227C     		ldrb	r2, [r4, #16]	@ zero_extendqisi2
 3854 00b4 1E4B     		ldr	r3, .L469+4
 3855 00b6 2AB1     		cbz	r2, .L444
1362:bluetooth_rxtx.c **** 			dma_discard = 0;
 3856              		.loc 1 1362 0
 3857 00b8 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 3858 00ba 42F02002 		orr	r2, r2, #32
 3859 00be 5A70     		strb	r2, [r3, #1]
1363:bluetooth_rxtx.c **** 		}
 3860              		.loc 1 1363 0
 3861 00c0 0022     		movs	r2, #0
 3862 00c2 1A74     		strb	r2, [r3, #16]
 3863              	.L444:
1366:bluetooth_rxtx.c **** 
 3864              		.loc 1 1366 0
 3865 00c4 204B     		ldr	r3, .L469+28
 3866 00c6 1888     		ldrh	r0, [r3]
 3867 00c8 80B2     		uxth	r0, r0
 3868 00ca FFF7FEFF 		bl	rssi_iir_update
 3869              	.LVL457:
ARM GAS  /tmp/ccxsBJK4.s 			page 116


1372:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 3870              		.loc 1 1372 0
 3871 00ce 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 3872 00d0 13B9     		cbnz	r3, .L445
1372:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 3873              		.loc 1 1372 0 is_stmt 0 discriminator 1
 3874 00d2 1E4B     		ldr	r3, .L469+32
 3875 00d4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3876 00d6 2BB1     		cbz	r3, .L446
 3877              	.L445:
1373:bluetooth_rxtx.c **** 			cs_trigger = 0;
 3878              		.loc 1 1373 0 is_stmt 1
 3879 00d8 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3880 00da 43F00803 		orr	r3, r3, #8
 3881 00de 6370     		strb	r3, [r4, #1]
1374:bluetooth_rxtx.c **** 		}
 3882              		.loc 1 1374 0
 3883 00e0 0023     		movs	r3, #0
 3884 00e2 3370     		strb	r3, [r6]
 3885              	.L446:
1377:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 3886              		.loc 1 1377 0
 3887 00e4 154B     		ldr	r3, .L469+16
 3888 00e6 93F90020 		ldrsb	r2, [r3]
 3889 00ea 194B     		ldr	r3, .L469+36
 3890 00ec 3532     		adds	r2, r2, #53
 3891 00ee 93F90030 		ldrsb	r3, [r3]
 3892 00f2 9A42     		cmp	r2, r3
 3893 00f4 03DA     		bge	.L447
1378:bluetooth_rxtx.c **** 		}
 3894              		.loc 1 1378 0
 3895 00f6 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3896 00f8 43F01003 		orr	r3, r3, #16
 3897 00fc 6370     		strb	r3, [r4, #1]
 3898              	.L447:
1381:bluetooth_rxtx.c **** 
 3899              		.loc 1 1381 0
 3900 00fe 154B     		ldr	r3, .L469+40
 3901 0100 0020     		movs	r0, #0
 3902 0102 1968     		ldr	r1, [r3]
 3903 0104 FFF7FEFF 		bl	enqueue
 3904              	.LVL458:
1383:bluetooth_rxtx.c **** 		rx_tc = 0;
 3905              		.loc 1 1383 0
 3906 0108 D8F80000 		ldr	r0, [r8]
 3907 010c FFF7FEFF 		bl	handle_usb
 3908              	.LVL459:
1384:bluetooth_rxtx.c **** 		rx_err = 0;
 3909              		.loc 1 1384 0
 3910 0110 0023     		movs	r3, #0
 3911 0112 3B60     		str	r3, [r7]
1385:bluetooth_rxtx.c **** 	}
 3912              		.loc 1 1385 0
 3913 0114 2B60     		str	r3, [r5]
 3914 0116 84E7     		b	.L436
 3915              	.L467:
1314:bluetooth_rxtx.c **** 	{
ARM GAS  /tmp/ccxsBJK4.s 			page 117


 3916              		.loc 1 1314 0 discriminator 2
 3917 0118 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 3918 011a 082B     		cmp	r3, #8
 3919 011c 86D0     		beq	.L448
1392:bluetooth_rxtx.c **** 	cs_trigger_disable();
 3920              		.loc 1 1392 0
 3921 011e FFF7FEFF 		bl	dio_ssp_stop
 3922              	.LVL460:
1394:bluetooth_rxtx.c **** 
 3923              		.loc 1 1394 0
 3924 0122 BDE8F843 		pop	{r3, r4, r5, r6, r7, r8, r9, lr}
1393:bluetooth_rxtx.c **** }
 3925              		.loc 1 1393 0
 3926 0126 FFF7FEBF 		b	cs_trigger_disable
 3927              	.LVL461:
 3928              	.L470:
 3929 012a 00BF     		.align	2
 3930              	.L469:
 3931 012c 3CC00920 		.word	537509948
 3932 0130 00000000 		.word	.LANCHOR0
 3933 0134 00000000 		.word	rx_tc
 3934 0138 00000000 		.word	cs_trigger
 3935 013c 00000000 		.word	cs_threshold_cur
 3936 0140 38C00920 		.word	537509944
 3937 0144 00000000 		.word	rx_err
 3938 0148 00000000 		.word	.LANCHOR1
 3939 014c 00000000 		.word	cs_no_squelch
 3940 0150 00000000 		.word	rssi_max
 3941 0154 00000000 		.word	idle_rxbuf
 3942 0158 00000000 		.word	clkn
 3943              		.cfi_endproc
 3944              	.LFE14:
 3946              		.section	.text.br_transmit,"ax",%progbits
 3947              		.align	1
 3948              		.global	br_transmit
 3949              		.thumb
 3950              		.thumb_func
 3952              	br_transmit:
 3953              	.LFB17:
1426:bluetooth_rxtx.c **** 	uint16_t gio_save;
 3954              		.loc 1 1426 0
 3955              		.cfi_startproc
 3956              		@ args = 0, pretend = 0, frame = 16
 3957              		@ frame_needed = 0, uses_anonymous_args = 0
 3958 0000 2DE9FF41 		push	{r0, r1, r2, r3, r4, r5, r6, r7, r8, lr}
 3959              		.cfi_def_cfa_offset 40
 3960              		.cfi_offset 0, -40
 3961              		.cfi_offset 1, -36
 3962              		.cfi_offset 2, -32
 3963              		.cfi_offset 3, -28
 3964              		.cfi_offset 4, -24
 3965              		.cfi_offset 5, -20
 3966              		.cfi_offset 6, -16
 3967              		.cfi_offset 7, -12
 3968              		.cfi_offset 8, -8
 3969              		.cfi_offset 14, -4
 3970              	.LVL462:
ARM GAS  /tmp/ccxsBJK4.s 			page 118


1431:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 3971              		.loc 1 1431 0
 3972 0004 954B     		ldr	r3, .L507
 3973 0006 0122     		movs	r2, #1
 3974 0008 D3E90245 		ldrd	r4, [r3, #8]
 3975 000c 0023     		movs	r3, #0
 3976 000e 2240     		ands	r2, r2, r4
 3977 0010 2B40     		ands	r3, r3, r5
 3978 0012 52EA0301 		orrs	r1, r2, r3
1432:bluetooth_rxtx.c **** 
 3979              		.loc 1 1432 0
 3980 0016 4FF00007 		mov	r7, #0
1431:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 3981              		.loc 1 1431 0
 3982 001a 45F25553 		movw	r3, #21845
1432:bluetooth_rxtx.c **** 
 3983              		.loc 1 1432 0
 3984 001e 4FEAD576 		lsr	r6, r5, #31
1431:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 3985              		.loc 1 1431 0
 3986 0022 4AF6AA28 		movw	r8, #43690
 3987 0026 18BF     		it	ne
 3988 0028 9846     		movne	r8, r3
 3989              	.LVL463:
1435:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 3990              		.loc 1 1435 0
 3991 002a E0B2     		uxtb	r0, r4
1432:bluetooth_rxtx.c **** 
 3992              		.loc 1 1432 0
 3993 002c 002F     		cmp	r7, #0
 3994 002e 08BF     		it eq
 3995 0030 012E     		cmpeq	r6, #1
 3996 0032 14BF     		ite	ne
 3997 0034 5526     		movne	r6, #85
 3998 0036 AA26     		moveq	r6, #170
 3999              	.LVL464:
1435:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 4000              		.loc 1 1435 0
 4001 0038 FFF7FEFF 		bl	reverse8
 4002              	.LVL465:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4003              		.loc 1 1434 0
 4004 003c 8DF80000 		strb	r0, [sp]
1436:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
 4005              		.loc 1 1436 0
 4006 0040 C4F30720 		ubfx	r0, r4, #8, #8
 4007 0044 FFF7FEFF 		bl	reverse8
 4008              	.LVL466:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4009              		.loc 1 1434 0
 4010 0048 8DF80100 		strb	r0, [sp, #1]
1437:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
 4011              		.loc 1 1437 0
 4012 004c C4F30740 		ubfx	r0, r4, #16, #8
 4013 0050 FFF7FEFF 		bl	reverse8
 4014              	.LVL467:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
ARM GAS  /tmp/ccxsBJK4.s 			page 119


 4015              		.loc 1 1434 0
 4016 0054 8DF80200 		strb	r0, [sp, #2]
1438:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
 4017              		.loc 1 1438 0
 4018 0058 200E     		lsrs	r0, r4, #24
 4019 005a FFF7FEFF 		bl	reverse8
 4020              	.LVL468:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4021              		.loc 1 1434 0
 4022 005e 8DF80300 		strb	r0, [sp, #3]
1439:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
 4023              		.loc 1 1439 0
 4024 0062 E8B2     		uxtb	r0, r5
 4025 0064 FFF7FEFF 		bl	reverse8
 4026              	.LVL469:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4027              		.loc 1 1434 0
 4028 0068 8DF80400 		strb	r0, [sp, #4]
1440:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
 4029              		.loc 1 1440 0
 4030 006c C5F30720 		ubfx	r0, r5, #8, #8
 4031 0070 FFF7FEFF 		bl	reverse8
 4032              	.LVL470:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4033              		.loc 1 1434 0
 4034 0074 8DF80500 		strb	r0, [sp, #5]
1441:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
 4035              		.loc 1 1441 0
 4036 0078 C5F30740 		ubfx	r0, r5, #16, #8
 4037 007c FFF7FEFF 		bl	reverse8
 4038              	.LVL471:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4039              		.loc 1 1434 0
 4040 0080 8DF80600 		strb	r0, [sp, #6]
1442:bluetooth_rxtx.c **** 		reverse8(trailer),
 4041              		.loc 1 1442 0
 4042 0084 280E     		lsrs	r0, r5, #24
 4043 0086 FFF7FEFF 		bl	reverse8
 4044              	.LVL472:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4045              		.loc 1 1434 0
 4046 008a 8DF80700 		strb	r0, [sp, #7]
1443:bluetooth_rxtx.c **** 		reverse8(0x77),
 4047              		.loc 1 1443 0
 4048 008e 3046     		mov	r0, r6
 4049 0090 FFF7FEFF 		bl	reverse8
 4050              	.LVL473:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4051              		.loc 1 1434 0
 4052 0094 8DF80800 		strb	r0, [sp, #8]
1444:bluetooth_rxtx.c **** 		reverse8(0x66),
 4053              		.loc 1 1444 0
 4054 0098 7720     		movs	r0, #119
 4055 009a FFF7FEFF 		bl	reverse8
 4056              	.LVL474:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4057              		.loc 1 1434 0
ARM GAS  /tmp/ccxsBJK4.s 			page 120


 4058 009e 8DF80900 		strb	r0, [sp, #9]
1445:bluetooth_rxtx.c **** 		reverse8(0x55),
 4059              		.loc 1 1445 0
 4060 00a2 6620     		movs	r0, #102
 4061 00a4 FFF7FEFF 		bl	reverse8
 4062              	.LVL475:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4063              		.loc 1 1434 0
 4064 00a8 8DF80A00 		strb	r0, [sp, #10]
1446:bluetooth_rxtx.c **** 		reverse8(0x44),
 4065              		.loc 1 1446 0
 4066 00ac 5520     		movs	r0, #85
 4067 00ae FFF7FEFF 		bl	reverse8
 4068              	.LVL476:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4069              		.loc 1 1434 0
 4070 00b2 8DF80B00 		strb	r0, [sp, #11]
1447:bluetooth_rxtx.c **** 		reverse8(0x33),
 4071              		.loc 1 1447 0
 4072 00b6 4420     		movs	r0, #68
 4073 00b8 FFF7FEFF 		bl	reverse8
 4074              	.LVL477:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4075              		.loc 1 1434 0
 4076 00bc 8DF80C00 		strb	r0, [sp, #12]
1448:bluetooth_rxtx.c **** 		reverse8(0x22),
 4077              		.loc 1 1448 0
 4078 00c0 3320     		movs	r0, #51
 4079 00c2 FFF7FEFF 		bl	reverse8
 4080              	.LVL478:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4081              		.loc 1 1434 0
 4082 00c6 8DF80D00 		strb	r0, [sp, #13]
1449:bluetooth_rxtx.c **** 		reverse8(0x11)
 4083              		.loc 1 1449 0
 4084 00ca 2220     		movs	r0, #34
 4085 00cc FFF7FEFF 		bl	reverse8
 4086              	.LVL479:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4087              		.loc 1 1434 0
 4088 00d0 8DF80E00 		strb	r0, [sp, #14]
1450:bluetooth_rxtx.c **** 	};
 4089              		.loc 1 1450 0
 4090 00d4 1120     		movs	r0, #17
 4091 00d6 FFF7FEFF 		bl	reverse8
 4092              	.LVL480:
 4093              	.LBB29:
 4094              	.LBB30:
1410:bluetooth_rxtx.c **** 
 4095              		.loc 1 1410 0
 4096 00da 3C46     		mov	r4, r7
 4097              	.LBE30:
 4098              	.LBE29:
1434:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4099              		.loc 1 1434 0
 4100 00dc 8DF80F00 		strb	r0, [sp, #15]
 4101              	.LVL481:
ARM GAS  /tmp/ccxsBJK4.s 			page 121


 4102              	.LBB33:
 4103              	.LBB32:
 4104              	.LBB31:
1412:bluetooth_rxtx.c **** 	{
 4105              		.loc 1 1412 0
 4106 00e0 3B46     		mov	r3, r7
 4107              	.LVL482:
 4108              	.L475:
1414:bluetooth_rxtx.c **** 	}
 4109              		.loc 1 1414 0
 4110 00e2 48FA03F2 		asr	r2, r8, r3
 4111 00e6 C3F10F01 		rsb	r1, r3, #15
 4112 00ea 02F00102 		and	r2, r2, #1
 4113 00ee 8A40     		lsls	r2, r2, r1
1412:bluetooth_rxtx.c **** 	{
 4114              		.loc 1 1412 0
 4115 00f0 0133     		adds	r3, r3, #1
 4116              	.LVL483:
1414:bluetooth_rxtx.c **** 	}
 4117              		.loc 1 1414 0
 4118 00f2 1443     		orrs	r4, r4, r2
 4119              	.LVL484:
1412:bluetooth_rxtx.c **** 	{
 4120              		.loc 1 1412 0
 4121 00f4 102B     		cmp	r3, #16
1414:bluetooth_rxtx.c **** 	}
 4122              		.loc 1 1414 0
 4123 00f6 A4B2     		uxth	r4, r4
 4124              	.LVL485:
1412:bluetooth_rxtx.c **** 	{
 4125              		.loc 1 1412 0
 4126 00f8 F3D1     		bne	.L475
 4127              	.LVL486:
 4128              	.LBE31:
 4129              	.LBE32:
 4130              	.LBE33:
 4131              	.LBB34:
 4132              	.LBB35:
1031:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 4133              		.loc 1 1031 0
 4134 00fa 0D20     		movs	r0, #13
 4135 00fc 47F6FF71 		movw	r1, #32767
 4136 0100 FFF7FEFF 		bl	cc2400_set
 4137              	.LVL487:
1032:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 4138              		.loc 1 1032 0
 4139 0104 1220     		movs	r0, #18
 4140 0106 42F62231 		movw	r1, #11042
 4141 010a FFF7FEFF 		bl	cc2400_set
 4142              	.LVL488:
1033:bluetooth_rxtx.c **** 
 4143              		.loc 1 1033 0
 4144 010e 1420     		movs	r0, #20
 4145 0110 41F24B31 		movw	r1, #4939
 4146 0114 FFF7FEFF 		bl	cc2400_set
 4147              	.LVL489:
1035:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
ARM GAS  /tmp/ccxsBJK4.s 			page 122


 4148              		.loc 1 1035 0
 4149 0118 2020     		movs	r0, #32
 4150 011a 40F60141 		movw	r1, #3073
 4151 011e FFF7FEFF 		bl	cc2400_set
 4152              	.LVL490:
1043:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 4153              		.loc 1 1043 0
 4154 0122 2146     		mov	r1, r4
 4155 0124 2C20     		movs	r0, #44
 4156 0126 FFF7FEFF 		bl	cc2400_set
 4157              	.LVL491:
1044:bluetooth_rxtx.c **** 
 4158              		.loc 1 1044 0
 4159 012a 2D20     		movs	r0, #45
 4160 012c 0021     		movs	r1, #0
 4161 012e FFF7FEFF 		bl	cc2400_set
 4162              	.LVL492:
1046:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 4163              		.loc 1 1046 0
 4164 0132 4B4B     		ldr	r3, .L507+4
 4165 0134 0220     		movs	r0, #2
 4166 0136 1988     		ldrh	r1, [r3]
1049:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 4167              		.loc 1 1049 0
 4168 0138 4A4C     		ldr	r4, .L507+8
 4169              	.LVL493:
1046:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 4170              		.loc 1 1046 0
 4171 013a 89B2     		uxth	r1, r1
 4172 013c FFF7FEFF 		bl	cc2400_set
 4173              	.LVL494:
1047:bluetooth_rxtx.c **** 
 4174              		.loc 1 1047 0
 4175 0140 0520     		movs	r0, #5
 4176 0142 0B21     		movs	r1, #11
 4177 0144 FFF7FEFF 		bl	cc2400_set
 4178              	.LVL495:
1049:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 4179              		.loc 1 1049 0
 4180 0148 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4181 014a 13B9     		cbnz	r3, .L476
1050:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 4182              		.loc 1 1050 0
 4183 014c 0320     		movs	r0, #3
 4184 014e 2921     		movs	r1, #41
 4185 0150 04E0     		b	.L505
 4186              	.L476:
1051:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 4187              		.loc 1 1051 0
 4188 0152 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4189 0154 012B     		cmp	r3, #1
 4190 0156 1DD1     		bne	.L478
1052:bluetooth_rxtx.c **** 	} else {
 4191              		.loc 1 1052 0
 4192 0158 0320     		movs	r0, #3
 4193 015a 4021     		movs	r1, #64
 4194              	.L505:
ARM GAS  /tmp/ccxsBJK4.s 			page 123


 4195 015c FFF7FEFF 		bl	cc2400_set
 4196              	.LVL496:
1058:bluetooth_rxtx.c **** 
 4197              		.loc 1 1058 0
 4198 0160 FFF7FEFF 		bl	clkn_start
 4199              	.LVL497:
 4200              	.L480:
1060:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 4201              		.loc 1 1060 0
 4202 0164 FFF7FEFF 		bl	cc2400_status
 4203              	.LVL498:
 4204 0168 4506     		lsls	r5, r0, #25
 4205 016a FBD5     		bpl	.L480
1061:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 4206              		.loc 1 1061 0
 4207 016c 6120     		movs	r0, #97
 4208 016e FFF7FEFF 		bl	cc2400_strobe
 4209              	.LVL499:
 4210              	.L482:
1062:bluetooth_rxtx.c **** 
 4211              		.loc 1 1062 0
 4212 0172 FFF7FEFF 		bl	cc2400_status
 4213              	.LVL500:
 4214 0176 4007     		lsls	r0, r0, #29
 4215 0178 FBD5     		bpl	.L482
1065:bluetooth_rxtx.c **** #endif
 4216              		.loc 1 1065 0
 4217 017a 3B4B     		ldr	r3, .L507+12
 4218 017c 8022     		movs	r2, #128
 4219 017e 1A60     		str	r2, [r3]
 4220              	.L484:
1068:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 4221              		.loc 1 1068 0
 4222 0180 0E20     		movs	r0, #14
 4223 0182 FFF7FEFF 		bl	cc2400_get
 4224              	.LVL501:
 4225 0186 00F01F00 		and	r0, r0, #31
 4226 018a 0F28     		cmp	r0, #15
 4227 018c F8D1     		bne	.L484
1069:bluetooth_rxtx.c **** 
 4228              		.loc 1 1069 0
 4229 018e 6320     		movs	r0, #99
 4230 0190 FFF7FEFF 		bl	cc2400_strobe
 4231              	.LVL502:
 4232              	.L478:
 4233              	.LBE35:
 4234              	.LBE34:
1455:bluetooth_rxtx.c **** 
 4235              		.loc 1 1455 0 discriminator 3
 4236 0194 1421     		movs	r1, #20
 4237 0196 2320     		movs	r0, #35
 4238 0198 FFF7FEFF 		bl	cc2400_set
 4239              	.LVL503:
1458:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4240              		.loc 1 1458 0 discriminator 3
 4241 019c 0820     		movs	r0, #8
 4242 019e FFF7FEFF 		bl	cc2400_get
ARM GAS  /tmp/ccxsBJK4.s 			page 124


 4243              	.LVL504:
1459:bluetooth_rxtx.c **** 
 4244              		.loc 1 1459 0 discriminator 3
 4245 01a2 C0F30801 		ubfx	r1, r0, #0, #9
1458:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4246              		.loc 1 1458 0 discriminator 3
 4247 01a6 0546     		mov	r5, r0
 4248              	.LVL505:
1459:bluetooth_rxtx.c **** 
 4249              		.loc 1 1459 0 discriminator 3
 4250 01a8 41F49C41 		orr	r1, r1, #19968
 4251 01ac 0820     		movs	r0, #8
 4252              	.LVL506:
 4253 01ae FFF7FEFF 		bl	cc2400_set
 4254              	.LVL507:
1429:bluetooth_rxtx.c **** 
 4255              		.loc 1 1429 0 discriminator 3
 4256 01b2 0026     		movs	r6, #0
 4257              	.LVL508:
 4258              	.L485:
1461:bluetooth_rxtx.c **** 	{
 4259              		.loc 1 1461 0 discriminator 1
 4260 01b4 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4261 01b6 022B     		cmp	r3, #2
 4262 01b8 45D1     		bne	.L499
1464:bluetooth_rxtx.c **** 
 4263              		.loc 1 1464 0
 4264 01ba 7608     		lsrs	r6, r6, #1
 4265              	.LVL509:
 4266              	.L487:
1464:bluetooth_rxtx.c **** 
 4267              		.loc 1 1464 0 is_stmt 0 discriminator 1
 4268 01bc 2B4F     		ldr	r7, .L507+16
 4269 01be 3B68     		ldr	r3, [r7]
 4270 01c0 B6EB530F 		cmp	r6, r3, lsr #1
 4271 01c4 05D1     		bne	.L506
 4272              	.L488:
1467:bluetooth_rxtx.c **** 				hop();
 4273              		.loc 1 1467 0 is_stmt 1
 4274 01c6 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4275 01c8 002B     		cmp	r3, #0
 4276 01ca F7D0     		beq	.L487
1468:bluetooth_rxtx.c **** 			}
 4277              		.loc 1 1468 0
 4278 01cc FFF7FEFF 		bl	hop
 4279              	.LVL510:
 4280 01d0 F4E7     		b	.L487
 4281              	.L506:
1464:bluetooth_rxtx.c **** 
 4282              		.loc 1 1464 0 discriminator 2
 4283 01d2 274B     		ldr	r3, .L507+20
 4284 01d4 1A68     		ldr	r2, [r3]
 4285 01d6 40F6C903 		movw	r3, #2249
 4286 01da 9A42     		cmp	r2, r3
 4287 01dc F3D9     		bls	.L488
1474:bluetooth_rxtx.c **** 
 4288              		.loc 1 1474 0
ARM GAS  /tmp/ccxsBJK4.s 			page 125


 4289 01de 254B     		ldr	r3, .L507+24
 4290 01e0 4FF48072 		mov	r2, #256
1472:bluetooth_rxtx.c **** 
 4291              		.loc 1 1472 0
 4292 01e4 3E68     		ldr	r6, [r7]
 4293              	.LVL511:
1476:bluetooth_rxtx.c **** 
 4294              		.loc 1 1476 0
 4295 01e6 1020     		movs	r0, #16
1474:bluetooth_rxtx.c **** 
 4296              		.loc 1 1474 0
 4297 01e8 1A60     		str	r2, [r3]
1476:bluetooth_rxtx.c **** 
 4298              		.loc 1 1476 0
 4299 01ea 6946     		mov	r1, sp
 4300 01ec FFF7FEFF 		bl	cc2400_fifo_write
 4301              	.LVL512:
 4302              	.L490:
1478:bluetooth_rxtx.c **** 		TXLED_CLR;
 4303              		.loc 1 1478 0 discriminator 1
 4304 01f0 0E20     		movs	r0, #14
 4305 01f2 FFF7FEFF 		bl	cc2400_get
 4306              	.LVL513:
 4307 01f6 00F01F00 		and	r0, r0, #31
 4308 01fa 0F28     		cmp	r0, #15
 4309 01fc F8D1     		bne	.L490
1479:bluetooth_rxtx.c **** 
 4310              		.loc 1 1479 0
 4311 01fe 1E4B     		ldr	r3, .L507+28
 4312 0200 4FF48072 		mov	r2, #256
 4313 0204 1A60     		str	r2, [r3]
1481:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 4314              		.loc 1 1481 0
 4315 0206 6420     		movs	r0, #100
 4316 0208 FFF7FEFF 		bl	cc2400_strobe
 4317              	.LVL514:
 4318              	.L492:
1482:bluetooth_rxtx.c **** 
 4319              		.loc 1 1482 0 discriminator 1
 4320 020c FFF7FEFF 		bl	cc2400_status
 4321              	.LVL515:
 4322 0210 4107     		lsls	r1, r0, #29
 4323 0212 FBD4     		bmi	.L492
 4324              	.L494:
1484:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 4325              		.loc 1 1484 0
 4326 0214 FFF7FEFF 		bl	cc2400_status
 4327              	.LVL516:
 4328 0218 4206     		lsls	r2, r0, #25
 4329 021a FBD5     		bpl	.L494
1485:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 4330              		.loc 1 1485 0
 4331 021c 6120     		movs	r0, #97
 4332 021e FFF7FEFF 		bl	cc2400_strobe
 4333              	.LVL517:
 4334              	.L496:
1486:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccxsBJK4.s 			page 126


 4335              		.loc 1 1486 0 discriminator 1
 4336 0222 FFF7FEFF 		bl	cc2400_status
 4337              	.LVL518:
 4338 0226 4307     		lsls	r3, r0, #29
 4339 0228 FBD5     		bpl	.L496
 4340              	.L498:
1488:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 4341              		.loc 1 1488 0
 4342 022a 0E20     		movs	r0, #14
 4343 022c FFF7FEFF 		bl	cc2400_get
 4344              	.LVL519:
 4345 0230 00F01F00 		and	r0, r0, #31
 4346 0234 0F28     		cmp	r0, #15
 4347 0236 F8D1     		bne	.L498
1489:bluetooth_rxtx.c **** 
 4348              		.loc 1 1489 0
 4349 0238 6320     		movs	r0, #99
 4350 023a FFF7FEFF 		bl	cc2400_strobe
 4351              	.LVL520:
1491:bluetooth_rxtx.c **** 	}
 4352              		.loc 1 1491 0
 4353 023e 3868     		ldr	r0, [r7]
 4354 0240 FFF7FEFF 		bl	handle_usb
 4355              	.LVL521:
 4356 0244 B6E7     		b	.L485
 4357              	.L499:
1495:bluetooth_rxtx.c **** #endif
 4358              		.loc 1 1495 0
 4359 0246 0D4B     		ldr	r3, .L507+32
 4360 0248 8022     		movs	r2, #128
 4361 024a 1A60     		str	r2, [r3]
1499:bluetooth_rxtx.c **** }
 4362              		.loc 1 1499 0
 4363 024c 0820     		movs	r0, #8
 4364 024e 2946     		mov	r1, r5
 4365 0250 FFF7FEFF 		bl	cc2400_set
 4366              	.LVL522:
1500:bluetooth_rxtx.c **** 
 4367              		.loc 1 1500 0
 4368 0254 04B0     		add	sp, sp, #16
 4369              		@ sp needed
 4370 0256 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 4371              	.LVL523:
 4372              	.L508:
 4373 025a 00BF     		.align	2
 4374              	.L507:
 4375 025c 00000000 		.word	target
 4376 0260 00000000 		.word	.LANCHOR1
 4377 0264 00000000 		.word	.LANCHOR0
 4378 0268 58C00920 		.word	537509976
 4379 026c 00000000 		.word	clkn
 4380 0270 08400040 		.word	1073758216
 4381 0274 38C00920 		.word	537509944
 4382 0278 3CC00920 		.word	537509948
 4383 027c 5CC00920 		.word	537509980
 4384              		.cfi_endproc
 4385              	.LFE17:
ARM GAS  /tmp/ccxsBJK4.s 			page 127


 4387              		.section	.text.reset_le,"ax",%progbits
 4388              		.align	1
 4389              		.global	reset_le
 4390              		.thumb
 4391              		.thumb_func
 4393              	reset_le:
 4394              	.LFB19:
1513:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
 4395              		.loc 1 1513 0
 4396              		.cfi_startproc
 4397              		@ args = 0, pretend = 0, frame = 0
 4398              		@ frame_needed = 0, uses_anonymous_args = 0
 4399 0000 08B5     		push	{r3, lr}
 4400              		.cfi_def_cfa_offset 8
 4401              		.cfi_offset 3, -8
 4402              		.cfi_offset 14, -4
1514:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
 4403              		.loc 1 1514 0
 4404 0002 0F48     		ldr	r0, .L510
 4405 0004 FFF7FEFF 		bl	le_set_access_address
 4406              	.LVL524:
1515:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
 4407              		.loc 1 1515 0
 4408 0008 0E4B     		ldr	r3, .L510+4
 4409 000a 0F4A     		ldr	r2, .L510+8
 4410 000c DA60     		str	r2, [r3, #12]
1516:bluetooth_rxtx.c **** 	le.crc_verify = 0;
 4411              		.loc 1 1516 0
 4412 000e 0F4A     		ldr	r2, .L510+12
 4413 0010 1A61     		str	r2, [r3, #16]
1517:bluetooth_rxtx.c **** 	le.last_packet = 0;
 4414              		.loc 1 1517 0
 4415 0012 0022     		movs	r2, #0
1526:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 4416              		.loc 1 1526 0
 4417 0014 1A84     		strh	r2, [r3, #32]	@ movhi
1517:bluetooth_rxtx.c **** 	le.last_packet = 0;
 4418              		.loc 1 1517 0
 4419 0016 5A61     		str	r2, [r3, #20]
1529:bluetooth_rxtx.c **** 
 4420              		.loc 1 1529 0
 4421 0018 9A84     		strh	r2, [r3, #36]	@ movhi
1518:bluetooth_rxtx.c **** 
 4422              		.loc 1 1518 0
 4423 001a 5A64     		str	r2, [r3, #68]
1520:bluetooth_rxtx.c **** 
 4424              		.loc 1 1520 0
 4425 001c 1A76     		strb	r2, [r3, #24]
1522:bluetooth_rxtx.c **** 	le.channel_increment = 0;
 4426              		.loc 1 1522 0
 4427 001e 5A76     		strb	r2, [r3, #25]
1523:bluetooth_rxtx.c **** 
 4428              		.loc 1 1523 0
 4429 0020 9A76     		strb	r2, [r3, #26]
1525:bluetooth_rxtx.c **** 	le.interval_timer = 0;
 4430              		.loc 1 1525 0
 4431 0022 DA61     		str	r2, [r3, #28]
ARM GAS  /tmp/ccxsBJK4.s 			page 128


1527:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 4432              		.loc 1 1527 0
 4433 0024 5A84     		strh	r2, [r3, #34]	@ movhi
1531:bluetooth_rxtx.c **** 	le.win_offset = 0;
 4434              		.loc 1 1531 0
 4435 0026 83F82620 		strb	r2, [r3, #38]
1532:bluetooth_rxtx.c **** 
 4436              		.loc 1 1532 0
 4437 002a 1A85     		strh	r2, [r3, #40]	@ movhi
1534:bluetooth_rxtx.c **** 	le.update_instant = 0;
 4438              		.loc 1 1534 0
 4439 002c DA62     		str	r2, [r3, #44]
1535:bluetooth_rxtx.c **** 	le.interval_update = 0;
 4440              		.loc 1 1535 0
 4441 002e 1A86     		strh	r2, [r3, #48]	@ movhi
1536:bluetooth_rxtx.c **** 	le.win_size_update = 0;
 4442              		.loc 1 1536 0
 4443 0030 5A86     		strh	r2, [r3, #50]	@ movhi
1537:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
 4444              		.loc 1 1537 0
 4445 0032 83F83420 		strb	r2, [r3, #52]
1538:bluetooth_rxtx.c **** 
 4446              		.loc 1 1538 0
 4447 0036 DA86     		strh	r2, [r3, #54]	@ movhi
1540:bluetooth_rxtx.c **** }
 4448              		.loc 1 1540 0
 4449 0038 054B     		ldr	r3, .L510+16
 4450 003a DA72     		strb	r2, [r3, #11]
 4451 003c 08BD     		pop	{r3, pc}
 4452              	.L511:
 4453 003e 00BF     		.align	2
 4454              	.L510:
 4455 0040 D6BE898E 		.word	-1903575338
 4456 0044 00000000 		.word	.LANCHOR1
 4457 0048 55555500 		.word	5592405
 4458 004c AAAAAA00 		.word	11184810
 4459 0050 00000000 		.word	.LANCHOR0
 4460              		.cfi_endproc
 4461              	.LFE19:
 4463              		.section	.text.reset_le_promisc,"ax",%progbits
 4464              		.align	1
 4465              		.global	reset_le_promisc
 4466              		.thumb
 4467              		.thumb_func
 4469              	reset_le_promisc:
 4470              	.LFB20:
1544:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
 4471              		.loc 1 1544 0
 4472              		.cfi_startproc
 4473              		@ args = 0, pretend = 0, frame = 0
 4474              		@ frame_needed = 0, uses_anonymous_args = 0
 4475 0000 10B5     		push	{r4, lr}
 4476              		.cfi_def_cfa_offset 8
 4477              		.cfi_offset 4, -8
 4478              		.cfi_offset 14, -4
1545:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
 4479              		.loc 1 1545 0
ARM GAS  /tmp/ccxsBJK4.s 			page 129


 4480 0002 064C     		ldr	r4, .L513
 4481 0004 0021     		movs	r1, #0
 4482 0006 2046     		mov	r0, r4
 4483 0008 4FF48472 		mov	r2, #264
 4484 000c FFF7FEFF 		bl	memset
 4485              	.LVL525:
1546:bluetooth_rxtx.c **** }
 4486              		.loc 1 1546 0
 4487 0010 4FF0FF33 		mov	r3, #-1
 4488 0014 C4F80031 		str	r3, [r4, #256]
 4489 0018 10BD     		pop	{r4, pc}
 4490              	.L514:
 4491 001a 00BF     		.align	2
 4492              	.L513:
 4493 001c 00000000 		.word	le_promisc
 4494              		.cfi_endproc
 4495              	.LFE20:
 4497              		.section	.text.bt_generic_le,"ax",%progbits
 4498              		.align	1
 4499              		.global	bt_generic_le
 4500              		.thumb
 4501              		.thumb_func
 4503              	bt_generic_le:
 4504              	.LFB21:
1551:bluetooth_rxtx.c **** 	u8 hold;
 4505              		.loc 1 1551 0
 4506              		.cfi_startproc
 4507              		@ args = 0, pretend = 0, frame = 0
 4508              		@ frame_needed = 0, uses_anonymous_args = 0
 4509              	.LVL526:
 4510 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 4511              		.cfi_def_cfa_offset 32
 4512              		.cfi_offset 3, -32
 4513              		.cfi_offset 4, -28
 4514              		.cfi_offset 5, -24
 4515              		.cfi_offset 6, -20
 4516              		.cfi_offset 7, -16
 4517              		.cfi_offset 8, -12
 4518              		.cfi_offset 9, -8
 4519              		.cfi_offset 14, -4
1556:bluetooth_rxtx.c **** 	mode = active_mode;
 4520              		.loc 1 1556 0
 4521 0004 694C     		ldr	r4, .L560
 4522 0006 0123     		movs	r3, #1
1551:bluetooth_rxtx.c **** 	u8 hold;
 4523              		.loc 1 1551 0
 4524 0008 8046     		mov	r8, r0
1556:bluetooth_rxtx.c **** 	mode = active_mode;
 4525              		.loc 1 1556 0
 4526 000a 2370     		strb	r3, [r4]
1557:bluetooth_rxtx.c **** 
 4527              		.loc 1 1557 0
 4528 000c 6074     		strb	r0, [r4, #17]
1559:bluetooth_rxtx.c **** 
 4529              		.loc 1 1559 0
 4530 000e FFF7FEFF 		bl	reset_le
 4531              	.LVL527:
ARM GAS  /tmp/ccxsBJK4.s 			page 130


1562:bluetooth_rxtx.c **** 
 4532              		.loc 1 1562 0
 4533 0012 674B     		ldr	r3, .L560+4
 4534 0014 4FF08072 		mov	r2, #16777216
 4535 0018 1A60     		str	r2, [r3]
1564:bluetooth_rxtx.c **** 
 4536              		.loc 1 1564 0
 4537 001a 664B     		ldr	r3, .L560+8
 4538 001c 1022     		movs	r2, #16
 4539 001e 1A60     		str	r2, [r3]
1566:bluetooth_rxtx.c **** 	dio_ssp_init();
 4540              		.loc 1 1566 0
 4541 0020 FFF7FEFF 		bl	queue_init
 4542              	.LVL528:
1567:bluetooth_rxtx.c **** 	dma_init();
 4543              		.loc 1 1567 0
 4544 0024 FFF7FEFF 		bl	dio_ssp_init
 4545              	.LVL529:
1568:bluetooth_rxtx.c **** 	dio_ssp_start();
 4546              		.loc 1 1568 0
 4547 0028 FFF7FEFF 		bl	dma_init
 4548              	.LVL530:
1569:bluetooth_rxtx.c **** 	cc2400_rx();
 4549              		.loc 1 1569 0
 4550 002c FFF7FEFF 		bl	dio_ssp_start
 4551              	.LVL531:
1570:bluetooth_rxtx.c **** 
 4552              		.loc 1 1570 0
 4553 0030 FFF7FEFF 		bl	cc2400_rx
 4554              	.LVL532:
1572:bluetooth_rxtx.c **** 
 4555              		.loc 1 1572 0
 4556 0034 FFF7FEFF 		bl	cs_trigger_enable
 4557              	.LVL533:
1574:bluetooth_rxtx.c **** 
 4558              		.loc 1 1574 0
 4559 0038 0025     		movs	r5, #0
 4560              	.LVL534:
 4561              	.L516:
1576:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 4562              		.loc 1 1576 0 discriminator 1
 4563 003a A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4564 003c 4345     		cmp	r3, r8
 4565 003e 40F0A380 		bne	.L540
 4566              	.LBB36:
1577:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 4567              		.loc 1 1577 0
 4568 0042 5A4B     		ldr	r3, .L560
 4569 0044 DB89     		ldrh	r3, [r3, #14]
 4570 0046 9BB2     		uxth	r3, r3
 4571 0048 D3B1     		cbz	r3, .L517
1578:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 4572              		.loc 1 1578 0
 4573 004a 6420     		movs	r0, #100
 4574 004c FFF7FEFF 		bl	cc2400_strobe
 4575              	.LVL535:
 4576              	.L519:
ARM GAS  /tmp/ccxsBJK4.s 			page 131


1579:bluetooth_rxtx.c **** 
 4577              		.loc 1 1579 0 discriminator 1
 4578 0050 FFF7FEFF 		bl	cc2400_status
 4579              	.LVL536:
 4580 0054 4707     		lsls	r7, r0, #29
 4581 0056 FBD4     		bmi	.L519
1582:bluetooth_rxtx.c **** 
 4582              		.loc 1 1582 0
 4583 0058 574B     		ldr	r3, .L560+12
 4584 005a 0220     		movs	r0, #2
 4585 005c 1988     		ldrh	r1, [r3]
 4586 005e 89B2     		uxth	r1, r1
 4587 0060 0139     		subs	r1, r1, #1
 4588 0062 89B2     		uxth	r1, r1
 4589 0064 FFF7FEFF 		bl	cc2400_set
 4590              	.LVL537:
1585:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 4591              		.loc 1 1585 0
 4592 0068 6120     		movs	r0, #97
 4593 006a FFF7FEFF 		bl	cc2400_strobe
 4594              	.LVL538:
 4595              	.L521:
1586:bluetooth_rxtx.c **** 
 4596              		.loc 1 1586 0 discriminator 1
 4597 006e FFF7FEFF 		bl	cc2400_status
 4598              	.LVL539:
 4599 0072 4607     		lsls	r6, r0, #29
 4600 0074 FBD5     		bpl	.L521
1589:bluetooth_rxtx.c **** 
 4601              		.loc 1 1589 0
 4602 0076 6220     		movs	r0, #98
 4603 0078 FFF7FEFF 		bl	cc2400_strobe
 4604              	.LVL540:
1591:bluetooth_rxtx.c **** 		}
 4605              		.loc 1 1591 0
 4606 007c 0023     		movs	r3, #0
 4607 007e E381     		strh	r3, [r4, #14]	@ movhi
 4608              	.L517:
1594:bluetooth_rxtx.c **** 			hop();
 4609              		.loc 1 1594 0
 4610 0080 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4611 0082 4C4E     		ldr	r6, .L560+8
 4612 0084 13B1     		cbz	r3, .L522
1595:bluetooth_rxtx.c **** 		} else {
 4613              		.loc 1 1595 0
 4614 0086 FFF7FEFF 		bl	hop
 4615              	.LVL541:
 4616 008a 02E0     		b	.L523
 4617              	.L522:
1597:bluetooth_rxtx.c **** 		}
 4618              		.loc 1 1597 0
 4619 008c 4FF48073 		mov	r3, #256
 4620 0090 3360     		str	r3, [r6]
 4621              	.L523:
1600:bluetooth_rxtx.c **** 
 4622              		.loc 1 1600 0
 4623 0092 1023     		movs	r3, #16
ARM GAS  /tmp/ccxsBJK4.s 			page 132


 4624 0094 3360     		str	r3, [r6]
1603:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 4625              		.loc 1 1603 0
 4626 0096 FFF7FEFF 		bl	rssi_reset
 4627              	.LVL542:
1604:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
 4628              		.loc 1 1604 0
 4629 009a 8027     		movs	r7, #128
 4630              	.LVL543:
 4631              	.L524:
1605:bluetooth_rxtx.c **** 		{
 4632              		.loc 1 1605 0 discriminator 1
 4633 009c 474B     		ldr	r3, .L560+16
 4634 009e 484E     		ldr	r6, .L560+20
 4635 00a0 1A68     		ldr	r2, [r3]
 4636 00a2 9946     		mov	r9, r3
 4637 00a4 D2B9     		cbnz	r2, .L526
1605:bluetooth_rxtx.c **** 		{
 4638              		.loc 1 1605 0 is_stmt 0 discriminator 2
 4639 00a6 3368     		ldr	r3, [r6]
 4640 00a8 C3B9     		cbnz	r3, .L526
1607:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4641              		.loc 1 1607 0 is_stmt 1
 4642 00aa 0620     		movs	r0, #6
 4643 00ac FFF7FEFF 		bl	cc2400_get
 4644              	.LVL544:
1608:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4645              		.loc 1 1608 0
 4646 00b0 444B     		ldr	r3, .L560+24
1607:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4647              		.loc 1 1607 0
 4648 00b2 C0F30720 		ubfx	r0, r0, #8, #8
 4649              	.LVL545:
1608:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4650              		.loc 1 1608 0
 4651 00b6 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 4652 00b8 63B1     		cbz	r3, .L525
1608:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4653              		.loc 1 1608 0 is_stmt 0 discriminator 1
 4654 00ba 7BB2     		sxtb	r3, r7
 4655 00bc 8033     		adds	r3, r3, #128
 4656 00be 09D1     		bne	.L525
1609:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 4657              		.loc 1 1609 0 is_stmt 1
 4658 00c0 414B     		ldr	r3, .L560+28
 4659 00c2 40B2     		sxtb	r0, r0
 4660              	.LVL546:
 4661 00c4 93F90070 		ldrsb	r7, [r3]
 4662              	.LVL547:
 4663 00c8 3637     		adds	r7, r7, #54
 4664 00ca B842     		cmp	r0, r7
 4665 00cc A8BF     		it	ge
 4666 00ce 0746     		movge	r7, r0
 4667 00d0 FFB2     		uxtb	r7, r7
1610:bluetooth_rxtx.c **** 			}
 4668              		.loc 1 1610 0
 4669 00d2 3846     		mov	r0, r7
ARM GAS  /tmp/ccxsBJK4.s 			page 133


 4670              	.L525:
 4671              	.LVL548:
1612:bluetooth_rxtx.c **** 		}
 4672              		.loc 1 1612 0
 4673 00d4 40B2     		sxtb	r0, r0
 4674              	.LVL549:
 4675 00d6 FFF7FEFF 		bl	rssi_add
 4676              	.LVL550:
 4677 00da DFE7     		b	.L524
 4678              	.L526:
1615:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 4679              		.loc 1 1615 0
 4680 00dc 3368     		ldr	r3, [r6]
 4681 00de 1BB1     		cbz	r3, .L528
1616:bluetooth_rxtx.c **** 		}
 4682              		.loc 1 1616 0
 4683 00e0 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4684 00e2 43F00203 		orr	r3, r3, #2
 4685 00e6 6370     		strb	r3, [r4, #1]
 4686              	.L528:
1620:bluetooth_rxtx.c **** 			goto rx_continue;
 4687              		.loc 1 1620 0
 4688 00e8 D9F80030 		ldr	r3, [r9]
 4689 00ec 002B     		cmp	r3, #0
 4690 00ee 57D0     		beq	.L529
1624:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 4691              		.loc 1 1624 0
 4692 00f0 324B     		ldr	r3, .L560+16
 4693 00f2 1B68     		ldr	r3, [r3]
 4694 00f4 012B     		cmp	r3, #1
 4695 00f6 03D9     		bls	.L530
1625:bluetooth_rxtx.c **** 
 4696              		.loc 1 1625 0
 4697 00f8 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4698 00fa 43F00103 		orr	r3, r3, #1
 4699 00fe 6370     		strb	r3, [r4, #1]
 4700              	.L530:
1627:bluetooth_rxtx.c **** 
 4701              		.loc 1 1627 0
 4702 0100 2D4B     		ldr	r3, .L560+12
 4703 0102 1888     		ldrh	r0, [r3]
 4704 0104 80B2     		uxth	r0, r0
 4705 0106 FFF7FEFF 		bl	rssi_iir_update
 4706              	.LVL551:
1633:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4707              		.loc 1 1633 0
 4708 010a 2E4B     		ldr	r3, .L560+24
 4709 010c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 4710 010e 12B9     		cbnz	r2, .L531
1633:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4711              		.loc 1 1633 0 is_stmt 0 discriminator 1
 4712 0110 2E4A     		ldr	r2, .L560+32
 4713 0112 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 4714 0114 32B1     		cbz	r2, .L532
 4715              	.L531:
1634:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4716              		.loc 1 1634 0 is_stmt 1
ARM GAS  /tmp/ccxsBJK4.s 			page 134


 4717 0116 6278     		ldrb	r2, [r4, #1]	@ zero_extendqisi2
1635:bluetooth_rxtx.c **** 			cs_trigger = 0;
 4718              		.loc 1 1635 0
 4719 0118 0225     		movs	r5, #2
 4720              	.LVL552:
1634:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4721              		.loc 1 1634 0
 4722 011a 42F00802 		orr	r2, r2, #8
 4723 011e 6270     		strb	r2, [r4, #1]
 4724              	.LVL553:
1636:bluetooth_rxtx.c **** 		}
 4725              		.loc 1 1636 0
 4726 0120 0022     		movs	r2, #0
 4727 0122 1A70     		strb	r2, [r3]
 4728              	.LVL554:
 4729              	.L532:
1639:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 4730              		.loc 1 1639 0
 4731 0124 284B     		ldr	r3, .L560+28
 4732 0126 93F90020 		ldrsb	r2, [r3]
 4733 012a 294B     		ldr	r3, .L560+36
 4734 012c 3532     		adds	r2, r2, #53
 4735 012e 93F90030 		ldrsb	r3, [r3]
 4736 0132 9A42     		cmp	r2, r3
 4737 0134 05DA     		bge	.L533
1640:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4738              		.loc 1 1640 0
 4739 0136 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
1641:bluetooth_rxtx.c **** 		}
 4740              		.loc 1 1641 0
 4741 0138 0225     		movs	r5, #2
 4742              	.LVL555:
1640:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4743              		.loc 1 1640 0
 4744 013a 43F01003 		orr	r3, r3, #16
 4745 013e 6370     		strb	r3, [r4, #1]
 4746              	.LVL556:
 4747 0140 00E0     		b	.L534
 4748              	.LVL557:
 4749              	.L533:
1645:bluetooth_rxtx.c **** 			goto rx_continue;
 4750              		.loc 1 1645 0
 4751 0142 6DB3     		cbz	r5, .L529
 4752              	.LVL558:
 4753              	.L534:
1651:bluetooth_rxtx.c **** 
 4754              		.loc 1 1651 0
 4755 0144 2348     		ldr	r0, .L560+40
1648:bluetooth_rxtx.c **** 
 4756              		.loc 1 1648 0
 4757 0146 013D     		subs	r5, r5, #1
 4758              	.LVL559:
1651:bluetooth_rxtx.c **** 
 4759              		.loc 1 1651 0
 4760 0148 00F5C871 		add	r1, r0, #400
 4761 014c 4FF4C872 		mov	r2, #400
 4762 0150 FFF7FEFF 		bl	memcpy
ARM GAS  /tmp/ccxsBJK4.s 			page 135


 4763              	.LVL560:
1648:bluetooth_rxtx.c **** 
 4764              		.loc 1 1648 0
 4765 0154 EDB2     		uxtb	r5, r5
 4766              	.LVL561:
1654:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 4767              		.loc 1 1654 0
 4768 0156 0023     		movs	r3, #0
 4769              	.LVL562:
 4770              	.L535:
 4771 0158 1F48     		ldr	r0, .L560+44
1641:bluetooth_rxtx.c **** 		}
 4772              		.loc 1 1641 0 discriminator 1
 4773 015a 0022     		movs	r2, #0
 4774 015c 00EBC300 		add	r0, r0, r3, lsl #3
 4775              	.LVL563:
 4776              	.L538:
1657:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4777              		.loc 1 1657 0 discriminator 2
 4778 0160 1E49     		ldr	r1, .L560+48
 4779 0162 0F68     		ldr	r7, [r1]
 4780 0164 FF5C     		ldrb	r7, [r7, r3]	@ zero_extendqisi2
1658:bluetooth_rxtx.c **** 			}
 4781              		.loc 1 1658 0 discriminator 2
 4782 0166 0968     		ldr	r1, [r1]
1657:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4783              		.loc 1 1657 0 discriminator 2
 4784 0168 FF09     		lsrs	r7, r7, #7
 4785 016a 8754     		strb	r7, [r0, r2]
1658:bluetooth_rxtx.c **** 			}
 4786              		.loc 1 1658 0 discriminator 2
 4787 016c CF5C     		ldrb	r7, [r1, r3]	@ zero_extendqisi2
1656:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4788              		.loc 1 1656 0 discriminator 2
 4789 016e 0132     		adds	r2, r2, #1
 4790              	.LVL564:
1658:bluetooth_rxtx.c **** 			}
 4791              		.loc 1 1658 0 discriminator 2
 4792 0170 7F00     		lsls	r7, r7, #1
 4793 0172 FFB2     		uxtb	r7, r7
1656:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4794              		.loc 1 1656 0 discriminator 2
 4795 0174 082A     		cmp	r2, #8
1658:bluetooth_rxtx.c **** 			}
 4796              		.loc 1 1658 0 discriminator 2
 4797 0176 CF54     		strb	r7, [r1, r3]
1656:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4798              		.loc 1 1656 0 discriminator 2
 4799 0178 F2D1     		bne	.L538
1654:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 4800              		.loc 1 1654 0
 4801 017a 0133     		adds	r3, r3, #1
 4802              	.LVL565:
 4803 017c 322B     		cmp	r3, #50
 4804 017e EBD1     		bne	.L535
1662:bluetooth_rxtx.c **** 		if (!ret) break;
 4805              		.loc 1 1662 0
ARM GAS  /tmp/ccxsBJK4.s 			page 136


 4806 0180 A36A     		ldr	r3, [r4, #40]
 4807              	.LVL566:
 4808 0182 1448     		ldr	r0, .L560+40
 4809 0184 9847     		blx	r3
 4810              	.LVL567:
1663:bluetooth_rxtx.c **** 
 4811              		.loc 1 1663 0
 4812 0186 58B9     		cbnz	r0, .L529
 4813              	.LVL568:
 4814              	.L540:
 4815              	.LBE36:
1671:bluetooth_rxtx.c **** 
 4816              		.loc 1 1671 0
 4817 0188 154B     		ldr	r3, .L560+52
 4818 018a 4FF08072 		mov	r2, #16777216
 4819 018e 1A60     		str	r2, [r3]
1674:bluetooth_rxtx.c **** 	dio_ssp_stop();
 4820              		.loc 1 1674 0
 4821 0190 FFF7FEFF 		bl	cc2400_idle
 4822              	.LVL569:
1675:bluetooth_rxtx.c **** 	cs_trigger_disable();
 4823              		.loc 1 1675 0
 4824 0194 FFF7FEFF 		bl	dio_ssp_stop
 4825              	.LVL570:
1677:bluetooth_rxtx.c **** 
 4826              		.loc 1 1677 0
 4827 0198 BDE8F843 		pop	{r3, r4, r5, r6, r7, r8, r9, lr}
1676:bluetooth_rxtx.c **** }
 4828              		.loc 1 1676 0
 4829 019c FFF7FEBF 		b	cs_trigger_disable
 4830              	.LVL571:
 4831              	.L529:
 4832              	.LBB37:
1666:bluetooth_rxtx.c **** 		rx_err = 0;
 4833              		.loc 1 1666 0
 4834 01a0 0023     		movs	r3, #0
 4835 01a2 C9F80030 		str	r3, [r9]
1667:bluetooth_rxtx.c **** 	}
 4836              		.loc 1 1667 0
 4837 01a6 3360     		str	r3, [r6]
 4838 01a8 47E7     		b	.L516
 4839              	.L561:
 4840 01aa 00BF     		.align	2
 4841              	.L560:
 4842 01ac 00000000 		.word	.LANCHOR0
 4843 01b0 00E100E0 		.word	-536813312
 4844 01b4 3CC00920 		.word	537509948
 4845 01b8 00000000 		.word	.LANCHOR1
 4846 01bc 00000000 		.word	rx_tc
 4847 01c0 00000000 		.word	rx_err
 4848 01c4 00000000 		.word	cs_trigger
 4849 01c8 00000000 		.word	cs_threshold_cur
 4850 01cc 00000000 		.word	cs_no_squelch
 4851 01d0 00000000 		.word	rssi_max
 4852 01d4 00000000 		.word	unpacked
 4853 01d8 90010000 		.word	unpacked+400
 4854 01dc 00000000 		.word	idle_rxbuf
ARM GAS  /tmp/ccxsBJK4.s 			page 137


 4855 01e0 80E100E0 		.word	-536813184
 4856              	.LBE37:
 4857              		.cfi_endproc
 4858              	.LFE21:
 4860              		.section	.text.bt_le_sync,"ax",%progbits
 4861              		.align	1
 4862              		.global	bt_le_sync
 4863              		.thumb
 4864              		.thumb_func
 4866              	bt_le_sync:
 4867              	.LFB22:
1681:bluetooth_rxtx.c **** 	int i;
 4868              		.loc 1 1681 0
 4869              		.cfi_startproc
 4870              		@ args = 0, pretend = 0, frame = 64
 4871              		@ frame_needed = 0, uses_anonymous_args = 0
 4872              	.LVL572:
 4873 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 4874              		.cfi_def_cfa_offset 36
 4875              		.cfi_offset 4, -36
 4876              		.cfi_offset 5, -32
 4877              		.cfi_offset 6, -28
 4878              		.cfi_offset 7, -24
 4879              		.cfi_offset 8, -20
 4880              		.cfi_offset 9, -16
 4881              		.cfi_offset 10, -12
 4882              		.cfi_offset 11, -8
 4883              		.cfi_offset 14, -4
 4884 0004 91B0     		sub	sp, sp, #68
 4885              		.cfi_def_cfa_offset 104
1686:bluetooth_rxtx.c **** 	mode = active_mode;
 4886              		.loc 1 1686 0
 4887 0006 AF4D     		ldr	r5, .L625
1689:bluetooth_rxtx.c **** 
 4888              		.loc 1 1689 0
 4889 0008 AF4C     		ldr	r4, .L625+4
1686:bluetooth_rxtx.c **** 	mode = active_mode;
 4890              		.loc 1 1686 0
 4891 000a 0123     		movs	r3, #1
 4892 000c 2B70     		strb	r3, [r5]
1689:bluetooth_rxtx.c **** 
 4893              		.loc 1 1689 0
 4894 000e 2376     		strb	r3, [r4, #24]
1692:bluetooth_rxtx.c **** 
 4895              		.loc 1 1692 0
 4896 0010 AE4B     		ldr	r3, .L625+8
 4897 0012 4FF08072 		mov	r2, #16777216
1687:bluetooth_rxtx.c **** 
 4898              		.loc 1 1687 0
 4899 0016 6874     		strb	r0, [r5, #17]
1692:bluetooth_rxtx.c **** 
 4900              		.loc 1 1692 0
 4901 0018 1A60     		str	r2, [r3]
1694:bluetooth_rxtx.c **** 
 4902              		.loc 1 1694 0
 4903 001a AD4B     		ldr	r3, .L625+12
 4904 001c 1022     		movs	r2, #16
ARM GAS  /tmp/ccxsBJK4.s 			page 138


 4905 001e 1A60     		str	r2, [r3]
1681:bluetooth_rxtx.c **** 	int i;
 4906              		.loc 1 1681 0
 4907 0020 0646     		mov	r6, r0
1696:bluetooth_rxtx.c **** 	dio_ssp_init();
 4908              		.loc 1 1696 0
 4909 0022 FFF7FEFF 		bl	queue_init
 4910              	.LVL573:
1697:bluetooth_rxtx.c **** 	dma_init_le();
 4911              		.loc 1 1697 0
 4912 0026 FFF7FEFF 		bl	dio_ssp_init
 4913              	.LVL574:
1698:bluetooth_rxtx.c **** 	dio_ssp_start();
 4914              		.loc 1 1698 0
 4915 002a FFF7FEFF 		bl	dma_init_le
 4916              	.LVL575:
1699:bluetooth_rxtx.c **** 
 4917              		.loc 1 1699 0
 4918 002e FFF7FEFF 		bl	dio_ssp_start
 4919              	.LVL576:
1701:bluetooth_rxtx.c **** 
 4920              		.loc 1 1701 0
 4921 0032 6068     		ldr	r0, [r4, #4]
 4922 0034 FFF7FEFF 		bl	rbit
 4923              	.LVL577:
 4924 0038 FFF7FEFF 		bl	cc2400_rx_sync
 4925              	.LVL578:
 4926              	.L563:
1703:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 4927              		.loc 1 1703 0 discriminator 1
 4928 003c AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
 4929 003e B342     		cmp	r3, r6
 4930 0040 40F0B681 		bne	.L603
 4931              	.LBB38:
1704:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 4932              		.loc 1 1704 0
 4933 0044 9F4B     		ldr	r3, .L625
 4934 0046 DB89     		ldrh	r3, [r3, #14]
 4935 0048 9BB2     		uxth	r3, r3
 4936 004a CBB1     		cbz	r3, .L564
1705:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 4937              		.loc 1 1705 0
 4938 004c 6420     		movs	r0, #100
 4939 004e FFF7FEFF 		bl	cc2400_strobe
 4940              	.LVL579:
 4941              	.L566:
1706:bluetooth_rxtx.c **** 
 4942              		.loc 1 1706 0 discriminator 1
 4943 0052 FFF7FEFF 		bl	cc2400_status
 4944              	.LVL580:
 4945 0056 4307     		lsls	r3, r0, #29
 4946 0058 FBD4     		bmi	.L566
1709:bluetooth_rxtx.c **** 
 4947              		.loc 1 1709 0
 4948 005a 2188     		ldrh	r1, [r4]
 4949 005c 0220     		movs	r0, #2
 4950 005e 89B2     		uxth	r1, r1
ARM GAS  /tmp/ccxsBJK4.s 			page 139


 4951 0060 0139     		subs	r1, r1, #1
 4952 0062 89B2     		uxth	r1, r1
 4953 0064 FFF7FEFF 		bl	cc2400_set
 4954              	.LVL581:
1712:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 4955              		.loc 1 1712 0
 4956 0068 6120     		movs	r0, #97
 4957 006a FFF7FEFF 		bl	cc2400_strobe
 4958              	.LVL582:
 4959              	.L568:
1713:bluetooth_rxtx.c **** 
 4960              		.loc 1 1713 0 discriminator 1
 4961 006e FFF7FEFF 		bl	cc2400_status
 4962              	.LVL583:
 4963 0072 4707     		lsls	r7, r0, #29
 4964 0074 FBD5     		bpl	.L568
1716:bluetooth_rxtx.c **** 
 4965              		.loc 1 1716 0
 4966 0076 6220     		movs	r0, #98
 4967 0078 FFF7FEFF 		bl	cc2400_strobe
 4968              	.LVL584:
1718:bluetooth_rxtx.c **** 		}
 4969              		.loc 1 1718 0
 4970 007c 0023     		movs	r3, #0
 4971 007e EB81     		strh	r3, [r5, #14]	@ movhi
 4972              	.L564:
1721:bluetooth_rxtx.c **** 
 4973              		.loc 1 1721 0
 4974 0080 934B     		ldr	r3, .L625+12
 4975 0082 1022     		movs	r2, #16
 4976 0084 1A60     		str	r2, [r3]
1724:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)
 4977              		.loc 1 1724 0
 4978 0086 FFF7FEFF 		bl	rssi_reset
 4979              	.LVL585:
 4980              	.L570:
1725:bluetooth_rxtx.c **** 			;
 4981              		.loc 1 1725 0 discriminator 1
 4982 008a 924B     		ldr	r3, .L625+16
 4983 008c 1A68     		ldr	r2, [r3]
 4984 008e 9946     		mov	r9, r3
 4985 0090 42B9     		cbnz	r2, .L569
1725:bluetooth_rxtx.c **** 			;
 4986              		.loc 1 1725 0 is_stmt 0 discriminator 2
 4987 0092 914B     		ldr	r3, .L625+20
 4988 0094 1B68     		ldr	r3, [r3]
 4989 0096 2BB9     		cbnz	r3, .L569
1725:bluetooth_rxtx.c **** 			;
 4990              		.loc 1 1725 0 discriminator 1
 4991 0098 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 4992 009a 1BB9     		cbnz	r3, .L569
 4993 009c 894B     		ldr	r3, .L625
 4994 009e 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 4995 00a0 B342     		cmp	r3, r6
 4996 00a2 F2D0     		beq	.L570
 4997              	.L569:
1728:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
ARM GAS  /tmp/ccxsBJK4.s 			page 140


 4998              		.loc 1 1728 0 is_stmt 1
 4999 00a4 0620     		movs	r0, #6
 5000 00a6 FFF7FEFF 		bl	cc2400_get
 5001              	.LVL586:
1729:bluetooth_rxtx.c **** 
 5002              		.loc 1 1729 0
 5003 00aa 8C4B     		ldr	r3, .L625+24
1728:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 5004              		.loc 1 1728 0
 5005 00ac C0F30720 		ubfx	r0, r0, #8, #8
 5006              	.LVL587:
1731:bluetooth_rxtx.c **** 			goto cleanup;
 5007              		.loc 1 1731 0
 5008 00b0 AA7C     		ldrb	r2, [r5, #18]	@ zero_extendqisi2
1729:bluetooth_rxtx.c **** 
 5009              		.loc 1 1729 0
 5010 00b2 1870     		strb	r0, [r3]
 5011 00b4 8A4B     		ldr	r3, .L625+28
1731:bluetooth_rxtx.c **** 			goto cleanup;
 5012              		.loc 1 1731 0
 5013 00b6 B242     		cmp	r2, r6
1729:bluetooth_rxtx.c **** 
 5014              		.loc 1 1729 0
 5015 00b8 1870     		strb	r0, [r3]
1731:bluetooth_rxtx.c **** 			goto cleanup;
 5016              		.loc 1 1731 0
 5017 00ba 824B     		ldr	r3, .L625
 5018 00bc 40F07881 		bne	.L603
1735:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 5019              		.loc 1 1735 0
 5020 00c0 854F     		ldr	r7, .L625+20
 5021 00c2 3A68     		ldr	r2, [r7]
 5022 00c4 BB46     		mov	fp, r7
 5023 00c6 1AB1     		cbz	r2, .L572
1736:bluetooth_rxtx.c **** 		}
 5024              		.loc 1 1736 0
 5025 00c8 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 5026 00ca 42F00202 		orr	r2, r2, #2
 5027 00ce 5A70     		strb	r2, [r3, #1]
 5028              	.L572:
1739:bluetooth_rxtx.c **** 			goto rx_flush;
 5029              		.loc 1 1739 0
 5030 00d0 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 5031 00d2 03F0FF01 		and	r1, r3, #255
 5032 00d6 002B     		cmp	r3, #0
 5033 00d8 40F0B780 		bne	.L574
1743:bluetooth_rxtx.c **** 			continue;
 5034              		.loc 1 1743 0
 5035 00dc D9F80030 		ldr	r3, [r9]
 5036 00e0 002B     		cmp	r3, #0
 5037 00e2 ABD0     		beq	.L563
1749:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
 5038              		.loc 1 1749 0
 5039 00e4 3422     		movs	r2, #52
 5040 00e6 03A8     		add	r0, sp, #12
 5041              	.LVL588:
 5042 00e8 FFF7FEFF 		bl	memset
ARM GAS  /tmp/ccxsBJK4.s 			page 141


 5043              	.LVL589:
1753:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5044              		.loc 1 1753 0
 5045 00ec 2088     		ldrh	r0, [r4]
1751:bluetooth_rxtx.c **** 
 5046              		.loc 1 1751 0
 5047 00ee 6368     		ldr	r3, [r4, #4]
1753:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5048              		.loc 1 1753 0
 5049 00f0 80B2     		uxth	r0, r0
 5050 00f2 6238     		subs	r0, r0, #98
 5051 00f4 C0B2     		uxtb	r0, r0
1751:bluetooth_rxtx.c **** 
 5052              		.loc 1 1751 0
 5053 00f6 0393     		str	r3, [sp, #12]
1753:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5054              		.loc 1 1753 0
 5055 00f8 FFF7FEFF 		bl	btle_channel_index
 5056              	.LVL590:
 5057 00fc 4FF03008 		mov	r8, #48
 5058 0100 08FB00F8 		mul	r8, r8, r0
 5059 0104 DFF808A2 		ldr	r10, .L625+76
 5060 0108 0AEB0803 		add	r3, r10, r8
 5061 010c 0193     		str	r3, [sp, #4]
 5062              	.LVL591:
 5063              	.LBB39:
1755:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5064              		.loc 1 1755 0
 5065 010e 754B     		ldr	r3, .L625+32
 5066              	.LVL592:
 5067 0110 93F800E0 		ldrb	lr, [r3]	@ zero_extendqisi2
1756:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5068              		.loc 1 1756 0
 5069 0114 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
1757:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5070              		.loc 1 1757 0
 5071 0116 9878     		ldrb	r0, [r3, #2]	@ zero_extendqisi2
1756:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5072              		.loc 1 1756 0
 5073 0118 1204     		lsls	r2, r2, #16
1758:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5074              		.loc 1 1758 0
 5075 011a D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 5076              	.LVL593:
1756:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5077              		.loc 1 1756 0
 5078 011c 42EA0E62 		orr	r2, r2, lr, lsl #24
1757:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5079              		.loc 1 1757 0
 5080 0120 0A43     		orrs	r2, r2, r1
1759:bluetooth_rxtx.c **** 		}
 5081              		.loc 1 1759 0
 5082 0122 42EA0020 		orr	r0, r2, r0, lsl #8
 5083 0126 0093     		str	r3, [sp]
 5084 0128 FFF7FEFF 		bl	rbit
 5085              	.LVL594:
 5086 012c 5AF80820 		ldr	r2, [r10, r8]
ARM GAS  /tmp/ccxsBJK4.s 			page 142


 5087              	.LBE39:
1763:bluetooth_rxtx.c **** 			goto rx_flush;
 5088              		.loc 1 1763 0
 5089 0130 009B     		ldr	r3, [sp]
 5090              	.LBB40:
1759:bluetooth_rxtx.c **** 		}
 5091              		.loc 1 1759 0
 5092 0132 5040     		eors	r0, r0, r2
 5093              	.LBE40:
1762:bluetooth_rxtx.c **** 		if (len > 39)
 5094              		.loc 1 1762 0
 5095 0134 C0F3052A 		ubfx	r10, r0, #8, #6
 5096 0138 0AF10208 		add	r8, r10, #2
1763:bluetooth_rxtx.c **** 			goto rx_flush;
 5097              		.loc 1 1763 0
 5098 013c B8F1270F 		cmp	r8, #39
 5099              	.LBB41:
1759:bluetooth_rxtx.c **** 		}
 5100              		.loc 1 1759 0
 5101 0140 0490     		str	r0, [sp, #16]
 5102              	.LVL595:
 5103              	.LBE41:
1763:bluetooth_rxtx.c **** 			goto rx_flush;
 5104              		.loc 1 1763 0
 5105 0142 00F28280 		bhi	.L574
1768:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
 5106              		.loc 1 1768 0
 5107 0146 0AF1080A 		add	r10, r10, #8
 5108 014a 4FEA9A02 		lsr	r2, r10, #2
 5109              	.LVL596:
1769:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
 5110              		.loc 1 1769 0
 5111 014e 0B2A     		cmp	r2, #11
 5112 0150 0DD0     		beq	.L581
1770:bluetooth_rxtx.c **** 				;
 5113              		.loc 1 1770 0
 5114 0152 03EB8203 		add	r3, r3, r2, lsl #2
 5115              	.LVL597:
 5116              	.L580:
 5117 0156 644A     		ldr	r2, .L625+36
 5118 0158 1268     		ldr	r2, [r2]
 5119 015a 9A42     		cmp	r2, r3
 5120 015c 0BD2     		bcs	.L579
1770:bluetooth_rxtx.c **** 				;
 5121              		.loc 1 1770 0 is_stmt 0 discriminator 2
 5122 015e DBF80010 		ldr	r1, [fp]
 5123 0162 0029     		cmp	r1, #0
 5124 0164 F7D0     		beq	.L580
 5125 0166 06E0     		b	.L579
 5126              	.LVL598:
 5127              	.L623:
1773:bluetooth_rxtx.c **** 				;
 5128              		.loc 1 1773 0 is_stmt 1 discriminator 2
 5129 0168 DBF80030 		ldr	r3, [fp]
 5130 016c 1BB9     		cbnz	r3, .L579
 5131              	.L581:
1773:bluetooth_rxtx.c **** 				;
ARM GAS  /tmp/ccxsBJK4.s 			page 143


 5132              		.loc 1 1773 0 is_stmt 0
 5133 016e 5F4B     		ldr	r3, .L625+40
 5134 0170 1B68     		ldr	r3, [r3]
 5135 0172 D807     		lsls	r0, r3, #31
 5136 0174 F8D4     		bmi	.L623
 5137              	.LVL599:
 5138              	.L579:
1776:bluetooth_rxtx.c **** 
 5139              		.loc 1 1776 0 is_stmt 1
 5140 0176 5E4B     		ldr	r3, .L625+44
1779:bluetooth_rxtx.c **** 
 5141              		.loc 1 1779 0
 5142 0178 6120     		movs	r0, #97
1776:bluetooth_rxtx.c **** 
 5143              		.loc 1 1776 0
 5144 017a 1A68     		ldr	r2, [r3]
1782:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5145              		.loc 1 1782 0
 5146 017c 4FF0040B 		mov	fp, #4
1776:bluetooth_rxtx.c **** 
 5147              		.loc 1 1776 0
 5148 0180 22F00102 		bic	r2, r2, #1
 5149 0184 1A60     		str	r2, [r3]
1779:bluetooth_rxtx.c **** 
 5150              		.loc 1 1779 0
 5151 0186 FFF7FEFF 		bl	cc2400_strobe
 5152              	.LVL600:
 5153              	.L583:
 5154              	.LBB42:
1783:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5155              		.loc 1 1783 0 discriminator 2
 5156 018a 564A     		ldr	r2, .L625+32
 5157 018c 0BF10100 		add	r0, fp, #1
 5158 0190 12F80B10 		ldrb	r1, [r2, fp]	@ zero_extendqisi2
 5159 0194 0BF1030C 		add	ip, fp, #3
1784:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5160              		.loc 1 1784 0 discriminator 2
 5161 0198 12F800E0 		ldrb	lr, [r2, r0]	@ zero_extendqisi2
 5162 019c 0BF10200 		add	r0, fp, #2
1785:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5163              		.loc 1 1785 0 discriminator 2
 5164 01a0 105C     		ldrb	r0, [r2, r0]	@ zero_extendqisi2
1786:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5165              		.loc 1 1786 0 discriminator 2
 5166 01a2 12F80CC0 		ldrb	ip, [r2, ip]	@ zero_extendqisi2
 5167              	.LVL601:
1787:bluetooth_rxtx.c **** 		}
 5168              		.loc 1 1787 0 discriminator 2
 5169 01a6 4FEAAB02 		asr	r2, fp, #2
1784:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5170              		.loc 1 1784 0 discriminator 2
 5171 01aa 4CEA0161 		orr	r1, ip, r1, lsl #24
 5172              	.LVL602:
1785:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5173              		.loc 1 1785 0 discriminator 2
 5174 01ae 41EA0E41 		orr	r1, r1, lr, lsl #16
1787:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccxsBJK4.s 			page 144


 5175              		.loc 1 1787 0 discriminator 2
 5176 01b2 41EA0020 		orr	r0, r1, r0, lsl #8
 5177 01b6 0092     		str	r2, [sp]
 5178 01b8 FFF7FEFF 		bl	rbit
 5179              	.LVL603:
 5180 01bc 009A     		ldr	r2, [sp]
 5181 01be 10AB     		add	r3, sp, #64
 5182 01c0 03EB8201 		add	r1, r3, r2, lsl #2
 5183 01c4 019B     		ldr	r3, [sp, #4]
 5184              	.LBE42:
1782:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5185              		.loc 1 1782 0 discriminator 2
 5186 01c6 0BF1040B 		add	fp, fp, #4
 5187              	.LVL604:
 5188              	.LBB43:
1787:bluetooth_rxtx.c **** 		}
 5189              		.loc 1 1787 0 discriminator 2
 5190 01ca 53F82220 		ldr	r2, [r3, r2, lsl #2]
 5191              	.LBE43:
1782:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5192              		.loc 1 1782 0 discriminator 2
 5193 01ce BBF12C0F 		cmp	fp, #44
 5194              	.LBB44:
1787:bluetooth_rxtx.c **** 		}
 5195              		.loc 1 1787 0 discriminator 2
 5196 01d2 82EA0000 		eor	r0, r2, r0
 5197 01d6 41F8300C 		str	r0, [r1, #-48]
 5198              	.LBE44:
1782:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5199              		.loc 1 1782 0 discriminator 2
 5200 01da D6D1     		bne	.L583
1790:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
 5201              		.loc 1 1790 0
 5202 01dc 6369     		ldr	r3, [r4, #20]
 5203 01de EBB9     		cbnz	r3, .L584
 5204              	.L585:
1800:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
 5205              		.loc 1 1800 0
 5206 01e0 444B     		ldr	r3, .L625+48
 5207 01e2 1022     		movs	r2, #16
 5208 01e4 1A60     		str	r2, [r3]
1801:bluetooth_rxtx.c **** 
 5209              		.loc 1 1801 0
 5210 01e6 03A8     		add	r0, sp, #12
 5211              	.LVL605:
 5212 01e8 AB69     		ldr	r3, [r5, #24]
 5213 01ea 9847     		blx	r3
 5214              	.LVL606:
1804:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
 5215              		.loc 1 1804 0
 5216 01ec 424B     		ldr	r3, .L625+52
 5217 01ee 4FF08078 		mov	r8, #16777216
 5218              	.LVL607:
 5219 01f2 C3F80080 		str	r8, [r3]
1805:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 5220              		.loc 1 1805 0
 5221 01f6 03A9     		add	r1, sp, #12
ARM GAS  /tmp/ccxsBJK4.s 			page 145


 5222              	.LVL608:
 5223 01f8 0120     		movs	r0, #1
 5224 01fa FFF7FEFF 		bl	enqueue
 5225              	.LVL609:
1806:bluetooth_rxtx.c **** 
 5226              		.loc 1 1806 0
 5227 01fe 334B     		ldr	r3, .L625+8
1808:bluetooth_rxtx.c **** 
 5228              		.loc 1 1808 0
 5229 0200 3E4A     		ldr	r2, .L625+56
1806:bluetooth_rxtx.c **** 
 5230              		.loc 1 1806 0
 5231 0202 C3F80080 		str	r8, [r3]
1808:bluetooth_rxtx.c **** 
 5232              		.loc 1 1808 0
 5233 0206 3E4B     		ldr	r3, .L625+60
 5234 0208 40F63541 		movw	r1, #3125
 5235 020c 1B68     		ldr	r3, [r3]
 5236 020e 1268     		ldr	r2, [r2]
 5237 0210 C3F31303 		ubfx	r3, r3, #0, #20
 5238 0214 01FB0323 		mla	r3, r1, r3, r2
 5239 0218 6364     		str	r3, [r4, #68]
 5240 021a 16E0     		b	.L574
 5241              	.LVL610:
 5242              	.L584:
 5243              	.LBB45:
1791:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
 5244              		.loc 1 1791 0
 5245 021c 2A4B     		ldr	r3, .L625+4
 5246 021e 04A9     		add	r1, sp, #16
 5247 0220 1869     		ldr	r0, [r3, #16]
 5248 0222 4246     		mov	r2, r8
 5249 0224 FFF7FEFF 		bl	btle_crcgen_lut
 5250              	.LVL611:
1792:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 5251              		.loc 1 1792 0
 5252 0228 10AB     		add	r3, sp, #64
 5253 022a 5344     		add	r3, r3, r10
 5254 022c 13F8342C 		ldrb	r2, [r3, #-52]	@ zero_extendqisi2
1793:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5255              		.loc 1 1793 0
 5256 0230 10AB     		add	r3, sp, #64
 5257 0232 4344     		add	r3, r3, r8
 5258 0234 13F82F1C 		ldrb	r1, [r3, #-47]	@ zero_extendqisi2
 5259 0238 0902     		lsls	r1, r1, #8
 5260 023a 41EA0241 		orr	r1, r1, r2, lsl #16
1794:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
 5261              		.loc 1 1794 0
 5262 023e 13F8302C 		ldrb	r2, [r3, #-48]	@ zero_extendqisi2
 5263 0242 41EA0203 		orr	r3, r1, r2
1795:bluetooth_rxtx.c **** 				goto rx_flush;
 5264              		.loc 1 1795 0
 5265 0246 9842     		cmp	r0, r3
 5266 0248 CAD0     		beq	.L585
 5267              	.LVL612:
 5268              	.L574:
 5269              	.LBE45:
ARM GAS  /tmp/ccxsBJK4.s 			page 146


1812:bluetooth_rxtx.c **** 
 5270              		.loc 1 1812 0
 5271 024a 6120     		movs	r0, #97
 5272 024c FFF7FEFF 		bl	cc2400_strobe
 5273              	.LVL613:
1815:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
 5274              		.loc 1 1815 0
 5275 0250 274B     		ldr	r3, .L625+44
 5276 0252 1A68     		ldr	r2, [r3]
 5277 0254 22F00102 		bic	r2, r2, #1
 5278 0258 1A60     		str	r2, [r3]
 5279              	.L586:
1816:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
 5280              		.loc 1 1816 0 discriminator 1
 5281 025a 2A4B     		ldr	r3, .L625+64
 5282 025c 1B68     		ldr	r3, [r3]
 5283 025e 5907     		lsls	r1, r3, #29
 5284 0260 02D5     		bpl	.L624
 5285              	.LBB46:
1817:bluetooth_rxtx.c **** 		}
 5286              		.loc 1 1817 0
 5287 0262 294B     		ldr	r3, .L625+68
 5288 0264 1B68     		ldr	r3, [r3]
 5289 0266 F8E7     		b	.L586
 5290              	.L624:
 5291              	.LBE46:
1821:bluetooth_rxtx.c **** 		if (now < le.last_packet)
 5292              		.loc 1 1821 0
 5293 0268 254B     		ldr	r3, .L625+60
 5294 026a 244A     		ldr	r2, .L625+56
 5295 026c 1B68     		ldr	r3, [r3]
 5296 026e 1268     		ldr	r2, [r2]
 5297 0270 40F63541 		movw	r1, #3125
 5298 0274 C3F31303 		ubfx	r3, r3, #0, #20
 5299 0278 01FB0323 		mla	r3, r1, r3, r2
 5300              	.LVL614:
1822:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5301              		.loc 1 1822 0
 5302 027c 626C     		ldr	r2, [r4, #68]
1825:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
 5303              		.loc 1 1825 0
 5304 027e 217E     		ldrb	r1, [r4, #24]	@ zero_extendqisi2
1822:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5305              		.loc 1 1822 0
 5306 0280 9342     		cmp	r3, r2
1825:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
 5307              		.loc 1 1825 0
 5308 0282 A1F10201 		sub	r1, r1, #2
1823:bluetooth_rxtx.c **** 		if  ( // timeout
 5309              		.loc 1 1823 0
 5310 0286 38BF     		it	cc
 5311 0288 03F14343 		addcc	r3, r3, #-1023410176
 5312              	.LVL615:
1824:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5313              		.loc 1 1824 0
 5314 028c C9B2     		uxtb	r1, r1
1823:bluetooth_rxtx.c **** 		if  ( // timeout
ARM GAS  /tmp/ccxsBJK4.s 			page 147


 5315              		.loc 1 1823 0
 5316 028e 38BF     		it	cc
 5317 0290 03F5A003 		addcc	r3, r3, #5242880
 5318              	.LVL616:
1824:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5319              		.loc 1 1824 0
 5320 0294 0129     		cmp	r1, #1
 5321 0296 03D8     		bhi	.L589
1826:bluetooth_rxtx.c **** 			// jam finished
 5322              		.loc 1 1826 0
 5323 0298 1C49     		ldr	r1, .L625+72
 5324 029a 9B1A     		subs	r3, r3, r2
 5325              	.LVL617:
 5326 029c 8B42     		cmp	r3, r1
 5327 029e 02D8     		bhi	.L590
 5328              	.L589:
1828:bluetooth_rxtx.c **** 			)
 5329              		.loc 1 1828 0
 5330 02a0 EB69     		ldr	r3, [r5, #28]
 5331 02a2 012B     		cmp	r3, #1
 5332 02a4 4FD1     		bne	.L591
 5333              	.L590:
1831:bluetooth_rxtx.c **** 			le_jam_count = 0;
 5334              		.loc 1 1831 0
 5335 02a6 FFF7FEFF 		bl	reset_le
 5336              	.LVL618:
1833:bluetooth_rxtx.c **** 
 5337              		.loc 1 1833 0
 5338 02aa 0949     		ldr	r1, .L625+12
1832:bluetooth_rxtx.c **** 			TXLED_CLR;
 5339              		.loc 1 1832 0
 5340 02ac 0023     		movs	r3, #0
1833:bluetooth_rxtx.c **** 
 5341              		.loc 1 1833 0
 5342 02ae 4FF48070 		mov	r0, #256
1832:bluetooth_rxtx.c **** 			TXLED_CLR;
 5343              		.loc 1 1832 0
 5344 02b2 EB61     		str	r3, [r5, #28]
1833:bluetooth_rxtx.c **** 
 5345              		.loc 1 1833 0
 5346 02b4 0860     		str	r0, [r1]
1835:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 5347              		.loc 1 1835 0
 5348 02b6 E97C     		ldrb	r1, [r5, #19]	@ zero_extendqisi2
1832:bluetooth_rxtx.c **** 			TXLED_CLR;
 5349              		.loc 1 1832 0
 5350 02b8 024A     		ldr	r2, .L625
1835:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 5351              		.loc 1 1835 0
 5352 02ba 0129     		cmp	r1, #1
 5353 02bc 2AD1     		bne	.L592
1836:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
 5354              		.loc 1 1836 0
 5355 02be D374     		strb	r3, [r2, #19]
1837:bluetooth_rxtx.c **** 				goto cleanup;
 5356              		.loc 1 1837 0
 5357 02c0 9374     		strb	r3, [r2, #18]
ARM GAS  /tmp/ccxsBJK4.s 			page 148


1838:bluetooth_rxtx.c **** 			}
 5358              		.loc 1 1838 0
 5359 02c2 75E0     		b	.L603
 5360              	.L626:
 5361              		.align	2
 5362              	.L625:
 5363 02c4 00000000 		.word	.LANCHOR0
 5364 02c8 00000000 		.word	.LANCHOR1
 5365 02cc 00E100E0 		.word	-536813312
 5366 02d0 3CC00920 		.word	537509948
 5367 02d4 00000000 		.word	rx_tc
 5368 02d8 00000000 		.word	rx_err
 5369 02dc 00000000 		.word	rssi_max
 5370 02e0 00000000 		.word	rssi_min
 5371 02e4 00000000 		.word	rxbuf1
 5372 02e8 04410050 		.word	1342193924
 5373 02ec 10410050 		.word	1342193936
 5374 02f0 24000340 		.word	1073938468
 5375 02f4 38C00920 		.word	537509944
 5376 02f8 80E100E0 		.word	-536813184
 5377 02fc 08400040 		.word	1073758216
 5378 0300 00000000 		.word	clkn
 5379 0304 0C000340 		.word	1073938444
 5380 0308 08000340 		.word	1073938440
 5381 030c 80F0FA02 		.word	50000000
 5382 0310 F0000000 		.word	.LANCHOR2+240
 5383              	.L592:
1842:bluetooth_rxtx.c **** 				goto cleanup;
 5384              		.loc 1 1842 0
 5385 0314 0A2E     		cmp	r6, #10
 5386 0316 4BD0     		beq	.L603
1845:bluetooth_rxtx.c **** 
 5387              		.loc 1 1845 0
 5388 0318 0123     		movs	r3, #1
1847:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5389              		.loc 1 1847 0
 5390 031a 6420     		movs	r0, #100
1845:bluetooth_rxtx.c **** 
 5391              		.loc 1 1845 0
 5392 031c 2376     		strb	r3, [r4, #24]
1847:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5393              		.loc 1 1847 0
 5394 031e FFF7FEFF 		bl	cc2400_strobe
 5395              	.LVL619:
 5396              	.L595:
1848:bluetooth_rxtx.c **** 
 5397              		.loc 1 1848 0 discriminator 1
 5398 0322 FFF7FEFF 		bl	cc2400_status
 5399              	.LVL620:
 5400 0326 4207     		lsls	r2, r0, #29
 5401 0328 FBD4     		bmi	.L595
1851:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5402              		.loc 1 1851 0
 5403 032a B4F84A30 		ldrh	r3, [r4, #74]
 5404 032e 9BB2     		uxth	r3, r3
 5405 0330 23B1     		cbz	r3, .L605
1851:bluetooth_rxtx.c **** 			restart_jamming = 1;
ARM GAS  /tmp/ccxsBJK4.s 			page 149


 5406              		.loc 1 1851 0 is_stmt 0 discriminator 1
 5407 0332 264B     		ldr	r3, .L627
 5408 0334 B3F84A30 		ldrh	r3, [r3, #74]
 5409 0338 9BB2     		uxth	r3, r3
 5410 033a 01E0     		b	.L596
 5411              	.L605:
1851:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5412              		.loc 1 1851 0
 5413 033c 40F66213 		movw	r3, #2402
 5414              	.L596:
1851:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5415              		.loc 1 1851 0 discriminator 3
 5416 0340 2380     		strh	r3, [r4]	@ movhi
1852:bluetooth_rxtx.c **** 		}
 5417              		.loc 1 1852 0 is_stmt 1 discriminator 3
 5418 0342 0123     		movs	r3, #1
 5419 0344 EB62     		str	r3, [r5, #44]
 5420              	.L591:
1855:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
 5421              		.loc 1 1855 0
 5422 0346 2C20     		movs	r0, #44
 5423 0348 6189     		ldrh	r1, [r4, #10]
 5424 034a FFF7FEFF 		bl	cc2400_set
 5425              	.LVL621:
1856:bluetooth_rxtx.c **** 
 5426              		.loc 1 1856 0
 5427 034e 2D20     		movs	r0, #45
 5428 0350 2189     		ldrh	r1, [r4, #8]
 5429 0352 FFF7FEFF 		bl	cc2400_set
 5430              	.LVL622:
1858:bluetooth_rxtx.c **** 			hop();
 5431              		.loc 1 1858 0
 5432 0356 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 5433 0358 0BB1     		cbz	r3, .L597
1859:bluetooth_rxtx.c **** 
 5434              		.loc 1 1859 0
 5435 035a FFF7FEFF 		bl	hop
 5436              	.LVL623:
 5437              	.L597:
1862:bluetooth_rxtx.c **** 			le_jam();
 5438              		.loc 1 1862 0
 5439 035e EB69     		ldr	r3, [r5, #28]
 5440 0360 DFF87080 		ldr	r8, .L627+8
 5441 0364 002B     		cmp	r3, #0
 5442 0366 07DD     		ble	.L598
1863:bluetooth_rxtx.c **** 			--le_jam_count;
 5443              		.loc 1 1863 0
 5444 0368 FFF7FEFF 		bl	le_jam
 5445              	.LVL624:
1864:bluetooth_rxtx.c **** 		} else {
 5446              		.loc 1 1864 0
 5447 036c D8F81C30 		ldr	r3, [r8, #28]
 5448 0370 013B     		subs	r3, r3, #1
 5449 0372 C8F81C30 		str	r3, [r8, #28]
 5450 0376 16E0     		b	.L599
 5451              	.L598:
1867:bluetooth_rxtx.c **** 			dio_ssp_start();
ARM GAS  /tmp/ccxsBJK4.s 			page 150


 5452              		.loc 1 1867 0
 5453 0378 FFF7FEFF 		bl	dma_init_le
 5454              	.LVL625:
1868:bluetooth_rxtx.c **** 
 5455              		.loc 1 1868 0
 5456 037c FFF7FEFF 		bl	dio_ssp_start
 5457              	.LVL626:
1870:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
 5458              		.loc 1 1870 0
 5459 0380 D8F82C30 		ldr	r3, [r8, #44]
 5460 0384 43B1     		cbz	r3, .L602
1871:bluetooth_rxtx.c **** 				restart_jamming = 0;
 5461              		.loc 1 1871 0
 5462 0386 6068     		ldr	r0, [r4, #4]
 5463 0388 FFF7FEFF 		bl	rbit
 5464              	.LVL627:
 5465 038c FFF7FEFF 		bl	cc2400_rx_sync
 5466              	.LVL628:
1872:bluetooth_rxtx.c **** 			} else {
 5467              		.loc 1 1872 0
 5468 0390 0023     		movs	r3, #0
 5469 0392 C8F82C30 		str	r3, [r8, #44]
 5470 0396 06E0     		b	.L599
 5471              	.L602:
1875:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
 5472              		.loc 1 1875 0
 5473 0398 FFF7FEFF 		bl	cc2400_status
 5474              	.LVL629:
 5475 039c 4307     		lsls	r3, r0, #29
 5476 039e FBD5     		bpl	.L602
1876:bluetooth_rxtx.c **** 			}
 5477              		.loc 1 1876 0
 5478 03a0 6220     		movs	r0, #98
 5479 03a2 FFF7FEFF 		bl	cc2400_strobe
 5480              	.LVL630:
 5481              	.L599:
1880:bluetooth_rxtx.c **** 		rx_err = 0;
 5482              		.loc 1 1880 0 discriminator 1
 5483 03a6 0023     		movs	r3, #0
 5484 03a8 C9F80030 		str	r3, [r9]
1881:bluetooth_rxtx.c **** 	}
 5485              		.loc 1 1881 0 discriminator 1
 5486 03ac 3B60     		str	r3, [r7]
 5487 03ae 45E6     		b	.L563
 5488              	.L603:
 5489              	.LBE38:
1887:bluetooth_rxtx.c **** 
 5490              		.loc 1 1887 0
 5491 03b0 074B     		ldr	r3, .L627+4
 5492 03b2 4FF08072 		mov	r2, #16777216
 5493 03b6 1A60     		str	r2, [r3]
1890:bluetooth_rxtx.c **** 	dio_ssp_stop();
 5494              		.loc 1 1890 0
 5495 03b8 FFF7FEFF 		bl	cc2400_idle
 5496              	.LVL631:
1891:bluetooth_rxtx.c **** 	cs_trigger_disable();
 5497              		.loc 1 1891 0
ARM GAS  /tmp/ccxsBJK4.s 			page 151


 5498 03bc FFF7FEFF 		bl	dio_ssp_stop
 5499              	.LVL632:
1892:bluetooth_rxtx.c **** }
 5500              		.loc 1 1892 0
 5501 03c0 FFF7FEFF 		bl	cs_trigger_disable
 5502              	.LVL633:
1893:bluetooth_rxtx.c **** 
 5503              		.loc 1 1893 0
 5504 03c4 11B0     		add	sp, sp, #68
 5505              		@ sp needed
 5506 03c6 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 5507              	.L628:
 5508 03ca 00BF     		.align	2
 5509              	.L627:
 5510 03cc 00000000 		.word	.LANCHOR1
 5511 03d0 80E100E0 		.word	-536813184
 5512 03d4 00000000 		.word	.LANCHOR0
 5513              		.cfi_endproc
 5514              	.LFE22:
 5516              		.section	.text.bt_follow_le,"ax",%progbits
 5517              		.align	1
 5518              		.global	bt_follow_le
 5519              		.thumb
 5520              		.thumb_func
 5522              	bt_follow_le:
 5523              	.LFB25:
2058:bluetooth_rxtx.c **** 		}
2059:bluetooth_rxtx.c **** 	}
2060:bluetooth_rxtx.c **** }
2061:bluetooth_rxtx.c **** 
2062:bluetooth_rxtx.c **** void bt_follow_le() {
 5524              		.loc 1 2062 0
 5525              		.cfi_startproc
 5526              		@ args = 0, pretend = 0, frame = 0
 5527              		@ frame_needed = 0, uses_anonymous_args = 0
 5528 0000 10B5     		push	{r4, lr}
 5529              		.cfi_def_cfa_offset 8
 5530              		.cfi_offset 4, -8
 5531              		.cfi_offset 14, -4
2063:bluetooth_rxtx.c **** 	reset_le();
 5532              		.loc 1 2063 0
 5533 0002 FFF7FEFF 		bl	reset_le
 5534              	.LVL634:
2064:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 5535              		.loc 1 2064 0
 5536 0006 044C     		ldr	r4, .L630
 5537 0008 044B     		ldr	r3, .L630+4
2065:bluetooth_rxtx.c **** 	bt_le_sync(MODE_BT_FOLLOW_LE);
 5538              		.loc 1 2065 0
 5539 000a 0920     		movs	r0, #9
2064:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 5540              		.loc 1 2064 0
 5541 000c A361     		str	r3, [r4, #24]
 5542              		.loc 1 2065 0
 5543 000e FFF7FEFF 		bl	bt_le_sync
 5544              	.LVL635:
2066:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccxsBJK4.s 			page 152


2067:bluetooth_rxtx.c **** 	/* old non-sync mode
2068:bluetooth_rxtx.c **** 	data_cb = cb_follow_le;
2069:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
2070:bluetooth_rxtx.c **** 	bt_generic_le(MODE_BT_FOLLOW_LE);
2071:bluetooth_rxtx.c **** 	*/
2072:bluetooth_rxtx.c **** 
2073:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 5545              		.loc 1 2073 0
 5546 0012 0023     		movs	r3, #0
 5547 0014 6374     		strb	r3, [r4, #17]
 5548 0016 10BD     		pop	{r4, pc}
 5549              	.L631:
 5550              		.align	2
 5551              	.L630:
 5552 0018 00000000 		.word	.LANCHOR0
 5553 001c 00000000 		.word	connection_follow_cb
 5554              		.cfi_endproc
 5555              	.LFE25:
 5557              		.section	.text.le_promisc_state,"ax",%progbits
 5558              		.align	1
 5559              		.global	le_promisc_state
 5560              		.thumb
 5561              		.thumb_func
 5563              	le_promisc_state:
 5564              	.LFB26:
2074:bluetooth_rxtx.c **** }
2075:bluetooth_rxtx.c **** 
2076:bluetooth_rxtx.c **** // issue state change message
2077:bluetooth_rxtx.c **** void le_promisc_state(u8 type, void *data, unsigned len) {
 5565              		.loc 1 2077 0
 5566              		.cfi_startproc
 5567              		@ args = 0, pretend = 0, frame = 56
 5568              		@ frame_needed = 0, uses_anonymous_args = 0
 5569              	.LVL636:
 5570 0000 70B5     		push	{r4, r5, r6, lr}
 5571              		.cfi_def_cfa_offset 16
 5572              		.cfi_offset 4, -16
 5573              		.cfi_offset 5, -12
 5574              		.cfi_offset 6, -8
 5575              		.cfi_offset 14, -4
 5576 0002 8EB0     		sub	sp, sp, #56
 5577              		.cfi_def_cfa_offset 72
 5578              		.loc 1 2077 0
 5579 0004 0646     		mov	r6, r0
 5580 0006 0D46     		mov	r5, r1
 5581 0008 1446     		mov	r4, r2
2078:bluetooth_rxtx.c **** 	u8 buf[50] = { 0, };
 5582              		.loc 1 2078 0
 5583 000a 01A8     		add	r0, sp, #4
 5584              	.LVL637:
 5585 000c 0021     		movs	r1, #0
 5586              	.LVL638:
 5587 000e 3222     		movs	r2, #50
 5588              	.LVL639:
 5589 0010 FFF7FEFF 		bl	memset
 5590              	.LVL640:
2079:bluetooth_rxtx.c **** 	if (len > 49)
ARM GAS  /tmp/ccxsBJK4.s 			page 153


2080:bluetooth_rxtx.c **** 		len = 49;
2081:bluetooth_rxtx.c **** 
2082:bluetooth_rxtx.c **** 	buf[0] = type;
2083:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 5591              		.loc 1 2083 0
 5592 0014 2946     		mov	r1, r5
 5593 0016 312C     		cmp	r4, #49
 5594 0018 34BF     		ite	cc
 5595 001a 2246     		movcc	r2, r4
 5596 001c 3122     		movcs	r2, #49
 5597              	.LVL641:
 5598 001e 0DF10500 		add	r0, sp, #5
2082:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 5599              		.loc 1 2082 0
 5600 0022 8DF80460 		strb	r6, [sp, #4]
 5601              		.loc 1 2083 0
 5602 0026 FFF7FEFF 		bl	memcpy
 5603              	.LVL642:
2084:bluetooth_rxtx.c **** 	enqueue(LE_PROMISC, (uint8_t*)buf);
 5604              		.loc 1 2084 0
 5605 002a 01A9     		add	r1, sp, #4
 5606 002c 0520     		movs	r0, #5
 5607 002e FFF7FEFF 		bl	enqueue
 5608              	.LVL643:
2085:bluetooth_rxtx.c **** }
 5609              		.loc 1 2085 0
 5610 0032 0EB0     		add	sp, sp, #56
 5611              		@ sp needed
 5612 0034 70BD     		pop	{r4, r5, r6, pc}
 5613              		.cfi_endproc
 5614              	.LFE26:
 5616              		.section	.text.promisc_recover_hop_increment,"ax",%progbits
 5617              		.align	1
 5618              		.global	promisc_recover_hop_increment
 5619              		.thumb
 5620              		.thumb_func
 5622              	promisc_recover_hop_increment:
 5623              	.LFB27:
2086:bluetooth_rxtx.c **** 
2087:bluetooth_rxtx.c **** // divide, rounding to the nearest integer: round up at 0.5.
2088:bluetooth_rxtx.c **** #define DIVIDE_ROUND(N, D) ((N) + (D)/2) / (D)
2089:bluetooth_rxtx.c **** 
2090:bluetooth_rxtx.c **** void promisc_recover_hop_increment(u8 *packet) {
 5624              		.loc 1 2090 0
 5625              		.cfi_startproc
 5626              		@ args = 0, pretend = 0, frame = 0
 5627              		@ frame_needed = 0, uses_anonymous_args = 0
 5628              	.LVL644:
 5629 0000 38B5     		push	{r3, r4, r5, lr}
 5630              		.cfi_def_cfa_offset 16
 5631              		.cfi_offset 3, -16
 5632              		.cfi_offset 4, -12
 5633              		.cfi_offset 5, -8
 5634              		.cfi_offset 14, -4
2091:bluetooth_rxtx.c **** 	static u32 first_ts = 0;
2092:bluetooth_rxtx.c **** 	if (channel == 2404) {
 5635              		.loc 1 2092 0
ARM GAS  /tmp/ccxsBJK4.s 			page 154


 5636 0002 314A     		ldr	r2, .L642
 5637 0004 40F66413 		movw	r3, #2404
 5638 0008 1188     		ldrh	r1, [r2]
 5639 000a 304C     		ldr	r4, .L642+4
 5640 000c 89B2     		uxth	r1, r1
 5641 000e 9942     		cmp	r1, r3
 5642 0010 0DD1     		bne	.L634
2093:bluetooth_rxtx.c **** 		first_ts = CLK100NS;
 5643              		.loc 1 2093 0
 5644 0012 2F4B     		ldr	r3, .L642+8
 5645 0014 2F4A     		ldr	r2, .L642+12
 5646 0016 1B68     		ldr	r3, [r3]
 5647 0018 1268     		ldr	r2, [r2]
 5648 001a C3F31303 		ubfx	r3, r3, #0, #20
 5649 001e 40F63541 		movw	r1, #3125
 5650 0022 01FB0323 		mla	r3, r1, r3, r2
 5651 0026 2363     		str	r3, [r4, #48]
2094:bluetooth_rxtx.c **** 		hop_direct_channel = 2406;
 5652              		.loc 1 2094 0
 5653 0028 40F66613 		movw	r3, #2406
 5654 002c 48E0     		b	.L636
 5655              	.L634:
2095:bluetooth_rxtx.c **** 		do_hop = 1;
2096:bluetooth_rxtx.c **** 	} else if (channel == 2406) {
 5656              		.loc 1 2096 0
 5657 002e 1088     		ldrh	r0, [r2]
 5658              	.LVL645:
 5659 0030 40F66611 		movw	r1, #2406
 5660 0034 80B2     		uxth	r0, r0
 5661 0036 8842     		cmp	r0, r1
 5662 0038 42D1     		bne	.L636
 5663              	.LVL646:
 5664              	.LBB51:
 5665              	.LBB52:
 5666              	.LBB53:
2097:bluetooth_rxtx.c **** 		u32 second_ts = CLK100NS;
 5667              		.loc 1 2097 0
 5668 003a 254B     		ldr	r3, .L642+8
 5669 003c 2549     		ldr	r1, .L642+12
 5670 003e 1B68     		ldr	r3, [r3]
 5671 0040 0968     		ldr	r1, [r1]
 5672 0042 40F63540 		movw	r0, #3125
 5673 0046 C3F31303 		ubfx	r3, r3, #0, #20
 5674 004a 00FB0313 		mla	r3, r0, r3, r1
 5675              	.LVL647:
2098:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
 5676              		.loc 1 2098 0
 5677 004e 206B     		ldr	r0, [r4, #48]
2099:bluetooth_rxtx.c **** 			second_ts += 3276800000; // handle rollover
2100:bluetooth_rxtx.c **** 		// Number of channels hopped between previous and current timestamp.
2101:bluetooth_rxtx.c **** 		u32 channels_hopped = DIVIDE_ROUND(second_ts - first_ts,
 5678              		.loc 1 2101 0
 5679 0050 528C     		ldrh	r2, [r2, #34]
2098:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
 5680              		.loc 1 2098 0
 5681 0052 8342     		cmp	r3, r0
2099:bluetooth_rxtx.c **** 			second_ts += 3276800000; // handle rollover
ARM GAS  /tmp/ccxsBJK4.s 			page 155


 5682              		.loc 1 2099 0
 5683 0054 3CBF     		itt	cc
 5684 0056 03F14343 		addcc	r3, r3, #-1023410176
 5685              	.LVL648:
 5686 005a 03F5A003 		addcc	r3, r3, #5242880
 5687              	.LVL649:
 5688              		.loc 1 2101 0
 5689 005e 1B1A     		subs	r3, r3, r0
 5690              	.LVL650:
 5691 0060 43F2D405 		movw	r5, #12500
 5692 0064 41F66A00 		movw	r0, #6250
 5693 0068 00FB0233 		mla	r3, r0, r2, r3
 5694 006c 5543     		muls	r5, r2, r5
 5695 006e B3FBF5F3 		udiv	r3, r3, r5
 5696              	.LVL651:
2102:bluetooth_rxtx.c **** 										   le.conn_interval * LE_BASECLK);
2103:bluetooth_rxtx.c **** 		if (channels_hopped < 37) {
 5697              		.loc 1 2103 0
 5698 0072 242B     		cmp	r3, #36
2101:bluetooth_rxtx.c **** 										   le.conn_interval * LE_BASECLK);
 5699              		.loc 1 2101 0
 5700 0074 1449     		ldr	r1, .L642
 5701              		.loc 1 2103 0
 5702 0076 21D8     		bhi	.L638
2104:bluetooth_rxtx.c **** 			// Get the hop increment based on the number of channels hopped.
2105:bluetooth_rxtx.c **** 			le.channel_increment = hop_interval_lut[channels_hopped];
 5703              		.loc 1 2105 0
 5704 0078 1748     		ldr	r0, .L642+16
2106:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 5705              		.loc 1 2106 0
 5706 007a 5208     		lsrs	r2, r2, #1
2105:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 5707              		.loc 1 2105 0
 5708 007c 0344     		add	r3, r3, r0
 5709              	.LVL652:
 5710 007e 93F87008 		ldrb	r0, [r3, #2160]	@ zero_extendqisi2
 5711              		.loc 1 2106 0
 5712 0082 0A84     		strh	r2, [r1, #32]	@ movhi
2105:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 5713              		.loc 1 2105 0
 5714 0084 8876     		strb	r0, [r1, #26]
2107:bluetooth_rxtx.c **** 			le.conn_count = 0;
2108:bluetooth_rxtx.c **** 			le.conn_epoch = 0;
2109:bluetooth_rxtx.c **** 			do_hop = 0;
2110:bluetooth_rxtx.c **** 			// Move on to regular connection following.
2111:bluetooth_rxtx.c **** 			le.channel_idx = (1 + le.channel_increment) % 37;
 5715              		.loc 1 2111 0
 5716 0086 2522     		movs	r2, #37
 5717 0088 0130     		adds	r0, r0, #1
 5718 008a 90FBF2F5 		sdiv	r5, r0, r2
 5719 008e 02FB1502 		mls	r2, r2, r5, r0
2107:bluetooth_rxtx.c **** 			le.conn_count = 0;
 5720              		.loc 1 2107 0
 5721 0092 0023     		movs	r3, #0
 5722              	.LVL653:
 5723 0094 8B84     		strh	r3, [r1, #36]	@ movhi
2108:bluetooth_rxtx.c **** 			do_hop = 0;
ARM GAS  /tmp/ccxsBJK4.s 			page 156


 5724              		.loc 1 2108 0
 5725 0096 CB61     		str	r3, [r1, #28]
2109:bluetooth_rxtx.c **** 			// Move on to regular connection following.
 5726              		.loc 1 2109 0
 5727 0098 E372     		strb	r3, [r4, #11]
2112:bluetooth_rxtx.c **** 			le.link_state = LINK_CONNECTED;
 5728              		.loc 1 2112 0
 5729 009a 0320     		movs	r0, #3
2113:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 5730              		.loc 1 2113 0
 5731 009c 4B61     		str	r3, [r1, #20]
2114:bluetooth_rxtx.c **** 			hop_mode = HOP_BTLE;
2115:bluetooth_rxtx.c **** 			packet_cb = connection_follow_cb;
 5732              		.loc 1 2115 0
 5733 009e 0F4B     		ldr	r3, .L642+20
2111:bluetooth_rxtx.c **** 			le.link_state = LINK_CONNECTED;
 5734              		.loc 1 2111 0
 5735 00a0 4A76     		strb	r2, [r1, #25]
2112:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 5736              		.loc 1 2112 0
 5737 00a2 0876     		strb	r0, [r1, #24]
2116:bluetooth_rxtx.c **** 			le_promisc_state(3, &le.channel_increment, 1);
 5738              		.loc 1 2116 0
 5739 00a4 0122     		movs	r2, #1
 5740 00a6 1A31     		adds	r1, r1, #26
2115:bluetooth_rxtx.c **** 			le_promisc_state(3, &le.channel_increment, 1);
 5741              		.loc 1 2115 0
 5742 00a8 A361     		str	r3, [r4, #24]
2114:bluetooth_rxtx.c **** 			packet_cb = connection_follow_cb;
 5743              		.loc 1 2114 0
 5744 00aa A072     		strb	r0, [r4, #10]
 5745              		.loc 1 2116 0
 5746 00ac FFF7FEFF 		bl	le_promisc_state
 5747              	.LVL654:
2117:bluetooth_rxtx.c **** 
2118:bluetooth_rxtx.c **** 			if (jam_mode != JAM_NONE)
 5748              		.loc 1 2118 0
 5749 00b0 E37C     		ldrb	r3, [r4, #19]	@ zero_extendqisi2
 5750 00b2 43B1     		cbz	r3, .L633
2119:bluetooth_rxtx.c **** 				le_jam_count = JAM_COUNT_DEFAULT;
 5751              		.loc 1 2119 0
 5752 00b4 054B     		ldr	r3, .L642+4
 5753 00b6 2822     		movs	r2, #40
 5754 00b8 DA61     		str	r2, [r3, #28]
 5755 00ba 38BD     		pop	{r3, r4, r5, pc}
 5756              	.LVL655:
 5757              	.L638:
2120:bluetooth_rxtx.c **** 
2121:bluetooth_rxtx.c **** 			return;
2122:bluetooth_rxtx.c **** 		}
2123:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 5758              		.loc 1 2123 0
 5759 00bc 40F66413 		movw	r3, #2404
 5760              	.LVL656:
 5761              	.L636:
 5762              	.LBE53:
 5763              	.LBE52:
ARM GAS  /tmp/ccxsBJK4.s 			page 157


 5764              	.LBE51:
2124:bluetooth_rxtx.c **** 		do_hop = 1;
2125:bluetooth_rxtx.c **** 	}
2126:bluetooth_rxtx.c **** 	else {
2127:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 5765              		.loc 1 2127 0
 5766 00c0 A381     		strh	r3, [r4, #12]	@ movhi
2128:bluetooth_rxtx.c **** 		do_hop = 1;
 5767              		.loc 1 2128 0
 5768 00c2 0123     		movs	r3, #1
 5769 00c4 E372     		strb	r3, [r4, #11]
 5770              	.L633:
 5771 00c6 38BD     		pop	{r3, r4, r5, pc}
 5772              	.L643:
 5773              		.align	2
 5774              	.L642:
 5775 00c8 00000000 		.word	.LANCHOR1
 5776 00cc 00000000 		.word	.LANCHOR0
 5777 00d0 00000000 		.word	clkn
 5778 00d4 08400040 		.word	1073758216
 5779 00d8 00000000 		.word	.LANCHOR2
 5780 00dc 00000000 		.word	connection_follow_cb
 5781              		.cfi_endproc
 5782              	.LFE27:
 5784              		.section	.text.promisc_recover_hop_interval,"ax",%progbits
 5785              		.align	1
 5786              		.global	promisc_recover_hop_interval
 5787              		.thumb
 5788              		.thumb_func
 5790              	promisc_recover_hop_interval:
 5791              	.LFB28:
2129:bluetooth_rxtx.c **** 	}
2130:bluetooth_rxtx.c **** }
2131:bluetooth_rxtx.c **** 
2132:bluetooth_rxtx.c **** void promisc_recover_hop_interval(u8 *packet) {
 5792              		.loc 1 2132 0
 5793              		.cfi_startproc
 5794              		@ args = 0, pretend = 0, frame = 0
 5795              		@ frame_needed = 0, uses_anonymous_args = 0
 5796              	.LVL657:
 5797 0000 38B5     		push	{r3, r4, r5, lr}
 5798              		.cfi_def_cfa_offset 16
 5799              		.cfi_offset 3, -16
 5800              		.cfi_offset 4, -12
 5801              		.cfi_offset 5, -8
 5802              		.cfi_offset 14, -4
2133:bluetooth_rxtx.c **** 	static u32 prev_clk = 0;
2134:bluetooth_rxtx.c **** 
2135:bluetooth_rxtx.c **** 	u32 cur_clk = CLK100NS;
 5803              		.loc 1 2135 0
 5804 0002 254B     		ldr	r3, .L650
 5805 0004 40F63542 		movw	r2, #3125
 5806 0008 1C68     		ldr	r4, [r3]
 5807 000a 244B     		ldr	r3, .L650+4
 5808 000c C4F31304 		ubfx	r4, r4, #0, #20
 5809 0010 1B68     		ldr	r3, [r3]
2136:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
ARM GAS  /tmp/ccxsBJK4.s 			page 158


 5810              		.loc 1 2136 0
 5811 0012 234D     		ldr	r5, .L650+8
2135:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
 5812              		.loc 1 2135 0
 5813 0014 02FB0434 		mla	r4, r2, r4, r3
 5814              	.LVL658:
 5815              		.loc 1 2136 0
 5816 0018 6B6B     		ldr	r3, [r5, #52]
 5817 001a 9C42     		cmp	r4, r3
 5818 001c 05D2     		bcs	.L645
2137:bluetooth_rxtx.c **** 		cur_clk += 3267800000; // handle rollover
 5819              		.loc 1 2137 0
 5820 001e 04F14344 		add	r4, r4, #-1023410176
 5821              	.LVL659:
 5822 0022 A4F56514 		sub	r4, r4, #3751936
 5823              	.LVL660:
 5824 0026 A4F5A254 		sub	r4, r4, #5184
 5825              	.LVL661:
 5826              	.L645:
2138:bluetooth_rxtx.c **** 	u32 clk_diff = cur_clk - prev_clk;
 5827              		.loc 1 2138 0
 5828 002a E31A     		subs	r3, r4, r3
 5829              	.LVL662:
2139:bluetooth_rxtx.c **** 	u16 obsv_hop_interval; // observed hop interval
2140:bluetooth_rxtx.c **** 
2141:bluetooth_rxtx.c **** 	// probably consecutive data packets on the same channel
2142:bluetooth_rxtx.c **** 	if (clk_diff < 2 * LE_BASECLK)
 5830              		.loc 1 2142 0
 5831 002c 46F2A712 		movw	r2, #24999
 5832 0030 9342     		cmp	r3, r2
 5833 0032 30D9     		bls	.L644
2143:bluetooth_rxtx.c **** 		return;
2144:bluetooth_rxtx.c **** 
2145:bluetooth_rxtx.c **** 	if (clk_diff < le_promisc.smallest_hop_interval)
 5834              		.loc 1 2145 0
 5835 0034 1B4A     		ldr	r2, .L650+12
 5836 0036 D2F80011 		ldr	r1, [r2, #256]
 5837 003a 8B42     		cmp	r3, r1
2146:bluetooth_rxtx.c **** 		le_promisc.smallest_hop_interval = clk_diff;
 5838              		.loc 1 2146 0
 5839 003c 38BF     		it	cc
 5840 003e C2F80031 		strcc	r3, [r2, #256]
2147:bluetooth_rxtx.c **** 
2148:bluetooth_rxtx.c **** 	obsv_hop_interval = DIVIDE_ROUND(le_promisc.smallest_hop_interval, 37 * LE_BASECLK);
 5841              		.loc 1 2148 0
 5842 0042 D2F80021 		ldr	r2, [r2, #256]
 5843 0046 1849     		ldr	r1, .L650+16
 5844 0048 02F56132 		add	r2, r2, #230400
 5845 004c 02F25232 		addw	r2, r2, #850
 5846 0050 B2FBF1F2 		udiv	r2, r2, r1
2149:bluetooth_rxtx.c **** 
2150:bluetooth_rxtx.c **** 	if (le.conn_interval == obsv_hop_interval) {
 5847              		.loc 1 2150 0
 5848 0054 1549     		ldr	r1, .L650+20
2148:bluetooth_rxtx.c **** 
 5849              		.loc 1 2148 0
 5850 0056 92B2     		uxth	r2, r2
ARM GAS  /tmp/ccxsBJK4.s 			page 159


 5851              	.LVL663:
 5852              		.loc 1 2150 0
 5853 0058 488C     		ldrh	r0, [r1, #34]
 5854              	.LVL664:
2148:bluetooth_rxtx.c **** 
 5855              		.loc 1 2148 0
 5856 005a 124B     		ldr	r3, .L650+12
 5857              	.LVL665:
 5858              		.loc 1 2150 0
 5859 005c 9042     		cmp	r0, r2
 5860 005e 15D1     		bne	.L648
2151:bluetooth_rxtx.c **** 		// 5 consecutive hop intervals: consider it legit and move on
2152:bluetooth_rxtx.c **** 		++le_promisc.consec_intervals;
 5861              		.loc 1 2152 0
 5862 0060 D3F80421 		ldr	r2, [r3, #260]
 5863              	.LVL666:
 5864 0064 0132     		adds	r2, r2, #1
2153:bluetooth_rxtx.c **** 		if (le_promisc.consec_intervals == 5) {
 5865              		.loc 1 2153 0
 5866 0066 052A     		cmp	r2, #5
2152:bluetooth_rxtx.c **** 		if (le_promisc.consec_intervals == 5) {
 5867              		.loc 1 2152 0
 5868 0068 C3F80421 		str	r2, [r3, #260]
 5869              		.loc 1 2153 0
 5870 006c 12D1     		bne	.L649
2154:bluetooth_rxtx.c **** 			packet_cb = promisc_recover_hop_increment;
 5871              		.loc 1 2154 0
 5872 006e 104B     		ldr	r3, .L650+24
2155:bluetooth_rxtx.c **** 			hop_direct_channel = 2404;
2156:bluetooth_rxtx.c **** 			hop_mode = HOP_DIRECT;
2157:bluetooth_rxtx.c **** 			do_hop = 1;
2158:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 5873              		.loc 1 2158 0
 5874 0070 0220     		movs	r0, #2
2154:bluetooth_rxtx.c **** 			packet_cb = promisc_recover_hop_increment;
 5875              		.loc 1 2154 0
 5876 0072 AB61     		str	r3, [r5, #24]
2155:bluetooth_rxtx.c **** 			hop_direct_channel = 2404;
 5877              		.loc 1 2155 0
 5878 0074 40F66413 		movw	r3, #2404
 5879 0078 AB81     		strh	r3, [r5, #12]	@ movhi
2156:bluetooth_rxtx.c **** 			do_hop = 1;
 5880              		.loc 1 2156 0
 5881 007a 0423     		movs	r3, #4
 5882 007c AB72     		strb	r3, [r5, #10]
 5883              		.loc 1 2158 0
 5884 007e 2231     		adds	r1, r1, #34
2157:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 5885              		.loc 1 2157 0
 5886 0080 0123     		movs	r3, #1
 5887              		.loc 1 2158 0
 5888 0082 0246     		mov	r2, r0
2157:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 5889              		.loc 1 2157 0
 5890 0084 EB72     		strb	r3, [r5, #11]
 5891              		.loc 1 2158 0
 5892 0086 FFF7FEFF 		bl	le_promisc_state
ARM GAS  /tmp/ccxsBJK4.s 			page 160


 5893              	.LVL667:
 5894 008a 03E0     		b	.L649
 5895              	.LVL668:
 5896              	.L648:
2159:bluetooth_rxtx.c **** 		}
2160:bluetooth_rxtx.c **** 	} else {
2161:bluetooth_rxtx.c **** 		le.conn_interval = obsv_hop_interval;
 5897              		.loc 1 2161 0
 5898 008c 4A84     		strh	r2, [r1, #34]	@ movhi
2162:bluetooth_rxtx.c **** 		le_promisc.consec_intervals = 0;
 5899              		.loc 1 2162 0
 5900 008e 0022     		movs	r2, #0
 5901              	.LVL669:
 5902 0090 C3F80421 		str	r2, [r3, #260]
 5903              	.LVL670:
 5904              	.L649:
2163:bluetooth_rxtx.c **** 	}
2164:bluetooth_rxtx.c **** 
2165:bluetooth_rxtx.c **** 	prev_clk = cur_clk;
 5905              		.loc 1 2165 0
 5906 0094 6C63     		str	r4, [r5, #52]
 5907              	.L644:
 5908 0096 38BD     		pop	{r3, r4, r5, pc}
 5909              	.LVL671:
 5910              	.L651:
 5911              		.align	2
 5912              	.L650:
 5913 0098 00000000 		.word	clkn
 5914 009c 08400040 		.word	1073758216
 5915 00a0 00000000 		.word	.LANCHOR0
 5916 00a4 00000000 		.word	le_promisc
 5917 00a8 A40E0700 		.word	462500
 5918 00ac 00000000 		.word	.LANCHOR1
 5919 00b0 00000000 		.word	promisc_recover_hop_increment
 5920              		.cfi_endproc
 5921              	.LFE28:
 5923              		.section	.text.promisc_follow_cb,"ax",%progbits
 5924              		.align	1
 5925              		.global	promisc_follow_cb
 5926              		.thumb
 5927              		.thumb_func
 5929              	promisc_follow_cb:
 5930              	.LFB29:
2166:bluetooth_rxtx.c **** }
2167:bluetooth_rxtx.c **** 
2168:bluetooth_rxtx.c **** void promisc_follow_cb(u8 *packet) {
 5931              		.loc 1 2168 0
 5932              		.cfi_startproc
 5933              		@ args = 0, pretend = 0, frame = 0
 5934              		@ frame_needed = 0, uses_anonymous_args = 0
 5935              	.LVL672:
 5936 0000 38B5     		push	{r3, r4, r5, lr}
 5937              		.cfi_def_cfa_offset 16
 5938              		.cfi_offset 3, -16
 5939              		.cfi_offset 4, -12
 5940              		.cfi_offset 5, -8
 5941              		.cfi_offset 14, -4
ARM GAS  /tmp/ccxsBJK4.s 			page 161


2169:bluetooth_rxtx.c **** 	int i;
2170:bluetooth_rxtx.c **** 
2171:bluetooth_rxtx.c **** 	// get the CRCInit
2172:bluetooth_rxtx.c **** 	if (!le.crc_verify && packet[4] == 0x01 && packet[5] == 0x00) {
 5942              		.loc 1 2172 0
 5943 0002 184C     		ldr	r4, .L657
2168:bluetooth_rxtx.c **** 	int i;
 5944              		.loc 1 2168 0
 5945 0004 0146     		mov	r1, r0
 5946              		.loc 1 2172 0
 5947 0006 6369     		ldr	r3, [r4, #20]
 5948 0008 53BB     		cbnz	r3, .L652
 5949              		.loc 1 2172 0 is_stmt 0 discriminator 1
 5950 000a 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 5951 000c 012B     		cmp	r3, #1
 5952 000e 27D1     		bne	.L652
 5953 0010 4579     		ldrb	r5, [r0, #5]	@ zero_extendqisi2
 5954 0012 2DBB     		cbnz	r5, .L652
 5955              	.LVL673:
 5956              	.LBB57:
 5957              	.LBB58:
 5958              	.LBB59:
2173:bluetooth_rxtx.c **** 		u32 crc = (packet[8] << 16) | (packet[7] << 8) | packet[6];
 5959              		.loc 1 2173 0 is_stmt 1
 5960 0014 037A     		ldrb	r3, [r0, #8]	@ zero_extendqisi2
 5961 0016 C079     		ldrb	r0, [r0, #7]	@ zero_extendqisi2
 5962              	.LVL674:
2174:bluetooth_rxtx.c **** 
2175:bluetooth_rxtx.c **** 		le.crc_init = btle_reverse_crc(crc, packet + 4, 2);
 5963              		.loc 1 2175 0
 5964 0018 0222     		movs	r2, #2
2173:bluetooth_rxtx.c **** 		u32 crc = (packet[8] << 16) | (packet[7] << 8) | packet[6];
 5965              		.loc 1 2173 0
 5966 001a 0002     		lsls	r0, r0, #8
 5967 001c 40EA0340 		orr	r0, r0, r3, lsl #16
 5968 0020 8B79     		ldrb	r3, [r1, #6]	@ zero_extendqisi2
 5969              		.loc 1 2175 0
 5970 0022 0431     		adds	r1, r1, #4
 5971              	.LVL675:
 5972 0024 1843     		orrs	r0, r0, r3
 5973 0026 FFF7FEFF 		bl	btle_reverse_crc
 5974              	.LVL676:
 5975 002a 2A46     		mov	r2, r5
 5976 002c E060     		str	r0, [r4, #12]
 5977              	.LVL677:
2176:bluetooth_rxtx.c **** 		le.crc_init_reversed = 0;
2177:bluetooth_rxtx.c **** 		for (i = 0; i < 24; ++i)
 5978              		.loc 1 2177 0
 5979 002e 2B46     		mov	r3, r5
 5980              	.LVL678:
 5981              	.L655:
2178:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 5982              		.loc 1 2178 0
 5983 0030 20FA03F1 		lsr	r1, r0, r3
 5984 0034 C3F11705 		rsb	r5, r3, #23
 5985 0038 01F00101 		and	r1, r1, #1
 5986 003c A940     		lsls	r1, r1, r5
ARM GAS  /tmp/ccxsBJK4.s 			page 162


2177:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 5987              		.loc 1 2177 0
 5988 003e 0133     		adds	r3, r3, #1
 5989              	.LVL679:
 5990 0040 182B     		cmp	r3, #24
 5991              		.loc 1 2178 0
 5992 0042 42EA0102 		orr	r2, r2, r1
2177:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 5993              		.loc 1 2177 0
 5994 0046 F3D1     		bne	.L655
 5995 0048 2261     		str	r2, [r4, #16]
2179:bluetooth_rxtx.c **** 
2180:bluetooth_rxtx.c **** 		le.crc_verify = 1;
2181:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 5996              		.loc 1 2181 0
 5997 004a 074B     		ldr	r3, .L657+4
 5998              	.LVL680:
 5999 004c 074A     		ldr	r2, .L657+8
2180:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 6000              		.loc 1 2180 0
 6001 004e 0120     		movs	r0, #1
 6002              		.loc 1 2181 0
 6003 0050 9A61     		str	r2, [r3, #24]
2180:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 6004              		.loc 1 2180 0
 6005 0052 6061     		str	r0, [r4, #20]
2182:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 6006              		.loc 1 2182 0
 6007 0054 0649     		ldr	r1, .L657+12
 6008 0056 0322     		movs	r2, #3
 6009              	.LBE59:
 6010              	.LBE58:
 6011              	.LBE57:
2183:bluetooth_rxtx.c **** 	}
2184:bluetooth_rxtx.c **** }
 6012              		.loc 1 2184 0
 6013 0058 BDE83840 		pop	{r3, r4, r5, lr}
 6014              	.LBB62:
 6015              	.LBB61:
 6016              	.LBB60:
2182:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 6017              		.loc 1 2182 0
 6018 005c FFF7FEBF 		b	le_promisc_state
 6019              	.LVL681:
 6020              	.L652:
 6021 0060 38BD     		pop	{r3, r4, r5, pc}
 6022              	.L658:
 6023 0062 00BF     		.align	2
 6024              	.L657:
 6025 0064 00000000 		.word	.LANCHOR1
 6026 0068 00000000 		.word	.LANCHOR0
 6027 006c 00000000 		.word	promisc_recover_hop_interval
 6028 0070 0C000000 		.word	.LANCHOR1+12
 6029              	.LBE60:
 6030              	.LBE61:
 6031              	.LBE62:
 6032              		.cfi_endproc
ARM GAS  /tmp/ccxsBJK4.s 			page 163


 6033              	.LFE29:
 6035              		.section	.text.see_aa,"ax",%progbits
 6036              		.align	1
 6037              		.global	see_aa
 6038              		.thumb
 6039              		.thumb_func
 6041              	see_aa:
 6042              	.LFB30:
2185:bluetooth_rxtx.c **** 
2186:bluetooth_rxtx.c **** // called when we see an AA, add it to the list
2187:bluetooth_rxtx.c **** void see_aa(u32 aa) {
 6043              		.loc 1 2187 0
 6044              		.cfi_startproc
 6045              		@ args = 0, pretend = 0, frame = 0
 6046              		@ frame_needed = 0, uses_anonymous_args = 0
 6047              	.LVL682:
 6048 0000 30B5     		push	{r4, r5, lr}
 6049              		.cfi_def_cfa_offset 12
 6050              		.cfi_offset 4, -12
 6051              		.cfi_offset 5, -8
 6052              		.cfi_offset 14, -4
 6053              	.LVL683:
2188:bluetooth_rxtx.c **** 	int i, max = -1, killme = -1;
2189:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
 6054              		.loc 1 2189 0
 6055 0002 0022     		movs	r2, #0
 6056              	.LVL684:
 6057              	.L663:
2190:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 6058              		.loc 1 2190 0
 6059 0004 144D     		ldr	r5, .L672
 6060 0006 55F83210 		ldr	r1, [r5, r2, lsl #3]
 6061 000a 05EBC203 		add	r3, r5, r2, lsl #3
 6062 000e 8142     		cmp	r1, r0
 6063 0010 02D1     		bne	.L660
2191:bluetooth_rxtx.c **** 			++le_promisc.active_aa[i].count;
 6064              		.loc 1 2191 0
 6065 0012 5A68     		ldr	r2, [r3, #4]
 6066              	.LVL685:
 6067 0014 0132     		adds	r2, r2, #1
 6068 0016 1CE0     		b	.L671
 6069              	.LVL686:
 6070              	.L660:
2189:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 6071              		.loc 1 2189 0
 6072 0018 0132     		adds	r2, r2, #1
 6073              	.LVL687:
 6074 001a 202A     		cmp	r2, #32
 6075 001c F2D1     		bne	.L663
 6076 001e 4FF0FF33 		mov	r3, #-1
 6077 0022 1946     		mov	r1, r3
 6078 0024 0022     		movs	r2, #0
 6079              	.LVL688:
 6080              	.L666:
 6081 0026 05EBC204 		add	r4, r5, r2, lsl #3
2192:bluetooth_rxtx.c **** 			return;
2193:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccxsBJK4.s 			page 164


2194:bluetooth_rxtx.c **** 
2195:bluetooth_rxtx.c **** 	// evict someone
2196:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
2197:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 6082              		.loc 1 2197 0
 6083 002a 6468     		ldr	r4, [r4, #4]
 6084 002c 8C42     		cmp	r4, r1
 6085 002e 05DB     		blt	.L667
 6086              		.loc 1 2197 0 is_stmt 0 discriminator 1
 6087 0030 0029     		cmp	r1, #0
 6088 0032 A8BF     		it	ge
 6089 0034 0C46     		movge	r4, r1
 6090 0036 B8BF     		it	lt
 6091 0038 1346     		movlt	r3, r2
 6092              	.LVL689:
 6093 003a 00E0     		b	.L664
 6094              	.LVL690:
 6095              	.L667:
 6096 003c 1346     		mov	r3, r2
 6097              	.LVL691:
 6098              	.L664:
2196:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 6099              		.loc 1 2196 0 is_stmt 1
 6100 003e 0132     		adds	r2, r2, #1
 6101              	.LVL692:
 6102 0040 202A     		cmp	r2, #32
 6103 0042 01D0     		beq	.L665
 6104 0044 2146     		mov	r1, r4
 6105 0046 EEE7     		b	.L666
 6106              	.L665:
2198:bluetooth_rxtx.c **** 			killme = i;
2199:bluetooth_rxtx.c **** 			max = le_promisc.active_aa[i].count;
2200:bluetooth_rxtx.c **** 		}
2201:bluetooth_rxtx.c **** 
2202:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].aa = aa;
 6107              		.loc 1 2202 0
 6108 0048 45F83300 		str	r0, [r5, r3, lsl #3]
2203:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].count = 1;
 6109              		.loc 1 2203 0
 6110 004c 0122     		movs	r2, #1
 6111              	.LVL693:
 6112 004e 05EBC303 		add	r3, r5, r3, lsl #3
 6113              	.LVL694:
 6114              	.L671:
 6115 0052 5A60     		str	r2, [r3, #4]
 6116 0054 30BD     		pop	{r4, r5, pc}
 6117              	.L673:
 6118 0056 00BF     		.align	2
 6119              	.L672:
 6120 0058 00000000 		.word	le_promisc
 6121              		.cfi_endproc
 6122              	.LFE30:
 6124              		.section	.text.cb_le_promisc,"ax",%progbits
 6125              		.align	1
 6126              		.global	cb_le_promisc
 6127              		.thumb
 6128              		.thumb_func
ARM GAS  /tmp/ccxsBJK4.s 			page 165


 6130              	cb_le_promisc:
 6131              	.LFB31:
2204:bluetooth_rxtx.c **** }
2205:bluetooth_rxtx.c **** 
2206:bluetooth_rxtx.c **** /* le promiscuous mode */
2207:bluetooth_rxtx.c **** int cb_le_promisc(char *unpacked) {
 6132              		.loc 1 2207 0
 6133              		.cfi_startproc
 6134              		@ args = 0, pretend = 0, frame = 80
 6135              		@ frame_needed = 0, uses_anonymous_args = 0
 6136              	.LVL695:
 6137 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 6138              		.cfi_def_cfa_offset 28
 6139              		.cfi_offset 4, -28
 6140              		.cfi_offset 5, -24
 6141              		.cfi_offset 6, -20
 6142              		.cfi_offset 7, -16
 6143              		.cfi_offset 8, -12
 6144              		.cfi_offset 9, -8
 6145              		.cfi_offset 14, -4
 6146 0004 95B0     		sub	sp, sp, #84
 6147              		.cfi_def_cfa_offset 112
2208:bluetooth_rxtx.c **** 	int i, j, k;
2209:bluetooth_rxtx.c **** 	int idx;
2210:bluetooth_rxtx.c **** 
2211:bluetooth_rxtx.c **** 	// empty data PDU: 01 00
2212:bluetooth_rxtx.c **** 	char desired[4][16] = {
 6148              		.loc 1 2212 0
 6149 0006 0021     		movs	r1, #0
2207:bluetooth_rxtx.c **** 	int i, j, k;
 6150              		.loc 1 2207 0
 6151 0008 8046     		mov	r8, r0
 6152              		.loc 1 2212 0
 6153 000a 4022     		movs	r2, #64
 6154 000c 04A8     		add	r0, sp, #16
 6155              	.LVL696:
 6156 000e FFF7FEFF 		bl	memset
 6157              	.LVL697:
 6158 0012 0123     		movs	r3, #1
 6159 0014 8DF81030 		strb	r3, [sp, #16]
 6160 0018 8DF82030 		strb	r3, [sp, #32]
 6161 001c 8DF82330 		strb	r3, [sp, #35]
 6162 0020 8DF83030 		strb	r3, [sp, #48]
 6163 0024 8DF83230 		strb	r3, [sp, #50]
 6164 0028 8DF84030 		strb	r3, [sp, #64]
 6165 002c 8DF84230 		strb	r3, [sp, #66]
 6166 0030 8DF84330 		strb	r3, [sp, #67]
 6167              	.LVL698:
 6168 0034 14AD     		add	r5, sp, #80
 6169 0036 04AC     		add	r4, sp, #16
 6170              	.LVL699:
 6171              	.L678:
2213:bluetooth_rxtx.c **** 		{ 1, 0, 0, 0, 0, 0, 0, 0,
2214:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2215:bluetooth_rxtx.c **** 		{ 1, 0, 0, 1, 0, 0, 0, 0,
2216:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2217:bluetooth_rxtx.c **** 		{ 1, 0, 1, 0, 0, 0, 0, 0,
ARM GAS  /tmp/ccxsBJK4.s 			page 166


2218:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2219:bluetooth_rxtx.c **** 		{ 1, 0, 1, 1, 0, 0, 0, 0,
2220:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2221:bluetooth_rxtx.c **** 	};
2222:bluetooth_rxtx.c **** 
2223:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
2224:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 6172              		.loc 1 2224 0
 6173 0038 504E     		ldr	r6, .L710
 6174 003a 514F     		ldr	r7, .L710+4
 6175 003c 3088     		ldrh	r0, [r6]
 6176 003e 80B2     		uxth	r0, r0
 6177 0040 6238     		subs	r0, r0, #98
 6178 0042 C0B2     		uxtb	r0, r0
 6179 0044 FFF7FEFF 		bl	btle_channel_index
 6180              	.LVL700:
 6181 0048 3A5C     		ldrb	r2, [r7, r0]	@ zero_extendqisi2
 6182              	.LVL701:
2225:bluetooth_rxtx.c **** 
2226:bluetooth_rxtx.c **** 		// whiten the desired data
2227:bluetooth_rxtx.c **** 		for (j = 0; j < (int)sizeof(desired[i]); ++j) {
 6183              		.loc 1 2227 0
 6184 004a 0023     		movs	r3, #0
 6185              	.LVL702:
 6186              	.L676:
2228:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6187              		.loc 1 2228 0 discriminator 2
 6188 004c B918     		adds	r1, r7, r2
 6189 004e E05C     		ldrb	r0, [r4, r3]	@ zero_extendqisi2
 6190 0050 91F82810 		ldrb	r1, [r1, #40]	@ zero_extendqisi2
2229:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 6191              		.loc 1 2229 0 discriminator 2
 6192 0054 0132     		adds	r2, r2, #1
 6193              	.LVL703:
2228:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6194              		.loc 1 2228 0 discriminator 2
 6195 0056 4140     		eors	r1, r1, r0
 6196 0058 E154     		strb	r1, [r4, r3]
 6197              		.loc 1 2229 0 discriminator 2
 6198 005a 7F21     		movs	r1, #127
2227:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6199              		.loc 1 2227 0 discriminator 2
 6200 005c 0133     		adds	r3, r3, #1
 6201              	.LVL704:
 6202              		.loc 1 2229 0 discriminator 2
 6203 005e B2FBF1F0 		udiv	r0, r2, r1
2227:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6204              		.loc 1 2227 0 discriminator 2
 6205 0062 102B     		cmp	r3, #16
 6206              		.loc 1 2229 0 discriminator 2
 6207 0064 01FB1022 		mls	r2, r1, r0, r2
 6208              	.LVL705:
2227:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6209              		.loc 1 2227 0 discriminator 2
 6210 0068 F0D1     		bne	.L676
 6211 006a 1034     		adds	r4, r4, #16
2223:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
ARM GAS  /tmp/ccxsBJK4.s 			page 167


 6212              		.loc 1 2223 0
 6213 006c AC42     		cmp	r4, r5
 6214 006e E3D1     		bne	.L678
 6215 0070 08F12005 		add	r5, r8, #32
 6216 0074 08F53C78 		add	r8, r8, #752
 6217              	.LVL706:
 6218              	.L694:
 6219              	.LBB63:
2230:bluetooth_rxtx.c **** 		}
2231:bluetooth_rxtx.c **** 	}
2232:bluetooth_rxtx.c **** 
2233:bluetooth_rxtx.c **** 	// then look for that bitsream in our receive buffer
2234:bluetooth_rxtx.c **** 	for (i = 32; i < (DMA_SIZE*8*2 - 32 - 16); i++) {
2235:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 6220              		.loc 1 2235 0
 6221 0078 424B     		ldr	r3, .L710+8
 6222 007a 6C46     		mov	r4, sp
 6223 007c 0FCB     		ldmia	r3, {r0, r1, r2, r3}
 6224 007e 8DE80F00 		stmia	sp, {r0, r1, r2, r3}
 6225              	.LVL707:
 6226 0082 0022     		movs	r2, #0
 6227              	.LVL708:
 6228              	.L679:
 6229 0084 04AB     		add	r3, sp, #16
 6230 0086 03EB8201 		add	r1, r3, r2, lsl #2
 6231              	.LBE63:
2227:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 6232              		.loc 1 2227 0 discriminator 1
 6233 008a 0023     		movs	r3, #0
 6234              	.LVL709:
 6235              	.L684:
 6236              	.LBB68:
2236:bluetooth_rxtx.c **** 		int matching = -1;
2237:bluetooth_rxtx.c **** 
2238:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
2239:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
2240:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 6237              		.loc 1 2240 0
 6238 008c 15F803C0 		ldrb	ip, [r5, r3]	@ zero_extendqisi2
 6239 0090 C85C     		ldrb	r0, [r1, r3]	@ zero_extendqisi2
 6240 0092 8445     		cmp	ip, r0
 6241 0094 02D0     		beq	.L680
2241:bluetooth_rxtx.c **** 					ok[j] = 0;
 6242              		.loc 1 2241 0
 6243 0096 0023     		movs	r3, #0
 6244              	.LVL710:
 6245 0098 A350     		str	r3, [r4, r2]
2242:bluetooth_rxtx.c **** 					break;
 6246              		.loc 1 2242 0
 6247 009a 02E0     		b	.L681
 6248              	.LVL711:
 6249              	.L680:
2239:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 6250              		.loc 1 2239 0
 6251 009c 0133     		adds	r3, r3, #1
 6252              	.LVL712:
 6253 009e 102B     		cmp	r3, #16
ARM GAS  /tmp/ccxsBJK4.s 			page 168


 6254 00a0 F4D1     		bne	.L684
 6255              	.LVL713:
 6256              	.L681:
 6257 00a2 0432     		adds	r2, r2, #4
2238:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 6258              		.loc 1 2238 0
 6259 00a4 102A     		cmp	r2, #16
 6260 00a6 EDD1     		bne	.L679
 6261 00a8 0023     		movs	r3, #0
 6262              	.L687:
2243:bluetooth_rxtx.c **** 				}
2244:bluetooth_rxtx.c **** 			}
2245:bluetooth_rxtx.c **** 		}
2246:bluetooth_rxtx.c **** 
2247:bluetooth_rxtx.c **** 		// see if any match
2248:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
2249:bluetooth_rxtx.c **** 			if (ok[j]) {
 6263              		.loc 1 2249 0
 6264 00aa E258     		ldr	r2, [r4, r3]
 6265 00ac 1AB9     		cbnz	r2, .L685
 6266 00ae 0433     		adds	r3, r3, #4
2248:bluetooth_rxtx.c **** 			if (ok[j]) {
 6267              		.loc 1 2248 0
 6268 00b0 102B     		cmp	r3, #16
 6269 00b2 FAD1     		bne	.L687
 6270 00b4 3EE0     		b	.L698
 6271              	.L685:
 6272              	.LVL714:
2250:bluetooth_rxtx.c **** 				matching = j;
2251:bluetooth_rxtx.c **** 				break;
2252:bluetooth_rxtx.c **** 			}
2253:bluetooth_rxtx.c **** 		}
2254:bluetooth_rxtx.c **** 
2255:bluetooth_rxtx.c **** 		// skip if no match
2256:bluetooth_rxtx.c **** 		if (matching < 0)
2257:bluetooth_rxtx.c **** 			continue;
2258:bluetooth_rxtx.c **** 
2259:bluetooth_rxtx.c **** 		// found a match! unwhiten it and send it home
2260:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 6273              		.loc 1 2260 0
 6274 00b6 3088     		ldrh	r0, [r6]
 6275 00b8 80B2     		uxth	r0, r0
 6276 00ba 6238     		subs	r0, r0, #98
 6277 00bc C0B2     		uxtb	r0, r0
 6278 00be FFF7FEFF 		bl	btle_channel_index
 6279              	.LVL715:
 6280 00c2 385C     		ldrb	r0, [r7, r0]	@ zero_extendqisi2
 6281              	.LVL716:
2261:bluetooth_rxtx.c **** 		for (j = 0; j < 4+3+3; ++j) {
 6282              		.loc 1 2261 0
 6283 00c4 0023     		movs	r3, #0
 6284              	.LVL717:
 6285              	.L699:
2238:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 6286              		.loc 1 2238 0 discriminator 1
 6287 00c6 0021     		movs	r1, #0
 6288 00c8 05EBC30C 		add	ip, r5, r3, lsl #3
ARM GAS  /tmp/ccxsBJK4.s 			page 169


 6289 00cc 0A46     		mov	r2, r1
 6290              	.LVL718:
 6291              	.L692:
 6292 00ce 0CEB0204 		add	r4, ip, r2
 6293              	.LBB64:
 6294              	.LBB65:
2262:bluetooth_rxtx.c **** 			u8 byte = 0;
2263:bluetooth_rxtx.c **** 			for (k = 0; k < 8; k++) {
2264:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
2265:bluetooth_rxtx.c **** 				if (offset >= DMA_SIZE*8*2) break;
2266:bluetooth_rxtx.c **** 				int bit = unpacked[offset];
2267:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 6295              		.loc 1 2267 0
 6296 00d2 032B     		cmp	r3, #3
2266:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 6297              		.loc 1 2266 0
 6298 00d4 14F8204C 		ldrb	r4, [r4, #-32]	@ zero_extendqisi2
 6299              	.LVL719:
 6300              		.loc 1 2267 0
 6301 00d8 0CDD     		ble	.L689
2268:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 6302              		.loc 1 2268 0
 6303 00da 07EB000E 		add	lr, r7, r0
 6304 00de 9EF828E0 		ldrb	lr, [lr, #40]	@ zero_extendqisi2
2269:bluetooth_rxtx.c **** 					idx = (idx + 1) % sizeof(whitening);
 6305              		.loc 1 2269 0
 6306 00e2 0130     		adds	r0, r0, #1
 6307              	.LVL720:
2268:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 6308              		.loc 1 2268 0
 6309 00e4 84EA0E04 		eor	r4, r4, lr
 6310              	.LVL721:
 6311              		.loc 1 2269 0
 6312 00e8 4FF07F0E 		mov	lr, #127
 6313 00ec B0FBFEF9 		udiv	r9, r0, lr
 6314 00f0 0EFB1900 		mls	r0, lr, r9, r0
 6315              	.LVL722:
 6316              	.L689:
2270:bluetooth_rxtx.c **** 				}
2271:bluetooth_rxtx.c **** 				byte |= bit << k;
 6317              		.loc 1 2271 0
 6318 00f4 9440     		lsls	r4, r4, r2
 6319              	.LVL723:
 6320              	.LBE65:
2263:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 6321              		.loc 1 2263 0
 6322 00f6 0132     		adds	r2, r2, #1
 6323              	.LVL724:
 6324              	.LBB66:
 6325              		.loc 1 2271 0
 6326 00f8 2143     		orrs	r1, r1, r4
 6327              	.LVL725:
 6328              	.LBE66:
2263:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 6329              		.loc 1 2263 0
 6330 00fa 082A     		cmp	r2, #8
 6331              	.LBB67:
ARM GAS  /tmp/ccxsBJK4.s 			page 170


 6332              		.loc 1 2271 0
 6333 00fc C9B2     		uxtb	r1, r1
 6334              	.LVL726:
 6335              	.LBE67:
2263:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 6336              		.loc 1 2263 0
 6337 00fe E6D1     		bne	.L692
2272:bluetooth_rxtx.c **** 			}
2273:bluetooth_rxtx.c **** 			idle_rxbuf[j] = byte;
 6338              		.loc 1 2273 0
 6339 0100 214C     		ldr	r4, .L710+12
 6340 0102 2268     		ldr	r2, [r4]
 6341              	.LVL727:
 6342 0104 D154     		strb	r1, [r2, r3]
 6343              	.LBE64:
2261:bluetooth_rxtx.c **** 			u8 byte = 0;
 6344              		.loc 1 2261 0
 6345 0106 0133     		adds	r3, r3, #1
 6346              	.LVL728:
 6347 0108 0A2B     		cmp	r3, #10
 6348 010a DCD1     		bne	.L699
2274:bluetooth_rxtx.c **** 		}
2275:bluetooth_rxtx.c **** 
2276:bluetooth_rxtx.c **** 		u32 aa = (idle_rxbuf[3] << 24) |
 6349              		.loc 1 2276 0
 6350 010c 2368     		ldr	r3, [r4]
 6351              	.LVL729:
 6352 010e D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 6353              	.LVL730:
2277:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 6354              		.loc 1 2277 0
 6355 0110 2368     		ldr	r3, [r4]
 6356 0112 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
2278:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 6357              		.loc 1 2278 0
 6358 0114 2268     		ldr	r2, [r4]
2277:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 6359              		.loc 1 2277 0
 6360 0116 1B04     		lsls	r3, r3, #16
 6361              		.loc 1 2278 0
 6362 0118 5078     		ldrb	r0, [r2, #1]	@ zero_extendqisi2
 6363              	.LVL731:
2279:bluetooth_rxtx.c **** 				 (idle_rxbuf[0]);
 6364              		.loc 1 2279 0
 6365 011a 2268     		ldr	r2, [r4]
2276:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 6366              		.loc 1 2276 0
 6367 011c 43EA0163 		orr	r3, r3, r1, lsl #24
 6368              		.loc 1 2279 0
 6369 0120 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 6370              	.LVL732:
2277:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 6371              		.loc 1 2277 0
 6372 0122 1343     		orrs	r3, r3, r2
2280:bluetooth_rxtx.c **** 		see_aa(aa);
 6373              		.loc 1 2280 0
 6374 0124 43EA0020 		orr	r0, r3, r0, lsl #8
ARM GAS  /tmp/ccxsBJK4.s 			page 171


 6375 0128 FFF7FEFF 		bl	see_aa
 6376              	.LVL733:
2281:bluetooth_rxtx.c **** 
2282:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
 6377              		.loc 1 2282 0
 6378 012c 2168     		ldr	r1, [r4]
 6379 012e 0120     		movs	r0, #1
 6380 0130 FFF7FEFF 		bl	enqueue
 6381              	.LVL734:
 6382              	.L698:
 6383 0134 0135     		adds	r5, r5, #1
 6384              	.LVL735:
 6385              	.LBE68:
2234:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 6386              		.loc 1 2234 0
 6387 0136 4545     		cmp	r5, r8
 6388 0138 9ED1     		bne	.L694
 6389 013a 0023     		movs	r3, #0
 6390              	.LVL736:
 6391              	.L697:
 6392 013c 134A     		ldr	r2, .L710+16
 6393 013e 02EBC301 		add	r1, r2, r3, lsl #3
2283:bluetooth_rxtx.c **** 
2284:bluetooth_rxtx.c **** 	}
2285:bluetooth_rxtx.c **** 
2286:bluetooth_rxtx.c **** 	// once we see an AA 5 times, start following it
2287:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i) {
2288:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 6394              		.loc 1 2288 0
 6395 0142 4968     		ldr	r1, [r1, #4]
 6396 0144 0329     		cmp	r1, #3
 6397 0146 11DD     		ble	.L695
2289:bluetooth_rxtx.c **** 			le_set_access_address(le_promisc.active_aa[i].aa);
 6398              		.loc 1 2289 0
 6399 0148 52F83300 		ldr	r0, [r2, r3, lsl #3]
 6400 014c FFF7FEFF 		bl	le_set_access_address
 6401              	.LVL737:
2290:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 6402              		.loc 1 2290 0
 6403 0150 0F4B     		ldr	r3, .L710+20
 6404 0152 104A     		ldr	r2, .L710+24
2291:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
2292:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 6405              		.loc 1 2292 0
 6406 0154 0024     		movs	r4, #0
2290:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 6407              		.loc 1 2290 0
 6408 0156 9A62     		str	r2, [r3, #40]
2291:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 6409              		.loc 1 2291 0
 6410 0158 0F4A     		ldr	r2, .L710+28
2293:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 6411              		.loc 1 2293 0
 6412 015a 2046     		mov	r0, r4
2291:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 6413              		.loc 1 2291 0
 6414 015c 9A61     		str	r2, [r3, #24]
ARM GAS  /tmp/ccxsBJK4.s 			page 172


 6415              		.loc 1 2293 0
 6416 015e 0F49     		ldr	r1, .L710+32
 6417 0160 0422     		movs	r2, #4
2292:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 6418              		.loc 1 2292 0
 6419 0162 7461     		str	r4, [r6, #20]
 6420              		.loc 1 2293 0
 6421 0164 FFF7FEFF 		bl	le_promisc_state
 6422              	.LVL738:
2294:bluetooth_rxtx.c **** 			// quit using the old stuff and switch to sync mode
2295:bluetooth_rxtx.c **** 			return 0;
 6423              		.loc 1 2295 0
 6424 0168 2046     		mov	r0, r4
 6425 016a 03E0     		b	.L709
 6426              	.LVL739:
 6427              	.L695:
2287:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 6428              		.loc 1 2287 0
 6429 016c 0133     		adds	r3, r3, #1
 6430              	.LVL740:
 6431 016e 202B     		cmp	r3, #32
 6432 0170 E4D1     		bne	.L697
2296:bluetooth_rxtx.c **** 		}
2297:bluetooth_rxtx.c **** 	}
2298:bluetooth_rxtx.c **** 
2299:bluetooth_rxtx.c **** 	return 1;
 6433              		.loc 1 2299 0
 6434 0172 0120     		movs	r0, #1
 6435              	.LVL741:
 6436              	.L709:
2300:bluetooth_rxtx.c **** }
 6437              		.loc 1 2300 0
 6438 0174 15B0     		add	sp, sp, #84
 6439              		@ sp needed
 6440 0176 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 6441              	.LVL742:
 6442              	.L711:
 6443 017a 00BF     		.align	2
 6444              	.L710:
 6445 017c 00000000 		.word	.LANCHOR1
 6446 0180 00000000 		.word	.LANCHOR2
 6447 0184 98080000 		.word	.LANCHOR2+2200
 6448 0188 00000000 		.word	idle_rxbuf
 6449 018c 00000000 		.word	le_promisc
 6450 0190 00000000 		.word	.LANCHOR0
 6451 0194 00000000 		.word	cb_follow_le
 6452 0198 00000000 		.word	promisc_follow_cb
 6453 019c 04000000 		.word	.LANCHOR1+4
 6454              		.cfi_endproc
 6455              	.LFE31:
 6457              		.section	.text.bt_promisc_le,"ax",%progbits
 6458              		.align	1
 6459              		.global	bt_promisc_le
 6460              		.thumb
 6461              		.thumb_func
 6463              	bt_promisc_le:
 6464              	.LFB32:
ARM GAS  /tmp/ccxsBJK4.s 			page 173


2301:bluetooth_rxtx.c **** 
2302:bluetooth_rxtx.c **** void bt_promisc_le() {
 6465              		.loc 1 2302 0
 6466              		.cfi_startproc
 6467              		@ args = 0, pretend = 0, frame = 0
 6468              		@ frame_needed = 0, uses_anonymous_args = 0
 6469 0000 38B5     		push	{r3, r4, r5, lr}
 6470              		.cfi_def_cfa_offset 16
 6471              		.cfi_offset 3, -16
 6472              		.cfi_offset 4, -12
 6473              		.cfi_offset 5, -8
 6474              		.cfi_offset 14, -4
 6475              	.L713:
2303:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_PROMISC_LE) {
 6476              		.loc 1 2303 0 discriminator 1
 6477 0002 164D     		ldr	r5, .L722
 6478 0004 AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
 6479 0006 0A2B     		cmp	r3, #10
 6480 0008 26D1     		bne	.L712
2304:bluetooth_rxtx.c **** 		reset_le_promisc();
2305:bluetooth_rxtx.c **** 
2306:bluetooth_rxtx.c **** 		// jump to a random data channel and turn up the squelch
2307:bluetooth_rxtx.c **** 		if ((channel & 1) == 1)
 6481              		.loc 1 2307 0
 6482 000a 154C     		ldr	r4, .L722+4
2304:bluetooth_rxtx.c **** 		reset_le_promisc();
 6483              		.loc 1 2304 0
 6484 000c FFF7FEFF 		bl	reset_le_promisc
 6485              	.LVL743:
 6486              		.loc 1 2307 0
 6487 0010 2388     		ldrh	r3, [r4]
 6488 0012 DA07     		lsls	r2, r3, #31
2308:bluetooth_rxtx.c **** 			channel = 2440;
 6489              		.loc 1 2308 0
 6490 0014 44BF     		itt	mi
 6491 0016 40F68813 		movwmi	r3, #2440
 6492 001a 2380     		strhmi	r3, [r4]	@ movhi
2309:bluetooth_rxtx.c **** 
2310:bluetooth_rxtx.c **** 		// if the PC hasn't given us AA, determine by listening
2311:bluetooth_rxtx.c **** 		if (!le.target_set) {
 6493              		.loc 1 2311 0
 6494 001c 236C     		ldr	r3, [r4, #64]
 6495 001e 4BB9     		cbnz	r3, .L715
2312:bluetooth_rxtx.c **** 			// cs_threshold_req = -80;
2313:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
 6496              		.loc 1 2313 0
 6497 0020 0F4B     		ldr	r3, .L722+4
 6498 0022 1888     		ldrh	r0, [r3]
 6499 0024 80B2     		uxth	r0, r0
 6500 0026 FFF7FEFF 		bl	cs_threshold_calc_and_set
 6501              	.LVL744:
2314:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 6502              		.loc 1 2314 0
 6503 002a 0E4B     		ldr	r3, .L722+8
2315:bluetooth_rxtx.c **** 			bt_generic_le(MODE_BT_PROMISC_LE);
 6504              		.loc 1 2315 0
 6505 002c 0A20     		movs	r0, #10
ARM GAS  /tmp/ccxsBJK4.s 			page 174


2314:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 6506              		.loc 1 2314 0
 6507 002e AB62     		str	r3, [r5, #40]
 6508              		.loc 1 2315 0
 6509 0030 FFF7FEFF 		bl	bt_generic_le
 6510              	.LVL745:
 6511              	.L715:
2316:bluetooth_rxtx.c **** 		}
2317:bluetooth_rxtx.c **** 
2318:bluetooth_rxtx.c **** 		// could have got mode change in middle of above
2319:bluetooth_rxtx.c **** 		if (requested_mode != MODE_BT_PROMISC_LE)
 6512              		.loc 1 2319 0
 6513 0034 AD7C     		ldrb	r5, [r5, #18]	@ zero_extendqisi2
 6514 0036 EDB2     		uxtb	r5, r5
 6515 0038 0A2D     		cmp	r5, #10
 6516 003a 0DD1     		bne	.L712
2320:bluetooth_rxtx.c **** 			break;
2321:bluetooth_rxtx.c **** 
2322:bluetooth_rxtx.c **** 		le_promisc_state(0, &le.access_address, 4);
 6517              		.loc 1 2322 0
 6518 003c 0020     		movs	r0, #0
 6519 003e 0A49     		ldr	r1, .L722+12
 6520 0040 0422     		movs	r2, #4
 6521 0042 FFF7FEFF 		bl	le_promisc_state
 6522              	.LVL746:
2323:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 6523              		.loc 1 2323 0
 6524 0046 094A     		ldr	r2, .L722+16
 6525 0048 044B     		ldr	r3, .L722
2324:bluetooth_rxtx.c **** 		le.crc_verify = 0;
2325:bluetooth_rxtx.c **** 		bt_le_sync(MODE_BT_PROMISC_LE);
 6526              		.loc 1 2325 0
 6527 004a 2846     		mov	r0, r5
2323:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 6528              		.loc 1 2323 0
 6529 004c 9A61     		str	r2, [r3, #24]
2324:bluetooth_rxtx.c **** 		le.crc_verify = 0;
 6530              		.loc 1 2324 0
 6531 004e 0023     		movs	r3, #0
 6532 0050 6361     		str	r3, [r4, #20]
 6533              		.loc 1 2325 0
 6534 0052 FFF7FEFF 		bl	bt_le_sync
 6535              	.LVL747:
 6536 0056 D4E7     		b	.L713
 6537              	.L712:
 6538 0058 38BD     		pop	{r3, r4, r5, pc}
 6539              	.L723:
 6540 005a 00BF     		.align	2
 6541              	.L722:
 6542 005c 00000000 		.word	.LANCHOR0
 6543 0060 00000000 		.word	.LANCHOR1
 6544 0064 00000000 		.word	cb_le_promisc
 6545 0068 04000000 		.word	.LANCHOR1+4
 6546 006c 00000000 		.word	promisc_follow_cb
 6547              		.cfi_endproc
 6548              	.LFE32:
 6550              		.section	.text.bt_slave_le,"ax",%progbits
ARM GAS  /tmp/ccxsBJK4.s 			page 175


 6551              		.align	1
 6552              		.global	bt_slave_le
 6553              		.thumb
 6554              		.thumb_func
 6556              	bt_slave_le:
 6557              	.LFB33:
2326:bluetooth_rxtx.c **** 	}
2327:bluetooth_rxtx.c **** }
2328:bluetooth_rxtx.c **** 
2329:bluetooth_rxtx.c **** void bt_slave_le(u16 tx_pwr) {
 6558              		.loc 1 2329 0
 6559              		.cfi_startproc
 6560              		@ args = 0, pretend = 0, frame = 40
 6561              		@ frame_needed = 0, uses_anonymous_args = 0
 6562              	.LVL748:
 6563 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 6564              		.cfi_def_cfa_offset 24
 6565              		.cfi_offset 4, -24
 6566              		.cfi_offset 5, -20
 6567              		.cfi_offset 6, -16
 6568              		.cfi_offset 7, -12
 6569              		.cfi_offset 8, -8
 6570              		.cfi_offset 14, -4
 6571 0004 8AB0     		sub	sp, sp, #40
 6572              		.cfi_def_cfa_offset 64
2330:bluetooth_rxtx.c **** 	u32 calc_crc;
2331:bluetooth_rxtx.c **** 	int i;
2332:bluetooth_rxtx.c **** 
2333:bluetooth_rxtx.c **** 	u8 adv_ind[] = {
 6573              		.loc 1 2333 0
 6574 0006 324C     		ldr	r4, .L762
 6575 0008 01AD     		add	r5, sp, #4
2329:bluetooth_rxtx.c **** 	u32 calc_crc;
 6576              		.loc 1 2329 0
 6577 000a 8046     		mov	r8, r0
 6578              		.loc 1 2333 0
 6579 000c 04F12003 		add	r3, r4, #32
 6580 0010 2F46     		mov	r7, r5
 6581              	.LVL749:
 6582              	.L725:
 6583 0012 2068     		ldr	r0, [r4]	@ unaligned
 6584 0014 6168     		ldr	r1, [r4, #4]	@ unaligned
 6585 0016 2E46     		mov	r6, r5
 6586 0018 03C6     		stmia	r6!, {r0, r1}
 6587 001a 0834     		adds	r4, r4, #8
 6588 001c 9C42     		cmp	r4, r3
 6589 001e 3546     		mov	r5, r6
 6590 0020 F7D1     		bne	.L725
 6591 0022 2288     		ldrh	r2, [r4]	@ unaligned
 6592 0024 A378     		ldrb	r3, [r4, #2]	@ zero_extendqisi2
 6593 0026 3280     		strh	r2, [r6]	@ unaligned
 6594 0028 B370     		strb	r3, [r6, #2]
 6595              	.LVL750:
 6596 002a 0524     		movs	r4, #5
 6597              	.LVL751:
 6598              	.L727:
2334:bluetooth_rxtx.c **** 		// LL header
ARM GAS  /tmp/ccxsBJK4.s 			page 176


2335:bluetooth_rxtx.c **** 		0x42, 0x1e, // adv_nonconn_ind
2336:bluetooth_rxtx.c **** 
2337:bluetooth_rxtx.c **** 		// AdvA (6 bytes) + AdvData (upto 31 bytes)
2338:bluetooth_rxtx.c **** 
2339:bluetooth_rxtx.c **** 		// advertising address
2340:bluetooth_rxtx.c **** 		0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
2341:bluetooth_rxtx.c **** 
2342:bluetooth_rxtx.c **** 		// advertising flags, standards
2343:bluetooth_rxtx.c **** 		// 0x02, 0x01, 0x06, 
2344:bluetooth_rxtx.c **** 		
2345:bluetooth_rxtx.c **** 		// service advertised
2346:bluetooth_rxtx.c **** 		0x03, 0x03, 0xaa, 0xfe, //len, type, eddystone UUID
2347:bluetooth_rxtx.c **** 		
2348:bluetooth_rxtx.c **** 		// len(3 + URL frame + Eddystone URL), type, eddystone UUID
2349:bluetooth_rxtx.c **** 		0x13, 0x16, 0xaa, 0xfe, 
2350:bluetooth_rxtx.c **** 
2351:bluetooth_rxtx.c **** 		// URL frame
2352:bluetooth_rxtx.c **** 		0x10, 0x00, 0x02, // frametype (URL), tx power, URL scheme prefix (0x02: http://)
2353:bluetooth_rxtx.c **** 
2354:bluetooth_rxtx.c **** 		// Eddystone URL (available data, 0~20 bytes)
2355:bluetooth_rxtx.c **** 		0xaa, 'M', 'W', 'N', 'L', '_', '3', '0', '1', // Preamble, SSID
2356:bluetooth_rxtx.c **** 
2357:bluetooth_rxtx.c **** 		0xaa, 'm', 'w', 'n', //'l', 'w', 'l', 'a', 'n', // Preamble, PASSWD
2358:bluetooth_rxtx.c **** 
2359:bluetooth_rxtx.c **** 		// CRC (calc)
2360:bluetooth_rxtx.c **** 		0xff, 0xff, 0xff,
2361:bluetooth_rxtx.c **** 	};
2362:bluetooth_rxtx.c **** 
2363:bluetooth_rxtx.c **** 	u8 adv_ind_len = sizeof(adv_ind) - 3;
2364:bluetooth_rxtx.c **** 
2365:bluetooth_rxtx.c **** 	// copy the user-specified mac address
2366:bluetooth_rxtx.c **** 	for (i = 0; i < 6; ++i)
2367:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
 6599              		.loc 1 2367 0 discriminator 2
 6600 002c 294A     		ldr	r2, .L762+4
 6601 002e 3B1B     		subs	r3, r7, r4
 6602 0030 A25C     		ldrb	r2, [r4, r2]	@ zero_extendqisi2
2366:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
 6603              		.loc 1 2366 0 discriminator 2
 6604 0032 14F1FF34 		adds	r4, r4, #-1
 6605              	.LVL752:
 6606              		.loc 1 2367 0 discriminator 2
 6607 0036 DA71     		strb	r2, [r3, #7]
 6608              	.LVL753:
2366:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address[5-i];
 6609              		.loc 1 2366 0 discriminator 2
 6610 0038 F8D2     		bcs	.L727
2368:bluetooth_rxtx.c **** 
2369:bluetooth_rxtx.c **** 	calc_crc = btle_calc_crc(le.crc_init_reversed, adv_ind, adv_ind_len);
 6611              		.loc 1 2369 0
 6612 003a 274B     		ldr	r3, .L762+8
 6613 003c 3946     		mov	r1, r7
 6614 003e 1869     		ldr	r0, [r3, #16]
 6615 0040 2022     		movs	r2, #32
 6616 0042 FFF7FEFF 		bl	btle_calc_crc
 6617              	.LVL754:
2370:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+0] = (calc_crc >>  0) & 0xff;
ARM GAS  /tmp/ccxsBJK4.s 			page 177


2371:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+1] = (calc_crc >>  8) & 0xff;
 6618              		.loc 1 2371 0
 6619 0046 030A     		lsrs	r3, r0, #8
2370:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+0] = (calc_crc >>  0) & 0xff;
 6620              		.loc 1 2370 0
 6621 0048 8DF82400 		strb	r0, [sp, #36]
2372:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+2] = (calc_crc >> 16) & 0xff;
 6622              		.loc 1 2372 0
 6623 004c 000C     		lsrs	r0, r0, #16
 6624              	.LVL755:
2371:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+2] = (calc_crc >> 16) & 0xff;
 6625              		.loc 1 2371 0
 6626 004e 8DF82530 		strb	r3, [sp, #37]
 6627              		.loc 1 2372 0
 6628 0052 8DF82600 		strb	r0, [sp, #38]
2373:bluetooth_rxtx.c **** 
2374:bluetooth_rxtx.c **** 	clkn_start();
 6629              		.loc 1 2374 0
 6630 0056 FFF7FEFF 		bl	clkn_start
 6631              	.LVL756:
 6632              	.L728:
2375:bluetooth_rxtx.c **** 
2376:bluetooth_rxtx.c **** 	// spam advertising packets
2377:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_SLAVE_LE 
 6633              		.loc 1 2377 0 discriminator 1
 6634 005a 204C     		ldr	r4, .L762+12
 6635 005c A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 6636 005e 0C2B     		cmp	r3, #12
 6637 0060 1BD1     		bne	.L761
 6638              	.L731:
2378:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P0
2379:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P1
2380:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P2
2381:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P3
2382:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P4
2383:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P5
2384:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P6
2385:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P7) {
2386:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
 6639              		.loc 1 2386 0
 6640 0062 1F4B     		ldr	r3, .L762+16
 6641 0064 4FF08075 		mov	r5, #16777216
2387:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_DMA;
 6642              		.loc 1 2387 0
 6643 0068 4FF08064 		mov	r4, #67108864
2386:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_DMA;
 6644              		.loc 1 2386 0
 6645 006c 1D60     		str	r5, [r3]
2388:bluetooth_rxtx.c **** 		le_transmit(0x8e89bed6, adv_ind_len+3, adv_ind, tx_pwr);
 6646              		.loc 1 2388 0
 6647 006e 3A46     		mov	r2, r7
2387:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_DMA;
 6648              		.loc 1 2387 0
 6649 0070 1C60     		str	r4, [r3]
 6650              		.loc 1 2388 0
 6651 0072 1C48     		ldr	r0, .L762+20
 6652 0074 4346     		mov	r3, r8
ARM GAS  /tmp/ccxsBJK4.s 			page 178


 6653 0076 2321     		movs	r1, #35
 6654 0078 FFF7FEFF 		bl	le_transmit
 6655              	.LVL757:
2389:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 6656              		.loc 1 2389 0
 6657 007c 1A4B     		ldr	r3, .L762+24
 6658 007e 1D60     		str	r5, [r3]
2390:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_DMA;
 6659              		.loc 1 2390 0
 6660 0080 1C60     		str	r4, [r3]
 6661              	.LVL758:
 6662              	.LBB71:
 6663              	.LBB72:
 805:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
 6664              		.loc 1 805 0
 6665 0082 1A4B     		ldr	r3, .L762+28
 6666 0084 1A68     		ldr	r2, [r3]
 6667              	.LVL759:
 6668 0086 22F07F42 		bic	r2, r2, #-16777216
 6669              	.LVL760:
 806:bluetooth_rxtx.c **** 
 6670              		.loc 1 806 0
 6671 008a 02F5A072 		add	r2, r2, #320
 6672              	.LVL761:
 6673              	.L730:
 813:bluetooth_rxtx.c **** 	}
 6674              		.loc 1 813 0
 6675 008e 1968     		ldr	r1, [r3]
 6676 0090 21F07F41 		bic	r1, r1, #-16777216
 6677 0094 9142     		cmp	r1, r2
 6678 0096 FAD3     		bcc	.L730
 6679 0098 DFE7     		b	.L728
 6680              	.LVL762:
 6681              	.L761:
 6682              	.LBE72:
 6683              	.LBE71:
2378:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P1
 6684              		.loc 1 2378 0
 6685 009a A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 6686 009c 112B     		cmp	r3, #17
 6687 009e E0D0     		beq	.L731
2379:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P2
 6688              		.loc 1 2379 0
 6689 00a0 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 6690 00a2 122B     		cmp	r3, #18
 6691 00a4 DDD0     		beq	.L731
2380:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P3
 6692              		.loc 1 2380 0
 6693 00a6 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 6694 00a8 132B     		cmp	r3, #19
 6695 00aa DAD0     		beq	.L731
2381:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P4
 6696              		.loc 1 2381 0
 6697 00ac A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 6698 00ae 142B     		cmp	r3, #20
 6699 00b0 D7D0     		beq	.L731
2382:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P5
ARM GAS  /tmp/ccxsBJK4.s 			page 179


 6700              		.loc 1 2382 0
 6701 00b2 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 6702 00b4 152B     		cmp	r3, #21
 6703 00b6 D4D0     		beq	.L731
2383:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P6
 6704              		.loc 1 2383 0
 6705 00b8 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 6706 00ba 162B     		cmp	r3, #22
 6707 00bc D1D0     		beq	.L731
2384:bluetooth_rxtx.c **** 			|| requested_mode == MODE_BT_SLAVE_LE_P7) {
 6708              		.loc 1 2384 0
 6709 00be A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 6710 00c0 172B     		cmp	r3, #23
 6711 00c2 CED0     		beq	.L731
2385:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
 6712              		.loc 1 2385 0
 6713 00c4 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 6714 00c6 182B     		cmp	r3, #24
 6715 00c8 CBD0     		beq	.L731
2391:bluetooth_rxtx.c **** 		msleep(100);
2392:bluetooth_rxtx.c **** 	}
2393:bluetooth_rxtx.c **** }
 6716              		.loc 1 2393 0
 6717 00ca 0AB0     		add	sp, sp, #40
 6718              		@ sp needed
 6719 00cc BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 6720              	.L763:
 6721              		.align	2
 6722              	.L762:
 6723 00d0 A8080000 		.word	.LANCHOR2+2216
 6724 00d4 20000000 		.word	.LANCHOR0+32
 6725 00d8 00000000 		.word	.LANCHOR1
 6726 00dc 00000000 		.word	.LANCHOR0
 6727 00e0 80E100E0 		.word	-536813184
 6728 00e4 D6BE898E 		.word	-1903575338
 6729 00e8 00E100E0 		.word	-536813312
 6730 00ec 00000000 		.word	clkn
 6731              		.cfi_endproc
 6732              	.LFE33:
 6734              		.section	.text.rx_generic_sync,"ax",%progbits
 6735              		.align	1
 6736              		.global	rx_generic_sync
 6737              		.thumb
 6738              		.thumb_func
 6740              	rx_generic_sync:
 6741              	.LFB34:
2394:bluetooth_rxtx.c **** 
2395:bluetooth_rxtx.c **** void rx_generic_sync(void) {
 6742              		.loc 1 2395 0
 6743              		.cfi_startproc
 6744              		@ args = 0, pretend = 0, frame = 40
 6745              		@ frame_needed = 0, uses_anonymous_args = 0
 6746 0000 00B5     		push	{lr}
 6747              		.cfi_def_cfa_offset 4
 6748              		.cfi_offset 14, -4
 6749 0002 8BB0     		sub	sp, sp, #44
 6750              		.cfi_def_cfa_offset 48
ARM GAS  /tmp/ccxsBJK4.s 			page 180


 6751              	.LVL763:
2396:bluetooth_rxtx.c **** 	u8 len = 32;
2397:bluetooth_rxtx.c **** 	u8 buf[len+4];
2398:bluetooth_rxtx.c **** 	u16 reg_val;
2399:bluetooth_rxtx.c **** 
2400:bluetooth_rxtx.c **** 	/* Put syncword at start of buffer
2401:bluetooth_rxtx.c **** 	 * DGS: fix this later, we don't know number of syncword bytes, etc
2402:bluetooth_rxtx.c **** 	 */
2403:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCH);
 6752              		.loc 1 2403 0
 6753 0004 2D20     		movs	r0, #45
 6754 0006 FFF7FEFF 		bl	cc2400_get
 6755              	.LVL764:
2404:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
 6756              		.loc 1 2404 0
 6757 000a 030A     		lsrs	r3, r0, #8
2405:bluetooth_rxtx.c **** 	buf[1] = reg_val & 0xFF;
 6758              		.loc 1 2405 0
 6759 000c 8DF80500 		strb	r0, [sp, #5]
2406:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCL);
 6760              		.loc 1 2406 0
 6761 0010 2C20     		movs	r0, #44
 6762              	.LVL765:
2404:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
 6763              		.loc 1 2404 0
 6764 0012 8DF80430 		strb	r3, [sp, #4]
 6765              		.loc 1 2406 0
 6766 0016 FFF7FEFF 		bl	cc2400_get
 6767              	.LVL766:
2407:bluetooth_rxtx.c **** 	buf[2] = (reg_val >> 8) & 0xFF;
 6768              		.loc 1 2407 0
 6769 001a 030A     		lsrs	r3, r0, #8
 6770 001c 8DF80630 		strb	r3, [sp, #6]
2408:bluetooth_rxtx.c **** 	buf[3] = reg_val & 0xFF;
 6771              		.loc 1 2408 0
 6772 0020 8DF80700 		strb	r0, [sp, #7]
2409:bluetooth_rxtx.c **** 
2410:bluetooth_rxtx.c **** 	queue_init();
 6773              		.loc 1 2410 0
 6774 0024 FFF7FEFF 		bl	queue_init
 6775              	.LVL767:
2411:bluetooth_rxtx.c **** 	clkn_start();
 6776              		.loc 1 2411 0
 6777 0028 FFF7FEFF 		bl	clkn_start
 6778              	.LVL768:
 6779              	.L766:
2412:bluetooth_rxtx.c **** 
2413:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 6780              		.loc 1 2413 0 discriminator 1
 6781 002c FFF7FEFF 		bl	cc2400_status
 6782              	.LVL769:
 6783 0030 4306     		lsls	r3, r0, #25
 6784 0032 FBD5     		bpl	.L766
2414:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 6785              		.loc 1 2414 0
 6786 0034 6120     		movs	r0, #97
 6787 0036 FFF7FEFF 		bl	cc2400_strobe
ARM GAS  /tmp/ccxsBJK4.s 			page 181


 6788              	.LVL770:
 6789              	.L768:
2415:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 6790              		.loc 1 2415 0 discriminator 1
 6791 003a FFF7FEFF 		bl	cc2400_status
 6792              	.LVL771:
 6793 003e 4007     		lsls	r0, r0, #29
 6794 0040 FBD5     		bpl	.L768
2416:bluetooth_rxtx.c **** 	RXLED_SET;
 6795              		.loc 1 2416 0
 6796 0042 144B     		ldr	r3, .L774
 6797 0044 1022     		movs	r2, #16
 6798 0046 1A60     		str	r2, [r3]
2417:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2418:bluetooth_rxtx.c **** 		PAEN_SET;
 6799              		.loc 1 2418 0
 6800 0048 8022     		movs	r2, #128
 6801 004a 1A62     		str	r2, [r3, #32]
2419:bluetooth_rxtx.c **** 		HGM_SET;
 6802              		.loc 1 2419 0
 6803 004c 4FF48072 		mov	r2, #256
 6804 0050 1A62     		str	r2, [r3, #32]
 6805              	.L770:
2420:bluetooth_rxtx.c **** #endif
2421:bluetooth_rxtx.c **** 	while (1) {
2422:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 6806              		.loc 1 2422 0 discriminator 1
 6807 0052 0E20     		movs	r0, #14
 6808 0054 FFF7FEFF 		bl	cc2400_get
 6809              	.LVL772:
 6810 0058 00F01F00 		and	r0, r0, #31
 6811 005c 0F28     		cmp	r0, #15
 6812 005e F8D1     		bne	.L770
2423:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 6813              		.loc 1 2423 0
 6814 0060 6220     		movs	r0, #98
 6815 0062 FFF7FEFF 		bl	cc2400_strobe
 6816              	.LVL773:
2424:bluetooth_rxtx.c **** 		USRLED_CLR;
 6817              		.loc 1 2424 0
 6818 0066 0C4B     		ldr	r3, .L774+4
 6819 0068 0222     		movs	r2, #2
 6820 006a 1A60     		str	r2, [r3]
 6821              	.L772:
2425:bluetooth_rxtx.c **** 		while (!(cc2400_status() & SYNC_RECEIVED));
 6822              		.loc 1 2425 0 discriminator 1
 6823 006c FFF7FEFF 		bl	cc2400_status
 6824              	.LVL774:
 6825 0070 C106     		lsls	r1, r0, #27
 6826 0072 FBD5     		bpl	.L772
2426:bluetooth_rxtx.c **** 		USRLED_SET;
 6827              		.loc 1 2426 0
 6828 0074 074B     		ldr	r3, .L774
 6829 0076 0222     		movs	r2, #2
 6830 0078 1A60     		str	r2, [r3]
2427:bluetooth_rxtx.c **** 
2428:bluetooth_rxtx.c **** 		cc2400_fifo_read(len, buf+4);
ARM GAS  /tmp/ccxsBJK4.s 			page 182


 6831              		.loc 1 2428 0
 6832 007a 02A9     		add	r1, sp, #8
 6833 007c 2020     		movs	r0, #32
 6834 007e FFF7FEFF 		bl	cc2400_fifo_read
 6835              	.LVL775:
2429:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, buf);
 6836              		.loc 1 2429 0
 6837 0082 01A9     		add	r1, sp, #4
 6838              	.LVL776:
 6839 0084 0020     		movs	r0, #0
 6840 0086 FFF7FEFF 		bl	enqueue
 6841              	.LVL777:
2430:bluetooth_rxtx.c **** 		handle_usb(clkn);
 6842              		.loc 1 2430 0
 6843 008a 044B     		ldr	r3, .L774+8
 6844 008c 1868     		ldr	r0, [r3]
 6845 008e FFF7FEFF 		bl	handle_usb
 6846              	.LVL778:
2431:bluetooth_rxtx.c **** 	}
 6847              		.loc 1 2431 0
 6848 0092 DEE7     		b	.L770
 6849              	.L775:
 6850              		.align	2
 6851              	.L774:
 6852 0094 38C00920 		.word	537509944
 6853 0098 3CC00920 		.word	537509948
 6854 009c 00000000 		.word	clkn
 6855              		.cfi_endproc
 6856              	.LFE34:
 6858              		.section	.text.rx_generic,"ax",%progbits
 6859              		.align	1
 6860              		.global	rx_generic
 6861              		.thumb
 6862              		.thumb_func
 6864              	rx_generic:
 6865              	.LFB35:
2432:bluetooth_rxtx.c **** }
2433:bluetooth_rxtx.c **** 
2434:bluetooth_rxtx.c **** void rx_generic(void) {
 6866              		.loc 1 2434 0
 6867              		.cfi_startproc
 6868              		@ args = 0, pretend = 0, frame = 0
 6869              		@ frame_needed = 0, uses_anonymous_args = 0
 6870 0000 08B5     		push	{r3, lr}
 6871              		.cfi_def_cfa_offset 8
 6872              		.cfi_offset 3, -8
 6873              		.cfi_offset 14, -4
2435:bluetooth_rxtx.c **** 	// Check for packet mode
2436:bluetooth_rxtx.c **** 	if(cc2400_get(GRMDM) && 0x0400) {
 6874              		.loc 1 2436 0
 6875 0002 2020     		movs	r0, #32
 6876 0004 FFF7FEFF 		bl	cc2400_get
 6877              	.LVL779:
 6878 0008 08B1     		cbz	r0, .L777
2437:bluetooth_rxtx.c **** 		rx_generic_sync();
 6879              		.loc 1 2437 0
 6880 000a FFF7FEFF 		bl	rx_generic_sync
ARM GAS  /tmp/ccxsBJK4.s 			page 183


 6881              	.LVL780:
 6882              	.L777:
2438:bluetooth_rxtx.c **** 	} else {
2439:bluetooth_rxtx.c **** 		modulation = MOD_NONE;
 6883              		.loc 1 2439 0
 6884 000e 034B     		ldr	r3, .L778
 6885 0010 0322     		movs	r2, #3
 6886 0012 1A70     		strb	r2, [r3]
2440:bluetooth_rxtx.c **** 		bt_stream_rx();
2441:bluetooth_rxtx.c **** 	}
2442:bluetooth_rxtx.c **** }
 6887              		.loc 1 2442 0
 6888 0014 BDE80840 		pop	{r3, lr}
2440:bluetooth_rxtx.c **** 		bt_stream_rx();
 6889              		.loc 1 2440 0
 6890 0018 FFF7FEBF 		b	bt_stream_rx
 6891              	.LVL781:
 6892              	.L779:
 6893              		.align	2
 6894              	.L778:
 6895 001c 00000000 		.word	.LANCHOR0
 6896              		.cfi_endproc
 6897              	.LFE35:
 6899              		.section	.text.tx_generic,"ax",%progbits
 6900              		.align	1
 6901              		.global	tx_generic
 6902              		.thumb
 6903              		.thumb_func
 6905              	tx_generic:
 6906              	.LFB36:
2443:bluetooth_rxtx.c **** 
2444:bluetooth_rxtx.c **** void tx_generic(void) {
 6907              		.loc 1 2444 0
 6908              		.cfi_startproc
 6909              		@ args = 0, pretend = 0, frame = 0
 6910              		@ frame_needed = 0, uses_anonymous_args = 0
 6911 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 6912              		.cfi_def_cfa_offset 24
 6913              		.cfi_offset 4, -24
 6914              		.cfi_offset 5, -20
 6915              		.cfi_offset 6, -16
 6916              		.cfi_offset 7, -12
 6917              		.cfi_offset 8, -8
 6918              		.cfi_offset 14, -4
2445:bluetooth_rxtx.c **** 	u16 synch, syncl;
2446:bluetooth_rxtx.c **** 	u8 prev_mode = mode;
 6919              		.loc 1 2446 0
 6920 0004 354D     		ldr	r5, .L791
2447:bluetooth_rxtx.c **** 
2448:bluetooth_rxtx.c **** 	mode = MODE_TX_GENERIC;
 6921              		.loc 1 2448 0
 6922 0006 1023     		movs	r3, #16
2449:bluetooth_rxtx.c **** 
2450:bluetooth_rxtx.c **** 	// Save existing syncword
2451:bluetooth_rxtx.c **** 	synch = cc2400_get(SYNCH);
 6923              		.loc 1 2451 0
 6924 0008 2D20     		movs	r0, #45
ARM GAS  /tmp/ccxsBJK4.s 			page 184


2446:bluetooth_rxtx.c **** 
 6925              		.loc 1 2446 0
 6926 000a 6E7C     		ldrb	r6, [r5, #17]	@ zero_extendqisi2
2448:bluetooth_rxtx.c **** 
 6927              		.loc 1 2448 0
 6928 000c 6B74     		strb	r3, [r5, #17]
 6929              		.loc 1 2451 0
 6930 000e FFF7FEFF 		bl	cc2400_get
 6931              	.LVL782:
 6932 0012 8046     		mov	r8, r0
2452:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 6933              		.loc 1 2452 0
 6934 0014 2C20     		movs	r0, #44
 6935 0016 FFF7FEFF 		bl	cc2400_get
 6936              	.LVL783:
2453:bluetooth_rxtx.c **** 
2454:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, tx_pkt.synch);
 6937              		.loc 1 2454 0
 6938 001a 314C     		ldr	r4, .L791+4
2452:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 6939              		.loc 1 2452 0
 6940 001c 0746     		mov	r7, r0
 6941              		.loc 1 2454 0
 6942 001e 2188     		ldrh	r1, [r4]
 6943 0020 2D20     		movs	r0, #45
 6944 0022 FFF7FEFF 		bl	cc2400_set
 6945              	.LVL784:
2455:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, tx_pkt.syncl);
 6946              		.loc 1 2455 0
 6947 0026 2C20     		movs	r0, #44
 6948 0028 6188     		ldrh	r1, [r4, #2]
 6949 002a FFF7FEFF 		bl	cc2400_set
 6950              	.LVL785:
2456:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0057);
 6951              		.loc 1 2456 0
 6952 002e 0320     		movs	r0, #3
 6953 0030 5721     		movs	r1, #87
 6954 0032 FFF7FEFF 		bl	cc2400_set
 6955              	.LVL786:
2457:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);
 6956              		.loc 1 2457 0
 6957 0036 1420     		movs	r0, #20
 6958 0038 41F24B31 		movw	r1, #4939
 6959 003c FFF7FEFF 		bl	cc2400_set
 6960              	.LVL787:
2458:bluetooth_rxtx.c **** 	cc2400_set(GRMDM, 0x0f61);
 6961              		.loc 1 2458 0
 6962 0040 2020     		movs	r0, #32
 6963 0042 40F66171 		movw	r1, #3937
 6964 0046 FFF7FEFF 		bl	cc2400_set
 6965              	.LVL788:
2459:bluetooth_rxtx.c **** 	cc2400_set(FSDIV, tx_pkt.channel);
 6966              		.loc 1 2459 0
 6967 004a 0220     		movs	r0, #2
 6968 004c A188     		ldrh	r1, [r4, #4]
 6969 004e FFF7FEFF 		bl	cc2400_set
 6970              	.LVL789:
ARM GAS  /tmp/ccxsBJK4.s 			page 185


2460:bluetooth_rxtx.c **** 	cc2400_set(FREND, tx_pkt.pa_level);
 6971              		.loc 1 2460 0
 6972 0052 0520     		movs	r0, #5
 6973 0054 E179     		ldrb	r1, [r4, #7]	@ zero_extendqisi2
2446:bluetooth_rxtx.c **** 
 6974              		.loc 1 2446 0
 6975 0056 F6B2     		uxtb	r6, r6
 6976              	.LVL790:
 6977              		.loc 1 2460 0
 6978 0058 FFF7FEFF 		bl	cc2400_set
 6979              	.LVL791:
 6980              	.L782:
2461:bluetooth_rxtx.c **** 
2462:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 6981              		.loc 1 2462 0 discriminator 1
 6982 005c FFF7FEFF 		bl	cc2400_status
 6983              	.LVL792:
 6984 0060 4006     		lsls	r0, r0, #25
 6985 0062 FBD5     		bpl	.L782
2463:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 6986              		.loc 1 2463 0
 6987 0064 6120     		movs	r0, #97
 6988 0066 FFF7FEFF 		bl	cc2400_strobe
 6989              	.LVL793:
 6990              	.L784:
2464:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 6991              		.loc 1 2464 0 discriminator 1
 6992 006a FFF7FEFF 		bl	cc2400_status
 6993              	.LVL794:
 6994 006e 4107     		lsls	r1, r0, #29
 6995 0070 FBD5     		bpl	.L784
2465:bluetooth_rxtx.c **** 	TXLED_SET;
 6996              		.loc 1 2465 0
 6997 0072 1C4B     		ldr	r3, .L791+8
 6998 0074 4FF48072 		mov	r2, #256
 6999 0078 1A60     		str	r2, [r3]
2466:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2467:bluetooth_rxtx.c **** 		PAEN_SET;
 7000              		.loc 1 2467 0
 7001 007a 8022     		movs	r2, #128
 7002 007c 1A62     		str	r2, [r3, #32]
 7003              	.L786:
2468:bluetooth_rxtx.c **** #endif
2469:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 7004              		.loc 1 2469 0 discriminator 1
 7005 007e 0E20     		movs	r0, #14
 7006 0080 FFF7FEFF 		bl	cc2400_get
 7007              	.LVL795:
 7008 0084 00F01F00 		and	r0, r0, #31
 7009 0088 0F28     		cmp	r0, #15
 7010 008a F8D1     		bne	.L786
2470:bluetooth_rxtx.c **** 
2471:bluetooth_rxtx.c **** 	cc2400_fifo_write(tx_pkt.length, tx_pkt.data);
 7011              		.loc 1 2471 0
 7012 008c A079     		ldrb	r0, [r4, #6]	@ zero_extendqisi2
 7013 008e 1649     		ldr	r1, .L791+12
 7014 0090 FFF7FEFF 		bl	cc2400_fifo_write
ARM GAS  /tmp/ccxsBJK4.s 			page 186


 7015              	.LVL796:
2472:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 7016              		.loc 1 2472 0
 7017 0094 6320     		movs	r0, #99
 7018 0096 FFF7FEFF 		bl	cc2400_strobe
 7019              	.LVL797:
 7020              	.L788:
2473:bluetooth_rxtx.c **** 
2474:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 7021              		.loc 1 2474 0 discriminator 1
 7022 009a 0E20     		movs	r0, #14
 7023 009c FFF7FEFF 		bl	cc2400_get
 7024              	.LVL798:
 7025 00a0 00F01F00 		and	r0, r0, #31
 7026 00a4 0F28     		cmp	r0, #15
 7027 00a6 F8D1     		bne	.L788
2475:bluetooth_rxtx.c **** 	TXLED_CLR;
 7028              		.loc 1 2475 0
 7029 00a8 104B     		ldr	r3, .L791+16
 7030 00aa 4FF48072 		mov	r2, #256
 7031 00ae 1A60     		str	r2, [r3]
2476:bluetooth_rxtx.c **** 
2477:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 7032              		.loc 1 2477 0
 7033 00b0 6420     		movs	r0, #100
 7034 00b2 FFF7FEFF 		bl	cc2400_strobe
 7035              	.LVL799:
 7036              	.L790:
2478:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 7037              		.loc 1 2478 0 discriminator 1
 7038 00b6 FFF7FEFF 		bl	cc2400_status
 7039              	.LVL800:
 7040 00ba 4207     		lsls	r2, r0, #29
 7041 00bc FBD4     		bmi	.L790
2479:bluetooth_rxtx.c **** 
2480:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2481:bluetooth_rxtx.c **** 	PAEN_CLR;
 7042              		.loc 1 2481 0
 7043 00be 0C4B     		ldr	r3, .L791+20
 7044 00c0 8022     		movs	r2, #128
 7045 00c2 1A60     		str	r2, [r3]
2482:bluetooth_rxtx.c **** #endif
2483:bluetooth_rxtx.c **** 
2484:bluetooth_rxtx.c **** 	// Restore state
2485:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, synch);
 7046              		.loc 1 2485 0
 7047 00c4 2D20     		movs	r0, #45
 7048 00c6 4146     		mov	r1, r8
 7049 00c8 FFF7FEFF 		bl	cc2400_set
 7050              	.LVL801:
2486:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, syncl);
 7051              		.loc 1 2486 0
 7052 00cc 2C20     		movs	r0, #44
 7053 00ce 3946     		mov	r1, r7
 7054 00d0 FFF7FEFF 		bl	cc2400_set
 7055              	.LVL802:
2487:bluetooth_rxtx.c **** 	requested_mode = prev_mode;
ARM GAS  /tmp/ccxsBJK4.s 			page 187


 7056              		.loc 1 2487 0
 7057 00d4 AE74     		strb	r6, [r5, #18]
 7058 00d6 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 7059              	.LVL803:
 7060              	.L792:
 7061 00da 00BF     		.align	2
 7062              	.L791:
 7063 00dc 00000000 		.word	.LANCHOR0
 7064 00e0 00000000 		.word	tx_pkt
 7065 00e4 38C00920 		.word	537509944
 7066 00e8 08000000 		.word	tx_pkt+8
 7067 00ec 3CC00920 		.word	537509948
 7068 00f0 5CC00920 		.word	537509980
 7069              		.cfi_endproc
 7070              	.LFE36:
 7072              		.section	.text.specan,"ax",%progbits
 7073              		.align	1
 7074              		.global	specan
 7075              		.thumb
 7076              		.thumb_func
 7078              	specan:
 7079              	.LFB37:
2488:bluetooth_rxtx.c **** }
2489:bluetooth_rxtx.c **** 
2490:bluetooth_rxtx.c **** /* spectrum analysis */
2491:bluetooth_rxtx.c **** void specan()
2492:bluetooth_rxtx.c **** {
 7080              		.loc 1 2492 0
 7081              		.cfi_startproc
 7082              		@ args = 0, pretend = 0, frame = 56
 7083              		@ frame_needed = 0, uses_anonymous_args = 0
 7084 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 7085              		.cfi_def_cfa_offset 24
 7086              		.cfi_offset 4, -24
 7087              		.cfi_offset 5, -20
 7088              		.cfi_offset 6, -16
 7089              		.cfi_offset 7, -12
 7090              		.cfi_offset 8, -8
 7091              		.cfi_offset 14, -4
 7092 0004 8EB0     		sub	sp, sp, #56
 7093              		.cfi_def_cfa_offset 80
 7094              	.LVL804:
2493:bluetooth_rxtx.c **** 	u16 f;
2494:bluetooth_rxtx.c **** 	u8 i = 0;
2495:bluetooth_rxtx.c **** 	u8 buf[DMA_SIZE];
2496:bluetooth_rxtx.c **** 
2497:bluetooth_rxtx.c **** 	RXLED_SET;
 7095              		.loc 1 2497 0
 7096 0006 3D4B     		ldr	r3, .L810
 7097 0008 1022     		movs	r2, #16
 7098 000a 1A60     		str	r2, [r3]
2498:bluetooth_rxtx.c **** 
2499:bluetooth_rxtx.c **** 	queue_init();
 7099              		.loc 1 2499 0
 7100 000c FFF7FEFF 		bl	queue_init
 7101              	.LVL805:
2500:bluetooth_rxtx.c **** 	clkn_start();
ARM GAS  /tmp/ccxsBJK4.s 			page 188


 7102              		.loc 1 2500 0
 7103 0010 FFF7FEFF 		bl	clkn_start
 7104              	.LVL806:
2501:bluetooth_rxtx.c **** 
2502:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2503:bluetooth_rxtx.c **** 	PAEN_SET;
 7105              		.loc 1 2503 0
 7106 0014 3A4B     		ldr	r3, .L810+4
 7107 0016 8022     		movs	r2, #128
 7108 0018 1A60     		str	r2, [r3]
2504:bluetooth_rxtx.c **** 	//HGM_SET;
2505:bluetooth_rxtx.c **** #endif
2506:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 7109              		.loc 1 2506 0
 7110 001a 1220     		movs	r0, #18
 7111 001c 42F62231 		movw	r1, #11042
 7112 0020 FFF7FEFF 		bl	cc2400_set
 7113              	.LVL807:
2507:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 7114              		.loc 1 2507 0
 7115 0024 1420     		movs	r0, #20
 7116 0026 41F24B31 		movw	r1, #4939
 7117 002a FFF7FEFF 		bl	cc2400_set
 7118              	.LVL808:
2508:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 7119              		.loc 1 2508 0
 7120 002e 2020     		movs	r0, #32
 7121 0030 40F20111 		movw	r1, #257
 7122 0034 FFF7FEFF 		bl	cc2400_set
 7123              	.LVL809:
2509:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 7124              		.loc 1 2509 0
 7125 0038 0320     		movs	r0, #3
 7126 003a 2921     		movs	r1, #41
 7127 003c FFF7FEFF 		bl	cc2400_set
 7128              	.LVL810:
 7129              	.L795:
2510:bluetooth_rxtx.c **** 	//FIXME maybe set RSSI.RSSI_FILT
2511:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 7130              		.loc 1 2511 0 discriminator 1
 7131 0040 FFF7FEFF 		bl	cc2400_status
 7132              	.LVL811:
 7133 0044 4306     		lsls	r3, r0, #25
 7134 0046 FBD5     		bpl	.L795
 7135              	.L797:
2512:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 7136              		.loc 1 2512 0
 7137 0048 FFF7FEFF 		bl	cc2400_status
 7138              	.LVL812:
 7139 004c 00F00400 		and	r0, r0, #4
 7140 0050 00F0FF05 		and	r5, r0, #255
 7141 0054 0028     		cmp	r0, #0
 7142 0056 F7D1     		bne	.L797
 7143              	.LVL813:
 7144              	.L798:
2513:bluetooth_rxtx.c **** 
2514:bluetooth_rxtx.c **** 	while (requested_mode == MODE_SPECAN) {
ARM GAS  /tmp/ccxsBJK4.s 			page 189


 7145              		.loc 1 2514 0 discriminator 1
 7146 0058 2A4B     		ldr	r3, .L810+8
 7147 005a 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 7148 005c 042B     		cmp	r3, #4
 7149 005e 47D1     		bne	.L809
2515:bluetooth_rxtx.c **** 		for (f = low_freq; f < high_freq + 1; f++) {
 7150              		.loc 1 2515 0
 7151 0060 294B     		ldr	r3, .L810+12
 7152 0062 B3F84C40 		ldrh	r4, [r3, #76]
 7153 0066 9846     		mov	r8, r3
 7154 0068 A4B2     		uxth	r4, r4
 7155              	.LVL814:
 7156              	.L799:
 7157              		.loc 1 2515 0 is_stmt 0 discriminator 1
 7158 006a B8F84E30 		ldrh	r3, [r8, #78]
 7159 006e 9BB2     		uxth	r3, r3
 7160 0070 A342     		cmp	r3, r4
 7161 0072 F1DB     		blt	.L798
 7162 0074 611E     		subs	r1, r4, #1
 7163              	.LBB73:
2516:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 7164              		.loc 1 2516 0 is_stmt 1
 7165 0076 0220     		movs	r0, #2
 7166 0078 89B2     		uxth	r1, r1
 7167 007a FFF7FEFF 		bl	cc2400_set
 7168              	.LVL815:
2517:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 7169              		.loc 1 2517 0
 7170 007e 6120     		movs	r0, #97
 7171 0080 FFF7FEFF 		bl	cc2400_strobe
 7172              	.LVL816:
 7173              	.L801:
2518:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 7174              		.loc 1 2518 0 discriminator 1
 7175 0084 FFF7FEFF 		bl	cc2400_status
 7176              	.LVL817:
 7177 0088 4707     		lsls	r7, r0, #29
 7178 008a FBD5     		bpl	.L801
2519:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 7179              		.loc 1 2519 0
 7180 008c 6220     		movs	r0, #98
 7181 008e FFF7FEFF 		bl	cc2400_strobe
 7182              	.LVL818:
2520:bluetooth_rxtx.c **** 
2521:bluetooth_rxtx.c **** 			/* give the CC2400 time to acquire RSSI reading */
2522:bluetooth_rxtx.c **** 			volatile u32 j = 500; while (--j); //FIXME crude delay
 7183              		.loc 1 2522 0
 7184 0092 4FF4FA73 		mov	r3, #500
 7185 0096 0093     		str	r3, [sp]
 7186              	.L803:
 7187              		.loc 1 2522 0 is_stmt 0 discriminator 1
 7188 0098 009E     		ldr	r6, [sp]
 7189 009a 013E     		subs	r6, r6, #1
 7190 009c 0096     		str	r6, [sp]
 7191 009e 002E     		cmp	r6, #0
 7192 00a0 FAD1     		bne	.L803
2523:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
ARM GAS  /tmp/ccxsBJK4.s 			page 190


 7193              		.loc 1 2523 0 is_stmt 1
 7194 00a2 0EAB     		add	r3, sp, #56
 7195 00a4 0327     		movs	r7, #3
 7196 00a6 07FB0537 		mla	r7, r7, r5, r3
2524:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
2525:bluetooth_rxtx.c **** 			buf[(3 * i) + 2] = cc2400_get(RSSI) >> 8;
 7197              		.loc 1 2525 0
 7198 00aa 0620     		movs	r0, #6
2523:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 7199              		.loc 1 2523 0
 7200 00ac 230A     		lsrs	r3, r4, #8
 7201 00ae 07F8343C 		strb	r3, [r7, #-52]
2524:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
 7202              		.loc 1 2524 0
 7203 00b2 07F8334C 		strb	r4, [r7, #-51]
 7204              		.loc 1 2525 0
 7205 00b6 FFF7FEFF 		bl	cc2400_get
 7206              	.LVL819:
2526:bluetooth_rxtx.c **** 			i++;
 7207              		.loc 1 2526 0
 7208 00ba 0135     		adds	r5, r5, #1
 7209              	.LVL820:
 7210 00bc EDB2     		uxtb	r5, r5
 7211              	.LVL821:
2525:bluetooth_rxtx.c **** 			i++;
 7212              		.loc 1 2525 0
 7213 00be 000A     		lsrs	r0, r0, #8
2527:bluetooth_rxtx.c **** 			if (i == 16) {
 7214              		.loc 1 2527 0
 7215 00c0 102D     		cmp	r5, #16
2525:bluetooth_rxtx.c **** 			i++;
 7216              		.loc 1 2525 0
 7217 00c2 07F8320C 		strb	r0, [r7, #-50]
 7218              		.loc 1 2527 0
 7219 00c6 09D1     		bne	.L804
2528:bluetooth_rxtx.c **** 				enqueue(SPECAN, buf);
 7220              		.loc 1 2528 0
 7221 00c8 0420     		movs	r0, #4
 7222 00ca 0DEB0001 		add	r1, sp, r0
 7223 00ce FFF7FEFF 		bl	enqueue
 7224              	.LVL822:
2529:bluetooth_rxtx.c **** 				i = 0;
2530:bluetooth_rxtx.c **** 
2531:bluetooth_rxtx.c **** 				handle_usb(clkn);
 7225              		.loc 1 2531 0
 7226 00d2 0E4B     		ldr	r3, .L810+16
2529:bluetooth_rxtx.c **** 				i = 0;
 7227              		.loc 1 2529 0
 7228 00d4 3546     		mov	r5, r6
 7229              		.loc 1 2531 0
 7230 00d6 1868     		ldr	r0, [r3]
 7231 00d8 FFF7FEFF 		bl	handle_usb
 7232              	.LVL823:
 7233              	.L804:
2532:bluetooth_rxtx.c **** 			}
2533:bluetooth_rxtx.c **** 
2534:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
ARM GAS  /tmp/ccxsBJK4.s 			page 191


 7234              		.loc 1 2534 0
 7235 00dc 6420     		movs	r0, #100
 7236 00de FFF7FEFF 		bl	cc2400_strobe
 7237              	.LVL824:
 7238              	.L806:
2535:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 7239              		.loc 1 2535 0 discriminator 1
 7240 00e2 FFF7FEFF 		bl	cc2400_status
 7241              	.LVL825:
 7242 00e6 4607     		lsls	r6, r0, #29
 7243 00e8 FBD4     		bmi	.L806
 7244              	.LBE73:
2515:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 7245              		.loc 1 2515 0
 7246 00ea 0134     		adds	r4, r4, #1
 7247              	.LVL826:
 7248 00ec A4B2     		uxth	r4, r4
 7249              	.LVL827:
 7250 00ee BCE7     		b	.L799
 7251              	.LVL828:
 7252              	.L809:
2536:bluetooth_rxtx.c **** 		}
2537:bluetooth_rxtx.c **** 	}
2538:bluetooth_rxtx.c **** 	RXLED_CLR;
 7253              		.loc 1 2538 0
 7254 00f0 074B     		ldr	r3, .L810+20
 7255 00f2 1022     		movs	r2, #16
 7256 00f4 1A60     		str	r2, [r3]
2539:bluetooth_rxtx.c **** }
 7257              		.loc 1 2539 0
 7258 00f6 0EB0     		add	sp, sp, #56
 7259              		@ sp needed
 7260 00f8 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 7261              	.LVL829:
 7262              	.L811:
 7263              		.align	2
 7264              	.L810:
 7265 00fc 38C00920 		.word	537509944
 7266 0100 58C00920 		.word	537509976
 7267 0104 00000000 		.word	.LANCHOR0
 7268 0108 00000000 		.word	.LANCHOR1
 7269 010c 00000000 		.word	clkn
 7270 0110 3CC00920 		.word	537509948
 7271              		.cfi_endproc
 7272              	.LFE37:
 7274              		.section	.text.led_specan,"ax",%progbits
 7275              		.align	1
 7276              		.global	led_specan
 7277              		.thumb
 7278              		.thumb_func
 7280              	led_specan:
 7281              	.LFB38:
2540:bluetooth_rxtx.c **** 
2541:bluetooth_rxtx.c **** /* LED based spectrum analysis */
2542:bluetooth_rxtx.c **** void led_specan()
2543:bluetooth_rxtx.c **** {
 7282              		.loc 1 2543 0
ARM GAS  /tmp/ccxsBJK4.s 			page 192


 7283              		.cfi_startproc
 7284              		@ args = 0, pretend = 0, frame = 16
 7285              		@ frame_needed = 0, uses_anonymous_args = 0
 7286 0000 1FB5     		push	{r0, r1, r2, r3, r4, lr}
 7287              		.cfi_def_cfa_offset 24
 7288              		.cfi_offset 0, -24
 7289              		.cfi_offset 1, -20
 7290              		.cfi_offset 2, -16
 7291              		.cfi_offset 3, -12
 7292              		.cfi_offset 4, -8
 7293              		.cfi_offset 14, -4
 7294              	.LVL830:
2544:bluetooth_rxtx.c **** 	int8_t lvl;
2545:bluetooth_rxtx.c **** 	u8 i = 0;
2546:bluetooth_rxtx.c **** 	u16 channels[3] = {2412, 2437, 2462};
 7295              		.loc 1 2546 0
 7296 0002 444B     		ldr	r3, .L839
2547:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
2548:bluetooth_rxtx.c **** 	//void (*clr[3]) = {TXLED_CLR, RXLED_CLR, USRLED_CLR};
2549:bluetooth_rxtx.c **** 
2550:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2551:bluetooth_rxtx.c **** 	PAEN_SET;
 7297              		.loc 1 2551 0
 7298 0004 8022     		movs	r2, #128
2546:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
 7299              		.loc 1 2546 0
 7300 0006 1868     		ldr	r0, [r3]	@ unaligned
 7301 0008 9B88     		ldrh	r3, [r3, #4]	@ unaligned
 7302 000a 0290     		str	r0, [sp, #8]	@ unaligned
 7303 000c ADF80C30 		strh	r3, [sp, #12]	@ unaligned
 7304              		.loc 1 2551 0
 7305 0010 414B     		ldr	r3, .L839+4
2552:bluetooth_rxtx.c **** 	//HGM_SET;
2553:bluetooth_rxtx.c **** #endif
2554:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 7306              		.loc 1 2554 0
 7307 0012 1220     		movs	r0, #18
2551:bluetooth_rxtx.c **** 	//HGM_SET;
 7308              		.loc 1 2551 0
 7309 0014 1A60     		str	r2, [r3]
 7310              		.loc 1 2554 0
 7311 0016 42F62231 		movw	r1, #11042
 7312 001a FFF7FEFF 		bl	cc2400_set
 7313              	.LVL831:
2555:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 7314              		.loc 1 2555 0
 7315 001e 1420     		movs	r0, #20
 7316 0020 41F24B31 		movw	r1, #4939
 7317 0024 FFF7FEFF 		bl	cc2400_set
 7318              	.LVL832:
2556:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 7319              		.loc 1 2556 0
 7320 0028 2020     		movs	r0, #32
 7321 002a 40F20111 		movw	r1, #257
 7322 002e FFF7FEFF 		bl	cc2400_set
 7323              	.LVL833:
2557:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
ARM GAS  /tmp/ccxsBJK4.s 			page 193


 7324              		.loc 1 2557 0
 7325 0032 0320     		movs	r0, #3
 7326 0034 2921     		movs	r1, #41
 7327 0036 FFF7FEFF 		bl	cc2400_set
 7328              	.LVL834:
2558:bluetooth_rxtx.c **** 	cc2400_set(RSSI,    0x00F1); // RSSI Sample over 2 symbols
 7329              		.loc 1 2558 0
 7330 003a 0620     		movs	r0, #6
 7331 003c F121     		movs	r1, #241
 7332 003e FFF7FEFF 		bl	cc2400_set
 7333              	.LVL835:
 7334              	.L814:
2559:bluetooth_rxtx.c **** 
2560:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 7335              		.loc 1 2560 0 discriminator 1
 7336 0042 FFF7FEFF 		bl	cc2400_status
 7337              	.LVL836:
 7338 0046 4006     		lsls	r0, r0, #25
 7339 0048 FBD5     		bpl	.L814
 7340              	.L816:
2561:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 7341              		.loc 1 2561 0
 7342 004a FFF7FEFF 		bl	cc2400_status
 7343              	.LVL837:
 7344 004e 00F00400 		and	r0, r0, #4
 7345 0052 00F0FF04 		and	r4, r0, #255
 7346 0056 0028     		cmp	r0, #0
 7347 0058 F7D1     		bne	.L816
 7348              	.LVL838:
 7349              	.L817:
2562:bluetooth_rxtx.c **** 
2563:bluetooth_rxtx.c **** 	while (requested_mode == MODE_LED_SPECAN) {
 7350              		.loc 1 2563 0 discriminator 1
 7351 005a 304B     		ldr	r3, .L839+8
 7352 005c 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 7353 005e 072B     		cmp	r3, #7
 7354 0060 55D1     		bne	.L838
 7355              	.LBB74:
2564:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channels[i] - 1);
 7356              		.loc 1 2564 0
 7357 0062 04AA     		add	r2, sp, #16
 7358 0064 02EB4403 		add	r3, r2, r4, lsl #1
 7359 0068 33F8081C 		ldrh	r1, [r3, #-8]
 7360 006c 0220     		movs	r0, #2
 7361 006e 0139     		subs	r1, r1, #1
 7362 0070 89B2     		uxth	r1, r1
 7363 0072 FFF7FEFF 		bl	cc2400_set
 7364              	.LVL839:
2565:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 7365              		.loc 1 2565 0
 7366 0076 6120     		movs	r0, #97
 7367 0078 FFF7FEFF 		bl	cc2400_strobe
 7368              	.LVL840:
 7369              	.L819:
2566:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 7370              		.loc 1 2566 0 discriminator 1
 7371 007c FFF7FEFF 		bl	cc2400_status
ARM GAS  /tmp/ccxsBJK4.s 			page 194


 7372              	.LVL841:
 7373 0080 4107     		lsls	r1, r0, #29
 7374 0082 FBD5     		bpl	.L819
2567:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 7375              		.loc 1 2567 0
 7376 0084 6220     		movs	r0, #98
 7377 0086 FFF7FEFF 		bl	cc2400_strobe
 7378              	.LVL842:
2568:bluetooth_rxtx.c **** 
2569:bluetooth_rxtx.c **** 		/* give the CC2400 time to acquire RSSI reading */
2570:bluetooth_rxtx.c **** 		volatile u32 j = 500; while (--j); //FIXME crude delay
 7379              		.loc 1 2570 0
 7380 008a 4FF4FA73 		mov	r3, #500
 7381 008e 0193     		str	r3, [sp, #4]
 7382              	.L821:
 7383              		.loc 1 2570 0 is_stmt 0 discriminator 1
 7384 0090 019B     		ldr	r3, [sp, #4]
 7385 0092 013B     		subs	r3, r3, #1
 7386 0094 0193     		str	r3, [sp, #4]
 7387 0096 002B     		cmp	r3, #0
 7388 0098 FAD1     		bne	.L821
2571:bluetooth_rxtx.c **** 		lvl = (int8_t)((cc2400_get(RSSI) >> 8) & 0xff);
 7389              		.loc 1 2571 0 is_stmt 1
 7390 009a 0620     		movs	r0, #6
 7391 009c FFF7FEFF 		bl	cc2400_get
 7392              	.LVL843:
2572:bluetooth_rxtx.c **** 		if (lvl > rssi_threshold) {
 7393              		.loc 1 2572 0
 7394 00a0 1F4B     		ldr	r3, .L839+12
 7395 00a2 40F30720 		sbfx	r0, r0, #8, #8
 7396              	.LVL844:
 7397 00a6 93F85030 		ldrb	r3, [r3, #80]	@ zero_extendqisi2
 7398 00aa 5BB2     		sxtb	r3, r3
 7399 00ac 9842     		cmp	r0, r3
 7400 00ae 0CDD     		ble	.L822
2573:bluetooth_rxtx.c **** 			switch (i) {
 7401              		.loc 1 2573 0
 7402 00b0 012C     		cmp	r4, #1
 7403 00b2 07D0     		beq	.L824
 7404 00b4 03D3     		bcc	.L825
 7405 00b6 022C     		cmp	r4, #2
 7406 00b8 16D1     		bne	.L823
2574:bluetooth_rxtx.c **** 				case 0:
2575:bluetooth_rxtx.c **** 					TXLED_SET;
2576:bluetooth_rxtx.c **** 					break;
2577:bluetooth_rxtx.c **** 				case 1:
2578:bluetooth_rxtx.c **** 					RXLED_SET;
2579:bluetooth_rxtx.c **** 					break;
2580:bluetooth_rxtx.c **** 				case 2:
2581:bluetooth_rxtx.c **** 					USRLED_SET;
 7407              		.loc 1 2581 0
 7408 00ba 1A4B     		ldr	r3, .L839+16
 7409 00bc 13E0     		b	.L834
 7410              	.L825:
2575:bluetooth_rxtx.c **** 					break;
 7411              		.loc 1 2575 0
 7412 00be 4FF48072 		mov	r2, #256
ARM GAS  /tmp/ccxsBJK4.s 			page 195


 7413 00c2 00E0     		b	.L837
 7414              	.L824:
2578:bluetooth_rxtx.c **** 					break;
 7415              		.loc 1 2578 0
 7416 00c4 1022     		movs	r2, #16
 7417              	.L837:
 7418 00c6 174B     		ldr	r3, .L839+16
 7419 00c8 0BE0     		b	.L836
 7420              	.L822:
2582:bluetooth_rxtx.c **** 					break;
2583:bluetooth_rxtx.c **** 			}
2584:bluetooth_rxtx.c **** 		}
2585:bluetooth_rxtx.c **** 		else {
2586:bluetooth_rxtx.c **** 			switch (i) {
 7421              		.loc 1 2586 0
 7422 00ca 012C     		cmp	r4, #1
 7423 00cc 07D0     		beq	.L827
 7424 00ce 03D3     		bcc	.L828
 7425 00d0 022C     		cmp	r4, #2
 7426 00d2 09D1     		bne	.L823
2587:bluetooth_rxtx.c **** 				case 0:
2588:bluetooth_rxtx.c **** 					TXLED_CLR;
2589:bluetooth_rxtx.c **** 					break;
2590:bluetooth_rxtx.c **** 				case 1:
2591:bluetooth_rxtx.c **** 					RXLED_CLR;
2592:bluetooth_rxtx.c **** 					break;
2593:bluetooth_rxtx.c **** 				case 2:
2594:bluetooth_rxtx.c **** 					USRLED_CLR;
 7427              		.loc 1 2594 0
 7428 00d4 144B     		ldr	r3, .L839+20
 7429 00d6 06E0     		b	.L834
 7430              	.L828:
2588:bluetooth_rxtx.c **** 					break;
 7431              		.loc 1 2588 0
 7432 00d8 4FF48072 		mov	r2, #256
 7433 00dc 00E0     		b	.L835
 7434              	.L827:
2591:bluetooth_rxtx.c **** 					break;
 7435              		.loc 1 2591 0
 7436 00de 1022     		movs	r2, #16
 7437              	.L835:
 7438 00e0 114B     		ldr	r3, .L839+20
 7439              	.L836:
 7440 00e2 1A60     		str	r2, [r3]
2592:bluetooth_rxtx.c **** 				case 2:
 7441              		.loc 1 2592 0
 7442 00e4 00E0     		b	.L823
 7443              	.L834:
 7444              		.loc 1 2594 0
 7445 00e6 1C60     		str	r4, [r3]
 7446              	.L823:
2595:bluetooth_rxtx.c **** 					break;
2596:bluetooth_rxtx.c **** 			}
2597:bluetooth_rxtx.c **** 		}
2598:bluetooth_rxtx.c **** 
2599:bluetooth_rxtx.c **** 		i = (i+1) % 3;
 7447              		.loc 1 2599 0
ARM GAS  /tmp/ccxsBJK4.s 			page 196


 7448 00e8 0323     		movs	r3, #3
 7449 00ea 0134     		adds	r4, r4, #1
 7450              	.LVL845:
 7451 00ec 94FBF3F2 		sdiv	r2, r4, r3
 7452 00f0 03FB1244 		mls	r4, r3, r2, r4
 7453              	.LVL846:
2600:bluetooth_rxtx.c **** 
2601:bluetooth_rxtx.c **** 		handle_usb(clkn);
 7454              		.loc 1 2601 0
 7455 00f4 0D4B     		ldr	r3, .L839+24
2599:bluetooth_rxtx.c **** 
 7456              		.loc 1 2599 0
 7457 00f6 E4B2     		uxtb	r4, r4
 7458              	.LVL847:
 7459              		.loc 1 2601 0
 7460 00f8 1868     		ldr	r0, [r3]
 7461 00fa FFF7FEFF 		bl	handle_usb
 7462              	.LVL848:
2602:bluetooth_rxtx.c **** 
2603:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
 7463              		.loc 1 2603 0
 7464 00fe 6420     		movs	r0, #100
 7465 0100 FFF7FEFF 		bl	cc2400_strobe
 7466              	.LVL849:
 7467              	.L831:
2604:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 7468              		.loc 1 2604 0 discriminator 1
 7469 0104 FFF7FEFF 		bl	cc2400_status
 7470              	.LVL850:
 7471 0108 4207     		lsls	r2, r0, #29
 7472 010a FBD4     		bmi	.L831
 7473 010c A5E7     		b	.L817
 7474              	.L838:
 7475              	.LBE74:
2605:bluetooth_rxtx.c **** 	}
2606:bluetooth_rxtx.c **** }
 7476              		.loc 1 2606 0
 7477 010e 04B0     		add	sp, sp, #16
 7478              		@ sp needed
 7479 0110 10BD     		pop	{r4, pc}
 7480              	.LVL851:
 7481              	.L840:
 7482 0112 00BF     		.align	2
 7483              	.L839:
 7484 0114 CC080000 		.word	.LANCHOR2+2252
 7485 0118 58C00920 		.word	537509976
 7486 011c 00000000 		.word	.LANCHOR0
 7487 0120 00000000 		.word	.LANCHOR1
 7488 0124 38C00920 		.word	537509944
 7489 0128 3CC00920 		.word	537509948
 7490 012c 00000000 		.word	clkn
 7491              		.cfi_endproc
 7492              	.LFE38:
 7494              		.section	.text.startup.main,"ax",%progbits
 7495              		.align	1
 7496              		.global	main
 7497              		.thumb
ARM GAS  /tmp/ccxsBJK4.s 			page 197


 7498              		.thumb_func
 7500              	main:
 7501              	.LFB39:
2607:bluetooth_rxtx.c **** 
2608:bluetooth_rxtx.c **** int main()
2609:bluetooth_rxtx.c **** {
 7502              		.loc 1 2609 0
 7503              		.cfi_startproc
 7504              		@ args = 0, pretend = 0, frame = 0
 7505              		@ frame_needed = 0, uses_anonymous_args = 0
 7506 0000 10B5     		push	{r4, lr}
 7507              		.cfi_def_cfa_offset 8
 7508              		.cfi_offset 4, -8
 7509              		.cfi_offset 14, -4
2610:bluetooth_rxtx.c **** 	ubertooth_init();
 7510              		.loc 1 2610 0
 7511 0002 FFF7FEFF 		bl	ubertooth_init
 7512              	.LVL852:
2611:bluetooth_rxtx.c **** 	clkn_init();
 7513              		.loc 1 2611 0
 7514 0006 FFF7FEFF 		bl	clkn_init
 7515              	.LVL853:
2612:bluetooth_rxtx.c **** 	ubertooth_usb_init(vendor_request_handler);
 7516              		.loc 1 2612 0
 7517 000a 4E48     		ldr	r0, .L873
 7518 000c FFF7FEFF 		bl	ubertooth_usb_init
 7519              	.LVL854:
 7520              	.L871:
2613:bluetooth_rxtx.c **** 	cc2400_idle();
 7521              		.loc 1 2613 0
 7522 0010 FFF7FEFF 		bl	cc2400_idle
 7523              	.LVL855:
 7524              	.L842:
2614:bluetooth_rxtx.c **** 
2615:bluetooth_rxtx.c **** 	while (1) {
2616:bluetooth_rxtx.c **** 		handle_usb(clkn);
 7525              		.loc 1 2616 0
 7526 0014 4C4B     		ldr	r3, .L873+4
2617:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 7527              		.loc 1 2617 0
 7528 0016 4D4C     		ldr	r4, .L873+8
2616:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 7529              		.loc 1 2616 0
 7530 0018 1868     		ldr	r0, [r3]
 7531 001a FFF7FEFF 		bl	handle_usb
 7532              	.LVL856:
 7533              		.loc 1 2617 0
 7534 001e A27C     		ldrb	r2, [r4, #18]	@ zero_extendqisi2
 7535 0020 637C     		ldrb	r3, [r4, #17]	@ zero_extendqisi2
 7536 0022 9A42     		cmp	r2, r3
 7537 0024 F6D0     		beq	.L842
2618:bluetooth_rxtx.c **** 			switch (requested_mode) {
 7538              		.loc 1 2618 0
 7539 0026 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 7540 0028 182B     		cmp	r3, #24
 7541 002a F3D8     		bhi	.L842
 7542 002c 01A2     		adr	r2, .L845
ARM GAS  /tmp/ccxsBJK4.s 			page 198


 7543 002e 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 7544 0032 00BF     		.p2align 2
 7545              	.L845:
 7546 0034 11000000 		.word	.L871+1
 7547 0038 A9000000 		.word	.L846+1
 7548 003c B3000000 		.word	.L847+1
 7549 0040 CD000000 		.word	.L848+1
 7550 0044 F7000000 		.word	.L849+1
 7551 0048 DB000000 		.word	.L850+1
 7552 004c EB000000 		.word	.L851+1
 7553 0050 FD000000 		.word	.L852+1
 7554 0054 BD000000 		.word	.L853+1
 7555 0058 C1000000 		.word	.L854+1
 7556 005c C7000000 		.word	.L855+1
 7557 0060 99000000 		.word	.L856+1
 7558 0064 3B010000 		.word	.L869+1
 7559 0068 03010000 		.word	.L858+1
 7560 006c A5000000 		.word	.L859+1
 7561 0070 0F010000 		.word	.L860+1
 7562 0074 19010000 		.word	.L861+1
 7563 0078 1F010000 		.word	.L862+1
 7564 007c 23010000 		.word	.L863+1
 7565 0080 27010000 		.word	.L864+1
 7566 0084 2B010000 		.word	.L865+1
 7567 0088 2F010000 		.word	.L866+1
 7568 008c 33010000 		.word	.L867+1
 7569 0090 37010000 		.word	.L868+1
 7570 0094 3B010000 		.word	.L869+1
 7571              	.L856:
2619:bluetooth_rxtx.c **** 				case MODE_RESET:
2620:bluetooth_rxtx.c **** 					/* Allow time for the USB command to return correctly */
2621:bluetooth_rxtx.c **** 					wait(1);
 7572              		.loc 1 2621 0
 7573 0098 0120     		movs	r0, #1
 7574 009a FFF7FEFF 		bl	wait
 7575              	.LVL857:
2622:bluetooth_rxtx.c **** 					reset();
 7576              		.loc 1 2622 0
 7577 009e FFF7FEFF 		bl	reset
 7578              	.LVL858:
2623:bluetooth_rxtx.c **** 					break;
 7579              		.loc 1 2623 0
 7580 00a2 B7E7     		b	.L842
 7581              	.L859:
2624:bluetooth_rxtx.c **** 				case MODE_AFH:
2625:bluetooth_rxtx.c **** 					mode = MODE_AFH;
 7582              		.loc 1 2625 0
 7583 00a4 0E23     		movs	r3, #14
 7584 00a6 00E0     		b	.L872
 7585              	.L846:
2626:bluetooth_rxtx.c **** 					bt_stream_rx();
2627:bluetooth_rxtx.c **** 					break;
2628:bluetooth_rxtx.c **** 				case MODE_RX_SYMBOLS:
2629:bluetooth_rxtx.c **** 					mode = MODE_RX_SYMBOLS;
 7586              		.loc 1 2629 0
 7587 00a8 0123     		movs	r3, #1
 7588              	.L872:
ARM GAS  /tmp/ccxsBJK4.s 			page 199


 7589 00aa 6374     		strb	r3, [r4, #17]
2630:bluetooth_rxtx.c **** 					bt_stream_rx();
 7590              		.loc 1 2630 0
 7591 00ac FFF7FEFF 		bl	bt_stream_rx
 7592              	.LVL859:
2631:bluetooth_rxtx.c **** 					break;
 7593              		.loc 1 2631 0
 7594 00b0 B0E7     		b	.L842
 7595              	.L847:
2632:bluetooth_rxtx.c **** 				case MODE_TX_SYMBOLS:
2633:bluetooth_rxtx.c **** 					mode = MODE_TX_SYMBOLS;
 7596              		.loc 1 2633 0
 7597 00b2 0223     		movs	r3, #2
 7598 00b4 6374     		strb	r3, [r4, #17]
2634:bluetooth_rxtx.c **** 					br_transmit();
 7599              		.loc 1 2634 0
 7600 00b6 FFF7FEFF 		bl	br_transmit
 7601              	.LVL860:
2635:bluetooth_rxtx.c **** 					break;
 7602              		.loc 1 2635 0
 7603 00ba ABE7     		b	.L842
 7604              	.L853:
2636:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW:
2637:bluetooth_rxtx.c **** 					mode = MODE_BT_FOLLOW;
 7605              		.loc 1 2637 0
 7606 00bc 0823     		movs	r3, #8
 7607 00be F4E7     		b	.L872
 7608              	.L854:
2638:bluetooth_rxtx.c **** 					bt_stream_rx();
2639:bluetooth_rxtx.c **** 					break;
2640:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW_LE:
2641:bluetooth_rxtx.c **** 					bt_follow_le();
 7609              		.loc 1 2641 0
 7610 00c0 FFF7FEFF 		bl	bt_follow_le
 7611              	.LVL861:
2642:bluetooth_rxtx.c **** 					break;
 7612              		.loc 1 2642 0
 7613 00c4 A6E7     		b	.L842
 7614              	.L855:
2643:bluetooth_rxtx.c **** 				case MODE_BT_PROMISC_LE:
2644:bluetooth_rxtx.c **** 					bt_promisc_le();
 7615              		.loc 1 2644 0
 7616 00c6 FFF7FEFF 		bl	bt_promisc_le
 7617              	.LVL862:
2645:bluetooth_rxtx.c **** 					break;
 7618              		.loc 1 2645 0
 7619 00ca A3E7     		b	.L842
 7620              	.L848:
2646:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE:
2647:bluetooth_rxtx.c **** 					bt_slave_le(0x000f);
2648:bluetooth_rxtx.c **** 					break;
2649:bluetooth_rxtx.c **** 				case MODE_TX_TEST:
2650:bluetooth_rxtx.c **** 					mode = MODE_TX_TEST;
 7621              		.loc 1 2650 0
 7622 00cc 0323     		movs	r3, #3
2651:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 7623              		.loc 1 2651 0
ARM GAS  /tmp/ccxsBJK4.s 			page 200


 7624 00ce 1F48     		ldr	r0, .L873+8
 7625 00d0 1F49     		ldr	r1, .L873+12
2650:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 7626              		.loc 1 2650 0
 7627 00d2 6374     		strb	r3, [r4, #17]
 7628              		.loc 1 2651 0
 7629 00d4 FFF7FEFF 		bl	cc2400_txtest
 7630              	.LVL863:
2652:bluetooth_rxtx.c **** 					break;
 7631              		.loc 1 2652 0
 7632 00d8 9CE7     		b	.L842
 7633              	.L850:
2653:bluetooth_rxtx.c **** 				case MODE_RANGE_TEST:
2654:bluetooth_rxtx.c **** 					mode = MODE_RANGE_TEST;
 7634              		.loc 1 2654 0
 7635 00da 0523     		movs	r3, #5
2655:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 7636              		.loc 1 2655 0
 7637 00dc 1C48     		ldr	r0, .L873+12
2654:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 7638              		.loc 1 2654 0
 7639 00de 6374     		strb	r3, [r4, #17]
 7640              		.loc 1 2655 0
 7641 00e0 FFF7FEFF 		bl	cc2400_rangetest
 7642              	.LVL864:
2656:bluetooth_rxtx.c **** 					requested_mode = MODE_IDLE;
 7643              		.loc 1 2656 0
 7644 00e4 0023     		movs	r3, #0
 7645 00e6 A374     		strb	r3, [r4, #18]
2657:bluetooth_rxtx.c **** 					break;
 7646              		.loc 1 2657 0
 7647 00e8 94E7     		b	.L842
 7648              	.L851:
2658:bluetooth_rxtx.c **** 				case MODE_REPEATER:
2659:bluetooth_rxtx.c **** 					mode = MODE_REPEATER;
 7649              		.loc 1 2659 0
 7650 00ea 0623     		movs	r3, #6
2660:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 7651              		.loc 1 2660 0
 7652 00ec 1848     		ldr	r0, .L873+12
2659:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 7653              		.loc 1 2659 0
 7654 00ee 6374     		strb	r3, [r4, #17]
 7655              		.loc 1 2660 0
 7656 00f0 FFF7FEFF 		bl	cc2400_repeater
 7657              	.LVL865:
2661:bluetooth_rxtx.c **** 					break;
 7658              		.loc 1 2661 0
 7659 00f4 8EE7     		b	.L842
 7660              	.L849:
2662:bluetooth_rxtx.c **** 				case MODE_SPECAN:
2663:bluetooth_rxtx.c **** 					specan();
 7661              		.loc 1 2663 0
 7662 00f6 FFF7FEFF 		bl	specan
 7663              	.LVL866:
2664:bluetooth_rxtx.c **** 					break;
 7664              		.loc 1 2664 0
ARM GAS  /tmp/ccxsBJK4.s 			page 201


 7665 00fa 8BE7     		b	.L842
 7666              	.L852:
2665:bluetooth_rxtx.c **** 				case MODE_LED_SPECAN:
2666:bluetooth_rxtx.c **** 					led_specan();
 7667              		.loc 1 2666 0
 7668 00fc FFF7FEFF 		bl	led_specan
 7669              	.LVL867:
2667:bluetooth_rxtx.c **** 					break;
 7670              		.loc 1 2667 0
 7671 0100 88E7     		b	.L842
 7672              	.L858:
2668:bluetooth_rxtx.c **** 				case MODE_EGO:
2669:bluetooth_rxtx.c **** 					mode = MODE_EGO;
 7673              		.loc 1 2669 0
 7674 0102 0D23     		movs	r3, #13
 7675 0104 6374     		strb	r3, [r4, #17]
2670:bluetooth_rxtx.c **** 					ego_main(ego_mode);
 7676              		.loc 1 2670 0
 7677 0106 207D     		ldrb	r0, [r4, #20]	@ zero_extendqisi2
 7678 0108 FFF7FEFF 		bl	ego_main
 7679              	.LVL868:
2671:bluetooth_rxtx.c **** 					break;
 7680              		.loc 1 2671 0
 7681 010c 82E7     		b	.L842
 7682              	.L860:
2672:bluetooth_rxtx.c **** 				case MODE_RX_GENERIC:
2673:bluetooth_rxtx.c **** 					mode = MODE_RX_GENERIC;
 7683              		.loc 1 2673 0
 7684 010e 0F23     		movs	r3, #15
 7685 0110 6374     		strb	r3, [r4, #17]
2674:bluetooth_rxtx.c **** 					rx_generic();
 7686              		.loc 1 2674 0
 7687 0112 FFF7FEFF 		bl	rx_generic
 7688              	.LVL869:
2675:bluetooth_rxtx.c **** 					break;
 7689              		.loc 1 2675 0
 7690 0116 7DE7     		b	.L842
 7691              	.L861:
2676:bluetooth_rxtx.c **** 				case MODE_TX_GENERIC:
2677:bluetooth_rxtx.c **** 					tx_generic();
 7692              		.loc 1 2677 0
 7693 0118 FFF7FEFF 		bl	tx_generic
 7694              	.LVL870:
2678:bluetooth_rxtx.c **** 					break;
 7695              		.loc 1 2678 0
 7696 011c 7AE7     		b	.L842
 7697              	.L862:
2679:bluetooth_rxtx.c **** 				case MODE_IDLE:
2680:bluetooth_rxtx.c **** 					cc2400_idle();
2681:bluetooth_rxtx.c **** 					break;
2682:bluetooth_rxtx.c **** 				// JWHUR POWER CONTROL
2683:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P0:
2684:bluetooth_rxtx.c **** 					bt_slave_le(0x0008);
 7698              		.loc 1 2684 0
 7699 011e 0820     		movs	r0, #8
 7700 0120 0CE0     		b	.L870
 7701              	.L863:
ARM GAS  /tmp/ccxsBJK4.s 			page 202


2685:bluetooth_rxtx.c **** 					break;
2686:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P1:
2687:bluetooth_rxtx.c **** 					bt_slave_le(0x0009);
 7702              		.loc 1 2687 0
 7703 0122 0920     		movs	r0, #9
 7704 0124 0AE0     		b	.L870
 7705              	.L864:
2688:bluetooth_rxtx.c **** 					break;
2689:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P2:
2690:bluetooth_rxtx.c **** 					bt_slave_le(0x000a);
 7706              		.loc 1 2690 0
 7707 0126 0A20     		movs	r0, #10
 7708 0128 08E0     		b	.L870
 7709              	.L865:
2691:bluetooth_rxtx.c **** 					break;
2692:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P3:
2693:bluetooth_rxtx.c **** 					bt_slave_le(0x000b);
 7710              		.loc 1 2693 0
 7711 012a 0B20     		movs	r0, #11
 7712 012c 06E0     		b	.L870
 7713              	.L866:
2694:bluetooth_rxtx.c **** 					break;
2695:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P4:
2696:bluetooth_rxtx.c **** 					bt_slave_le(0x000c);
 7714              		.loc 1 2696 0
 7715 012e 0C20     		movs	r0, #12
 7716 0130 04E0     		b	.L870
 7717              	.L867:
2697:bluetooth_rxtx.c **** 					break;
2698:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P5:
2699:bluetooth_rxtx.c **** 					bt_slave_le(0x000d);
 7718              		.loc 1 2699 0
 7719 0132 0D20     		movs	r0, #13
 7720 0134 02E0     		b	.L870
 7721              	.L868:
2700:bluetooth_rxtx.c **** 					break;
2701:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P6:
2702:bluetooth_rxtx.c **** 					bt_slave_le(0x000e);
 7722              		.loc 1 2702 0
 7723 0136 0E20     		movs	r0, #14
 7724 0138 00E0     		b	.L870
 7725              	.L869:
2703:bluetooth_rxtx.c **** 					break;
2704:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE_P7:
2705:bluetooth_rxtx.c **** 					bt_slave_le(0x000f);
 7726              		.loc 1 2705 0
 7727 013a 0F20     		movs	r0, #15
 7728              	.L870:
 7729 013c FFF7FEFF 		bl	bt_slave_le
 7730              	.LVL871:
2706:bluetooth_rxtx.c **** 					break;
 7731              		.loc 1 2706 0
 7732 0140 68E7     		b	.L842
 7733              	.L874:
 7734 0142 00BF     		.align	2
 7735              	.L873:
 7736 0144 00000000 		.word	vendor_request_handler
ARM GAS  /tmp/ccxsBJK4.s 			page 203


 7737 0148 00000000 		.word	clkn
 7738 014c 00000000 		.word	.LANCHOR0
 7739 0150 00000000 		.word	.LANCHOR1
 7740              		.cfi_endproc
 7741              	.LFE39:
 7743              		.comm	unpacked,800,1
 7744              		.global	packet_cb
 7745              		.global	data_cb
 7746              		.global	le_jam_count
 7747              		.comm	le_promisc,264,4
 7748              		.global	le
 7749              		.global	slave_mac_address
 7750              		.comm	tx_pkt,58,2
 7751              		.global	rssi_threshold
 7752              		.global	high_freq
 7753              		.global	low_freq
 7754              		.global	modulation
 7755              		.global	ego_mode
 7756              		.global	jam_mode
 7757              		.global	requested_mode
 7758              		.global	mode
 7759              		.global	status
 7760              		.global	dma_discard
 7761              		.global	idle_buf_channel
 7762              		.global	idle_buf_clk100ns
 7763              		.global	idle_buf_clkn_high
 7764              		.global	le_adv_channel
 7765              		.global	requested_channel
 7766              		.global	hop_timeout
 7767              		.global	hop_direct_channel
 7768              		.global	channel
 7769              		.global	do_hop
 7770              		.global	hop_mode
 7771              		.global	compile_info
 7772              		.comm	rr,5,1
 7773              		.comm	used_channels,1,1
 7774              		.comm	afh_map,10,1
 7775              		.comm	afh_enabled,1,1
 7776              		.comm	syncword,8,8
 7777              		.comm	target,16,8
 7778              		.comm	clkn_next_drift_fix,4,4
 7779              		.comm	clkn_last_drift_fix,4,4
 7780              		.comm	clk_drift_correction,2,2
 7781              		.comm	clk_drift_ppm,2,2
 7782              		.comm	clk100ns_offset,2,2
 7783              		.comm	clkn_offset,4,4
 7784              		.comm	last_hop,4,4
 7785              		.comm	clkn,4,4
 7786              		.comm	rx_err,4,4
 7787              		.comm	rx_tc,4,4
 7788              		.comm	idle_rxbuf,4,4
 7789              		.comm	active_rxbuf,4,4
 7790              		.comm	rxbuf2,50,1
 7791              		.comm	rxbuf1,50,1
 7792              		.comm	cs_trigger,1,1
 7793              		.comm	cs_threshold_cur,1,1
 7794              		.comm	cs_threshold_req,1,1
ARM GAS  /tmp/ccxsBJK4.s 			page 204


 7795              		.comm	cs_no_squelch,1,1
 7796              		.comm	rssi_count,1,1
 7797              		.comm	rssi_min,1,1
 7798              		.comm	rssi_max,1,1
 7799              		.section	.rodata
 7800              		.align	2
 7801              		.set	.LANCHOR2,. + 0
 7804              	whitening_index:
 7805 0000 46       		.byte	70
 7806 0001 3E       		.byte	62
 7807 0002 78       		.byte	120
 7808 0003 6F       		.byte	111
 7809 0004 4D       		.byte	77
 7810 0005 2E       		.byte	46
 7811 0006 0F       		.byte	15
 7812 0007 65       		.byte	101
 7813 0008 42       		.byte	66
 7814 0009 27       		.byte	39
 7815 000a 1F       		.byte	31
 7816 000b 1A       		.byte	26
 7817 000c 50       		.byte	80
 7818 000d 53       		.byte	83
 7819 000e 7D       		.byte	125
 7820 000f 59       		.byte	89
 7821 0010 0A       		.byte	10
 7822 0011 23       		.byte	35
 7823 0012 08       		.byte	8
 7824 0013 36       		.byte	54
 7825 0014 7A       		.byte	122
 7826 0015 11       		.byte	17
 7827 0016 21       		.byte	33
 7828 0017 00       		.byte	0
 7829 0018 3A       		.byte	58
 7830 0019 73       		.byte	115
 7831 001a 06       		.byte	6
 7832 001b 5E       		.byte	94
 7833 001c 56       		.byte	86
 7834 001d 31       		.byte	49
 7835 001e 34       		.byte	52
 7836 001f 14       		.byte	20
 7837 0020 28       		.byte	40
 7838 0021 1B       		.byte	27
 7839 0022 54       		.byte	84
 7840 0023 5A       		.byte	90
 7841 0024 3F       		.byte	63
 7842 0025 70       		.byte	112
 7843 0026 2F       		.byte	47
 7844 0027 66       		.byte	102
 7847              	whitening:
 7848 0028 01       		.byte	1
 7849 0029 01       		.byte	1
 7850 002a 01       		.byte	1
 7851 002b 01       		.byte	1
 7852 002c 00       		.byte	0
 7853 002d 01       		.byte	1
 7854 002e 00       		.byte	0
 7855 002f 01       		.byte	1
ARM GAS  /tmp/ccxsBJK4.s 			page 205


 7856 0030 00       		.byte	0
 7857 0031 01       		.byte	1
 7858 0032 00       		.byte	0
 7859 0033 00       		.byte	0
 7860 0034 00       		.byte	0
 7861 0035 00       		.byte	0
 7862 0036 01       		.byte	1
 7863 0037 00       		.byte	0
 7864 0038 01       		.byte	1
 7865 0039 01       		.byte	1
 7866 003a 00       		.byte	0
 7867 003b 01       		.byte	1
 7868 003c 01       		.byte	1
 7869 003d 01       		.byte	1
 7870 003e 01       		.byte	1
 7871 003f 00       		.byte	0
 7872 0040 00       		.byte	0
 7873 0041 01       		.byte	1
 7874 0042 01       		.byte	1
 7875 0043 01       		.byte	1
 7876 0044 00       		.byte	0
 7877 0045 00       		.byte	0
 7878 0046 01       		.byte	1
 7879 0047 00       		.byte	0
 7880 0048 01       		.byte	1
 7881 0049 00       		.byte	0
 7882 004a 01       		.byte	1
 7883 004b 01       		.byte	1
 7884 004c 00       		.byte	0
 7885 004d 00       		.byte	0
 7886 004e 01       		.byte	1
 7887 004f 01       		.byte	1
 7888 0050 00       		.byte	0
 7889 0051 00       		.byte	0
 7890 0052 00       		.byte	0
 7891 0053 00       		.byte	0
 7892 0054 00       		.byte	0
 7893 0055 01       		.byte	1
 7894 0056 01       		.byte	1
 7895 0057 00       		.byte	0
 7896 0058 01       		.byte	1
 7897 0059 01       		.byte	1
 7898 005a 00       		.byte	0
 7899 005b 01       		.byte	1
 7900 005c 00       		.byte	0
 7901 005d 01       		.byte	1
 7902 005e 01       		.byte	1
 7903 005f 01       		.byte	1
 7904 0060 00       		.byte	0
 7905 0061 01       		.byte	1
 7906 0062 00       		.byte	0
 7907 0063 00       		.byte	0
 7908 0064 00       		.byte	0
 7909 0065 01       		.byte	1
 7910 0066 01       		.byte	1
 7911 0067 00       		.byte	0
 7912 0068 00       		.byte	0
ARM GAS  /tmp/ccxsBJK4.s 			page 206


 7913 0069 01       		.byte	1
 7914 006a 00       		.byte	0
 7915 006b 00       		.byte	0
 7916 006c 00       		.byte	0
 7917 006d 01       		.byte	1
 7918 006e 00       		.byte	0
 7919 006f 00       		.byte	0
 7920 0070 00       		.byte	0
 7921 0071 00       		.byte	0
 7922 0072 00       		.byte	0
 7923 0073 00       		.byte	0
 7924 0074 01       		.byte	1
 7925 0075 00       		.byte	0
 7926 0076 00       		.byte	0
 7927 0077 01       		.byte	1
 7928 0078 00       		.byte	0
 7929 0079 00       		.byte	0
 7930 007a 01       		.byte	1
 7931 007b 01       		.byte	1
 7932 007c 00       		.byte	0
 7933 007d 01       		.byte	1
 7934 007e 00       		.byte	0
 7935 007f 00       		.byte	0
 7936 0080 01       		.byte	1
 7937 0081 01       		.byte	1
 7938 0082 01       		.byte	1
 7939 0083 01       		.byte	1
 7940 0084 00       		.byte	0
 7941 0085 01       		.byte	1
 7942 0086 01       		.byte	1
 7943 0087 01       		.byte	1
 7944 0088 00       		.byte	0
 7945 0089 00       		.byte	0
 7946 008a 00       		.byte	0
 7947 008b 00       		.byte	0
 7948 008c 01       		.byte	1
 7949 008d 01       		.byte	1
 7950 008e 01       		.byte	1
 7951 008f 01       		.byte	1
 7952 0090 01       		.byte	1
 7953 0091 01       		.byte	1
 7954 0092 01       		.byte	1
 7955 0093 00       		.byte	0
 7956 0094 00       		.byte	0
 7957 0095 00       		.byte	0
 7958 0096 01       		.byte	1
 7959 0097 01       		.byte	1
 7960 0098 01       		.byte	1
 7961 0099 00       		.byte	0
 7962 009a 01       		.byte	1
 7963 009b 01       		.byte	1
 7964 009c 00       		.byte	0
 7965 009d 00       		.byte	0
 7966 009e 00       		.byte	0
 7967 009f 01       		.byte	1
 7968 00a0 00       		.byte	0
 7969 00a1 01       		.byte	1
ARM GAS  /tmp/ccxsBJK4.s 			page 207


 7970 00a2 00       		.byte	0
 7971 00a3 00       		.byte	0
 7972 00a4 01       		.byte	1
 7973 00a5 00       		.byte	0
 7974 00a6 01       		.byte	1
 7977              	compile_info:
 7978 00a7 75626572 		.ascii	"ubertooth 2017-03-R2 (mwnl@mwnl-lenovo) 2018. 05. 1"
 7978      746F6F74 
 7978      68203230 
 7978      31372D30 
 7978      332D5232 
 7979 00da 352E2028 		.ascii	"5. (\355\231\224) 17:24:40 KST\000"
 7979      ED999429 
 7979      2031373A 
 7979      32343A34 
 7979      30204B53 
 7982              	whitening_word:
 7983 00f0 40B2BCC3 		.word	-1011043776
 7984 00f4 1F374A5F 		.word	1598699295
 7985 00f8 85F69C9A 		.word	-1700989307
 7986 00fc C1D6C544 		.word	1153816257
 7987 0100 2059DEE1 		.word	-505521888
 7988 0104 8F1BA5AF 		.word	-1348134001
 7989 0108 427B4ECD 		.word	-850494654
 7990 010c 60EB6222 		.word	576908128
 7991 0110 902CEFF0 		.word	-252760944
 7992 0114 C78DD257 		.word	1473416647
 7993 0118 A13DA766 		.word	1722236321
 7994 011c B0753111 		.word	288454064
 7995 0120 8940B2BC 		.word	-1129168759
 7996 0124 C31F374A 		.word	1245126595
 7997 0128 5F85F69C 		.word	-1661565601
 7998 012c 9AC1D6C5 		.word	-975781478
 7999 0130 442059DE 		.word	-564584380
 8000 0134 E18F1BA5 		.word	-1524920351
 8001 0138 AF427B4E 		.word	1316700847
 8002 013c CD60EB62 		.word	1659592909
 8003 0140 22902CEF 		.word	-282292190
 8004 0144 F0C78DD2 		.word	-762460176
 8005 0148 57A13DA7 		.word	-1489133225
 8006 014c 66B07531 		.word	829796454
 8007 0150 D257A13D 		.word	1033983954
 8008 0154 A766B075 		.word	1974494887
 8009 0158 31114896 		.word	-1773661903
 8010 015c 77F8E346 		.word	1189345399
 8011 0160 E9ABD09E 		.word	-1630491671
 8012 0164 5333D8BA 		.word	-1160236205
 8013 0168 980824CB 		.word	-886830952
 8014 016c 3BFC71A3 		.word	-1552810949
 8015 0170 F45568CF 		.word	-815245836
 8016 0174 A9196C5D 		.word	1567365545
 8017 0178 4C0492E5 		.word	-443415476
 8018 017c 1DFEB851 		.word	1371078173
 8019 0180 1BA5AF42 		.word	1118807323
 8020 0184 7B4ECD60 		.word	1624067707
 8021 0188 EB622290 		.word	-1876794645
 8022 018c 2CEFF0C7 		.word	-940511444
ARM GAS  /tmp/ccxsBJK4.s 			page 208


 8023 0190 8DD257A1 		.word	-1588079987
 8024 0194 3DA766B0 		.word	-1335449795
 8025 0198 75311148 		.word	1209086325
 8026 019c 9677F8E3 		.word	-470255722
 8027 01a0 46E9ABD0 		.word	-794039994
 8028 01a4 9E5333D8 		.word	-667724898
 8029 01a8 BA980824 		.word	604543162
 8030 01ac CB3BFC71 		.word	1912355787
 8031 01b0 6479873F 		.word	1065843044
 8032 01b4 6E94BE0A 		.word	180261998
 8033 01b8 ED393583 		.word	-2093663763
 8034 01bc AD8B8940 		.word	1082756013
 8035 01c0 B2BCC31F 		.word	532921522
 8036 01c4 374A5F85 		.word	-2057352649
 8037 01c8 F69C9AC1 		.word	-1046831882
 8038 01cc D6C54420 		.word	541378006
 8039 01d0 59DEE18F 		.word	-1881022887
 8040 01d4 1BA5AF42 		.word	1118807323
 8041 01d8 7B4ECD60 		.word	1624067707
 8042 01dc EB622290 		.word	-1876794645
 8043 01e0 AD8B8940 		.word	1082756013
 8044 01e4 B2BCC31F 		.word	532921522
 8045 01e8 374A5F85 		.word	-2057352649
 8046 01ec F69C9AC1 		.word	-1046831882
 8047 01f0 D6C54420 		.word	541378006
 8048 01f4 59DEE18F 		.word	-1881022887
 8049 01f8 1BA5AF42 		.word	1118807323
 8050 01fc 7B4ECD60 		.word	1624067707
 8051 0200 EB622290 		.word	-1876794645
 8052 0204 2CEFF0C7 		.word	-940511444
 8053 0208 8DD257A1 		.word	-1588079987
 8054 020c 3DA766B0 		.word	-1335449795
 8055 0210 F69C9AC1 		.word	-1046831882
 8056 0214 D6C54420 		.word	541378006
 8057 0218 59DEE18F 		.word	-1881022887
 8058 021c 1BA5AF42 		.word	1118807323
 8059 0220 7B4ECD60 		.word	1624067707
 8060 0224 EB622290 		.word	-1876794645
 8061 0228 2CEFF0C7 		.word	-940511444
 8062 022c 8DD257A1 		.word	-1588079987
 8063 0230 3DA766B0 		.word	-1335449795
 8064 0234 75311148 		.word	1209086325
 8065 0238 9677F8E3 		.word	-470255722
 8066 023c 46E9ABD0 		.word	-794039994
 8067 0240 3F6E94BE 		.word	-1097568705
 8068 0244 0AED3935 		.word	892988682
 8069 0248 83AD8B89 		.word	-1987334781
 8070 024c 40B2BCC3 		.word	-1011043776
 8071 0250 1F374A5F 		.word	1598699295
 8072 0254 85F69C9A 		.word	-1700989307
 8073 0258 C1D6C544 		.word	1153816257
 8074 025c 2059DEE1 		.word	-505521888
 8075 0260 8F1BA5AF 		.word	-1348134001
 8076 0264 427B4ECD 		.word	-850494654
 8077 0268 60EB6222 		.word	576908128
 8078 026c 902CEFF0 		.word	-252760944
 8079 0270 0824CB3B 		.word	1003168776
ARM GAS  /tmp/ccxsBJK4.s 			page 209


 8080 0274 FC71A3F4 		.word	-190615044
 8081 0278 5568CFA9 		.word	-1446025131
 8082 027c 196C5D4C 		.word	1281190937
 8083 0280 0492E51D 		.word	501584388
 8084 0284 FEB851FA 		.word	-95307522
 8085 0288 2AB4E7D4 		.word	-723012566
 8086 028c 0CB62E26 		.word	640595468
 8087 0290 02C9F20E 		.word	250792194
 8088 0294 7FDC287D 		.word	2099829887
 8089 0298 15DA736A 		.word	1785977365
 8090 029c 065B1713 		.word	320297734
 8091 02a0 C1D6C544 		.word	1153816257
 8092 02a4 2059DEE1 		.word	-505521888
 8093 02a8 8F1BA5AF 		.word	-1348134001
 8094 02ac 427B4ECD 		.word	-850494654
 8095 02b0 60EB6222 		.word	576908128
 8096 02b4 902CEFF0 		.word	-252760944
 8097 02b8 C78DD257 		.word	1473416647
 8098 02bc A13DA766 		.word	1722236321
 8099 02c0 B0753111 		.word	288454064
 8100 02c4 489677F8 		.word	-126380472
 8101 02c8 E346E9AB 		.word	-1410775325
 8102 02cc D09E5333 		.word	861118160
 8103 02d0 9AC1D6C5 		.word	-975781478
 8104 02d4 442059DE 		.word	-564584380
 8105 02d8 E18F1BA5 		.word	-1524920351
 8106 02dc AF427B4E 		.word	1316700847
 8107 02e0 CD60EB62 		.word	1659592909
 8108 02e4 22902CEF 		.word	-282292190
 8109 02e8 F0C78DD2 		.word	-762460176
 8110 02ec 57A13DA7 		.word	-1489133225
 8111 02f0 66B07531 		.word	829796454
 8112 02f4 11489677 		.word	2006337553
 8113 02f8 F8E346E9 		.word	-381230088
 8114 02fc ABD09E53 		.word	1402917035
 8115 0300 5333D8BA 		.word	-1160236205
 8116 0304 980824CB 		.word	-886830952
 8117 0308 3BFC71A3 		.word	-1552810949
 8118 030c F45568CF 		.word	-815245836
 8119 0310 A9196C5D 		.word	1567365545
 8120 0314 4C0492E5 		.word	-443415476
 8121 0318 1DFEB851 		.word	1371078173
 8122 031c FA2AB4E7 		.word	-407622918
 8123 0320 D40CB62E 		.word	783682772
 8124 0324 2602C9F2 		.word	-221707738
 8125 0328 0E7FDC28 		.word	685539086
 8126 032c 7D15DA73 		.word	1943672189
 8127 0330 2CEFF0C7 		.word	-940511444
 8128 0334 8DD257A1 		.word	-1588079987
 8129 0338 3DA766B0 		.word	-1335449795
 8130 033c 75311148 		.word	1209086325
 8131 0340 9677F8E3 		.word	-470255722
 8132 0344 46E9ABD0 		.word	-794039994
 8133 0348 9E5333D8 		.word	-667724898
 8134 034c BA980824 		.word	604543162
 8135 0350 CB3BFC71 		.word	1912355787
 8136 0354 A3F45568 		.word	1750463651
ARM GAS  /tmp/ccxsBJK4.s 			page 210


 8137 0358 CFA9196C 		.word	1813621199
 8138 035c 5D4C0492 		.word	-1845212067
 8139 0360 E51DFEB8 		.word	-1191305755
 8140 0364 51FA2AB4 		.word	-1272251823
 8141 0368 E7D40CB6 		.word	-1240673049
 8142 036c 2E2602C9 		.word	-922606034
 8143 0370 F20E7FDC 		.word	-595652878
 8144 0374 287D15DA 		.word	-636125912
 8145 0378 736A065B 		.word	1527147123
 8146 037c 17138164 		.word	1686180631
 8147 0380 79873F6E 		.word	1849657209
 8148 0384 94BE0AED 		.word	-318062956
 8149 0388 393583AD 		.word	-1383910087
 8150 038c 8B8940B2 		.word	-1304393333
 8151 0390 BE0AED39 		.word	971836094
 8152 0394 3583AD8B 		.word	-1951562955
 8153 0398 8940B2BC 		.word	-1129168759
 8154 039c C31F374A 		.word	1245126595
 8155 03a0 5F85F69C 		.word	-1661565601
 8156 03a4 9AC1D6C5 		.word	-975781478
 8157 03a8 442059DE 		.word	-564584380
 8158 03ac E18F1BA5 		.word	-1524920351
 8159 03b0 AF427B4E 		.word	1316700847
 8160 03b4 CD60EB62 		.word	1659592909
 8161 03b8 22902CEF 		.word	-282292190
 8162 03bc F0C78DD2 		.word	-762460176
 8163 03c0 77F8E346 		.word	1189345399
 8164 03c4 E9ABD09E 		.word	-1630491671
 8165 03c8 5333D8BA 		.word	-1160236205
 8166 03cc 980824CB 		.word	-886830952
 8167 03d0 3BFC71A3 		.word	-1552810949
 8168 03d4 F45568CF 		.word	-815245836
 8169 03d8 A9196C5D 		.word	1567365545
 8170 03dc 4C0492E5 		.word	-443415476
 8171 03e0 1DFEB851 		.word	1371078173
 8172 03e4 FA2AB4E7 		.word	-407622918
 8173 03e8 D40CB62E 		.word	783682772
 8174 03ec 2602C9F2 		.word	-221707738
 8175 03f0 D09E5333 		.word	861118160
 8176 03f4 D8BA9808 		.word	144227032
 8177 03f8 24CB3BFC 		.word	-63190236
 8178 03fc 71A3F455 		.word	1442095985
 8179 0400 68CFA919 		.word	430559080
 8180 0404 6C5D4C04 		.word	72113516
 8181 0408 92E51DFE 		.word	-31595118
 8182 040c B851FA2A 		.word	721047992
 8183 0410 B4E7D40C 		.word	215279540
 8184 0414 B62E2602 		.word	36056758
 8185 0418 C9F20E7F 		.word	2131686089
 8186 041c DC287D15 		.word	360523996
 8187 0420 196C5D4C 		.word	1281190937
 8188 0424 0492E51D 		.word	501584388
 8189 0428 FEB851FA 		.word	-95307522
 8190 042c 2AB4E7D4 		.word	-723012566
 8191 0430 0CB62E26 		.word	640595468
 8192 0434 02C9F20E 		.word	250792194
 8193 0438 7FDC287D 		.word	2099829887
ARM GAS  /tmp/ccxsBJK4.s 			page 211


 8194 043c 15DA736A 		.word	1785977365
 8195 0440 065B1713 		.word	320297734
 8196 0444 81647987 		.word	-2022087551
 8197 0448 3F6E94BE 		.word	-1097568705
 8198 044c 0AED3935 		.word	892988682
 8199 0450 427B4ECD 		.word	-850494654
 8200 0454 60EB6222 		.word	576908128
 8201 0458 902CEFF0 		.word	-252760944
 8202 045c C78DD257 		.word	1473416647
 8203 0460 A13DA766 		.word	1722236321
 8204 0464 B0753111 		.word	288454064
 8205 0468 489677F8 		.word	-126380472
 8206 046c E346E9AB 		.word	-1410775325
 8207 0470 D09E5333 		.word	861118160
 8208 0474 D8BA9808 		.word	144227032
 8209 0478 24CB3BFC 		.word	-63190236
 8210 047c 71A3F455 		.word	1442095985
 8211 0480 8B8940B2 		.word	-1304393333
 8212 0484 BCC31F37 		.word	924828604
 8213 0488 4A5F85F6 		.word	-159031478
 8214 048c 9C9AC1D6 		.word	-691955044
 8215 0490 C5442059 		.word	1495286981
 8216 0494 DEE18F1B 		.word	462414302
 8217 0498 A5AF427B 		.word	2067967909
 8218 049c 4ECD60EB 		.word	-345977522
 8219 04a0 6222902C 		.word	747643490
 8220 04a4 EFF0C78D 		.word	-1916276497
 8221 04a8 D257A13D 		.word	1033983954
 8222 04ac A766B075 		.word	1974494887
 8223 04b0 F45568CF 		.word	-815245836
 8224 04b4 A9196C5D 		.word	1567365545
 8225 04b8 4C0492E5 		.word	-443415476
 8226 04bc 1DFEB851 		.word	1371078173
 8227 04c0 FA2AB4E7 		.word	-407622918
 8228 04c4 D40CB62E 		.word	783682772
 8229 04c8 2602C9F2 		.word	-221707738
 8230 04cc 0E7FDC28 		.word	685539086
 8231 04d0 7D15DA73 		.word	1943672189
 8232 04d4 6A065B17 		.word	391841386
 8233 04d8 13816479 		.word	2036629779
 8234 04dc 873F6E94 		.word	-1804714105
 8235 04e0 3DA766B0 		.word	-1335449795
 8236 04e4 75311148 		.word	1209086325
 8237 04e8 9677F8E3 		.word	-470255722
 8238 04ec 46E9ABD0 		.word	-794039994
 8239 04f0 9E5333D8 		.word	-667724898
 8240 04f4 BA980824 		.word	604543162
 8241 04f8 CB3BFC71 		.word	1912355787
 8242 04fc A3F45568 		.word	1750463651
 8243 0500 CFA9196C 		.word	1813621199
 8244 0504 5D4C0492 		.word	-1845212067
 8245 0508 E51DFEB8 		.word	-1191305755
 8246 050c 51FA2AB4 		.word	-1272251823
 8247 0510 66B07531 		.word	829796454
 8248 0514 11489677 		.word	2006337553
 8249 0518 F8E346E9 		.word	-381230088
 8250 051c ABD09E53 		.word	1402917035
ARM GAS  /tmp/ccxsBJK4.s 			page 212


 8251 0520 33D8BA98 		.word	-1732585421
 8252 0524 0824CB3B 		.word	1003168776
 8253 0528 FC71A3F4 		.word	-190615044
 8254 052c 5568CFA9 		.word	-1446025131
 8255 0530 196C5D4C 		.word	1281190937
 8256 0534 0492E51D 		.word	501584388
 8257 0538 FEB851FA 		.word	-95307522
 8258 053c 2AB4E7D4 		.word	-723012566
 8259 0540 AF427B4E 		.word	1316700847
 8260 0544 CD60EB62 		.word	1659592909
 8261 0548 22902CEF 		.word	-282292190
 8262 054c F0C78DD2 		.word	-762460176
 8263 0550 57A13DA7 		.word	-1489133225
 8264 0554 66B07531 		.word	829796454
 8265 0558 11489677 		.word	2006337553
 8266 055c F8E346E9 		.word	-381230088
 8267 0560 ABD09E53 		.word	1402917035
 8268 0564 33D8BA98 		.word	-1732585421
 8269 0568 0824CB3B 		.word	1003168776
 8270 056c FC71A3F4 		.word	-190615044
 8271 0570 980824CB 		.word	-886830952
 8272 0574 3BFC71A3 		.word	-1552810949
 8273 0578 F45568CF 		.word	-815245836
 8274 057c A9196C5D 		.word	1567365545
 8275 0580 4C0492E5 		.word	-443415476
 8276 0584 1DFEB851 		.word	1371078173
 8277 0588 FA2AB4E7 		.word	-407622918
 8278 058c D40CB62E 		.word	783682772
 8279 0590 2602C9F2 		.word	-221707738
 8280 0594 0E7FDC28 		.word	685539086
 8281 0598 7D15DA73 		.word	1943672189
 8282 059c 6A065B17 		.word	391841386
 8283 05a0 51FA2AB4 		.word	-1272251823
 8284 05a4 E7D40CB6 		.word	-1240673049
 8285 05a8 2E2602C9 		.word	-922606034
 8286 05ac F20E7FDC 		.word	-595652878
 8287 05b0 287D15DA 		.word	-636125912
 8288 05b4 736A065B 		.word	1527147123
 8289 05b8 17138164 		.word	1686180631
 8290 05bc 79873F6E 		.word	1849657209
 8291 05c0 94BE0AED 		.word	-318062956
 8292 05c4 393583AD 		.word	-1383910087
 8293 05c8 8B8940B2 		.word	-1304393333
 8294 05cc BCC31F37 		.word	924828604
 8295 05d0 0AED3935 		.word	892988682
 8296 05d4 83AD8B89 		.word	-1987334781
 8297 05d8 40B2BCC3 		.word	-1011043776
 8298 05dc 1F374A5F 		.word	1598699295
 8299 05e0 85F69C9A 		.word	-1700989307
 8300 05e4 C1D6C544 		.word	1153816257
 8301 05e8 2059DEE1 		.word	-505521888
 8302 05ec 8F1BA5AF 		.word	-1348134001
 8303 05f0 427B4ECD 		.word	-850494654
 8304 05f4 60EB6222 		.word	576908128
 8305 05f8 902CEFF0 		.word	-252760944
 8306 05fc C78DD257 		.word	1473416647
 8307 0600 C31F374A 		.word	1245126595
ARM GAS  /tmp/ccxsBJK4.s 			page 213


 8308 0604 5F85F69C 		.word	-1661565601
 8309 0608 9AC1D6C5 		.word	-975781478
 8310 060c 442059DE 		.word	-564584380
 8311 0610 E18F1BA5 		.word	-1524920351
 8312 0614 AF427B4E 		.word	1316700847
 8313 0618 CD60EB62 		.word	1659592909
 8314 061c 22902CEF 		.word	-282292190
 8315 0620 F0C78DD2 		.word	-762460176
 8316 0624 57A13DA7 		.word	-1489133225
 8317 0628 66B07531 		.word	829796454
 8318 062c 11489677 		.word	2006337553
 8319 0630 BCC31F37 		.word	924828604
 8320 0634 4A5F85F6 		.word	-159031478
 8321 0638 9C9AC1D6 		.word	-691955044
 8322 063c C5442059 		.word	1495286981
 8323 0640 DEE18F1B 		.word	462414302
 8324 0644 A5AF427B 		.word	2067967909
 8325 0648 4ECD60EB 		.word	-345977522
 8326 064c 6222902C 		.word	747643490
 8327 0650 EFF0C78D 		.word	-1916276497
 8328 0654 D257A13D 		.word	1033983954
 8329 0658 A766B075 		.word	1974494887
 8330 065c 31114896 		.word	-1773661903
 8331 0660 75311148 		.word	1209086325
 8332 0664 9677F8E3 		.word	-470255722
 8333 0668 46E9ABD0 		.word	-794039994
 8334 066c 9E5333D8 		.word	-667724898
 8335 0670 BA980824 		.word	604543162
 8336 0674 CB3BFC71 		.word	1912355787
 8337 0678 A3F45568 		.word	1750463651
 8338 067c CFA9196C 		.word	1813621199
 8339 0680 5D4C0492 		.word	-1845212067
 8340 0684 E51DFEB8 		.word	-1191305755
 8341 0688 51FA2AB4 		.word	-1272251823
 8342 068c E7D40CB6 		.word	-1240673049
 8343 0690 2E2602C9 		.word	-922606034
 8344 0694 F20E7FDC 		.word	-595652878
 8345 0698 287D15DA 		.word	-636125912
 8346 069c 736A065B 		.word	1527147123
 8347 06a0 17138164 		.word	1686180631
 8348 06a4 79873F6E 		.word	1849657209
 8349 06a8 94BE0AED 		.word	-318062956
 8350 06ac 393583AD 		.word	-1383910087
 8351 06b0 8B8940B2 		.word	-1304393333
 8352 06b4 BCC31F37 		.word	924828604
 8353 06b8 4A5F85F6 		.word	-159031478
 8354 06bc 9C9AC1D6 		.word	-691955044
 8355 06c0 E7D40CB6 		.word	-1240673049
 8356 06c4 2E2602C9 		.word	-922606034
 8357 06c8 F20E7FDC 		.word	-595652878
 8358 06cc 287D15DA 		.word	-636125912
 8359 06d0 736A065B 		.word	1527147123
 8360 06d4 17138164 		.word	1686180631
 8361 06d8 79873F6E 		.word	1849657209
 8362 06dc 94BE0AED 		.word	-318062956
 8363 06e0 393583AD 		.word	-1383910087
 8364 06e4 8B8940B2 		.word	-1304393333
ARM GAS  /tmp/ccxsBJK4.s 			page 214


 8365 06e8 BCC31F37 		.word	924828604
 8366 06ec 4A5F85F6 		.word	-159031478
 8367 06f0 60EB6222 		.word	576908128
 8368 06f4 902CEFF0 		.word	-252760944
 8369 06f8 C78DD257 		.word	1473416647
 8370 06fc A13DA766 		.word	1722236321
 8371 0700 B0753111 		.word	288454064
 8372 0704 489677F8 		.word	-126380472
 8373 0708 E346E9AB 		.word	-1410775325
 8374 070c D09E5333 		.word	861118160
 8375 0710 D8BA9808 		.word	144227032
 8376 0714 24CB3BFC 		.word	-63190236
 8377 0718 71A3F455 		.word	1442095985
 8378 071c 68CFA919 		.word	430559080
 8379 0720 A9196C5D 		.word	1567365545
 8380 0724 4C0492E5 		.word	-443415476
 8381 0728 1DFEB851 		.word	1371078173
 8382 072c FA2AB4E7 		.word	-407622918
 8383 0730 D40CB62E 		.word	783682772
 8384 0734 2602C9F2 		.word	-221707738
 8385 0738 0E7FDC28 		.word	685539086
 8386 073c 7D15DA73 		.word	1943672189
 8387 0740 6A065B17 		.word	391841386
 8388 0744 13816479 		.word	2036629779
 8389 0748 873F6E94 		.word	-1804714105
 8390 074c BE0AED39 		.word	971836094
 8391 0750 F20E7FDC 		.word	-595652878
 8392 0754 287D15DA 		.word	-636125912
 8393 0758 736A065B 		.word	1527147123
 8394 075c 17138164 		.word	1686180631
 8395 0760 79873F6E 		.word	1849657209
 8396 0764 94BE0AED 		.word	-318062956
 8397 0768 393583AD 		.word	-1383910087
 8398 076c 8B8940B2 		.word	-1304393333
 8399 0770 BCC31F37 		.word	924828604
 8400 0774 4A5F85F6 		.word	-159031478
 8401 0778 9C9AC1D6 		.word	-691955044
 8402 077c C5442059 		.word	1495286981
 8403 0780 3BFC71A3 		.word	-1552810949
 8404 0784 F45568CF 		.word	-815245836
 8405 0788 A9196C5D 		.word	1567365545
 8406 078c 4C0492E5 		.word	-443415476
 8407 0790 1DFEB851 		.word	1371078173
 8408 0794 FA2AB4E7 		.word	-407622918
 8409 0798 D40CB62E 		.word	783682772
 8410 079c 2602C9F2 		.word	-221707738
 8411 07a0 0E7FDC28 		.word	685539086
 8412 07a4 7D15DA73 		.word	1943672189
 8413 07a8 6A065B17 		.word	391841386
 8414 07ac 13816479 		.word	2036629779
 8415 07b0 442059DE 		.word	-564584380
 8416 07b4 E18F1BA5 		.word	-1524920351
 8417 07b8 AF427B4E 		.word	1316700847
 8418 07bc CD60EB62 		.word	1659592909
 8419 07c0 22902CEF 		.word	-282292190
 8420 07c4 F0C78DD2 		.word	-762460176
 8421 07c8 57A13DA7 		.word	-1489133225
ARM GAS  /tmp/ccxsBJK4.s 			page 215


 8422 07cc 66B07531 		.word	829796454
 8423 07d0 11489677 		.word	2006337553
 8424 07d4 F8E346E9 		.word	-381230088
 8425 07d8 ABD09E53 		.word	1402917035
 8426 07dc 33D8BA98 		.word	-1732585421
 8427 07e0 8DD257A1 		.word	-1588079987
 8428 07e4 3DA766B0 		.word	-1335449795
 8429 07e8 75311148 		.word	1209086325
 8430 07ec 9677F8E3 		.word	-470255722
 8431 07f0 46E9ABD0 		.word	-794039994
 8432 07f4 9E5333D8 		.word	-667724898
 8433 07f8 BA980824 		.word	604543162
 8434 07fc CB3BFC71 		.word	1912355787
 8435 0800 A3F45568 		.word	1750463651
 8436 0804 CFA9196C 		.word	1813621199
 8437 0808 5D4C0492 		.word	-1845212067
 8438 080c E51DFEB8 		.word	-1191305755
 8439 0810 D6C54420 		.word	541378006
 8440 0814 59DEE18F 		.word	-1881022887
 8441 0818 1BA5AF42 		.word	1118807323
 8442 081c 7B4ECD60 		.word	1624067707
 8443 0820 EB622290 		.word	-1876794645
 8444 0824 2CEFF0C7 		.word	-940511444
 8445 0828 8DD257A1 		.word	-1588079987
 8446 082c 3DA766B0 		.word	-1335449795
 8447 0830 75311148 		.word	1209086325
 8448 0834 9677F8E3 		.word	-470255722
 8449 0838 46E9ABD0 		.word	-794039994
 8450 083c 9E5333D8 		.word	-667724898
 8451 0840 1F374A5F 		.word	1598699295
 8452 0844 85F69C9A 		.word	-1700989307
 8453 0848 C1D6C544 		.word	1153816257
 8454 084c 2059DEE1 		.word	-505521888
 8455 0850 8F1BA5AF 		.word	-1348134001
 8456 0854 427B4ECD 		.word	-850494654
 8457 0858 60EB6222 		.word	576908128
 8458 085c 902CEFF0 		.word	-252760944
 8459 0860 C78DD257 		.word	1473416647
 8460 0864 A13DA766 		.word	1722236321
 8461 0868 B0753111 		.word	288454064
 8462 086c 489677F8 		.word	-126380472
 8465              	hop_interval_lut:
 8466 0870 00       		.byte	0
 8467 0871 01       		.byte	1
 8468 0872 13       		.byte	19
 8469 0873 19       		.byte	25
 8470 0874 1C       		.byte	28
 8471 0875 0F       		.byte	15
 8472 0876 1F       		.byte	31
 8473 0877 10       		.byte	16
 8474 0878 0E       		.byte	14
 8475 0879 21       		.byte	33
 8476 087a 1A       		.byte	26
 8477 087b 1B       		.byte	27
 8478 087c 22       		.byte	34
 8479 087d 14       		.byte	20
 8480 087e 08       		.byte	8
ARM GAS  /tmp/ccxsBJK4.s 			page 216


 8481 087f 05       		.byte	5
 8482 0880 07       		.byte	7
 8483 0881 18       		.byte	24
 8484 0882 23       		.byte	35
 8485 0883 02       		.byte	2
 8486 0884 0D       		.byte	13
 8487 0885 1E       		.byte	30
 8488 0886 20       		.byte	32
 8489 0887 1D       		.byte	29
 8490 0888 11       		.byte	17
 8491 0889 03       		.byte	3
 8492 088a 0A       		.byte	10
 8493 088b 0B       		.byte	11
 8494 088c 04       		.byte	4
 8495 088d 17       		.byte	23
 8496 088e 15       		.byte	21
 8497 088f 06       		.byte	6
 8498 0890 16       		.byte	22
 8499 0891 09       		.byte	9
 8500 0892 0C       		.byte	12
 8501 0893 12       		.byte	18
 8502 0894 24       		.byte	36
 8503 0895 000000   		.space	3
 8504              	.LC0:
 8505 0898 01000000 		.word	1
 8506 089c 01000000 		.word	1
 8507 08a0 01000000 		.word	1
 8508 08a4 01000000 		.word	1
 8509              	.LC1:
 8510 08a8 42       		.byte	66
 8511 08a9 1E       		.byte	30
 8512 08aa FF       		.byte	-1
 8513 08ab FF       		.byte	-1
 8514 08ac FF       		.byte	-1
 8515 08ad FF       		.byte	-1
 8516 08ae FF       		.byte	-1
 8517 08af FF       		.byte	-1
 8518 08b0 03       		.byte	3
 8519 08b1 03       		.byte	3
 8520 08b2 AA       		.byte	-86
 8521 08b3 FE       		.byte	-2
 8522 08b4 13       		.byte	19
 8523 08b5 16       		.byte	22
 8524 08b6 AA       		.byte	-86
 8525 08b7 FE       		.byte	-2
 8526 08b8 10       		.byte	16
 8527 08b9 00       		.byte	0
 8528 08ba 02       		.byte	2
 8529 08bb AA       		.byte	-86
 8530 08bc 4D       		.byte	77
 8531 08bd 57       		.byte	87
 8532 08be 4E       		.byte	78
 8533 08bf 4C       		.byte	76
 8534 08c0 5F       		.byte	95
 8535 08c1 33       		.byte	51
 8536 08c2 30       		.byte	48
 8537 08c3 31       		.byte	49
ARM GAS  /tmp/ccxsBJK4.s 			page 217


 8538 08c4 AA       		.byte	-86
 8539 08c5 6D       		.byte	109
 8540 08c6 77       		.byte	119
 8541 08c7 6E       		.byte	110
 8542 08c8 FF       		.byte	-1
 8543 08c9 FF       		.byte	-1
 8544 08ca FF       		.byte	-1
 8545 08cb 00       		.space	1
 8546              	.LC2:
 8547 08cc 6C09     		.short	2412
 8548 08ce 8509     		.short	2437
 8549 08d0 9E09     		.short	2462
 8550 08d2 0000     		.section	.rodata.str1.1,"aMS",%progbits,1
 8551              	.LC3:
 8552 0000 32303137 		.ascii	"2017-03-R2\000"
 8552      2D30332D 
 8552      523200
 8553              		.data
 8554              		.align	2
 8555              		.set	.LANCHOR1,. + 0
 8558              	channel:
 8559 0000 8909     		.short	2441
 8560 0002 0000     		.space	2
 8563              	le:
 8564 0004 D6BE898E 		.word	-1903575338
 8565 0008 7D6B     		.short	27517
 8566 000a 7191     		.short	-28303
 8567 000c 55555500 		.word	5592405
 8568 0010 AAAAAA00 		.word	11184810
 8569 0014 00000000 		.word	0
 8570 0018 00       		.byte	0
 8571 0019 000000   		.space	3
 8572 001c 00000000 		.word	0
 8573 0020 00000000 		.space	32
 8573      00000000 
 8573      00000000 
 8573      00000000 
 8573      00000000 
 8574 0040 00000000 		.word	0
 8575 0044 00000000 		.word	0
 8578              	hop_timeout:
 8579 0048 9E00     		.short	158
 8582              	le_adv_channel:
 8583 004a 6209     		.short	2402
 8586              	low_freq:
 8587 004c 6009     		.short	2400
 8590              	high_freq:
 8591 004e B309     		.short	2483
 8594              	rssi_threshold:
 8595 0050 E2       		.byte	-30
 8596 0051 000000   		.bss
 8597              		.align	2
 8598              		.set	.LANCHOR0,. + 0
 8601              	modulation:
 8602 0000 00       		.space	1
 8605              	status:
 8606 0001 00       		.space	1
ARM GAS  /tmp/ccxsBJK4.s 			page 218


 8609              	idle_buf_clkn_high:
 8610 0002 00       		.space	1
 8611 0003 00       		.space	1
 8614              	idle_buf_clk100ns:
 8615 0004 00000000 		.space	4
 8618              	idle_buf_channel:
 8619 0008 0000     		.space	2
 8622              	hop_mode:
 8623 000a 00       		.space	1
 8626              	do_hop:
 8627 000b 00       		.space	1
 8630              	hop_direct_channel:
 8631 000c 0000     		.space	2
 8634              	requested_channel:
 8635 000e 0000     		.space	2
 8638              	dma_discard:
 8639 0010 00       		.space	1
 8642              	mode:
 8643 0011 00       		.space	1
 8646              	requested_mode:
 8647 0012 00       		.space	1
 8650              	jam_mode:
 8651 0013 00       		.space	1
 8654              	ego_mode:
 8655 0014 00       		.space	1
 8656 0015 000000   		.space	3
 8659              	packet_cb:
 8660 0018 00000000 		.space	4
 8663              	le_jam_count:
 8664 001c 00000000 		.space	4
 8667              	slave_mac_address:
 8668 0020 00000000 		.space	6
 8668      0000
 8669 0026 0000     		.space	2
 8672              	data_cb:
 8673 0028 00000000 		.space	4
 8676              	restart_jamming.4791:
 8677 002c 00000000 		.space	4
 8680              	first_ts.4888:
 8681 0030 00000000 		.space	4
 8684              	prev_clk.4894:
 8685 0034 00000000 		.space	4
 8686              		.text
 8687              	.Letext0:
 8688              		.file 2 "/usr/lib/gcc/arm-none-eabi/4.8.2/include/stddef.h"
 8689              		.file 3 "/usr/lib/gcc/arm-none-eabi/4.8.2/include/stdint-gcc.h"
 8690              		.file 4 "../../host/libubertooth/src/ubertooth_interface.h"
 8691              		.file 5 "../common/ubertooth.h"
 8692              		.file 6 "ubertooth_usb.h"
 8693              		.file 7 "bluetooth_le.h"
 8694              		.file 8 "ego.h"
 8695              		.file 9 "ubertooth_rssi.h"
 8696              		.file 10 "ubertooth_cs.h"
 8697              		.file 11 "ubertooth_dma.h"
 8698              		.file 12 "ubertooth_clock.h"
 8699              		.file 13 "bluetooth.h"
 8700              		.file 14 "cc2400_rangetest.h"
ARM GAS  /tmp/ccxsBJK4.s 			page 219


 8701              		.file 15 "/usr/include/newlib/string.h"
ARM GAS  /tmp/ccxsBJK4.s 			page 220


DEFINED SYMBOLS
                            *ABS*:0000000000000000 bluetooth_rxtx.c
     /tmp/ccxsBJK4.s:19     .text.reverse8:0000000000000000 $t
     /tmp/ccxsBJK4.s:23     .text.reverse8:0000000000000000 reverse8
     /tmp/ccxsBJK4.s:72     .text.cc2400_rx:0000000000000000 $t
     /tmp/ccxsBJK4.s:76     .text.cc2400_rx:0000000000000000 cc2400_rx
     /tmp/ccxsBJK4.s:189    .text.cc2400_rx:0000000000000098 $d
     /tmp/ccxsBJK4.s:196    .text.cc2400_rx_sync:0000000000000000 $t
     /tmp/ccxsBJK4.s:200    .text.cc2400_rx_sync:0000000000000000 cc2400_rx_sync
     /tmp/ccxsBJK4.s:325    .text.cc2400_rx_sync:00000000000000a4 $d
     /tmp/ccxsBJK4.s:332    .text.enqueue:0000000000000000 $t
     /tmp/ccxsBJK4.s:336    .text.enqueue:0000000000000000 enqueue
     /tmp/ccxsBJK4.s:446    .text.enqueue:0000000000000084 $d
                            *COM*:0000000000000004 clkn
                            *COM*:0000000000000001 rssi_min
                            *COM*:0000000000000001 rssi_max
                            *COM*:0000000000000001 rssi_count
     /tmp/ccxsBJK4.s:456    .text.le_set_access_address:0000000000000000 $t
     /tmp/ccxsBJK4.s:460    .text.le_set_access_address:0000000000000000 le_set_access_address
     /tmp/ccxsBJK4.s:487    .text.le_set_access_address:0000000000000014 $d
     /tmp/ccxsBJK4.s:492    .text.cc2400_idle:0000000000000000 $t
     /tmp/ccxsBJK4.s:496    .text.cc2400_idle:0000000000000000 cc2400_idle
     /tmp/ccxsBJK4.s:610    .text.cc2400_idle:000000000000009c $d
                            *COM*:0000000000000010 target
     /tmp/ccxsBJK4.s:618    .text.cb_follow_le:0000000000000000 $t
     /tmp/ccxsBJK4.s:623    .text.cb_follow_le:0000000000000000 cb_follow_le
     /tmp/ccxsBJK4.s:837    .text.cb_follow_le:00000000000000ec $d
                            *COM*:0000000000000320 unpacked
                            *COM*:0000000000000004 idle_rxbuf
     /tmp/ccxsBJK4.s:847    .text.connection_follow_cb:0000000000000000 $t
     /tmp/ccxsBJK4.s:852    .text.connection_follow_cb:0000000000000000 connection_follow_cb
     /tmp/ccxsBJK4.s:1123   .text.connection_follow_cb:0000000000000164 $d
     /tmp/ccxsBJK4.s:1133   .text.vendor_request_handler:0000000000000000 $t
     /tmp/ccxsBJK4.s:1137   .text.vendor_request_handler:0000000000000000 vendor_request_handler
     /tmp/ccxsBJK4.s:1163   .text.vendor_request_handler:0000000000000014 $d
     /tmp/ccxsBJK4.s:1242   .text.vendor_request_handler:00000000000000b0 $t
     /tmp/ccxsBJK4.s:1765   .text.vendor_request_handler:0000000000000344 $d
                            *COM*:0000000000000005 rr
                            *COM*:0000000000000001 cs_threshold_req
     /tmp/ccxsBJK4.s:1783   .text.vendor_request_handler:0000000000000380 $t
     /tmp/ccxsBJK4.s:2383   .text.vendor_request_handler:0000000000000634 $d
                            *COM*:0000000000000004 clkn_offset
                            *COM*:0000000000000002 clk100ns_offset
                            *COM*:000000000000000a afh_map
                            *COM*:0000000000000001 used_channels
                            *COM*:0000000000000001 afh_enabled
                            *COM*:0000000000000002 clk_drift_ppm
                            *COM*:0000000000000004 clkn_next_drift_fix
                            *COM*:0000000000000002 clk_drift_correction
                            *COM*:0000000000000004 clkn_last_drift_fix
                            *COM*:000000000000003a tx_pkt
     /tmp/ccxsBJK4.s:2400   .text.vendor_request_handler:000000000000066c $t
     /tmp/ccxsBJK4.s:2512   .text.vendor_request_handler:00000000000006f0 $d
     /tmp/ccxsBJK4.s:2518   .text.enqueue_with_ts:0000000000000000 $t
     /tmp/ccxsBJK4.s:2523   .text.enqueue_with_ts:0000000000000000 enqueue_with_ts
     /tmp/ccxsBJK4.s:2599   .text.enqueue_with_ts:0000000000000050 $d
     /tmp/ccxsBJK4.s:2605   .text.TIMER0_IRQHandler:0000000000000000 $t
ARM GAS  /tmp/ccxsBJK4.s 			page 221


     /tmp/ccxsBJK4.s:2610   .text.TIMER0_IRQHandler:0000000000000000 TIMER0_IRQHandler
     /tmp/ccxsBJK4.s:2809   .text.TIMER0_IRQHandler:0000000000000110 $d
                            *COM*:0000000000000004 last_hop
     /tmp/ccxsBJK4.s:2826   .text.EINT3_IRQHandler:0000000000000000 $t
     /tmp/ccxsBJK4.s:2831   .text.EINT3_IRQHandler:0000000000000000 EINT3_IRQHandler
     /tmp/ccxsBJK4.s:2862   .text.EINT3_IRQHandler:0000000000000024 $d
                            *COM*:0000000000000001 cs_trigger
     /tmp/ccxsBJK4.s:2870   .text.DMA_IRQHandler:0000000000000000 $t
     /tmp/ccxsBJK4.s:2875   .text.DMA_IRQHandler:0000000000000000 DMA_IRQHandler
     /tmp/ccxsBJK4.s:3028   .text.DMA_IRQHandler:00000000000000d4 $d
                            *COM*:0000000000000004 active_rxbuf
                            *COM*:0000000000000004 rx_tc
                            *COM*:0000000000000004 rx_err
     /tmp/ccxsBJK4.s:3046   .text.le_transmit:0000000000000000 $t
     /tmp/ccxsBJK4.s:3051   .text.le_transmit:0000000000000000 le_transmit
     /tmp/ccxsBJK4.s:3341   .text.le_transmit:0000000000000194 $d
     /tmp/ccxsBJK4.s:3351   .text.le_jam:0000000000000000 $t
     /tmp/ccxsBJK4.s:3356   .text.le_jam:0000000000000000 le_jam
     /tmp/ccxsBJK4.s:3437   .text.le_jam:0000000000000074 $d
     /tmp/ccxsBJK4.s:3442   .text.hop:0000000000000000 $t
     /tmp/ccxsBJK4.s:3447   .text.hop:0000000000000000 hop
     /tmp/ccxsBJK4.s:3694   .text.hop:0000000000000180 $d
     /tmp/ccxsBJK4.s:3706   .text.bt_stream_rx:0000000000000000 $t
     /tmp/ccxsBJK4.s:3711   .text.bt_stream_rx:0000000000000000 bt_stream_rx
     /tmp/ccxsBJK4.s:3931   .text.bt_stream_rx:000000000000012c $d
                            *COM*:0000000000000001 cs_threshold_cur
                            *COM*:0000000000000001 cs_no_squelch
     /tmp/ccxsBJK4.s:3947   .text.br_transmit:0000000000000000 $t
     /tmp/ccxsBJK4.s:3952   .text.br_transmit:0000000000000000 br_transmit
     /tmp/ccxsBJK4.s:4375   .text.br_transmit:000000000000025c $d
     /tmp/ccxsBJK4.s:4388   .text.reset_le:0000000000000000 $t
     /tmp/ccxsBJK4.s:4393   .text.reset_le:0000000000000000 reset_le
     /tmp/ccxsBJK4.s:4455   .text.reset_le:0000000000000040 $d
     /tmp/ccxsBJK4.s:4464   .text.reset_le_promisc:0000000000000000 $t
     /tmp/ccxsBJK4.s:4469   .text.reset_le_promisc:0000000000000000 reset_le_promisc
     /tmp/ccxsBJK4.s:4493   .text.reset_le_promisc:000000000000001c $d
                            *COM*:0000000000000108 le_promisc
     /tmp/ccxsBJK4.s:4498   .text.bt_generic_le:0000000000000000 $t
     /tmp/ccxsBJK4.s:4503   .text.bt_generic_le:0000000000000000 bt_generic_le
     /tmp/ccxsBJK4.s:4842   .text.bt_generic_le:00000000000001ac $d
     /tmp/ccxsBJK4.s:4861   .text.bt_le_sync:0000000000000000 $t
     /tmp/ccxsBJK4.s:4866   .text.bt_le_sync:0000000000000000 bt_le_sync
     /tmp/ccxsBJK4.s:5363   .text.bt_le_sync:00000000000002c4 $d
                            *COM*:0000000000000032 rxbuf1
     /tmp/ccxsBJK4.s:5385   .text.bt_le_sync:0000000000000314 $t
     /tmp/ccxsBJK4.s:5510   .text.bt_le_sync:00000000000003cc $d
     /tmp/ccxsBJK4.s:5517   .text.bt_follow_le:0000000000000000 $t
     /tmp/ccxsBJK4.s:5522   .text.bt_follow_le:0000000000000000 bt_follow_le
     /tmp/ccxsBJK4.s:5552   .text.bt_follow_le:0000000000000018 $d
     /tmp/ccxsBJK4.s:5558   .text.le_promisc_state:0000000000000000 $t
     /tmp/ccxsBJK4.s:5563   .text.le_promisc_state:0000000000000000 le_promisc_state
     /tmp/ccxsBJK4.s:5617   .text.promisc_recover_hop_increment:0000000000000000 $t
     /tmp/ccxsBJK4.s:5622   .text.promisc_recover_hop_increment:0000000000000000 promisc_recover_hop_increment
     /tmp/ccxsBJK4.s:5775   .text.promisc_recover_hop_increment:00000000000000c8 $d
     /tmp/ccxsBJK4.s:5785   .text.promisc_recover_hop_interval:0000000000000000 $t
     /tmp/ccxsBJK4.s:5790   .text.promisc_recover_hop_interval:0000000000000000 promisc_recover_hop_interval
     /tmp/ccxsBJK4.s:5913   .text.promisc_recover_hop_interval:0000000000000098 $d
ARM GAS  /tmp/ccxsBJK4.s 			page 222


     /tmp/ccxsBJK4.s:5924   .text.promisc_follow_cb:0000000000000000 $t
     /tmp/ccxsBJK4.s:5929   .text.promisc_follow_cb:0000000000000000 promisc_follow_cb
     /tmp/ccxsBJK4.s:6025   .text.promisc_follow_cb:0000000000000064 $d
     /tmp/ccxsBJK4.s:6036   .text.see_aa:0000000000000000 $t
     /tmp/ccxsBJK4.s:6041   .text.see_aa:0000000000000000 see_aa
     /tmp/ccxsBJK4.s:6120   .text.see_aa:0000000000000058 $d
     /tmp/ccxsBJK4.s:6125   .text.cb_le_promisc:0000000000000000 $t
     /tmp/ccxsBJK4.s:6130   .text.cb_le_promisc:0000000000000000 cb_le_promisc
     /tmp/ccxsBJK4.s:6445   .text.cb_le_promisc:000000000000017c $d
     /tmp/ccxsBJK4.s:6458   .text.bt_promisc_le:0000000000000000 $t
     /tmp/ccxsBJK4.s:6463   .text.bt_promisc_le:0000000000000000 bt_promisc_le
     /tmp/ccxsBJK4.s:6542   .text.bt_promisc_le:000000000000005c $d
     /tmp/ccxsBJK4.s:6551   .text.bt_slave_le:0000000000000000 $t
     /tmp/ccxsBJK4.s:6556   .text.bt_slave_le:0000000000000000 bt_slave_le
     /tmp/ccxsBJK4.s:6723   .text.bt_slave_le:00000000000000d0 $d
     /tmp/ccxsBJK4.s:6735   .text.rx_generic_sync:0000000000000000 $t
     /tmp/ccxsBJK4.s:6740   .text.rx_generic_sync:0000000000000000 rx_generic_sync
     /tmp/ccxsBJK4.s:6852   .text.rx_generic_sync:0000000000000094 $d
     /tmp/ccxsBJK4.s:6859   .text.rx_generic:0000000000000000 $t
     /tmp/ccxsBJK4.s:6864   .text.rx_generic:0000000000000000 rx_generic
     /tmp/ccxsBJK4.s:6895   .text.rx_generic:000000000000001c $d
     /tmp/ccxsBJK4.s:6900   .text.tx_generic:0000000000000000 $t
     /tmp/ccxsBJK4.s:6905   .text.tx_generic:0000000000000000 tx_generic
     /tmp/ccxsBJK4.s:7063   .text.tx_generic:00000000000000dc $d
     /tmp/ccxsBJK4.s:7073   .text.specan:0000000000000000 $t
     /tmp/ccxsBJK4.s:7078   .text.specan:0000000000000000 specan
     /tmp/ccxsBJK4.s:7265   .text.specan:00000000000000fc $d
     /tmp/ccxsBJK4.s:7275   .text.led_specan:0000000000000000 $t
     /tmp/ccxsBJK4.s:7280   .text.led_specan:0000000000000000 led_specan
     /tmp/ccxsBJK4.s:7484   .text.led_specan:0000000000000114 $d
     /tmp/ccxsBJK4.s:7495   .text.startup.main:0000000000000000 $t
     /tmp/ccxsBJK4.s:7500   .text.startup.main:0000000000000000 main
     /tmp/ccxsBJK4.s:7546   .text.startup.main:0000000000000034 $d
     /tmp/ccxsBJK4.s:7573   .text.startup.main:0000000000000098 $t
     /tmp/ccxsBJK4.s:7736   .text.startup.main:0000000000000144 $d
     /tmp/ccxsBJK4.s:8659   .bss:0000000000000018 packet_cb
     /tmp/ccxsBJK4.s:8672   .bss:0000000000000028 data_cb
     /tmp/ccxsBJK4.s:8663   .bss:000000000000001c le_jam_count
     /tmp/ccxsBJK4.s:8563   .data:0000000000000004 le
     /tmp/ccxsBJK4.s:8667   .bss:0000000000000020 slave_mac_address
     /tmp/ccxsBJK4.s:8594   .data:0000000000000050 rssi_threshold
     /tmp/ccxsBJK4.s:8590   .data:000000000000004e high_freq
     /tmp/ccxsBJK4.s:8586   .data:000000000000004c low_freq
     /tmp/ccxsBJK4.s:8601   .bss:0000000000000000 modulation
     /tmp/ccxsBJK4.s:8654   .bss:0000000000000014 ego_mode
     /tmp/ccxsBJK4.s:8650   .bss:0000000000000013 jam_mode
     /tmp/ccxsBJK4.s:8646   .bss:0000000000000012 requested_mode
     /tmp/ccxsBJK4.s:8642   .bss:0000000000000011 mode
     /tmp/ccxsBJK4.s:8605   .bss:0000000000000001 status
     /tmp/ccxsBJK4.s:8638   .bss:0000000000000010 dma_discard
     /tmp/ccxsBJK4.s:8618   .bss:0000000000000008 idle_buf_channel
     /tmp/ccxsBJK4.s:8614   .bss:0000000000000004 idle_buf_clk100ns
     /tmp/ccxsBJK4.s:8609   .bss:0000000000000002 idle_buf_clkn_high
     /tmp/ccxsBJK4.s:8582   .data:000000000000004a le_adv_channel
     /tmp/ccxsBJK4.s:8634   .bss:000000000000000e requested_channel
     /tmp/ccxsBJK4.s:8578   .data:0000000000000048 hop_timeout
     /tmp/ccxsBJK4.s:8630   .bss:000000000000000c hop_direct_channel
ARM GAS  /tmp/ccxsBJK4.s 			page 223


     /tmp/ccxsBJK4.s:8558   .data:0000000000000000 channel
     /tmp/ccxsBJK4.s:8626   .bss:000000000000000b do_hop
     /tmp/ccxsBJK4.s:8622   .bss:000000000000000a hop_mode
     /tmp/ccxsBJK4.s:7977   .rodata:00000000000000a7 compile_info
                            *COM*:0000000000000008 syncword
                            *COM*:0000000000000032 rxbuf2
     /tmp/ccxsBJK4.s:7800   .rodata:0000000000000000 $d
     /tmp/ccxsBJK4.s:7804   .rodata:0000000000000000 whitening_index
     /tmp/ccxsBJK4.s:7847   .rodata:0000000000000028 whitening
     /tmp/ccxsBJK4.s:7982   .rodata:00000000000000f0 whitening_word
     /tmp/ccxsBJK4.s:8465   .rodata:0000000000000870 hop_interval_lut
     /tmp/ccxsBJK4.s:8554   .data:0000000000000000 $d
     /tmp/ccxsBJK4.s:8597   .bss:0000000000000000 $d
     /tmp/ccxsBJK4.s:8676   .bss:000000000000002c restart_jamming.4791
     /tmp/ccxsBJK4.s:8680   .bss:0000000000000030 first_ts.4888
     /tmp/ccxsBJK4.s:8684   .bss:0000000000000034 prev_clk.4894
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
cc2400_set
cs_threshold_calc_and_set
clkn_start
cc2400_status
cc2400_strobe
usb_enqueue
rssi_get_avg
memcpy
rbit
clkn_stop
dio_ssp_stop
cs_reset
rssi_reset
btle_channel_index
btle_crcgen_lut
memcmp
__aeabi_llsl
get_part_num
get_device_serial
cc2400_get
set_isp
strlen
precalc
bootloader_ctrl
dequeue
queue_init
cc2400_fifo_write
next_hop
btle_next_hop
dio_ssp_init
dma_init
dio_ssp_start
cs_trigger_enable
rssi_add
handle_usb
rssi_iir_update
cs_trigger_disable
memset
ARM GAS  /tmp/ccxsBJK4.s 			page 224


dma_init_le
btle_reverse_crc
btle_calc_crc
cc2400_fifo_read
ubertooth_init
clkn_init
ubertooth_usb_init
wait
reset
cc2400_txtest
cc2400_rangetest
cc2400_repeater
ego_main
