ARM GAS  /tmp/ccCuKxzC.s 			page 1


   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"bluetooth_rxtx.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.msleep,"ax",%progbits
  19              		.align	1
  20              		.thumb
  21              		.thumb_func
  23              	msleep:
  24              	.LFB6:
  25              		.file 1 "bluetooth_rxtx.c"
   1:bluetooth_rxtx.c **** /*
   2:bluetooth_rxtx.c ****  * Copyright 2010-2013 Michael Ossmann
   3:bluetooth_rxtx.c ****  * Copyright 2011-2013 Dominic Spill
   4:bluetooth_rxtx.c ****  *
   5:bluetooth_rxtx.c ****  * This file is part of Project Ubertooth.
   6:bluetooth_rxtx.c ****  *
   7:bluetooth_rxtx.c ****  * This program is free software; you can redistribute it and/or modify
   8:bluetooth_rxtx.c ****  * it under the terms of the GNU General Public License as published by
   9:bluetooth_rxtx.c ****  * the Free Software Foundation; either version 2, or (at your option)
  10:bluetooth_rxtx.c ****  * any later version.
  11:bluetooth_rxtx.c ****  *
  12:bluetooth_rxtx.c ****  * This program is distributed in the hope that it will be useful,
  13:bluetooth_rxtx.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  14:bluetooth_rxtx.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  15:bluetooth_rxtx.c ****  * GNU General Public License for more details.
  16:bluetooth_rxtx.c ****  *
  17:bluetooth_rxtx.c ****  * You should have received a copy of the GNU General Public License
  18:bluetooth_rxtx.c ****  * along with this program; see the file COPYING.  If not, write to
  19:bluetooth_rxtx.c ****  * the Free Software Foundation, Inc., 51 Franklin Street,
  20:bluetooth_rxtx.c ****  * Boston, MA 02110-1301, USA.
  21:bluetooth_rxtx.c ****  */
  22:bluetooth_rxtx.c **** 
  23:bluetooth_rxtx.c **** #include <string.h>
  24:bluetooth_rxtx.c **** #include <stdlib.h>
  25:bluetooth_rxtx.c **** 
  26:bluetooth_rxtx.c **** #include "ubertooth.h"
  27:bluetooth_rxtx.c **** #include "ubertooth_usb.h"
  28:bluetooth_rxtx.c **** #include "ubertooth_interface.h"
  29:bluetooth_rxtx.c **** #include "ubertooth_rssi.h"
  30:bluetooth_rxtx.c **** #include "ubertooth_cs.h"
  31:bluetooth_rxtx.c **** #include "ubertooth_dma.h"
  32:bluetooth_rxtx.c **** #include "ubertooth_clock.h"
  33:bluetooth_rxtx.c **** #include "bluetooth.h"
ARM GAS  /tmp/ccCuKxzC.s 			page 2


  34:bluetooth_rxtx.c **** #include "bluetooth_le.h"
  35:bluetooth_rxtx.c **** #include "cc2400_rangetest.h"
  36:bluetooth_rxtx.c **** #include "ego.h"
  37:bluetooth_rxtx.c **** 
  38:bluetooth_rxtx.c **** #define MIN(x,y)	((x)<(y)?(x):(y))
  39:bluetooth_rxtx.c **** #define MAX(x,y)	((x)>(y)?(x):(y))
  40:bluetooth_rxtx.c **** 
  41:bluetooth_rxtx.c **** /* build info */
  42:bluetooth_rxtx.c **** const char compile_info[] =
  43:bluetooth_rxtx.c **** 	"ubertooth " GIT_REVISION " (" COMPILE_BY "@" COMPILE_HOST ") " TIMESTAMP;
  44:bluetooth_rxtx.c **** 
  45:bluetooth_rxtx.c **** /* hopping stuff */
  46:bluetooth_rxtx.c **** volatile uint8_t  hop_mode = HOP_NONE;
  47:bluetooth_rxtx.c **** volatile uint8_t  do_hop = 0;                  // set by timer interrupt
  48:bluetooth_rxtx.c **** volatile uint16_t channel = 2441;
  49:bluetooth_rxtx.c **** volatile uint16_t hop_direct_channel = 0;      // for hopping directly to a channel
  50:bluetooth_rxtx.c **** volatile uint16_t hop_timeout = 158;
  51:bluetooth_rxtx.c **** volatile uint16_t requested_channel = 0;
  52:bluetooth_rxtx.c **** volatile uint16_t le_adv_channel = 2402;
  53:bluetooth_rxtx.c **** 
  54:bluetooth_rxtx.c **** /* bulk USB stuff */
  55:bluetooth_rxtx.c **** volatile uint8_t  idle_buf_clkn_high = 0;
  56:bluetooth_rxtx.c **** volatile uint32_t idle_buf_clk100ns = 0;
  57:bluetooth_rxtx.c **** volatile uint16_t idle_buf_channel = 0;
  58:bluetooth_rxtx.c **** volatile uint8_t  dma_discard = 0;
  59:bluetooth_rxtx.c **** volatile uint8_t  status = 0;
  60:bluetooth_rxtx.c **** 
  61:bluetooth_rxtx.c **** /* operation mode */
  62:bluetooth_rxtx.c **** volatile uint8_t mode = MODE_IDLE;
  63:bluetooth_rxtx.c **** volatile uint8_t requested_mode = MODE_IDLE;
  64:bluetooth_rxtx.c **** volatile uint8_t jam_mode = JAM_NONE;
  65:bluetooth_rxtx.c **** volatile uint8_t ego_mode = EGO_FOLLOW;
  66:bluetooth_rxtx.c **** 
  67:bluetooth_rxtx.c **** volatile uint8_t modulation = MOD_BT_BASIC_RATE;
  68:bluetooth_rxtx.c **** 
  69:bluetooth_rxtx.c **** /* specan stuff */
  70:bluetooth_rxtx.c **** volatile uint16_t low_freq = 2400;
  71:bluetooth_rxtx.c **** volatile uint16_t high_freq = 2483;
  72:bluetooth_rxtx.c **** volatile int8_t rssi_threshold = -30;  // -54dBm - 30 = -84dBm
  73:bluetooth_rxtx.c **** 
  74:bluetooth_rxtx.c **** /* Generic TX stuff */
  75:bluetooth_rxtx.c **** generic_tx_packet tx_pkt;
  76:bluetooth_rxtx.c **** 
  77:bluetooth_rxtx.c **** /* le stuff */
  78:bluetooth_rxtx.c **** int dlen = 0;
  79:bluetooth_rxtx.c **** uint8_t *slave_mac_address_data;
  80:bluetooth_rxtx.c **** uint8_t slave_mac_address[6] = { 0, };
  81:bluetooth_rxtx.c **** 
  82:bluetooth_rxtx.c **** //JWHUR for rssi sampling synchronization
  83:bluetooth_rxtx.c **** uint32_t now_sync = 0, start_sync =0;
  84:bluetooth_rxtx.c **** uint16_t sync_channel = 0;
  85:bluetooth_rxtx.c **** 
  86:bluetooth_rxtx.c **** le_state_t le = {
  87:bluetooth_rxtx.c **** 	.access_address = 0x8e89bed6,           // advertising channel access address
  88:bluetooth_rxtx.c **** 	.synch = 0x6b7d,                        // bit-reversed adv channel AA
  89:bluetooth_rxtx.c **** 	.syncl = 0x9171,
  90:bluetooth_rxtx.c **** 	.crc_init  = 0x555555,                  // advertising channel CRCInit
ARM GAS  /tmp/ccCuKxzC.s 			page 3


  91:bluetooth_rxtx.c **** 	.crc_init_reversed = 0xAAAAAA,
  92:bluetooth_rxtx.c **** 	.crc_verify = 0,
  93:bluetooth_rxtx.c **** 
  94:bluetooth_rxtx.c **** 	.link_state = LINK_INACTIVE,
  95:bluetooth_rxtx.c **** 	.conn_epoch = 0,
  96:bluetooth_rxtx.c **** 	.target_set = 0,
  97:bluetooth_rxtx.c **** 	.last_packet = 0,
  98:bluetooth_rxtx.c **** };
  99:bluetooth_rxtx.c **** 
 100:bluetooth_rxtx.c **** typedef struct _le_promisc_active_aa_t {
 101:bluetooth_rxtx.c **** 	u32 aa;
 102:bluetooth_rxtx.c **** 	int count;
 103:bluetooth_rxtx.c **** } le_promisc_active_aa_t;
 104:bluetooth_rxtx.c **** 
 105:bluetooth_rxtx.c **** typedef struct _le_promisc_state_t {
 106:bluetooth_rxtx.c **** 	// LFU cache of recently seen AA's
 107:bluetooth_rxtx.c **** 	le_promisc_active_aa_t active_aa[32];
 108:bluetooth_rxtx.c **** 
 109:bluetooth_rxtx.c **** 	// recovering hop interval
 110:bluetooth_rxtx.c **** 	u32 smallest_hop_interval;
 111:bluetooth_rxtx.c **** 	int consec_intervals;
 112:bluetooth_rxtx.c **** } le_promisc_state_t;
 113:bluetooth_rxtx.c **** le_promisc_state_t le_promisc;
 114:bluetooth_rxtx.c **** #define AA_LIST_SIZE (int)(sizeof(le_promisc.active_aa) / sizeof(le_promisc_active_aa_t))
 115:bluetooth_rxtx.c **** 
 116:bluetooth_rxtx.c **** /* LE jamming */
 117:bluetooth_rxtx.c **** #define JAM_COUNT_DEFAULT 40
 118:bluetooth_rxtx.c **** int le_jam_count = 0;
 119:bluetooth_rxtx.c **** 
 120:bluetooth_rxtx.c **** /* set LE access address */
 121:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa);
 122:bluetooth_rxtx.c **** 
 123:bluetooth_rxtx.c **** typedef int (*data_cb_t)(char *);
 124:bluetooth_rxtx.c **** data_cb_t data_cb = NULL;
 125:bluetooth_rxtx.c **** 
 126:bluetooth_rxtx.c **** typedef void (*packet_cb_t)(u8 *);
 127:bluetooth_rxtx.c **** packet_cb_t packet_cb = NULL;
 128:bluetooth_rxtx.c **** 
 129:bluetooth_rxtx.c **** /* Unpacked symbol buffers (two rxbufs) */
 130:bluetooth_rxtx.c **** char unpacked[DMA_SIZE*8*2];
 131:bluetooth_rxtx.c **** 
 132:bluetooth_rxtx.c **** static int enqueue(uint8_t type, uint8_t* buf)
 133:bluetooth_rxtx.c **** {
 134:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 135:bluetooth_rxtx.c **** 	
 136:bluetooth_rxtx.c **** 	/* fail if queue is full */
 137:bluetooth_rxtx.c **** 	if (f == NULL) {
 138:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 139:bluetooth_rxtx.c **** 		return 0;
 140:bluetooth_rxtx.c **** 	}
 141:bluetooth_rxtx.c **** 
 142:bluetooth_rxtx.c **** 	f->pkt_type = type;
 143:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 144:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 145:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 146:bluetooth_rxtx.c **** 	} else {
 147:bluetooth_rxtx.c **** 		f->clkn_high = idle_buf_clkn_high;
ARM GAS  /tmp/ccCuKxzC.s 			page 4


 148:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 149:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
 150:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 151:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
 152:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 153:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 154:bluetooth_rxtx.c **** 	}
 155:bluetooth_rxtx.c **** 
 156:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
 157:bluetooth_rxtx.c **** 
 158:bluetooth_rxtx.c **** 	f->status = status;
 159:bluetooth_rxtx.c **** 	status = 0;
 160:bluetooth_rxtx.c **** 
 161:bluetooth_rxtx.c **** 	return 1;
 162:bluetooth_rxtx.c **** }
 163:bluetooth_rxtx.c **** 
 164:bluetooth_rxtx.c **** //JWHUR usb_time_rx
 165:bluetooth_rxtx.c **** static int enqueue_time(uint8_t* buf)
 166:bluetooth_rxtx.c **** {
 167:bluetooth_rxtx.c **** 	usb_time_rx* f = usb_enqueue_time();
 168:bluetooth_rxtx.c **** 	if  (f == NULL) {
 169:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 170:bluetooth_rxtx.c **** 		return 0;
 171:bluetooth_rxtx.c **** 	}
 172:bluetooth_rxtx.c **** 	memcpy(f->time, buf, 16 * sizeof(long));
 173:bluetooth_rxtx.c **** 	return 1;
 174:bluetooth_rxtx.c **** }
 175:bluetooth_rxtx.c **** //
 176:bluetooth_rxtx.c **** 
 177:bluetooth_rxtx.c **** int enqueue_with_ts(uint8_t type, uint8_t* buf, uint32_t ts)
 178:bluetooth_rxtx.c **** {
 179:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 180:bluetooth_rxtx.c **** 
 181:bluetooth_rxtx.c **** 	/* fail if queue is full */
 182:bluetooth_rxtx.c **** 	if (f == NULL) {
 183:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 184:bluetooth_rxtx.c **** 		return 0;
 185:bluetooth_rxtx.c **** 	}
 186:bluetooth_rxtx.c **** 
 187:bluetooth_rxtx.c **** 	f->pkt_type = type;
 188:bluetooth_rxtx.c **** 
 189:bluetooth_rxtx.c **** 	f->clkn_high = 0;
 190:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 191:bluetooth_rxtx.c **** 
 192:bluetooth_rxtx.c **** 	f->channel = (uint8_t)((channel - 2402) & 0xff);
 193:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 194:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 195:bluetooth_rxtx.c **** 
 196:bluetooth_rxtx.c **** 	memcpy(f->data, buf, DMA_SIZE);
 197:bluetooth_rxtx.c **** 
 198:bluetooth_rxtx.c **** 	f->status = status;
 199:bluetooth_rxtx.c **** 	status = 0;
 200:bluetooth_rxtx.c **** 
 201:bluetooth_rxtx.c **** 	return 1;
 202:bluetooth_rxtx.c **** }
 203:bluetooth_rxtx.c **** 
 204:bluetooth_rxtx.c **** static int vendor_request_handler(uint8_t request, uint16_t* request_params, uint8_t* data, int* da
ARM GAS  /tmp/ccCuKxzC.s 			page 5


 205:bluetooth_rxtx.c **** {
 206:bluetooth_rxtx.c **** 	uint32_t clock;
 207:bluetooth_rxtx.c **** 	size_t length; // string length
 208:bluetooth_rxtx.c **** 	usb_pkt_rx* p = NULL;
 209:bluetooth_rxtx.c **** 	uint16_t reg_val;
 210:bluetooth_rxtx.c **** 	uint8_t i;
 211:bluetooth_rxtx.c **** 	dlen = *data_len;
 212:bluetooth_rxtx.c **** 
 213:bluetooth_rxtx.c **** 	switch (request) {
 214:bluetooth_rxtx.c **** 
 215:bluetooth_rxtx.c **** 	case UBERTOOTH_PING:
 216:bluetooth_rxtx.c **** 		*data_len = 0;
 217:bluetooth_rxtx.c **** 		break;
 218:bluetooth_rxtx.c **** 
 219:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_SYMBOLS:
 220:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_SYMBOLS;
 221:bluetooth_rxtx.c **** 		*data_len = 0;
 222:bluetooth_rxtx.c **** 		break;
 223:bluetooth_rxtx.c **** 
 224:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_SYMBOLS:
 225:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
 226:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 227:bluetooth_rxtx.c **** 		*data_len = 0;
 228:bluetooth_rxtx.c **** 		break;
 229:bluetooth_rxtx.c **** 
 230:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_USRLED:
 231:bluetooth_rxtx.c **** 		data[0] = (USRLED) ? 1 : 0;
 232:bluetooth_rxtx.c **** 		*data_len = 1;
 233:bluetooth_rxtx.c **** 		break;
 234:bluetooth_rxtx.c **** 
 235:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_USRLED:
 236:bluetooth_rxtx.c **** 		if (request_params[0])
 237:bluetooth_rxtx.c **** 			USRLED_SET;
 238:bluetooth_rxtx.c **** 		else
 239:bluetooth_rxtx.c **** 			USRLED_CLR;
 240:bluetooth_rxtx.c **** 		break;
 241:bluetooth_rxtx.c **** 
 242:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_RXLED:
 243:bluetooth_rxtx.c **** 		data[0] = (RXLED) ? 1 : 0;
 244:bluetooth_rxtx.c **** 		*data_len = 1;
 245:bluetooth_rxtx.c **** 		break;
 246:bluetooth_rxtx.c **** 
 247:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_RXLED:
 248:bluetooth_rxtx.c **** 		if (request_params[0])
 249:bluetooth_rxtx.c **** 			RXLED_SET;
 250:bluetooth_rxtx.c **** 		else
 251:bluetooth_rxtx.c **** 			RXLED_CLR;
 252:bluetooth_rxtx.c **** 		break;
 253:bluetooth_rxtx.c **** 
 254:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_TXLED:
 255:bluetooth_rxtx.c **** 		data[0] = (TXLED) ? 1 : 0;
 256:bluetooth_rxtx.c **** 		*data_len = 1;
 257:bluetooth_rxtx.c **** 		break;
 258:bluetooth_rxtx.c **** 
 259:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_TXLED:
 260:bluetooth_rxtx.c **** 		if (request_params[0])
 261:bluetooth_rxtx.c **** 			TXLED_SET;
ARM GAS  /tmp/ccCuKxzC.s 			page 6


 262:bluetooth_rxtx.c **** 		else
 263:bluetooth_rxtx.c **** 			TXLED_CLR;
 264:bluetooth_rxtx.c **** 		break;
 265:bluetooth_rxtx.c **** 
 266:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_1V8:
 267:bluetooth_rxtx.c **** 		data[0] = (CC1V8) ? 1 : 0;
 268:bluetooth_rxtx.c **** 		*data_len = 1;
 269:bluetooth_rxtx.c **** 		break;
 270:bluetooth_rxtx.c **** 
 271:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_1V8:
 272:bluetooth_rxtx.c **** 		if (request_params[0])
 273:bluetooth_rxtx.c **** 			CC1V8_SET;
 274:bluetooth_rxtx.c **** 		else
 275:bluetooth_rxtx.c **** 			CC1V8_CLR;
 276:bluetooth_rxtx.c **** 		break;
 277:bluetooth_rxtx.c **** 
 278:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PARTNUM:
 279:bluetooth_rxtx.c **** 		get_part_num(data, data_len);
 280:bluetooth_rxtx.c **** 		break;
 281:bluetooth_rxtx.c **** 
 282:bluetooth_rxtx.c **** 	case UBERTOOTH_RESET:
 283:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 284:bluetooth_rxtx.c **** 		break;
 285:bluetooth_rxtx.c **** 
 286:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SERIAL:
 287:bluetooth_rxtx.c **** 		get_device_serial(data, data_len);
 288:bluetooth_rxtx.c **** 		break;
 289:bluetooth_rxtx.c **** 
 290:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 291:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PAEN:
 292:bluetooth_rxtx.c **** 		data[0] = (PAEN) ? 1 : 0;
 293:bluetooth_rxtx.c **** 		*data_len = 1;
 294:bluetooth_rxtx.c **** 		break;
 295:bluetooth_rxtx.c **** 
 296:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PAEN:
 297:bluetooth_rxtx.c **** 		if (request_params[0])
 298:bluetooth_rxtx.c **** 			PAEN_SET;
 299:bluetooth_rxtx.c **** 		else
 300:bluetooth_rxtx.c **** 			PAEN_CLR;
 301:bluetooth_rxtx.c **** 		break;
 302:bluetooth_rxtx.c **** 
 303:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_HGM:
 304:bluetooth_rxtx.c **** 		data[0] = (HGM) ? 1 : 0;
 305:bluetooth_rxtx.c **** 		*data_len = 1;
 306:bluetooth_rxtx.c **** 		break;
 307:bluetooth_rxtx.c **** 
 308:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_HGM:
 309:bluetooth_rxtx.c **** 		if (request_params[0])
 310:bluetooth_rxtx.c **** 			HGM_SET;
 311:bluetooth_rxtx.c **** 		else
 312:bluetooth_rxtx.c **** 			HGM_CLR;
 313:bluetooth_rxtx.c **** 		break;
 314:bluetooth_rxtx.c **** #endif
 315:bluetooth_rxtx.c **** 
 316:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 317:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_TEST:
 318:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_TEST;
ARM GAS  /tmp/ccCuKxzC.s 			page 7


 319:bluetooth_rxtx.c **** 		break;
 320:bluetooth_rxtx.c **** 
 321:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_PALEVEL:
 322:bluetooth_rxtx.c **** 		data[0] = cc2400_get(FREND) & 0x7;
 323:bluetooth_rxtx.c **** 		*data_len = 1;
 324:bluetooth_rxtx.c **** 		break;
 325:bluetooth_rxtx.c **** 
 326:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_PALEVEL:
 327:bluetooth_rxtx.c **** 		if( request_params[0] < 8 ) {
 328:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 329:bluetooth_rxtx.c **** 		} else {
 330:bluetooth_rxtx.c **** 			return 0;
 331:bluetooth_rxtx.c **** 		}
 332:bluetooth_rxtx.c **** 		break;
 333:bluetooth_rxtx.c **** 
 334:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_TEST:
 335:bluetooth_rxtx.c **** 		requested_mode = MODE_RANGE_TEST;
 336:bluetooth_rxtx.c **** 		break;
 337:bluetooth_rxtx.c **** 
 338:bluetooth_rxtx.c **** 	case UBERTOOTH_REPEATER:
 339:bluetooth_rxtx.c **** 		requested_mode = MODE_REPEATER;
 340:bluetooth_rxtx.c **** 		break;
 341:bluetooth_rxtx.c **** #endif
 342:bluetooth_rxtx.c **** 
 343:bluetooth_rxtx.c **** 	case UBERTOOTH_RANGE_CHECK:
 344:bluetooth_rxtx.c **** 		data[0] = rr.valid;
 345:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 346:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 347:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 348:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 349:bluetooth_rxtx.c **** 		*data_len = 5;
 350:bluetooth_rxtx.c **** 		break;
 351:bluetooth_rxtx.c **** 
 352:bluetooth_rxtx.c **** 	case UBERTOOTH_STOP:
 353:bluetooth_rxtx.c **** 		requested_mode = MODE_IDLE;
 354:bluetooth_rxtx.c **** 		break;
 355:bluetooth_rxtx.c **** 
 356:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_MOD:
 357:bluetooth_rxtx.c **** 		data[0] = modulation;
 358:bluetooth_rxtx.c **** 		*data_len = 1;
 359:bluetooth_rxtx.c **** 		break;
 360:bluetooth_rxtx.c **** 
 361:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_MOD:
 362:bluetooth_rxtx.c **** 		modulation = request_params[0];
 363:bluetooth_rxtx.c **** 		break;
 364:bluetooth_rxtx.c **** 
 365:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CHANNEL:
 366:bluetooth_rxtx.c **** 		data[0] = channel & 0xFF;
 367:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
 368:bluetooth_rxtx.c **** 		*data_len = 2;
 369:bluetooth_rxtx.c **** 		break;
 370:bluetooth_rxtx.c **** 
 371:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CHANNEL:
 372:bluetooth_rxtx.c **** 		requested_channel = request_params[0];
 373:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 374:bluetooth_rxtx.c **** 		if (requested_channel > MAX_FREQ) {
 375:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
ARM GAS  /tmp/ccCuKxzC.s 			page 8


 376:bluetooth_rxtx.c **** 			requested_channel = 2402;
 377:bluetooth_rxtx.c **** 		}
 378:bluetooth_rxtx.c **** 		/* fixed channel mode, can be outside bluetooth band */
 379:bluetooth_rxtx.c **** 		else {
 380:bluetooth_rxtx.c **** 			hop_mode = HOP_NONE;
 381:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 382:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 383:bluetooth_rxtx.c **** 		}
 384:bluetooth_rxtx.c **** 
 385:bluetooth_rxtx.c **** 		le_adv_channel = requested_channel;
 386:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 387:bluetooth_rxtx.c **** 			channel = requested_channel;
 388:bluetooth_rxtx.c **** 			requested_channel = 0;
 389:bluetooth_rxtx.c **** 
 390:bluetooth_rxtx.c **** 			/* CS threshold is mode-dependent. Update it after
 391:bluetooth_rxtx.c **** 			 * possible mode change. TODO - kludgy. */
 392:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
 393:bluetooth_rxtx.c **** 		}
 394:bluetooth_rxtx.c **** 		break;
 395:bluetooth_rxtx.c **** 
 396:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ISP:
 397:bluetooth_rxtx.c **** 		set_isp();
 398:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 399:bluetooth_rxtx.c **** 		break;
 400:bluetooth_rxtx.c **** 
 401:bluetooth_rxtx.c **** 	case UBERTOOTH_FLASH:
 402:bluetooth_rxtx.c **** 		bootloader_ctrl = DFU_MODE;
 403:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 404:bluetooth_rxtx.c **** 		break;
 405:bluetooth_rxtx.c **** 
 406:bluetooth_rxtx.c **** 	case UBERTOOTH_SPECAN:
 407:bluetooth_rxtx.c **** 		if (request_params[0] < 2049 || request_params[0] > 3072 ||
 408:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 409:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 410:bluetooth_rxtx.c **** 			return 0;
 411:bluetooth_rxtx.c **** 		low_freq = request_params[0];
 412:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 413:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 414:bluetooth_rxtx.c **** 		*data_len = 0;
 415:bluetooth_rxtx.c **** 		break;
 416:bluetooth_rxtx.c **** 
 417:bluetooth_rxtx.c **** 	case UBERTOOTH_RX_GENERIC:
 418:bluetooth_rxtx.c **** 		requested_mode = MODE_RX_GENERIC;
 419:bluetooth_rxtx.c **** 		*data_len = 0;
 420:bluetooth_rxtx.c **** 		break;
 421:bluetooth_rxtx.c **** 
 422:bluetooth_rxtx.c **** 	case UBERTOOTH_LED_SPECAN:
 423:bluetooth_rxtx.c **** 		if (request_params[0] > 256)
 424:bluetooth_rxtx.c **** 			return 0;
 425:bluetooth_rxtx.c **** 		rssi_threshold = 54 - request_params[0];
 426:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 427:bluetooth_rxtx.c **** 		*data_len = 0;
 428:bluetooth_rxtx.c **** 		break;
 429:bluetooth_rxtx.c **** 
 430:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_REV_NUM:
 431:bluetooth_rxtx.c **** 		data[0] = 0x00;
 432:bluetooth_rxtx.c **** 		data[1] = 0x00;
ARM GAS  /tmp/ccCuKxzC.s 			page 9


 433:bluetooth_rxtx.c **** 
 434:bluetooth_rxtx.c **** 		length = (u8)strlen(GIT_REVISION);
 435:bluetooth_rxtx.c **** 		data[2] = length;
 436:bluetooth_rxtx.c **** 
 437:bluetooth_rxtx.c **** 		memcpy(&data[3], GIT_REVISION, length);
 438:bluetooth_rxtx.c **** 
 439:bluetooth_rxtx.c **** 		*data_len = 2 + 1 + length;
 440:bluetooth_rxtx.c **** 		break;
 441:bluetooth_rxtx.c **** 
 442:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_COMPILE_INFO:
 443:bluetooth_rxtx.c **** 		length = (u8)strlen(compile_info);
 444:bluetooth_rxtx.c **** 		data[0] = length;
 445:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 446:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 447:bluetooth_rxtx.c **** 		break;
 448:bluetooth_rxtx.c **** 
 449:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_BOARD_ID:
 450:bluetooth_rxtx.c **** 		data[0] = BOARD_ID;
 451:bluetooth_rxtx.c **** 		*data_len = 1;
 452:bluetooth_rxtx.c **** 		break;
 453:bluetooth_rxtx.c **** 
 454:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_SQUELCH:
 455:bluetooth_rxtx.c **** 		cs_threshold_req = (int8_t)request_params[0];
 456:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 457:bluetooth_rxtx.c **** 		break;
 458:bluetooth_rxtx.c **** 
 459:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_SQUELCH:
 460:bluetooth_rxtx.c **** 		data[0] = cs_threshold_req;
 461:bluetooth_rxtx.c **** 		*data_len = 1;
 462:bluetooth_rxtx.c **** 		break;
 463:bluetooth_rxtx.c **** 
 464:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_BDADDR:
 465:bluetooth_rxtx.c **** 		target.address = 0;
 466:bluetooth_rxtx.c **** 		target.syncword = 0;
 467:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 468:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 469:bluetooth_rxtx.c **** 		}
 470:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 471:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 472:bluetooth_rxtx.c **** 		}
 473:bluetooth_rxtx.c **** 		precalc();
 474:bluetooth_rxtx.c **** 		break;
 475:bluetooth_rxtx.c **** 
 476:bluetooth_rxtx.c **** 	case UBERTOOTH_START_HOPPING:
 477:bluetooth_rxtx.c **** 		clkn_offset = 0;
 478:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 479:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 480:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
 481:bluetooth_rxtx.c **** 		}
 482:bluetooth_rxtx.c **** 		hop_mode = HOP_BLUETOOTH;
 483:bluetooth_rxtx.c **** 		dma_discard = 1;
 484:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 485:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 486:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 487:bluetooth_rxtx.c **** 		break;
 488:bluetooth_rxtx.c **** 
 489:bluetooth_rxtx.c **** 	case UBERTOOTH_AFH:
ARM GAS  /tmp/ccCuKxzC.s 			page 10


 490:bluetooth_rxtx.c **** 		hop_mode = HOP_AFH;
 491:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 492:bluetooth_rxtx.c **** 
 493:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 494:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 495:bluetooth_rxtx.c **** 		}
 496:bluetooth_rxtx.c **** 		used_channels = 0;
 497:bluetooth_rxtx.c **** 		afh_enabled = 1;
 498:bluetooth_rxtx.c **** 		break;
 499:bluetooth_rxtx.c **** 
 500:bluetooth_rxtx.c **** 	case UBERTOOTH_HOP:
 501:bluetooth_rxtx.c **** 		do_hop = 1;
 502:bluetooth_rxtx.c **** 		break;
 503:bluetooth_rxtx.c **** 
 504:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CLOCK:
 505:bluetooth_rxtx.c **** 		clock = data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24;
 506:bluetooth_rxtx.c **** 		clkn = clock;
 507:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 508:bluetooth_rxtx.c **** 		break;
 509:bluetooth_rxtx.c **** 
 510:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_AFHMAP:
 511:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 512:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 513:bluetooth_rxtx.c **** 		}
 514:bluetooth_rxtx.c **** 		afh_enabled = 1;
 515:bluetooth_rxtx.c **** 		*data_len = 10;
 516:bluetooth_rxtx.c **** 		break;
 517:bluetooth_rxtx.c **** 
 518:bluetooth_rxtx.c **** 	case UBERTOOTH_CLEAR_AFHMAP:
 519:bluetooth_rxtx.c **** 		for(int i=0; i < 10; i++) {
 520:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 521:bluetooth_rxtx.c **** 		}
 522:bluetooth_rxtx.c **** 		afh_enabled = 0;
 523:bluetooth_rxtx.c **** 		*data_len = 10;
 524:bluetooth_rxtx.c **** 		break;
 525:bluetooth_rxtx.c **** 
 526:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CLOCK:
 527:bluetooth_rxtx.c **** 		clock = clkn;
 528:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 529:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 530:bluetooth_rxtx.c **** 		}
 531:bluetooth_rxtx.c **** 		*data_len = 4;
 532:bluetooth_rxtx.c **** 		break;
 533:bluetooth_rxtx.c **** 
 534:bluetooth_rxtx.c **** 	case UBERTOOTH_TRIM_CLOCK:
 535:bluetooth_rxtx.c **** 		clk100ns_offset = (data[0] << 8) | (data[1] << 0);
 536:bluetooth_rxtx.c **** 		break;
 537:bluetooth_rxtx.c **** 
 538:bluetooth_rxtx.c **** 	case UBERTOOTH_FIX_CLOCK_DRIFT:
 539:bluetooth_rxtx.c **** 		clk_drift_ppm += (int16_t)(data[0] << 8) | (data[1] << 0);
 540:bluetooth_rxtx.c **** 
 541:bluetooth_rxtx.c **** 		// Too slow
 542:bluetooth_rxtx.c **** 		if (clk_drift_ppm < 0) {
 543:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 544:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 545:bluetooth_rxtx.c **** 		}
 546:bluetooth_rxtx.c **** 		// Too fast
ARM GAS  /tmp/ccCuKxzC.s 			page 11


 547:bluetooth_rxtx.c **** 		else if (clk_drift_ppm > 0) {
 548:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
 549:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 550:bluetooth_rxtx.c **** 		}
 551:bluetooth_rxtx.c **** 		// Don't trim
 552:bluetooth_rxtx.c **** 		else {
 553:bluetooth_rxtx.c **** 			clk_drift_correction = 0;
 554:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
 555:bluetooth_rxtx.c **** 		}
 556:bluetooth_rxtx.c **** 
 557:bluetooth_rxtx.c **** 		break;
 558:bluetooth_rxtx.c **** 
 559:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SNIFFING:
 560:bluetooth_rxtx.c **** 		*data_len = 0;
 561:bluetooth_rxtx.c **** 
 562:bluetooth_rxtx.c **** 		do_hop = 0;
 563:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 564:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 565:bluetooth_rxtx.c **** 
 566:bluetooth_rxtx.c **** 		queue_init();
 567:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 568:bluetooth_rxtx.c **** 		break;
 569:bluetooth_rxtx.c **** 	
 570:bluetooth_rxtx.c **** 	// JWHUR cfo estimation tracking
 571:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_CFO:
 572:bluetooth_rxtx.c **** 		do_hop = 0;
 573:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 574:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_CFO_LE;
 575:bluetooth_rxtx.c **** 
 576:bluetooth_rxtx.c **** 		queue_init();
 577:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 578:bluetooth_rxtx.c **** 		break;
 579:bluetooth_rxtx.c **** 
 580:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_RSSI:
 581:bluetooth_rxtx.c **** 		do_hop = 0;
 582:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 583:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_RSSI_LE;
 584:bluetooth_rxtx.c **** 
 585:bluetooth_rxtx.c **** 		queue_init();
 586:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 587:bluetooth_rxtx.c **** 		break;
 588:bluetooth_rxtx.c **** 
 589:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_ACCESS_ADDRESS:
 590:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 591:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 592:bluetooth_rxtx.c **** 		}
 593:bluetooth_rxtx.c **** 		*data_len = 4;
 594:bluetooth_rxtx.c **** 		break;
 595:bluetooth_rxtx.c **** 
 596:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_ACCESS_ADDRESS:
 597:bluetooth_rxtx.c **** 		le_set_access_address(data[0] | data[1] << 8 | data[2] << 16 | data[3] << 24);
 598:bluetooth_rxtx.c **** 		le.target_set = 1;
 599:bluetooth_rxtx.c **** 		break;
 600:bluetooth_rxtx.c **** 
 601:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING:
 602:bluetooth_rxtx.c **** 		// do something! just don't commit anything here
 603:bluetooth_rxtx.c **** 		break;
ARM GAS  /tmp/ccCuKxzC.s 			page 12


 604:bluetooth_rxtx.c **** 
 605:bluetooth_rxtx.c **** 	case UBERTOOTH_DO_SOMETHING_REPLY:
 606:bluetooth_rxtx.c **** 		// after you do something, tell me what you did!
 607:bluetooth_rxtx.c **** 		// don't commit here please
 608:bluetooth_rxtx.c **** 		data[0] = 0x13;
 609:bluetooth_rxtx.c **** 		data[1] = 0x37;
 610:bluetooth_rxtx.c **** 		*data_len = 2;
 611:bluetooth_rxtx.c **** 		break;
 612:bluetooth_rxtx.c **** 
 613:bluetooth_rxtx.c **** 	case UBERTOOTH_GET_CRC_VERIFY:
 614:bluetooth_rxtx.c **** 		data[0] = le.crc_verify ? 1 : 0;
 615:bluetooth_rxtx.c **** 		*data_len = 1;
 616:bluetooth_rxtx.c **** 		break;
 617:bluetooth_rxtx.c **** 
 618:bluetooth_rxtx.c **** 	case UBERTOOTH_SET_CRC_VERIFY:
 619:bluetooth_rxtx.c **** 		le.crc_verify = request_params[0] ? 1 : 0;
 620:bluetooth_rxtx.c **** 		break;
 621:bluetooth_rxtx.c **** 
 622:bluetooth_rxtx.c **** 	case UBERTOOTH_POLL:
 623:bluetooth_rxtx.c **** 		p = dequeue();
 624:bluetooth_rxtx.c **** 		if (p != NULL) {
 625:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 626:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 627:bluetooth_rxtx.c **** 		} else {
 628:bluetooth_rxtx.c **** 			data[0] = 0;
 629:bluetooth_rxtx.c **** 			*data_len = 1;
 630:bluetooth_rxtx.c **** 		}
 631:bluetooth_rxtx.c **** 		break;
 632:bluetooth_rxtx.c **** 
 633:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_PROMISC:
 634:bluetooth_rxtx.c **** 		*data_len = 0;
 635:bluetooth_rxtx.c **** 
 636:bluetooth_rxtx.c **** 		hop_mode = HOP_NONE;
 637:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 638:bluetooth_rxtx.c **** 
 639:bluetooth_rxtx.c **** 		queue_init();
 640:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 641:bluetooth_rxtx.c **** 		break;
 642:bluetooth_rxtx.c **** 
 643:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_REGISTER:
 644:bluetooth_rxtx.c **** 		reg_val = cc2400_get(request_params[0]);
 645:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 646:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 647:bluetooth_rxtx.c **** 		*data_len = 2;
 648:bluetooth_rxtx.c **** 		break;
 649:bluetooth_rxtx.c **** 
 650:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTER:
 651:bluetooth_rxtx.c **** 		cc2400_set(request_params[0] & 0xff, request_params[1]);
 652:bluetooth_rxtx.c **** 		break;
 653:bluetooth_rxtx.c **** 
 654:bluetooth_rxtx.c **** 	case UBERTOOTH_WRITE_REGISTERS:
 655:bluetooth_rxtx.c **** 		for(i=0; i<request_params[0]; i++) {
 656:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 657:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
 658:bluetooth_rxtx.c **** 		}
 659:bluetooth_rxtx.c **** 		break;
 660:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccCuKxzC.s 			page 13


 661:bluetooth_rxtx.c **** 	case UBERTOOTH_READ_ALL_REGISTERS:
 662:bluetooth_rxtx.c **** 		#define MAX_READ_REG 0x2d
 663:bluetooth_rxtx.c **** 		for(i=0; i<=MAX_READ_REG; i++) {
 664:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 665:bluetooth_rxtx.c **** 			data[i*3] = i;
 666:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
 667:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 668:bluetooth_rxtx.c **** 		}
 669:bluetooth_rxtx.c **** 		*data_len = MAX_READ_REG*3;
 670:bluetooth_rxtx.c **** 		break;
 671:bluetooth_rxtx.c **** 
 672:bluetooth_rxtx.c **** 	case UBERTOOTH_TX_GENERIC_PACKET:
 673:bluetooth_rxtx.c **** 		i = 7 + data[6];
 674:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 675:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 676:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_GENERIC;
 677:bluetooth_rxtx.c **** 		*data_len = 0;
 678:bluetooth_rxtx.c **** 		break;
 679:bluetooth_rxtx.c **** 
 680:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SLAVE:
 681:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*dlen);
 682:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 683:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 684:bluetooth_rxtx.c **** 		break;
 685:bluetooth_rxtx.c **** 
 686:bluetooth_rxtx.c **** 	//JWHUR for rssi sampling synchronization
 687:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SYNC:
 688:bluetooth_rxtx.c **** 		slave_mac_address_data = (uint8_t*) malloc(sizeof(uint8_t)*6);
 689:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, 6);
 690:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SYNC_LE;
 691:bluetooth_rxtx.c **** 		do_hop = 0;
 692:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 693:bluetooth_rxtx.c **** 		queue_init();
 694:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 695:bluetooth_rxtx.c **** 		break;
 696:bluetooth_rxtx.c **** 	
 697:bluetooth_rxtx.c **** 	case UBERTOOTH_BTLE_SET_TARGET:
 698:bluetooth_rxtx.c **** 		// Addresses appear in packets in reverse-octet order.
 699:bluetooth_rxtx.c **** 		// Store the target address in reverse order so that we can do a simple memcmp later
 700:bluetooth_rxtx.c **** 		le.target[0] = data[5];
 701:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 702:bluetooth_rxtx.c **** 		le.target[2] = data[3];
 703:bluetooth_rxtx.c **** 		le.target[3] = data[2];
 704:bluetooth_rxtx.c **** 		le.target[4] = data[1];
 705:bluetooth_rxtx.c **** 		le.target[5] = data[0];
 706:bluetooth_rxtx.c **** 		le.target_set = 1;
 707:bluetooth_rxtx.c **** 		break;
 708:bluetooth_rxtx.c **** 
 709:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 710:bluetooth_rxtx.c **** 	case UBERTOOTH_JAM_MODE:
 711:bluetooth_rxtx.c **** 		jam_mode = request_params[0];
 712:bluetooth_rxtx.c **** 		break;
 713:bluetooth_rxtx.c **** #endif
 714:bluetooth_rxtx.c **** 
 715:bluetooth_rxtx.c **** 	case UBERTOOTH_EGO:
 716:bluetooth_rxtx.c **** #ifndef TX_ENABLE
 717:bluetooth_rxtx.c **** 		if (ego_mode == EGO_JAM)
ARM GAS  /tmp/ccCuKxzC.s 			page 14


 718:bluetooth_rxtx.c **** 			return 0;
 719:bluetooth_rxtx.c **** #endif
 720:bluetooth_rxtx.c **** 		requested_mode = MODE_EGO;
 721:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 722:bluetooth_rxtx.c **** 		break;
 723:bluetooth_rxtx.c **** 
 724:bluetooth_rxtx.c **** 	default:
 725:bluetooth_rxtx.c **** 		return 0;
 726:bluetooth_rxtx.c **** 	}
 727:bluetooth_rxtx.c **** 	return 1;
 728:bluetooth_rxtx.c **** }
 729:bluetooth_rxtx.c **** 
 730:bluetooth_rxtx.c **** /* Update CLKN. */
 731:bluetooth_rxtx.c **** void TIMER0_IRQHandler()
 732:bluetooth_rxtx.c **** {
 733:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 734:bluetooth_rxtx.c **** 
 735:bluetooth_rxtx.c **** 		clkn += clkn_offset + 1;
 736:bluetooth_rxtx.c **** 		clkn_offset = 0;
 737:bluetooth_rxtx.c **** 
 738:bluetooth_rxtx.c **** 		uint32_t le_clk = (clkn - le.conn_epoch) & 0x03;
 739:bluetooth_rxtx.c **** 
 740:bluetooth_rxtx.c **** 		/* Trigger hop based on mode */
 741:bluetooth_rxtx.c **** 
 742:bluetooth_rxtx.c **** 		/* NONE or SWEEP -> 25 Hz */
 743:bluetooth_rxtx.c **** 		if (hop_mode == HOP_NONE || hop_mode == HOP_SWEEP) {
 744:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 745:bluetooth_rxtx.c **** 				do_hop = 1;
 746:bluetooth_rxtx.c **** 		}
 747:bluetooth_rxtx.c **** 		/* BLUETOOTH -> 1600 Hz */
 748:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BLUETOOTH) {
 749:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 750:bluetooth_rxtx.c **** 				do_hop = 1;
 751:bluetooth_rxtx.c **** 		}
 752:bluetooth_rxtx.c **** 		/* BLUETOOTH Low Energy -> 7.5ms - 4.0s in multiples of 1.25 ms */
 753:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_BTLE) {
 754:bluetooth_rxtx.c **** 			// Only hop if connected
 755:bluetooth_rxtx.c **** 			if (le.link_state == LINK_CONNECTED && le_clk == 0) {
 756:bluetooth_rxtx.c **** 				--le.interval_timer;
 757:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 758:bluetooth_rxtx.c **** 					do_hop = 1;
 759:bluetooth_rxtx.c **** 					++le.conn_count;
 760:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 761:bluetooth_rxtx.c **** 				} else {
 762:bluetooth_rxtx.c **** 					TXLED_CLR; // hack!
 763:bluetooth_rxtx.c **** 				}
 764:bluetooth_rxtx.c **** 			}
 765:bluetooth_rxtx.c **** 		}
 766:bluetooth_rxtx.c **** 		else if (hop_mode == HOP_AFH) {
 767:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
 768:bluetooth_rxtx.c **** 				do_hop = 1;
 769:bluetooth_rxtx.c **** 			}
 770:bluetooth_rxtx.c **** 		}
 771:bluetooth_rxtx.c **** 
 772:bluetooth_rxtx.c **** 		// Fix linear clock drift deviation
 773:bluetooth_rxtx.c **** 		if(clkn_next_drift_fix != 0 && clk100ns_offset == 0) {
 774:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
ARM GAS  /tmp/ccCuKxzC.s 			page 15


 775:bluetooth_rxtx.c **** 
 776:bluetooth_rxtx.c **** 				// Too fast
 777:bluetooth_rxtx.c **** 				if(clk_drift_ppm >= 0) {
 778:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 779:bluetooth_rxtx.c **** 				}
 780:bluetooth_rxtx.c **** 
 781:bluetooth_rxtx.c **** 				// Too slow
 782:bluetooth_rxtx.c **** 				else {
 783:bluetooth_rxtx.c **** 					clk100ns_offset = 6249;
 784:bluetooth_rxtx.c **** 				}
 785:bluetooth_rxtx.c **** 				clkn_last_drift_fix = clkn;
 786:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 787:bluetooth_rxtx.c **** 			}
 788:bluetooth_rxtx.c **** 		}
 789:bluetooth_rxtx.c **** 
 790:bluetooth_rxtx.c **** 		// Negative clock correction
 791:bluetooth_rxtx.c **** 		if(clk100ns_offset > 3124)
 792:bluetooth_rxtx.c **** 			clkn += 2;
 793:bluetooth_rxtx.c **** 
 794:bluetooth_rxtx.c **** 		T0MR0 = 3124 + clk100ns_offset;
 795:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
 796:bluetooth_rxtx.c **** 
 797:bluetooth_rxtx.c **** 		/* Ack interrupt */
 798:bluetooth_rxtx.c **** 		T0IR = TIR_MR0_Interrupt;
 799:bluetooth_rxtx.c **** 	}
 800:bluetooth_rxtx.c **** }
 801:bluetooth_rxtx.c **** 
 802:bluetooth_rxtx.c **** /* EINT3 handler is also defined in ubertooth.c for TC13BADGE. */
 803:bluetooth_rxtx.c **** #ifndef TC13BADGE
 804:bluetooth_rxtx.c **** void EINT3_IRQHandler()
 805:bluetooth_rxtx.c **** {
 806:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 807:bluetooth_rxtx.c **** 	IO2IntClr   = PIN_GIO6; // clear interrupt
 808:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 809:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 810:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 811:bluetooth_rxtx.c **** 		dma_discard = 0; 
 812:bluetooth_rxtx.c **** 
 813:bluetooth_rxtx.c **** }
 814:bluetooth_rxtx.c **** #endif // TC13BADGE
 815:bluetooth_rxtx.c **** 
 816:bluetooth_rxtx.c **** /*
 817:bluetooth_rxtx.c ****  * Sleep (busy wait) for 'millis' milliseconds
 818:bluetooth_rxtx.c ****  * Needs clkn. Be sure to call clkn_init() before using it.
 819:bluetooth_rxtx.c ****  */
 820:bluetooth_rxtx.c **** static void msleep(uint32_t millis)
 821:bluetooth_rxtx.c **** {
  26              		.loc 1 821 0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 0
  29              		@ frame_needed = 0, uses_anonymous_args = 0
  30              	.LVL0:
  31 0000 10B5     		push	{r4, lr}
  32              		.cfi_def_cfa_offset 8
  33              		.cfi_offset 4, -8
  34              		.cfi_offset 14, -4
 822:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
ARM GAS  /tmp/ccCuKxzC.s 			page 16


 823:bluetooth_rxtx.c **** 	uint32_t stop_at = now + millis * 10000 / 3125; // millis -> clkn ticks
  35              		.loc 1 823 0
  36 0002 42F21071 		movw	r1, #10000
 822:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
  37              		.loc 1 822 0
  38 0006 084B     		ldr	r3, .L5
  39              		.loc 1 823 0
  40 0008 4843     		muls	r0, r1, r0
  41              	.LVL1:
 822:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
  42              		.loc 1 822 0
  43 000a 1A68     		ldr	r2, [r3]
  44              	.LVL2:
  45              		.loc 1 823 0
  46 000c 40F63544 		movw	r4, #3125
  47 0010 B0FBF4F1 		udiv	r1, r0, r4
 822:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
  48              		.loc 1 822 0
  49 0014 22F07F42 		bic	r2, r2, #-16777216
  50              	.LVL3:
  51              		.loc 1 823 0
  52 0018 0A44     		add	r2, r2, r1
  53              	.LVL4:
  54              	.L3:
 824:bluetooth_rxtx.c **** 
 825:bluetooth_rxtx.c **** 	// handle clkn overflow
 826:bluetooth_rxtx.c **** 	if (stop_at >= ((uint32_t)1<<28)) {
 827:bluetooth_rxtx.c **** 		stop_at -= ((uint32_t)1<<28);
 828:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) >= now || (clkn & 0xffffff) < stop_at);
 829:bluetooth_rxtx.c **** 	} else {
 830:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) < stop_at);
  55              		.loc 1 830 0 discriminator 1
  56 001a 1968     		ldr	r1, [r3]
  57 001c 21F07F41 		bic	r1, r1, #-16777216
  58 0020 9142     		cmp	r1, r2
  59 0022 FAD3     		bcc	.L3
 831:bluetooth_rxtx.c **** 	}
 832:bluetooth_rxtx.c **** }
  60              		.loc 1 832 0
  61 0024 10BD     		pop	{r4, pc}
  62              	.L6:
  63 0026 00BF     		.align	2
  64              	.L5:
  65 0028 00000000 		.word	clkn
  66              		.cfi_endproc
  67              	.LFE6:
  69              		.section	.text.reverse8,"ax",%progbits
  70              		.align	1
  71              		.thumb
  72              		.thumb_func
  74              	reverse8:
  75              	.LFB16:
 833:bluetooth_rxtx.c **** 
 834:bluetooth_rxtx.c **** void DMA_IRQHandler()
 835:bluetooth_rxtx.c **** {
 836:bluetooth_rxtx.c **** 	if ( mode == MODE_RX_SYMBOLS
 837:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
ARM GAS  /tmp/ccCuKxzC.s 			page 17


 838:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 839:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 840:bluetooth_rxtx.c **** 	   || mode == MODE_BT_CFO_LE
 841:bluetooth_rxtx.c **** 	   || mode == MODE_BT_RSSI_LE
 842:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 843:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
 844:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SYNC_LE
 845:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 846:bluetooth_rxtx.c **** 	{
 847:bluetooth_rxtx.c **** 		/* interrupt on channel 0 */
 848:bluetooth_rxtx.c **** 		if (DMACIntStat & (1 << 0)) {
 849:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 850:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 851:bluetooth_rxtx.c **** 
 852:bluetooth_rxtx.c **** 				if (hop_mode == HOP_BLUETOOTH)
 853:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 854:bluetooth_rxtx.c **** 
 855:bluetooth_rxtx.c **** 				idle_buf_clk100ns  = CLK100NS;
 856:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 857:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 858:bluetooth_rxtx.c **** 
 859:bluetooth_rxtx.c **** 				/* Keep buffer swapping in sync with DMA. */
 860:bluetooth_rxtx.c **** 				volatile uint8_t* tmp = active_rxbuf;
 861:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 862:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 863:bluetooth_rxtx.c **** 
 864:bluetooth_rxtx.c **** 				++rx_tc;
 865:bluetooth_rxtx.c **** 			}
 866:bluetooth_rxtx.c **** 			if (DMACIntErrStat & (1 << 0)) {
 867:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 868:bluetooth_rxtx.c **** 				++rx_err;
 869:bluetooth_rxtx.c **** 			}
 870:bluetooth_rxtx.c **** 		}
 871:bluetooth_rxtx.c **** 	}
 872:bluetooth_rxtx.c **** }
 873:bluetooth_rxtx.c **** 
 874:bluetooth_rxtx.c **** static void cc2400_idle()
 875:bluetooth_rxtx.c **** {
 876:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 877:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 878:bluetooth_rxtx.c **** 
 879:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 880:bluetooth_rxtx.c **** 	PAEN_CLR;
 881:bluetooth_rxtx.c **** 	HGM_CLR;
 882:bluetooth_rxtx.c **** #endif
 883:bluetooth_rxtx.c **** 
 884:bluetooth_rxtx.c **** 	RXLED_CLR;
 885:bluetooth_rxtx.c **** 	TXLED_CLR;
 886:bluetooth_rxtx.c **** 	USRLED_CLR;
 887:bluetooth_rxtx.c **** 
 888:bluetooth_rxtx.c **** 	clkn_stop();
 889:bluetooth_rxtx.c **** 	dio_ssp_stop();
 890:bluetooth_rxtx.c **** 	cs_reset();
 891:bluetooth_rxtx.c **** 	rssi_reset();
 892:bluetooth_rxtx.c **** 
 893:bluetooth_rxtx.c **** 	/* hopping stuff */
 894:bluetooth_rxtx.c **** 	hop_mode = HOP_NONE;
ARM GAS  /tmp/ccCuKxzC.s 			page 18


 895:bluetooth_rxtx.c **** 	do_hop = 0;
 896:bluetooth_rxtx.c **** 	channel = 2441;
 897:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 898:bluetooth_rxtx.c **** 	hop_timeout = 158;
 899:bluetooth_rxtx.c **** 	requested_channel = 0;
 900:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
 901:bluetooth_rxtx.c **** 
 902:bluetooth_rxtx.c **** 
 903:bluetooth_rxtx.c **** 	/* bulk USB stuff */
 904:bluetooth_rxtx.c **** 	idle_buf_clkn_high = 0;
 905:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 906:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 907:bluetooth_rxtx.c **** 	dma_discard = 0;
 908:bluetooth_rxtx.c **** 	status = 0;
 909:bluetooth_rxtx.c **** 
 910:bluetooth_rxtx.c **** 	/* operation mode */
 911:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 912:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 913:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 914:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 915:bluetooth_rxtx.c **** 
 916:bluetooth_rxtx.c **** 	modulation = MOD_BT_BASIC_RATE;
 917:bluetooth_rxtx.c **** 
 918:bluetooth_rxtx.c **** 	/* specan stuff */
 919:bluetooth_rxtx.c **** 	low_freq = 2400;
 920:bluetooth_rxtx.c **** 	high_freq = 2483;
 921:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 922:bluetooth_rxtx.c **** 
 923:bluetooth_rxtx.c **** 	target.address = 0;
 924:bluetooth_rxtx.c **** 	target.syncword = 0;
 925:bluetooth_rxtx.c **** }
 926:bluetooth_rxtx.c **** 
 927:bluetooth_rxtx.c **** /* start un-buffered rx */
 928:bluetooth_rxtx.c **** static void cc2400_rx()
 929:bluetooth_rxtx.c **** {
 930:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
 931:bluetooth_rxtx.c **** 
 932:bluetooth_rxtx.c **** 	if((modulation == MOD_BT_BASIC_RATE) || (modulation == MOD_BT_LOW_ENERGY)) {
 933:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
 934:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
 935:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
 936:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
 937:bluetooth_rxtx.c **** 		}
 938:bluetooth_rxtx.c **** 		cc2400_set(MANAND,  0x7fff);
 939:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
 940:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG 16 MAX MIN PAIRS
 941:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 942:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
 943:bluetooth_rxtx.c **** 		//      |  | |   |  +--------> CRC off
 944:bluetooth_rxtx.c **** 		//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
 945:bluetooth_rxtx.c **** 		//      |  | +---------------> 2 preamble bytes of 01010101
 946:bluetooth_rxtx.c **** 		//      |  +-----------------> not packet mode
 947:bluetooth_rxtx.c **** 			//      +--------------------> un-buffered mode
 948:bluetooth_rxtx.c **** 		cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
 949:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
 950:bluetooth_rxtx.c **** 	}
 951:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccCuKxzC.s 			page 19


 952:bluetooth_rxtx.c **** 	// Set up CS register
 953:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
 954:bluetooth_rxtx.c **** 
 955:bluetooth_rxtx.c **** 	clkn_start();
 956:bluetooth_rxtx.c **** 
 957:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 958:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 959:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 960:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 961:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 962:bluetooth_rxtx.c **** 	PAEN_SET;
 963:bluetooth_rxtx.c **** 	HGM_SET;
 964:bluetooth_rxtx.c **** #endif
 965:bluetooth_rxtx.c **** }
 966:bluetooth_rxtx.c **** 
 967:bluetooth_rxtx.c **** /* start un-buffered rx */
 968:bluetooth_rxtx.c **** static void cc2400_rx_sync(u32 sync)
 969:bluetooth_rxtx.c **** {
 970:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 971:bluetooth_rxtx.c **** 
 972:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
 973:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 974:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
 975:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
 976:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
 977:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
 978:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 0 preamble bytes of 01010101
 979:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
 980:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
 981:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 0
 982:bluetooth_rxtx.c **** 
 983:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 984:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 985:bluetooth_rxtx.c **** 		grmdm = 0x6561; // un-buffered mode, packet w/ sync word detection
 986:bluetooth_rxtx.c **** 		// 0 11 00 1 010 11 0 00 0 1
 987:bluetooth_rxtx.c **** 		//   |  |  | |   |  +--------> CRC off
 988:bluetooth_rxtx.c **** 		//   |  |  | |   +-----------> sync word: 32 MSB bits of SYNC_WORD
 989:bluetooth_rxtx.c **** 		//   |  |  | +---------------> 2 preamble bytes of 01010101
 990:bluetooth_rxtx.c **** 		//   |  |  +-----------------> packet mode
 991:bluetooth_rxtx.c **** 		//   |  +--------------------> un-buffered mode
 992:bluetooth_rxtx.c **** 		//   +-----------------------> sync error bits: 3
 993:bluetooth_rxtx.c **** 
 994:bluetooth_rxtx.c **** 	} else {
 995:bluetooth_rxtx.c **** 		/* oops */
 996:bluetooth_rxtx.c **** 		return;
 997:bluetooth_rxtx.c **** 	}
 998:bluetooth_rxtx.c **** 
 999:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1000:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
1001:bluetooth_rxtx.c **** 
1002:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x104b); //JWHUR AFC settling = 2 maxmin pairs
1003:bluetooth_rxtx.c **** 	//cc2400_set(MDMTST0, 0x124b);
1004:bluetooth_rxtx.c **** 	// 1      2      4b
1005:bluetooth_rxtx.c **** 	// 00 0 1 0 0 10 01001011
1006:bluetooth_rxtx.c **** 	//    | | | | |  +---------> AFC_DELTA = ??
1007:bluetooth_rxtx.c **** 	//    | | | | +------------> AFC settling = 4 pairs (8 bit preamble)
1008:bluetooth_rxtx.c **** 	//    | | | +--------------> no AFC adjust on packet
ARM GAS  /tmp/ccCuKxzC.s 			page 20


1009:bluetooth_rxtx.c **** 	//    | | +----------------> do not invert data
1010:bluetooth_rxtx.c **** 	//    | +------------------> TX IF freq 1 0Hz
1011:bluetooth_rxtx.c **** 	//    +--------------------> PRNG off
1012:bluetooth_rxtx.c **** 	//
1013:bluetooth_rxtx.c **** 	// ref: CC2400 datasheet page 67
1014:bluetooth_rxtx.c **** 	// AFC settling explained page 41/42
1015:bluetooth_rxtx.c **** 
1016:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   grmdm);
1017:bluetooth_rxtx.c **** 
1018:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1019:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1020:bluetooth_rxtx.c **** 
1021:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel - 1); // 1 MHz IF
1022:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
1023:bluetooth_rxtx.c **** 
1024:bluetooth_rxtx.c **** 	//JWHUR RSSI sampling symbols
1025:bluetooth_rxtx.c **** 	cc2400_set(RSSI, 0x003f);
1026:bluetooth_rxtx.c **** 
1027:bluetooth_rxtx.c **** 	// Set up CS register
1028:bluetooth_rxtx.c **** 	cs_threshold_calc_and_set(channel);
1029:bluetooth_rxtx.c **** 
1030:bluetooth_rxtx.c **** 	clkn_start();
1031:bluetooth_rxtx.c **** 
1032:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1033:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1034:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1035:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
1036:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1037:bluetooth_rxtx.c **** 	PAEN_SET;
1038:bluetooth_rxtx.c **** 	HGM_SET;
1039:bluetooth_rxtx.c **** #endif
1040:bluetooth_rxtx.c **** }
1041:bluetooth_rxtx.c **** 
1042:bluetooth_rxtx.c **** /* start buffered tx */
1043:bluetooth_rxtx.c **** static void cc2400_tx_sync(uint32_t sync)
1044:bluetooth_rxtx.c **** {
1045:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1046:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1047:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1048:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1049:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
1050:bluetooth_rxtx.c **** 
1051:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1052:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1053:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1054:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1055:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1056:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1057:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1058:bluetooth_rxtx.c **** 
1059:bluetooth_rxtx.c **** 	cc2400_set(SYNCL,   sync & 0xffff);
1060:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
1061:bluetooth_rxtx.c **** 
1062:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   channel);
1063:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1064:bluetooth_rxtx.c **** 
1065:bluetooth_rxtx.c **** 	if (modulation == MOD_BT_BASIC_RATE) {
ARM GAS  /tmp/ccCuKxzC.s 			page 21


1066:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
1067:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
1068:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1069:bluetooth_rxtx.c **** 	} else {
1070:bluetooth_rxtx.c **** 		/* oops */
1071:bluetooth_rxtx.c **** 		return;
1072:bluetooth_rxtx.c **** 	}
1073:bluetooth_rxtx.c **** 
1074:bluetooth_rxtx.c **** 	clkn_start();
1075:bluetooth_rxtx.c **** 
1076:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1077:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1078:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1079:bluetooth_rxtx.c **** 
1080:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1081:bluetooth_rxtx.c **** 	PAEN_SET;
1082:bluetooth_rxtx.c **** #endif
1083:bluetooth_rxtx.c **** 
1084:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1085:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1086:bluetooth_rxtx.c **** 
1087:bluetooth_rxtx.c **** #endif
1088:bluetooth_rxtx.c **** }
1089:bluetooth_rxtx.c **** 
1090:bluetooth_rxtx.c **** /*
1091:bluetooth_rxtx.c ****  * Transmit a BTLE packet with the specified access address.
1092:bluetooth_rxtx.c ****  *
1093:bluetooth_rxtx.c ****  * All modulation parameters are set within this function. The data
1094:bluetooth_rxtx.c ****  * should not be pre-whitened, but the CRC should be calculated and
1095:bluetooth_rxtx.c ****  * included in the data length.
1096:bluetooth_rxtx.c ****  */
1097:bluetooth_rxtx.c **** void le_transmit(u32 aa, u8 len, u8 *data, u16 ch)
1098:bluetooth_rxtx.c **** {
1099:bluetooth_rxtx.c **** 	unsigned i, j;
1100:bluetooth_rxtx.c **** 	int bit;
1101:bluetooth_rxtx.c **** 	uint16_t jw_channel = 2402;
1102:bluetooth_rxtx.c **** 	jw_channel = ch;
1103:bluetooth_rxtx.c **** 	u8 txbuf[64] = {0, };
1104:bluetooth_rxtx.c **** 	u8 tx_len;
1105:bluetooth_rxtx.c **** 	u8 byte;
1106:bluetooth_rxtx.c **** 	u16 gio_save;
1107:bluetooth_rxtx.c **** 	//JWHUR tx power control
1108:bluetooth_rxtx.c **** 	u8 tx_pwr = 0x0007;
1109:bluetooth_rxtx.c **** 
1110:bluetooth_rxtx.c **** 	// first four bytes: AA
1111:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
1112:bluetooth_rxtx.c **** 		byte = aa & 0xff;
1113:bluetooth_rxtx.c **** 		aa >>= 8;
1114:bluetooth_rxtx.c **** 		txbuf[i] = 0;
1115:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
1116:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
1117:bluetooth_rxtx.c **** 			byte >>= 1;
1118:bluetooth_rxtx.c **** 		}
1119:bluetooth_rxtx.c **** 	}
1120:bluetooth_rxtx.c **** 
1121:bluetooth_rxtx.c **** 	// whiten the data and copy it into the txbuf
1122:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(jw_channel-2402)];
ARM GAS  /tmp/ccCuKxzC.s 			page 22


1123:bluetooth_rxtx.c **** 	
1124:bluetooth_rxtx.c **** 	for (i = 0; i < len; ++i) {
1125:bluetooth_rxtx.c **** 		byte = data[i];
1126:bluetooth_rxtx.c **** 		txbuf[i+4] = 0;
1127:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
1128:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
1129:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
1130:bluetooth_rxtx.c **** 			byte >>= 1;
1131:bluetooth_rxtx.c **** 			txbuf[i+4] |= bit << (7 - j);
1132:bluetooth_rxtx.c **** 		}
1133:bluetooth_rxtx.c **** 	}
1134:bluetooth_rxtx.c **** 
1135:bluetooth_rxtx.c **** 	len += 4; // include the AA in len
1136:bluetooth_rxtx.c **** 
1137:bluetooth_rxtx.c **** 	// Bluetooth-like modulation
1138:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1139:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1140:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
1141:bluetooth_rxtx.c **** 
1142:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1143:bluetooth_rxtx.c **** 	// 0 00 01 1 001 00 0 00 0 1
1144:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1145:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1146:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1147:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1148:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1149:bluetooth_rxtx.c **** 
1150:bluetooth_rxtx.c **** 	cc2400_set(FSDIV,   jw_channel);
1151:bluetooth_rxtx.c **** 	// JWHUR cc2400 data sheet about power control
1152:bluetooth_rxtx.c **** 	// lsb 3 bit : dbm
1153:bluetooth_rxtx.c **** 	// 000 : -25
1154:bluetooth_rxtx.c **** 	// 001 : -15
1155:bluetooth_rxtx.c **** 	// 010 : -10
1156:bluetooth_rxtx.c **** 	// 011 : -7
1157:bluetooth_rxtx.c **** 	// 100 : -4.6
1158:bluetooth_rxtx.c **** 	// 101 : -2.8
1159:bluetooth_rxtx.c **** 	// 110 : -1.3
1160:bluetooth_rxtx.c **** 	// 111 : 0
1161:bluetooth_rxtx.c **** 	cc2400_set(FREND, tx_pwr);
1162:bluetooth_rxtx.c **** 	//cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1163:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1164:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1165:bluetooth_rxtx.c **** 
1166:bluetooth_rxtx.c **** 	// sync byte depends on the first transmitted bit of the AA
1167:bluetooth_rxtx.c **** 	if (aa & 1)
1168:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0xaaaa);
1169:bluetooth_rxtx.c **** 	else
1170:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0x5555);
1171:bluetooth_rxtx.c **** 
1172:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1173:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
1174:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
1175:bluetooth_rxtx.c **** 
1176:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1177:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1178:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1179:bluetooth_rxtx.c **** 	TXLED_SET;
ARM GAS  /tmp/ccCuKxzC.s 			page 23


1180:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1181:bluetooth_rxtx.c **** 	PAEN_SET;
1182:bluetooth_rxtx.c **** #endif
1183:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1184:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1185:bluetooth_rxtx.c **** 
1186:bluetooth_rxtx.c **** 	// put the packet into the FIFO
1187:bluetooth_rxtx.c **** 	
1188:bluetooth_rxtx.c **** /*	for (i = 0; i < len; i += 16) {
1189:bluetooth_rxtx.c **** 		while (GIO6) ; // wait for the FIFO to drain (FIFO_FULL false)
1190:bluetooth_rxtx.c **** 		tx_len = len - i;
1191:bluetooth_rxtx.c **** 		if (tx_len >16)
1192:bluetooth_rxtx.c **** 			tx_len = 16;
1193:bluetooth_rxtx.c **** 		cc2400_fifo_write(tx_len, txbuf + i);
1194:bluetooth_rxtx.c **** 	}*/
1195:bluetooth_rxtx.c **** 
1196:bluetooth_rxtx.c **** 	//JWHUR cc2400 fifo write
1197:bluetooth_rxtx.c **** 	while (GIO6) ;
1198:bluetooth_rxtx.c **** 	if (len > 46) len = 46;
1199:bluetooth_rxtx.c **** 	cc2400_fifo_write(len, txbuf);
1200:bluetooth_rxtx.c **** 
1201:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1202:bluetooth_rxtx.c **** 	TXLED_CLR;
1203:bluetooth_rxtx.c **** 
1204:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1205:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
1206:bluetooth_rxtx.c **** 
1207:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1208:bluetooth_rxtx.c **** 	PAEN_CLR;
1209:bluetooth_rxtx.c **** #endif
1210:bluetooth_rxtx.c **** 
1211:bluetooth_rxtx.c **** 	// reset GIO
1212:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
1213:bluetooth_rxtx.c **** }
1214:bluetooth_rxtx.c **** 
1215:bluetooth_rxtx.c **** void le_jam(void) {
1216:bluetooth_rxtx.c **** #ifdef TX_ENABLE
1217:bluetooth_rxtx.c **** 	cc2400_set(MANAND,  0x7fff);
1218:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
1219:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
1220:bluetooth_rxtx.c **** 
1221:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0c01);
1222:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
1223:bluetooth_rxtx.c **** 	//      |  | |   |  +--------> CRC off
1224:bluetooth_rxtx.c **** 	//      |  | |   +-----------> sync word: 8 MSB bits of SYNC_WORD
1225:bluetooth_rxtx.c **** 	//      |  | +---------------> 0 preamble bytes of 01010101
1226:bluetooth_rxtx.c **** 	//      |  +-----------------> packet mode
1227:bluetooth_rxtx.c **** 	//      +--------------------> buffered mode
1228:bluetooth_rxtx.c **** 
1229:bluetooth_rxtx.c **** 	// cc2400_set(FSDIV,   channel);
1230:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
1231:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
1232:bluetooth_rxtx.c **** 
1233:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
1234:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1235:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1236:bluetooth_rxtx.c **** 	TXLED_SET;
ARM GAS  /tmp/ccCuKxzC.s 			page 24


1237:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1238:bluetooth_rxtx.c **** 	PAEN_SET;
1239:bluetooth_rxtx.c **** #endif
1240:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1241:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
1242:bluetooth_rxtx.c **** #endif
1243:bluetooth_rxtx.c **** }
1244:bluetooth_rxtx.c **** 
1245:bluetooth_rxtx.c **** /* TODO - return whether hop happened, or should caller have to keep
1246:bluetooth_rxtx.c ****  * track of this? */
1247:bluetooth_rxtx.c **** void hop(void)
1248:bluetooth_rxtx.c **** {
1249:bluetooth_rxtx.c **** 	do_hop = 0;
1250:bluetooth_rxtx.c **** 	last_hop = clkn;
1251:bluetooth_rxtx.c **** 
1252:bluetooth_rxtx.c **** 	// No hopping, if channel is set correctly, do nothing
1253:bluetooth_rxtx.c **** 	if (hop_mode == HOP_NONE) {
1254:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
1255:bluetooth_rxtx.c **** 			return;
1256:bluetooth_rxtx.c **** 	}
1257:bluetooth_rxtx.c **** 	/* Slow sweep (100 hops/sec)
1258:bluetooth_rxtx.c **** 	 * only hop to currently used channels if AFH is enabled
1259:bluetooth_rxtx.c **** 	 */
1260:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_SWEEP) {
1261:bluetooth_rxtx.c **** 		do {
1262:bluetooth_rxtx.c **** 			channel += 32;
1263:bluetooth_rxtx.c **** 			if (channel > 2480)
1264:bluetooth_rxtx.c **** 				channel -= 79;
1265:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
1266:bluetooth_rxtx.c **** 	}
1267:bluetooth_rxtx.c **** 
1268:bluetooth_rxtx.c **** 	/* AFH detection
1269:bluetooth_rxtx.c **** 	 * only hop to currently unused channesl
1270:bluetooth_rxtx.c **** 	 */
1271:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_AFH) {
1272:bluetooth_rxtx.c **** 		do {
1273:bluetooth_rxtx.c **** 			channel += 32;
1274:bluetooth_rxtx.c **** 			if (channel > 2480)
1275:bluetooth_rxtx.c **** 				channel -= 79;
1276:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
1277:bluetooth_rxtx.c **** 	}
1278:bluetooth_rxtx.c **** 
1279:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BLUETOOTH) {
1280:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
1281:bluetooth_rxtx.c **** 	}
1282:bluetooth_rxtx.c **** 
1283:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_BTLE) {
1284:bluetooth_rxtx.c **** 		channel = btle_next_hop(&le);
1285:bluetooth_rxtx.c **** 	}
1286:bluetooth_rxtx.c **** 
1287:bluetooth_rxtx.c **** 	else if (hop_mode == HOP_DIRECT) {
1288:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
1289:bluetooth_rxtx.c **** 	}
1290:bluetooth_rxtx.c **** 	/* IDLE mode, but leave amp on, so don't call cc2400_idle(). */
1291:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
1292:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1293:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccCuKxzC.s 			page 25


1294:bluetooth_rxtx.c **** 	/* Retune */
1295:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1296:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
1297:bluetooth_rxtx.c **** 	else
1298:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel - 1);
1299:bluetooth_rxtx.c **** 
1300:bluetooth_rxtx.c **** 	/* Update CS register if hopping.  */
1301:bluetooth_rxtx.c **** 	if (hop_mode > 0) {
1302:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
1303:bluetooth_rxtx.c **** 	}
1304:bluetooth_rxtx.c **** 
1305:bluetooth_rxtx.c **** 	/* Wait for lock */
1306:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
1307:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
1308:bluetooth_rxtx.c **** 
1309:bluetooth_rxtx.c **** 	dma_discard = 1;
1310:bluetooth_rxtx.c **** 
1311:bluetooth_rxtx.c **** 	if(mode == MODE_TX_SYMBOLS)
1312:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1313:bluetooth_rxtx.c **** 	else
1314:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
1315:bluetooth_rxtx.c **** }
1316:bluetooth_rxtx.c **** 
1317:bluetooth_rxtx.c **** /* Bluetooth packet monitoring */
1318:bluetooth_rxtx.c **** void bt_stream_rx()
1319:bluetooth_rxtx.c **** {
1320:bluetooth_rxtx.c **** 	int8_t rssi;
1321:bluetooth_rxtx.c **** 	int8_t rssi_at_trigger;
1322:bluetooth_rxtx.c **** 
1323:bluetooth_rxtx.c **** 	RXLED_CLR;
1324:bluetooth_rxtx.c **** 
1325:bluetooth_rxtx.c **** 	queue_init();
1326:bluetooth_rxtx.c **** 	dio_ssp_init();
1327:bluetooth_rxtx.c **** 	dma_init();
1328:bluetooth_rxtx.c **** 	dio_ssp_start();
1329:bluetooth_rxtx.c **** 
1330:bluetooth_rxtx.c **** 	cc2400_rx();
1331:bluetooth_rxtx.c **** 
1332:bluetooth_rxtx.c **** 	cs_trigger_enable();
1333:bluetooth_rxtx.c **** 
1334:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_RX_SYMBOLS || requested_mode == MODE_BT_FOLLOW )
1335:bluetooth_rxtx.c **** 	{
1336:bluetooth_rxtx.c **** 
1337:bluetooth_rxtx.c **** 		RXLED_CLR;
1338:bluetooth_rxtx.c **** 
1339:bluetooth_rxtx.c **** 		/* Wait for DMA transfer. TODO - need more work on
1340:bluetooth_rxtx.c **** 		 * RSSI. Should send RSSI indications to host even
1341:bluetooth_rxtx.c **** 		 * when not transferring data. That would also keep
1342:bluetooth_rxtx.c **** 		 * the USB stream going. This loop runs 50-80 times
1343:bluetooth_rxtx.c **** 		 * while waiting for DMA, but RSSI sampling does not
1344:bluetooth_rxtx.c **** 		 * cover all the symbols in a DMA transfer. Can not do
1345:bluetooth_rxtx.c **** 		 * RSSI sampling in CS interrupt, but could log time
1346:bluetooth_rxtx.c **** 		 * at multiple trigger points there. The MAX() below
1347:bluetooth_rxtx.c **** 		 * helps with statistics in the case that cs_trigger
1348:bluetooth_rxtx.c **** 		 * happened before the loop started. */
1349:bluetooth_rxtx.c **** 		rssi_reset();
1350:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
ARM GAS  /tmp/ccCuKxzC.s 			page 26


1351:bluetooth_rxtx.c **** 		while (!rx_tc) {
1352:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1353:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1354:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1355:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
1356:bluetooth_rxtx.c **** 			}
1357:bluetooth_rxtx.c **** 			rssi_add(rssi);
1358:bluetooth_rxtx.c **** 
1359:bluetooth_rxtx.c **** 			handle_usb(clkn);
1360:bluetooth_rxtx.c **** 
1361:bluetooth_rxtx.c **** 			/* If timer says time to hop, do it. */
1362:bluetooth_rxtx.c **** 			if (do_hop) {
1363:bluetooth_rxtx.c **** 				hop();
1364:bluetooth_rxtx.c **** 			} else {
1365:bluetooth_rxtx.c **** 				TXLED_CLR;
1366:bluetooth_rxtx.c **** 			}
1367:bluetooth_rxtx.c **** 			/* TODO - set per-channel carrier sense threshold.
1368:bluetooth_rxtx.c **** 			 * Set by firmware or host. */
1369:bluetooth_rxtx.c **** 		}
1370:bluetooth_rxtx.c **** 
1371:bluetooth_rxtx.c **** 		RXLED_SET;
1372:bluetooth_rxtx.c **** 
1373:bluetooth_rxtx.c **** 		if (rx_err) {
1374:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1375:bluetooth_rxtx.c **** 		}
1376:bluetooth_rxtx.c **** 
1377:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1378:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1379:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1380:bluetooth_rxtx.c **** 
1381:bluetooth_rxtx.c **** 		if (dma_discard) {
1382:bluetooth_rxtx.c **** 			status |= DISCARD;
1383:bluetooth_rxtx.c **** 			dma_discard = 0;
1384:bluetooth_rxtx.c **** 		}
1385:bluetooth_rxtx.c **** 
1386:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1387:bluetooth_rxtx.c **** 
1388:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1389:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1390:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1391:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1392:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1393:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1394:bluetooth_rxtx.c **** 			cs_trigger = 0;
1395:bluetooth_rxtx.c **** 		}
1396:bluetooth_rxtx.c **** 
1397:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1398:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1399:bluetooth_rxtx.c **** 		}
1400:bluetooth_rxtx.c **** 
1401:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, (uint8_t*)idle_rxbuf);
1402:bluetooth_rxtx.c **** 
1403:bluetooth_rxtx.c **** 		handle_usb(clkn);
1404:bluetooth_rxtx.c **** 		rx_tc = 0;
1405:bluetooth_rxtx.c **** 		rx_err = 0;
1406:bluetooth_rxtx.c **** 	}
1407:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccCuKxzC.s 			page 27


1408:bluetooth_rxtx.c **** 	/* This call is a nop so far. Since bt_rx_stream() starts the
1409:bluetooth_rxtx.c **** 	 * stream, it makes sense that it would stop it. TODO - how
1410:bluetooth_rxtx.c **** 	 * should setup/teardown be handled? Should every new mode be
1411:bluetooth_rxtx.c **** 	 * starting from scratch? */
1412:bluetooth_rxtx.c **** 	dio_ssp_stop();
1413:bluetooth_rxtx.c **** 	cs_trigger_disable();
1414:bluetooth_rxtx.c **** }
1415:bluetooth_rxtx.c **** 
1416:bluetooth_rxtx.c **** static uint8_t reverse8(uint8_t data)
1417:bluetooth_rxtx.c **** {
  76              		.loc 1 1417 0
  77              		.cfi_startproc
  78              		@ args = 0, pretend = 0, frame = 0
  79              		@ frame_needed = 0, uses_anonymous_args = 0
  80              	.LVL5:
  81 0000 10B5     		push	{r4, lr}
  82              		.cfi_def_cfa_offset 8
  83              		.cfi_offset 4, -8
  84              		.cfi_offset 14, -4
  85              	.LVL6:
  86              	.LBB4:
1418:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
1419:bluetooth_rxtx.c **** 
1420:bluetooth_rxtx.c **** 	for(size_t i=0; i<8; i++)
  87              		.loc 1 1420 0
  88 0002 0023     		movs	r3, #0
  89              	.LBE4:
1418:bluetooth_rxtx.c **** 	uint8_t reversed = 0;
  90              		.loc 1 1418 0
  91 0004 1A46     		mov	r2, r3
  92              	.LVL7:
  93              	.L9:
  94              	.LBB5:
1421:bluetooth_rxtx.c **** 	{
1422:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (7-i);
  95              		.loc 1 1422 0 discriminator 2
  96 0006 40FA03F1 		asr	r1, r0, r3
  97 000a C3F10704 		rsb	r4, r3, #7
  98 000e 01F00101 		and	r1, r1, #1
  99 0012 A140     		lsls	r1, r1, r4
1420:bluetooth_rxtx.c **** 	{
 100              		.loc 1 1420 0 discriminator 2
 101 0014 0133     		adds	r3, r3, #1
 102              	.LVL8:
 103              		.loc 1 1422 0 discriminator 2
 104 0016 0A43     		orrs	r2, r2, r1
 105              	.LVL9:
1420:bluetooth_rxtx.c **** 	{
 106              		.loc 1 1420 0 discriminator 2
 107 0018 082B     		cmp	r3, #8
 108              		.loc 1 1422 0 discriminator 2
 109 001a D2B2     		uxtb	r2, r2
 110              	.LVL10:
1420:bluetooth_rxtx.c **** 	{
 111              		.loc 1 1420 0 discriminator 2
 112 001c F3D1     		bne	.L9
 113              	.LBE5:
ARM GAS  /tmp/ccCuKxzC.s 			page 28


1423:bluetooth_rxtx.c **** 	}
1424:bluetooth_rxtx.c **** 
1425:bluetooth_rxtx.c **** 	return reversed;
1426:bluetooth_rxtx.c **** }
 114              		.loc 1 1426 0
 115 001e 1046     		mov	r0, r2
 116              	.LVL11:
 117 0020 10BD     		pop	{r4, pc}
 118              		.cfi_endproc
 119              	.LFE16:
 121              		.section	.text.cc2400_rx,"ax",%progbits
 122              		.align	1
 123              		.thumb
 124              		.thumb_func
 126              	cc2400_rx:
 127              	.LFB9:
 929:bluetooth_rxtx.c **** 	u16 mdmctrl = 0;
 128              		.loc 1 929 0
 129              		.cfi_startproc
 130              		@ args = 0, pretend = 0, frame = 0
 131              		@ frame_needed = 0, uses_anonymous_args = 0
 132 0000 38B5     		push	{r3, r4, r5, lr}
 133              		.cfi_def_cfa_offset 16
 134              		.cfi_offset 3, -16
 135              		.cfi_offset 4, -12
 136              		.cfi_offset 5, -8
 137              		.cfi_offset 14, -4
 138              	.LVL12:
 932:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
 139              		.loc 1 932 0
 140 0002 254B     		ldr	r3, .L24
 141 0004 254C     		ldr	r4, .L24+4
 142 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 143 0008 12B1     		cbz	r2, .L12
 932:bluetooth_rxtx.c **** 		if (modulation == MOD_BT_BASIC_RATE) {
 144              		.loc 1 932 0 is_stmt 0 discriminator 1
 145 000a 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 146 000c 012A     		cmp	r2, #1
 147 000e 28D1     		bne	.L13
 148              	.L12:
 933:bluetooth_rxtx.c **** 			mdmctrl = 0x0029; // 160 kHz frequency deviation
 149              		.loc 1 933 0 is_stmt 1
 150 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 151 0012 33B1     		cbz	r3, .L19
 935:bluetooth_rxtx.c **** 			mdmctrl = 0x0040; // 250 kHz frequency deviation
 152              		.loc 1 935 0
 153 0014 204B     		ldr	r3, .L24
 154 0016 1D78     		ldrb	r5, [r3]	@ zero_extendqisi2
 930:bluetooth_rxtx.c **** 
 155              		.loc 1 930 0
 156 0018 012D     		cmp	r5, #1
 157 001a 0CBF     		ite	eq
 158 001c 4025     		moveq	r5, #64
 159 001e 0025     		movne	r5, #0
 160 0020 00E0     		b	.L14
 161              	.L19:
 934:bluetooth_rxtx.c **** 		} else if (modulation == MOD_BT_LOW_ENERGY) {
ARM GAS  /tmp/ccCuKxzC.s 			page 29


 162              		.loc 1 934 0
 163 0022 2925     		movs	r5, #41
 164              	.L14:
 165              	.LVL13:
 938:bluetooth_rxtx.c **** 		cc2400_set(LMTST,   0x2b22);
 166              		.loc 1 938 0
 167 0024 0D20     		movs	r0, #13
 168 0026 47F6FF71 		movw	r1, #32767
 169 002a FFF7FEFF 		bl	cc2400_set
 170              	.LVL14:
 939:bluetooth_rxtx.c **** 		cc2400_set(MDMTST0, 0x134b); // without PRNG 16 MAX MIN PAIRS
 171              		.loc 1 939 0
 172 002e 1220     		movs	r0, #18
 173 0030 42F62231 		movw	r1, #11042
 174 0034 FFF7FEFF 		bl	cc2400_set
 175              	.LVL15:
 940:bluetooth_rxtx.c **** 		cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 176              		.loc 1 940 0
 177 0038 1420     		movs	r0, #20
 178 003a 41F24B31 		movw	r1, #4939
 179 003e FFF7FEFF 		bl	cc2400_set
 180              	.LVL16:
 941:bluetooth_rxtx.c **** 		// 0 00 00 0 010 00 0 00 0 1
 181              		.loc 1 941 0
 182 0042 2020     		movs	r0, #32
 183 0044 40F20111 		movw	r1, #257
 184 0048 FFF7FEFF 		bl	cc2400_set
 185              	.LVL17:
 948:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, mdmctrl);
 186              		.loc 1 948 0
 187 004c 2188     		ldrh	r1, [r4]
 188 004e 0220     		movs	r0, #2
 189 0050 89B2     		uxth	r1, r1
 190 0052 0139     		subs	r1, r1, #1
 191 0054 89B2     		uxth	r1, r1
 192 0056 FFF7FEFF 		bl	cc2400_set
 193              	.LVL18:
 949:bluetooth_rxtx.c **** 	}
 194              		.loc 1 949 0
 195 005a 0320     		movs	r0, #3
 196 005c 2946     		mov	r1, r5
 197 005e FFF7FEFF 		bl	cc2400_set
 198              	.LVL19:
 199              	.L13:
 953:bluetooth_rxtx.c **** 
 200              		.loc 1 953 0
 201 0062 2088     		ldrh	r0, [r4]
 202 0064 80B2     		uxth	r0, r0
 203 0066 FFF7FEFF 		bl	cs_threshold_calc_and_set
 204              	.LVL20:
 955:bluetooth_rxtx.c **** 
 205              		.loc 1 955 0
 206 006a FFF7FEFF 		bl	clkn_start
 207              	.LVL21:
 208              	.L16:
 957:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 209              		.loc 1 957 0 discriminator 1
ARM GAS  /tmp/ccCuKxzC.s 			page 30


 210 006e FFF7FEFF 		bl	cc2400_status
 211              	.LVL22:
 212 0072 4206     		lsls	r2, r0, #25
 213 0074 FBD5     		bpl	.L16
 958:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 214              		.loc 1 958 0
 215 0076 6120     		movs	r0, #97
 216 0078 FFF7FEFF 		bl	cc2400_strobe
 217              	.LVL23:
 218              	.L18:
 959:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 219              		.loc 1 959 0 discriminator 1
 220 007c FFF7FEFF 		bl	cc2400_status
 221              	.LVL24:
 222 0080 4307     		lsls	r3, r0, #29
 223 0082 FBD5     		bpl	.L18
 960:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 224              		.loc 1 960 0
 225 0084 6220     		movs	r0, #98
 226 0086 FFF7FEFF 		bl	cc2400_strobe
 227              	.LVL25:
 962:bluetooth_rxtx.c **** 	HGM_SET;
 228              		.loc 1 962 0
 229 008a 054B     		ldr	r3, .L24+8
 230 008c 8022     		movs	r2, #128
 231 008e 1A60     		str	r2, [r3]
 963:bluetooth_rxtx.c **** #endif
 232              		.loc 1 963 0
 233 0090 4FF48072 		mov	r2, #256
 234 0094 1A60     		str	r2, [r3]
 235 0096 38BD     		pop	{r3, r4, r5, pc}
 236              	.L25:
 237              		.align	2
 238              	.L24:
 239 0098 00000000 		.word	.LANCHOR0
 240 009c 00000000 		.word	.LANCHOR1
 241 00a0 58C00920 		.word	537509976
 242              		.cfi_endproc
 243              	.LFE9:
 245              		.section	.text.cc2400_rx_sync,"ax",%progbits
 246              		.align	1
 247              		.thumb
 248              		.thumb_func
 250              	cc2400_rx_sync:
 251              	.LFB10:
 969:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 252              		.loc 1 969 0
 253              		.cfi_startproc
 254              		@ args = 0, pretend = 0, frame = 0
 255              		@ frame_needed = 0, uses_anonymous_args = 0
 256              	.LVL26:
 257 0000 70B5     		push	{r4, r5, r6, lr}
 258              		.cfi_def_cfa_offset 16
 259              		.cfi_offset 4, -16
 260              		.cfi_offset 5, -12
 261              		.cfi_offset 6, -8
 262              		.cfi_offset 14, -4
ARM GAS  /tmp/ccCuKxzC.s 			page 31


 972:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 263              		.loc 1 972 0
 264 0002 2A4B     		ldr	r3, .L34
 969:bluetooth_rxtx.c **** 	u16 grmdm, mdmctrl;
 265              		.loc 1 969 0
 266 0004 0446     		mov	r4, r0
 972:bluetooth_rxtx.c **** 		mdmctrl = 0x0029; // 160 kHz frequency deviation
 267              		.loc 1 972 0
 268 0006 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 269 0008 32B1     		cbz	r2, .L33
 983:bluetooth_rxtx.c **** 		mdmctrl = 0x0040; // 250 kHz frequency deviation
 270              		.loc 1 983 0
 271 000a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 272 000c 012B     		cmp	r3, #1
 273 000e 4BD1     		bne	.L26
 984:bluetooth_rxtx.c **** 		grmdm = 0x6561; // un-buffered mode, packet w/ sync word detection
 274              		.loc 1 984 0
 275 0010 4025     		movs	r5, #64
 985:bluetooth_rxtx.c **** 		// 0 11 00 1 010 11 0 00 0 1
 276              		.loc 1 985 0
 277 0012 46F26156 		movw	r6, #25953
 278 0016 02E0     		b	.L27
 279              	.L33:
 973:bluetooth_rxtx.c **** 		grmdm = 0x0461; // un-buffered mode, packet w/ sync word detection
 280              		.loc 1 973 0
 281 0018 2925     		movs	r5, #41
 974:bluetooth_rxtx.c **** 		// 0 00 00 1 000 11 0 00 0 1
 282              		.loc 1 974 0
 283 001a 40F26146 		movw	r6, #1121
 284              	.L27:
 285              	.LVL27:
 999:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 286              		.loc 1 999 0
 287 001e 0D20     		movs	r0, #13
 288              	.LVL28:
 289 0020 47F6FF71 		movw	r1, #32767
 290 0024 FFF7FEFF 		bl	cc2400_set
 291              	.LVL29:
1000:bluetooth_rxtx.c **** 
 292              		.loc 1 1000 0
 293 0028 1220     		movs	r0, #18
 294 002a 42F62231 		movw	r1, #11042
 295 002e FFF7FEFF 		bl	cc2400_set
 296              	.LVL30:
1002:bluetooth_rxtx.c **** 	//cc2400_set(MDMTST0, 0x124b);
 297              		.loc 1 1002 0
 298 0032 1420     		movs	r0, #20
 299 0034 41F24B01 		movw	r1, #4171
 300 0038 FFF7FEFF 		bl	cc2400_set
 301              	.LVL31:
1016:bluetooth_rxtx.c **** 
 302              		.loc 1 1016 0
 303 003c 2020     		movs	r0, #32
 304 003e 3146     		mov	r1, r6
 305 0040 FFF7FEFF 		bl	cc2400_set
 306              	.LVL32:
1018:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
ARM GAS  /tmp/ccCuKxzC.s 			page 32


 307              		.loc 1 1018 0
 308 0044 A1B2     		uxth	r1, r4
 309 0046 2C20     		movs	r0, #44
 310 0048 FFF7FEFF 		bl	cc2400_set
 311              	.LVL33:
1019:bluetooth_rxtx.c **** 
 312              		.loc 1 1019 0
 313 004c 210C     		lsrs	r1, r4, #16
1021:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 314              		.loc 1 1021 0
 315 004e 184C     		ldr	r4, .L34+4
 316              	.LVL34:
1019:bluetooth_rxtx.c **** 
 317              		.loc 1 1019 0
 318 0050 2D20     		movs	r0, #45
 319 0052 FFF7FEFF 		bl	cc2400_set
 320              	.LVL35:
1021:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, mdmctrl);
 321              		.loc 1 1021 0
 322 0056 2188     		ldrh	r1, [r4]
 323 0058 0220     		movs	r0, #2
 324 005a 89B2     		uxth	r1, r1
 325 005c 0139     		subs	r1, r1, #1
 326 005e 89B2     		uxth	r1, r1
 327 0060 FFF7FEFF 		bl	cc2400_set
 328              	.LVL36:
1022:bluetooth_rxtx.c **** 
 329              		.loc 1 1022 0
 330 0064 0320     		movs	r0, #3
 331 0066 2946     		mov	r1, r5
 332 0068 FFF7FEFF 		bl	cc2400_set
 333              	.LVL37:
1025:bluetooth_rxtx.c **** 
 334              		.loc 1 1025 0
 335 006c 0620     		movs	r0, #6
 336 006e 3F21     		movs	r1, #63
 337 0070 FFF7FEFF 		bl	cc2400_set
 338              	.LVL38:
1028:bluetooth_rxtx.c **** 
 339              		.loc 1 1028 0
 340 0074 2088     		ldrh	r0, [r4]
 341 0076 80B2     		uxth	r0, r0
 342 0078 FFF7FEFF 		bl	cs_threshold_calc_and_set
 343              	.LVL39:
1030:bluetooth_rxtx.c **** 
 344              		.loc 1 1030 0
 345 007c FFF7FEFF 		bl	clkn_start
 346              	.LVL40:
 347              	.L30:
1032:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 348              		.loc 1 1032 0 discriminator 1
 349 0080 FFF7FEFF 		bl	cc2400_status
 350              	.LVL41:
 351 0084 4006     		lsls	r0, r0, #25
 352 0086 FBD5     		bpl	.L30
1033:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 353              		.loc 1 1033 0
ARM GAS  /tmp/ccCuKxzC.s 			page 33


 354 0088 6120     		movs	r0, #97
 355 008a FFF7FEFF 		bl	cc2400_strobe
 356              	.LVL42:
 357              	.L32:
1034:bluetooth_rxtx.c **** 	cc2400_strobe(SRX);
 358              		.loc 1 1034 0 discriminator 1
 359 008e FFF7FEFF 		bl	cc2400_status
 360              	.LVL43:
 361 0092 4107     		lsls	r1, r0, #29
 362 0094 FBD5     		bpl	.L32
1035:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 363              		.loc 1 1035 0
 364 0096 6220     		movs	r0, #98
 365 0098 FFF7FEFF 		bl	cc2400_strobe
 366              	.LVL44:
1037:bluetooth_rxtx.c **** 	HGM_SET;
 367              		.loc 1 1037 0
 368 009c 054B     		ldr	r3, .L34+8
 369 009e 8022     		movs	r2, #128
 370 00a0 1A60     		str	r2, [r3]
1038:bluetooth_rxtx.c **** #endif
 371              		.loc 1 1038 0
 372 00a2 4FF48072 		mov	r2, #256
 373 00a6 1A60     		str	r2, [r3]
 374              	.LVL45:
 375              	.L26:
 376 00a8 70BD     		pop	{r4, r5, r6, pc}
 377              	.L35:
 378 00aa 00BF     		.align	2
 379              	.L34:
 380 00ac 00000000 		.word	.LANCHOR0
 381 00b0 00000000 		.word	.LANCHOR1
 382 00b4 58C00920 		.word	537509976
 383              		.cfi_endproc
 384              	.LFE10:
 386              		.section	.text.enqueue,"ax",%progbits
 387              		.align	1
 388              		.thumb
 389              		.thumb_func
 391              	enqueue:
 392              	.LFB0:
 133:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 393              		.loc 1 133 0
 394              		.cfi_startproc
 395              		@ args = 0, pretend = 0, frame = 0
 396              		@ frame_needed = 0, uses_anonymous_args = 0
 397              	.LVL46:
 398 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 399              		.cfi_def_cfa_offset 24
 400              		.cfi_offset 3, -24
 401              		.cfi_offset 4, -20
 402              		.cfi_offset 5, -16
 403              		.cfi_offset 6, -12
 404              		.cfi_offset 7, -8
 405              		.cfi_offset 14, -4
 133:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 406              		.loc 1 133 0
ARM GAS  /tmp/ccCuKxzC.s 			page 34


 407 0002 0646     		mov	r6, r0
 408 0004 0F46     		mov	r7, r1
 134:bluetooth_rxtx.c **** 	
 409              		.loc 1 134 0
 410 0006 FFF7FEFF 		bl	usb_enqueue
 411              	.LVL47:
 412 000a 1E4D     		ldr	r5, .L41
 137:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 413              		.loc 1 137 0
 414 000c 0446     		mov	r4, r0
 415 000e 20B9     		cbnz	r0, .L37
 138:bluetooth_rxtx.c **** 		return 0;
 416              		.loc 1 138 0
 417 0010 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 418 0012 43F00403 		orr	r3, r3, #4
 419 0016 6B70     		strb	r3, [r5, #1]
 139:bluetooth_rxtx.c **** 	}
 420              		.loc 1 139 0
 421 0018 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 422              	.LVL48:
 423              	.L37:
 143:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 424              		.loc 1 143 0
 425 001a 042E     		cmp	r6, #4
 142:bluetooth_rxtx.c **** 	if(type == SPECAN) {
 426              		.loc 1 142 0
 427 001c 0670     		strb	r6, [r0]
 143:bluetooth_rxtx.c **** 		f->clkn_high = (clkn >> 20) & 0xff;
 428              		.loc 1 143 0
 429 001e 0ED1     		bne	.L39
 144:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 430              		.loc 1 144 0
 431 0020 194B     		ldr	r3, .L41+4
 145:bluetooth_rxtx.c **** 	} else {
 432              		.loc 1 145 0
 433 0022 40F63541 		movw	r1, #3125
 144:bluetooth_rxtx.c **** 		f->clk100ns = CLK100NS;
 434              		.loc 1 144 0
 435 0026 1A68     		ldr	r2, [r3]
 436 0028 120D     		lsrs	r2, r2, #20
 437 002a C270     		strb	r2, [r0, #3]
 145:bluetooth_rxtx.c **** 	} else {
 438              		.loc 1 145 0
 439 002c 174A     		ldr	r2, .L41+8
 440 002e 1B68     		ldr	r3, [r3]
 441 0030 1268     		ldr	r2, [r2]
 442 0032 C3F31303 		ubfx	r3, r3, #0, #20
 443 0036 01FB0323 		mla	r3, r1, r3, r2
 444 003a 4360     		str	r3, [r0, #4]
 445 003c 15E0     		b	.L40
 446              	.L39:
 147:bluetooth_rxtx.c **** 		f->clk100ns = idle_buf_clk100ns;
 447              		.loc 1 147 0
 448 003e AB78     		ldrb	r3, [r5, #2]	@ zero_extendqisi2
 449 0040 C370     		strb	r3, [r0, #3]
 148:bluetooth_rxtx.c **** 		f->channel = (uint8_t)((idle_buf_channel - 2402) & 0xff);
 450              		.loc 1 148 0
ARM GAS  /tmp/ccCuKxzC.s 			page 35


 451 0042 6B68     		ldr	r3, [r5, #4]
 452 0044 4360     		str	r3, [r0, #4]
 149:bluetooth_rxtx.c **** 		f->rssi_min = rssi_min;
 453              		.loc 1 149 0
 454 0046 2B89     		ldrh	r3, [r5, #8]
 455 0048 9BB2     		uxth	r3, r3
 456 004a 623B     		subs	r3, r3, #98
 457 004c 8370     		strb	r3, [r0, #2]
 150:bluetooth_rxtx.c **** 		f->rssi_max = rssi_max;
 458              		.loc 1 150 0
 459 004e 104B     		ldr	r3, .L41+12
 460 0050 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 461 0052 4372     		strb	r3, [r0, #9]
 151:bluetooth_rxtx.c **** 		f->rssi_avg = rssi_get_avg(idle_buf_channel);
 462              		.loc 1 151 0
 463 0054 0F4B     		ldr	r3, .L41+16
 464 0056 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 465 0058 0372     		strb	r3, [r0, #8]
 152:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 466              		.loc 1 152 0
 467 005a 2889     		ldrh	r0, [r5, #8]
 468              	.LVL49:
 469 005c 80B2     		uxth	r0, r0
 470 005e FFF7FEFF 		bl	rssi_get_avg
 471              	.LVL50:
 153:bluetooth_rxtx.c **** 	}
 472              		.loc 1 153 0
 473 0062 0D4B     		ldr	r3, .L41+20
 152:bluetooth_rxtx.c **** 		f->rssi_count = rssi_count;
 474              		.loc 1 152 0
 475 0064 A072     		strb	r0, [r4, #10]
 153:bluetooth_rxtx.c **** 	}
 476              		.loc 1 153 0
 477 0066 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 478 0068 E372     		strb	r3, [r4, #11]
 479              	.L40:
 156:bluetooth_rxtx.c **** 
 480              		.loc 1 156 0
 481 006a 04F10E00 		add	r0, r4, #14
 482 006e 3946     		mov	r1, r7
 483 0070 3222     		movs	r2, #50
 484 0072 FFF7FEFF 		bl	memcpy
 485              	.LVL51:
 158:bluetooth_rxtx.c **** 	status = 0;
 486              		.loc 1 158 0
 487 0076 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 161:bluetooth_rxtx.c **** }
 488              		.loc 1 161 0
 489 0078 0120     		movs	r0, #1
 158:bluetooth_rxtx.c **** 	status = 0;
 490              		.loc 1 158 0
 491 007a 6370     		strb	r3, [r4, #1]
 159:bluetooth_rxtx.c **** 
 492              		.loc 1 159 0
 493 007c 0023     		movs	r3, #0
 494 007e 6B70     		strb	r3, [r5, #1]
 162:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccCuKxzC.s 			page 36


 495              		.loc 1 162 0
 496 0080 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 497              	.LVL52:
 498              	.L42:
 499 0082 00BF     		.align	2
 500              	.L41:
 501 0084 00000000 		.word	.LANCHOR0
 502 0088 00000000 		.word	clkn
 503 008c 08400040 		.word	1073758216
 504 0090 00000000 		.word	rssi_min
 505 0094 00000000 		.word	rssi_max
 506 0098 00000000 		.word	rssi_count
 507              		.cfi_endproc
 508              	.LFE0:
 510              		.section	.text.le_set_access_address,"ax",%progbits
 511              		.align	1
 512              		.thumb
 513              		.thumb_func
 515              	le_set_access_address:
 516              	.LFB19:
1427:bluetooth_rxtx.c **** 
1428:bluetooth_rxtx.c **** static uint16_t reverse16(uint16_t data)
1429:bluetooth_rxtx.c **** {
1430:bluetooth_rxtx.c **** 	uint16_t reversed = 0;
1431:bluetooth_rxtx.c **** 
1432:bluetooth_rxtx.c **** 	for(size_t i=0; i<16; i++)
1433:bluetooth_rxtx.c **** 	{
1434:bluetooth_rxtx.c **** 		reversed |= ((data >> i) & 0x01) << (15-i);
1435:bluetooth_rxtx.c **** 	}
1436:bluetooth_rxtx.c **** 
1437:bluetooth_rxtx.c **** 	return reversed;
1438:bluetooth_rxtx.c **** }
1439:bluetooth_rxtx.c **** 
1440:bluetooth_rxtx.c **** /*
1441:bluetooth_rxtx.c ****  * Transmit a BTBR packet with the specified access code.
1442:bluetooth_rxtx.c ****  *
1443:bluetooth_rxtx.c ****  * All modulation parameters are set within this function.
1444:bluetooth_rxtx.c ****  */
1445:bluetooth_rxtx.c **** void br_transmit()
1446:bluetooth_rxtx.c **** {
1447:bluetooth_rxtx.c **** 	uint16_t gio_save;
1448:bluetooth_rxtx.c **** 
1449:bluetooth_rxtx.c **** 	uint32_t clkn_saved = 0;
1450:bluetooth_rxtx.c **** 
1451:bluetooth_rxtx.c **** 	uint16_t preamble = (target.syncword & 1) == 1 ? 0x5555 : 0xaaaa;
1452:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
1453:bluetooth_rxtx.c **** 
1454:bluetooth_rxtx.c **** 	uint8_t data[16] = {
1455:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
1456:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
1457:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
1458:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
1459:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
1460:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
1461:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
1462:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
1463:bluetooth_rxtx.c **** 		reverse8(trailer),
ARM GAS  /tmp/ccCuKxzC.s 			page 37


1464:bluetooth_rxtx.c **** 		reverse8(0x77),
1465:bluetooth_rxtx.c **** 		reverse8(0x66),
1466:bluetooth_rxtx.c **** 		reverse8(0x55),
1467:bluetooth_rxtx.c **** 		reverse8(0x44),
1468:bluetooth_rxtx.c **** 		reverse8(0x33),
1469:bluetooth_rxtx.c **** 		reverse8(0x22),
1470:bluetooth_rxtx.c **** 		reverse8(0x11)
1471:bluetooth_rxtx.c **** 	};
1472:bluetooth_rxtx.c **** 
1473:bluetooth_rxtx.c **** 	cc2400_tx_sync(reverse16(preamble));
1474:bluetooth_rxtx.c **** 
1475:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
1476:bluetooth_rxtx.c **** 
1477:bluetooth_rxtx.c **** 	// set GIO to FIFO_FULL
1478:bluetooth_rxtx.c **** 	gio_save = cc2400_get(IOCFG);
1479:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
1480:bluetooth_rxtx.c **** 
1481:bluetooth_rxtx.c **** 	while ( requested_mode == MODE_TX_SYMBOLS )
1482:bluetooth_rxtx.c **** 	{
1483:bluetooth_rxtx.c **** 
1484:bluetooth_rxtx.c **** 		while ((clkn >> 1) == (clkn_saved >> 1) || T0TC < 2250) {
1485:bluetooth_rxtx.c **** 
1486:bluetooth_rxtx.c **** 			// If timer says time to hop, do it.
1487:bluetooth_rxtx.c **** 			if (do_hop) {
1488:bluetooth_rxtx.c **** 				hop();
1489:bluetooth_rxtx.c **** 			}
1490:bluetooth_rxtx.c **** 		}
1491:bluetooth_rxtx.c **** 
1492:bluetooth_rxtx.c **** 		clkn_saved = clkn;
1493:bluetooth_rxtx.c **** 
1494:bluetooth_rxtx.c **** 		TXLED_SET;
1495:bluetooth_rxtx.c **** 
1496:bluetooth_rxtx.c **** 		cc2400_fifo_write(16, data);
1497:bluetooth_rxtx.c **** 
1498:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1499:bluetooth_rxtx.c **** 		TXLED_CLR;
1500:bluetooth_rxtx.c **** 
1501:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
1502:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
1503:bluetooth_rxtx.c **** 
1504:bluetooth_rxtx.c **** 		while (!(cc2400_status() & XOSC16M_STABLE));
1505:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1506:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
1507:bluetooth_rxtx.c **** 
1508:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
1509:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
1510:bluetooth_rxtx.c **** 
1511:bluetooth_rxtx.c **** 		handle_usb(clkn);
1512:bluetooth_rxtx.c **** 	}
1513:bluetooth_rxtx.c **** 
1514:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
1515:bluetooth_rxtx.c **** 	PAEN_CLR;
1516:bluetooth_rxtx.c **** #endif
1517:bluetooth_rxtx.c **** 
1518:bluetooth_rxtx.c **** 	// reset GIO
1519:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, gio_save);
1520:bluetooth_rxtx.c **** }
ARM GAS  /tmp/ccCuKxzC.s 			page 38


1521:bluetooth_rxtx.c **** 
1522:bluetooth_rxtx.c **** /* set LE access address */
1523:bluetooth_rxtx.c **** static void le_set_access_address(u32 aa) {
 517              		.loc 1 1523 0
 518              		.cfi_startproc
 519              		@ args = 0, pretend = 0, frame = 0
 520              		@ frame_needed = 0, uses_anonymous_args = 0
 521              	.LVL53:
 522 0000 10B5     		push	{r4, lr}
 523              		.cfi_def_cfa_offset 8
 524              		.cfi_offset 4, -8
 525              		.cfi_offset 14, -4
1524:bluetooth_rxtx.c **** 	u32 aa_rev;
1525:bluetooth_rxtx.c **** 
1526:bluetooth_rxtx.c **** 	le.access_address = aa;
 526              		.loc 1 1526 0
 527 0002 044C     		ldr	r4, .L44
 528 0004 6060     		str	r0, [r4, #4]
1527:bluetooth_rxtx.c **** 	aa_rev = rbit(aa);
 529              		.loc 1 1527 0
 530 0006 FFF7FEFF 		bl	rbit
 531              	.LVL54:
1528:bluetooth_rxtx.c **** 	le.syncl = aa_rev & 0xffff;
 532              		.loc 1 1528 0
 533 000a 6081     		strh	r0, [r4, #10]	@ movhi
1529:bluetooth_rxtx.c **** 	le.synch = aa_rev >> 16;
 534              		.loc 1 1529 0
 535 000c 000C     		lsrs	r0, r0, #16
 536              	.LVL55:
 537 000e 2081     		strh	r0, [r4, #8]	@ movhi
 538 0010 10BD     		pop	{r4, pc}
 539              	.L45:
 540 0012 00BF     		.align	2
 541              	.L44:
 542 0014 00000000 		.word	.LANCHOR1
 543              		.cfi_endproc
 544              	.LFE19:
 546              		.section	.text.cc2400_idle,"ax",%progbits
 547              		.align	1
 548              		.thumb
 549              		.thumb_func
 551              	cc2400_idle:
 552              	.LFB8:
 875:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 553              		.loc 1 875 0
 554              		.cfi_startproc
 555              		@ args = 0, pretend = 0, frame = 0
 556              		@ frame_needed = 0, uses_anonymous_args = 0
 557 0000 10B5     		push	{r4, lr}
 558              		.cfi_def_cfa_offset 8
 559              		.cfi_offset 4, -8
 560              		.cfi_offset 14, -4
 876:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 561              		.loc 1 876 0
 562 0002 6420     		movs	r0, #100
 563 0004 FFF7FEFF 		bl	cc2400_strobe
 564              	.LVL56:
ARM GAS  /tmp/ccCuKxzC.s 			page 39


 565              	.L48:
 877:bluetooth_rxtx.c **** 
 566              		.loc 1 877 0 discriminator 1
 567 0008 FFF7FEFF 		bl	cc2400_status
 568              	.LVL57:
 569 000c 00F00400 		and	r0, r0, #4
 570 0010 00F0FF04 		and	r4, r0, #255
 571 0014 0028     		cmp	r0, #0
 572 0016 F7D1     		bne	.L48
 880:bluetooth_rxtx.c **** 	HGM_CLR;
 573              		.loc 1 880 0
 574 0018 204B     		ldr	r3, .L49
 575 001a 8022     		movs	r2, #128
 576 001c 1A60     		str	r2, [r3]
 884:bluetooth_rxtx.c **** 	TXLED_CLR;
 577              		.loc 1 884 0
 578 001e 1021     		movs	r1, #16
 881:bluetooth_rxtx.c **** #endif
 579              		.loc 1 881 0
 580 0020 4FF48072 		mov	r2, #256
 581 0024 1A60     		str	r2, [r3]
 884:bluetooth_rxtx.c **** 	TXLED_CLR;
 582              		.loc 1 884 0
 583 0026 43F8201C 		str	r1, [r3, #-32]
 885:bluetooth_rxtx.c **** 	USRLED_CLR;
 584              		.loc 1 885 0
 585 002a 43F8202C 		str	r2, [r3, #-32]
 886:bluetooth_rxtx.c **** 
 586              		.loc 1 886 0
 587 002e 0222     		movs	r2, #2
 588 0030 43F8202C 		str	r2, [r3, #-32]
 888:bluetooth_rxtx.c **** 	dio_ssp_stop();
 589              		.loc 1 888 0
 590 0034 FFF7FEFF 		bl	clkn_stop
 591              	.LVL58:
 889:bluetooth_rxtx.c **** 	cs_reset();
 592              		.loc 1 889 0
 593 0038 FFF7FEFF 		bl	dio_ssp_stop
 594              	.LVL59:
 890:bluetooth_rxtx.c **** 	rssi_reset();
 595              		.loc 1 890 0
 596 003c FFF7FEFF 		bl	cs_reset
 597              	.LVL60:
 891:bluetooth_rxtx.c **** 
 598              		.loc 1 891 0
 599 0040 FFF7FEFF 		bl	rssi_reset
 600              	.LVL61:
 894:bluetooth_rxtx.c **** 	do_hop = 0;
 601              		.loc 1 894 0
 602 0044 164B     		ldr	r3, .L49+4
 896:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 603              		.loc 1 896 0
 604 0046 174A     		ldr	r2, .L49+8
 605 0048 40F68911 		movw	r1, #2441
 894:bluetooth_rxtx.c **** 	do_hop = 0;
 606              		.loc 1 894 0
 607 004c 9C72     		strb	r4, [r3, #10]
ARM GAS  /tmp/ccCuKxzC.s 			page 40


 895:bluetooth_rxtx.c **** 	channel = 2441;
 608              		.loc 1 895 0
 609 004e DC72     		strb	r4, [r3, #11]
 896:bluetooth_rxtx.c **** 	hop_direct_channel = 0;
 610              		.loc 1 896 0
 611 0050 1180     		strh	r1, [r2]	@ movhi
 898:bluetooth_rxtx.c **** 	requested_channel = 0;
 612              		.loc 1 898 0
 613 0052 9E21     		movs	r1, #158
 897:bluetooth_rxtx.c **** 	hop_timeout = 158;
 614              		.loc 1 897 0
 615 0054 9C81     		strh	r4, [r3, #12]	@ movhi
 898:bluetooth_rxtx.c **** 	requested_channel = 0;
 616              		.loc 1 898 0
 617 0056 A2F84810 		strh	r1, [r2, #72]	@ movhi
 900:bluetooth_rxtx.c **** 
 618              		.loc 1 900 0
 619 005a 40F66211 		movw	r1, #2402
 899:bluetooth_rxtx.c **** 	le_adv_channel = 2402;
 620              		.loc 1 899 0
 621 005e DC81     		strh	r4, [r3, #14]	@ movhi
 900:bluetooth_rxtx.c **** 
 622              		.loc 1 900 0
 623 0060 A2F84A10 		strh	r1, [r2, #74]	@ movhi
 904:bluetooth_rxtx.c **** 	idle_buf_clk100ns = 0;
 624              		.loc 1 904 0
 625 0064 9C70     		strb	r4, [r3, #2]
 905:bluetooth_rxtx.c **** 	idle_buf_channel = 0;
 626              		.loc 1 905 0
 627 0066 5C60     		str	r4, [r3, #4]
 906:bluetooth_rxtx.c **** 	dma_discard = 0;
 628              		.loc 1 906 0
 629 0068 1C81     		strh	r4, [r3, #8]	@ movhi
 907:bluetooth_rxtx.c **** 	status = 0;
 630              		.loc 1 907 0
 631 006a 1C74     		strb	r4, [r3, #16]
 908:bluetooth_rxtx.c **** 
 632              		.loc 1 908 0
 633 006c 5C70     		strb	r4, [r3, #1]
 911:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 634              		.loc 1 911 0
 635 006e 5C74     		strb	r4, [r3, #17]
 912:bluetooth_rxtx.c **** 	jam_mode = JAM_NONE;
 636              		.loc 1 912 0
 637 0070 9C74     		strb	r4, [r3, #18]
 913:bluetooth_rxtx.c **** 	ego_mode = EGO_FOLLOW;
 638              		.loc 1 913 0
 639 0072 DC74     		strb	r4, [r3, #19]
 914:bluetooth_rxtx.c **** 
 640              		.loc 1 914 0
 641 0074 1C75     		strb	r4, [r3, #20]
 916:bluetooth_rxtx.c **** 
 642              		.loc 1 916 0
 643 0076 1C70     		strb	r4, [r3]
 919:bluetooth_rxtx.c **** 	high_freq = 2483;
 644              		.loc 1 919 0
 645 0078 4FF41663 		mov	r3, #2400
ARM GAS  /tmp/ccCuKxzC.s 			page 41


 646 007c A2F84C30 		strh	r3, [r2, #76]	@ movhi
 920:bluetooth_rxtx.c **** 	rssi_threshold = -30;
 647              		.loc 1 920 0
 648 0080 5333     		adds	r3, r3, #83
 649 0082 A2F84E30 		strh	r3, [r2, #78]	@ movhi
 923:bluetooth_rxtx.c **** 	target.syncword = 0;
 650              		.loc 1 923 0
 651 0086 0849     		ldr	r1, .L49+12
 921:bluetooth_rxtx.c **** 
 652              		.loc 1 921 0
 653 0088 E223     		movs	r3, #226
 654 008a 82F85030 		strb	r3, [r2, #80]
 923:bluetooth_rxtx.c **** 	target.syncword = 0;
 655              		.loc 1 923 0
 656 008e 0022     		movs	r2, #0
 657 0090 0023     		movs	r3, #0
 658 0092 C1E90023 		strd	r2, [r1]
 924:bluetooth_rxtx.c **** }
 659              		.loc 1 924 0
 660 0096 C1E90223 		strd	r2, [r1, #8]
 661 009a 10BD     		pop	{r4, pc}
 662              	.L50:
 663              		.align	2
 664              	.L49:
 665 009c 5CC00920 		.word	537509980
 666 00a0 00000000 		.word	.LANCHOR0
 667 00a4 00000000 		.word	.LANCHOR1
 668 00a8 00000000 		.word	target
 669              		.cfi_endproc
 670              	.LFE8:
 672              		.section	.text.cb_follow_le,"ax",%progbits
 673              		.align	1
 674              		.global	cb_follow_le
 675              		.thumb
 676              		.thumb_func
 678              	cb_follow_le:
 679              	.LFB26:
1530:bluetooth_rxtx.c **** }
1531:bluetooth_rxtx.c **** 
1532:bluetooth_rxtx.c **** /* reset le state, called by bt_generic_le and bt_follow_le() */
1533:bluetooth_rxtx.c **** void reset_le() {
1534:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
1535:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
1536:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
1537:bluetooth_rxtx.c **** 	//JWHUR crc verify on
1538:bluetooth_rxtx.c **** 	le.crc_verify = 1;
1539:bluetooth_rxtx.c **** 	le.last_packet = 0;
1540:bluetooth_rxtx.c **** 
1541:bluetooth_rxtx.c **** 	le.link_state = LINK_INACTIVE;
1542:bluetooth_rxtx.c **** 
1543:bluetooth_rxtx.c **** 	le.channel_idx = 0;
1544:bluetooth_rxtx.c **** 	le.channel_increment = 0;
1545:bluetooth_rxtx.c **** 
1546:bluetooth_rxtx.c **** 	le.conn_epoch = 0;
1547:bluetooth_rxtx.c **** 	le.interval_timer = 0;
1548:bluetooth_rxtx.c **** 	le.conn_interval = 0;
1549:bluetooth_rxtx.c **** 	le.conn_interval = 0;
ARM GAS  /tmp/ccCuKxzC.s 			page 42


1550:bluetooth_rxtx.c **** 	le.conn_count = 0;
1551:bluetooth_rxtx.c **** 
1552:bluetooth_rxtx.c **** 	le.win_size = 0;
1553:bluetooth_rxtx.c **** 	le.win_offset = 0;
1554:bluetooth_rxtx.c **** 
1555:bluetooth_rxtx.c **** 	le.update_pending = 0;
1556:bluetooth_rxtx.c **** 	le.update_instant = 0;
1557:bluetooth_rxtx.c **** 	le.interval_update = 0;
1558:bluetooth_rxtx.c **** 	le.win_size_update = 0;
1559:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
1560:bluetooth_rxtx.c **** 
1561:bluetooth_rxtx.c **** 	do_hop = 0;
1562:bluetooth_rxtx.c **** }
1563:bluetooth_rxtx.c **** 
1564:bluetooth_rxtx.c **** // reset LE Promisc state
1565:bluetooth_rxtx.c **** void reset_le_promisc(void) {
1566:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
1567:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
1568:bluetooth_rxtx.c **** }
1569:bluetooth_rxtx.c **** 
1570:bluetooth_rxtx.c **** /* generic le mode */
1571:bluetooth_rxtx.c **** void bt_generic_le(u8 active_mode)
1572:bluetooth_rxtx.c **** {
1573:bluetooth_rxtx.c **** 	u8 hold;
1574:bluetooth_rxtx.c **** 	int i, j;
1575:bluetooth_rxtx.c **** 	int8_t rssi, rssi_at_trigger;
1576:bluetooth_rxtx.c **** 
1577:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1578:bluetooth_rxtx.c **** 	mode = active_mode;
1579:bluetooth_rxtx.c **** 
1580:bluetooth_rxtx.c **** 	reset_le();
1581:bluetooth_rxtx.c **** 
1582:bluetooth_rxtx.c **** 	// enable USB interrupts
1583:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1584:bluetooth_rxtx.c **** 
1585:bluetooth_rxtx.c **** 	RXLED_CLR;
1586:bluetooth_rxtx.c **** 
1587:bluetooth_rxtx.c **** 	queue_init();
1588:bluetooth_rxtx.c **** 	dio_ssp_init();
1589:bluetooth_rxtx.c **** 	dma_init();
1590:bluetooth_rxtx.c **** 	dio_ssp_start();
1591:bluetooth_rxtx.c **** 	cc2400_rx();
1592:bluetooth_rxtx.c **** 
1593:bluetooth_rxtx.c **** 	cs_trigger_enable();
1594:bluetooth_rxtx.c **** 
1595:bluetooth_rxtx.c **** 	hold = 0;
1596:bluetooth_rxtx.c **** 
1597:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1598:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1599:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1600:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1601:bluetooth_rxtx.c **** 
1602:bluetooth_rxtx.c **** 			/* Retune */
1603:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1604:bluetooth_rxtx.c **** 
1605:bluetooth_rxtx.c **** 			/* Wait for lock */
1606:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
ARM GAS  /tmp/ccCuKxzC.s 			page 43


1607:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1608:bluetooth_rxtx.c **** 
1609:bluetooth_rxtx.c **** 			/* RX mode */
1610:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1611:bluetooth_rxtx.c **** 
1612:bluetooth_rxtx.c **** 			requested_channel = 0;
1613:bluetooth_rxtx.c **** 		}
1614:bluetooth_rxtx.c **** 
1615:bluetooth_rxtx.c **** 		if (do_hop) {
1616:bluetooth_rxtx.c **** 			hop();
1617:bluetooth_rxtx.c **** 		} else {
1618:bluetooth_rxtx.c **** 			TXLED_CLR;
1619:bluetooth_rxtx.c **** 		}
1620:bluetooth_rxtx.c **** 
1621:bluetooth_rxtx.c **** 		RXLED_CLR;
1622:bluetooth_rxtx.c **** 
1623:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1624:bluetooth_rxtx.c **** 		rssi_reset();
1625:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
1626:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
1627:bluetooth_rxtx.c **** 		{
1628:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1629:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
1630:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
1631:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
1632:bluetooth_rxtx.c **** 			}
1633:bluetooth_rxtx.c **** 			rssi_add(rssi);
1634:bluetooth_rxtx.c **** 		}
1635:bluetooth_rxtx.c **** 
1636:bluetooth_rxtx.c **** 		if (rx_err) {
1637:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1638:bluetooth_rxtx.c **** 		}
1639:bluetooth_rxtx.c **** 
1640:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1641:bluetooth_rxtx.c **** 		if (!rx_tc)
1642:bluetooth_rxtx.c **** 			goto rx_continue;
1643:bluetooth_rxtx.c **** 
1644:bluetooth_rxtx.c **** 		/* Missed a DMA trasfer? */
1645:bluetooth_rxtx.c **** 		if (rx_tc > 1)
1646:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
1647:bluetooth_rxtx.c **** 
1648:bluetooth_rxtx.c **** 		rssi_iir_update(channel);
1649:bluetooth_rxtx.c **** 
1650:bluetooth_rxtx.c **** 		/* Set squelch hold if there was either a CS trigger, squelch
1651:bluetooth_rxtx.c **** 		 * is disabled, or if the current rssi_max is above the same
1652:bluetooth_rxtx.c **** 		 * threshold. Currently, this is redundant, but allows for
1653:bluetooth_rxtx.c **** 		 * per-channel or other rssi triggers in the future. */
1654:bluetooth_rxtx.c **** 		if (cs_trigger || cs_no_squelch) {
1655:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
1656:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1657:bluetooth_rxtx.c **** 			cs_trigger = 0;
1658:bluetooth_rxtx.c **** 		}
1659:bluetooth_rxtx.c **** 
1660:bluetooth_rxtx.c **** 		if (rssi_max >= (cs_threshold_cur + 54)) {
1661:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
1662:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
1663:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccCuKxzC.s 			page 44


1664:bluetooth_rxtx.c **** 
1665:bluetooth_rxtx.c **** 		/* Hold expired? Ignore data. */
1666:bluetooth_rxtx.c **** 		if (hold == 0) {
1667:bluetooth_rxtx.c **** 			goto rx_continue;
1668:bluetooth_rxtx.c **** 		}
1669:bluetooth_rxtx.c **** 		hold--;
1670:bluetooth_rxtx.c **** 
1671:bluetooth_rxtx.c **** 		// copy the previously unpacked symbols to the front of the buffer
1672:bluetooth_rxtx.c **** 		memcpy(unpacked, unpacked + DMA_SIZE*8, DMA_SIZE*8);
1673:bluetooth_rxtx.c **** 
1674:bluetooth_rxtx.c **** 		// unpack the new packet to the end of the buffer
1675:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; ++i) {
1676:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
1677:bluetooth_rxtx.c **** 			for (j = 0; j < 8; ++j) {
1678:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
1679:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
1680:bluetooth_rxtx.c **** 			}
1681:bluetooth_rxtx.c **** 		}
1682:bluetooth_rxtx.c **** 
1683:bluetooth_rxtx.c **** 		int ret = data_cb(unpacked);
1684:bluetooth_rxtx.c **** 		if (!ret) break;
1685:bluetooth_rxtx.c **** 
1686:bluetooth_rxtx.c **** 	rx_continue:
1687:bluetooth_rxtx.c **** 		rx_tc = 0;
1688:bluetooth_rxtx.c **** 		rx_err = 0;
1689:bluetooth_rxtx.c **** 	}
1690:bluetooth_rxtx.c **** 
1691:bluetooth_rxtx.c **** 	// disable USB interrupts
1692:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1693:bluetooth_rxtx.c **** 
1694:bluetooth_rxtx.c **** 	// reset the radio completely
1695:bluetooth_rxtx.c **** 	cc2400_idle();
1696:bluetooth_rxtx.c **** 	dio_ssp_stop();
1697:bluetooth_rxtx.c **** 	cs_trigger_disable();
1698:bluetooth_rxtx.c **** }
1699:bluetooth_rxtx.c **** 
1700:bluetooth_rxtx.c **** //JWHUR rssi tracking
1701:bluetooth_rxtx.c **** void bt_le_sync_rssi(u8 active_mode) 
1702:bluetooth_rxtx.c **** {
1703:bluetooth_rxtx.c **** 	int i;
1704:bluetooth_rxtx.c **** 	int8_t rssi;
1705:bluetooth_rxtx.c **** 	// channel 37 = 2402, channel 38 = 2426, channel 39 = 2480
1706:bluetooth_rxtx.c **** 	static int restart_jamming = 0;
1707:bluetooth_rxtx.c **** 	u8 rssi_buf[DMA_SIZE] = {0, };
1708:bluetooth_rxtx.c **** 
1709:bluetooth_rxtx.c **** 	if (start_sync >= ((uint32_t)1<<28)) {
1710:bluetooth_rxtx.c **** 		start_sync -= ((uint32_t)1<<28);
1711:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) >= now_sync || (clkn & 0xffffff) < start_sync);
1712:bluetooth_rxtx.c **** 	} else {
1713:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) < start_sync);
1714:bluetooth_rxtx.c **** 	}
1715:bluetooth_rxtx.c **** 
1716:bluetooth_rxtx.c **** 	// rssi sampling for only 3000 ms
1717:bluetooth_rxtx.c **** 	uint32_t now = (clkn & 0xffffff);
1718:bluetooth_rxtx.c **** 	uint32_t stop_at = now + 3000 * 10000 / 3125; // millis -> clkn ticks
1719:bluetooth_rxtx.c **** 	int overflow = 0;
1720:bluetooth_rxtx.c **** 	// handle clkn overflow
ARM GAS  /tmp/ccCuKxzC.s 			page 45


1721:bluetooth_rxtx.c **** 	if (stop_at >= ((uint32_t)1<<28)) {
1722:bluetooth_rxtx.c **** 		stop_at -= ((uint32_t)1<<28);
1723:bluetooth_rxtx.c **** 		overflow = 1;
1724:bluetooth_rxtx.c **** 	}
1725:bluetooth_rxtx.c **** 
1726:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1727:bluetooth_rxtx.c **** 	requested_mode = active_mode;
1728:bluetooth_rxtx.c **** 	mode = active_mode;
1729:bluetooth_rxtx.c **** 
1730:bluetooth_rxtx.c **** 	le.link_state = LINK_LISTENING;
1731:bluetooth_rxtx.c **** 
1732:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1733:bluetooth_rxtx.c **** 	RXLED_CLR;
1734:bluetooth_rxtx.c **** 	queue_init();
1735:bluetooth_rxtx.c **** 	dio_ssp_init();
1736:bluetooth_rxtx.c **** 	dma_init_le();
1737:bluetooth_rxtx.c **** 	dio_ssp_start();
1738:bluetooth_rxtx.c **** 
1739:bluetooth_rxtx.c **** 	cc2400_rx_sync(rbit(le.access_address));
1740:bluetooth_rxtx.c **** 
1741:bluetooth_rxtx.c **** 	requested_channel = 1;
1742:bluetooth_rxtx.c **** 	channel = 2462;
1743:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1744:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1745:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1746:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
1747:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel);
1748:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1749:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
1750:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1751:bluetooth_rxtx.c **** 			requested_channel = 0;
1752:bluetooth_rxtx.c **** 		}
1753:bluetooth_rxtx.c **** 		RXLED_CLR;
1754:bluetooth_rxtx.c **** 		if (requested_mode != active_mode) {
1755:bluetooth_rxtx.c **** 			goto cleanup;
1756:bluetooth_rxtx.c **** 		}
1757:bluetooth_rxtx.c **** 
1758:bluetooth_rxtx.c **** 		//JWHUR buffering time information
1759:bluetooth_rxtx.c **** 		u32 time_buf1[16] = {0, };
1760:bluetooth_rxtx.c **** 		u32 time_buf2[16] = {0, };
1761:bluetooth_rxtx.c **** 		u32 time_buf3[16] = {0, };
1762:bluetooth_rxtx.c **** 		u32 time_buf4[16] = {0, };
1763:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; i++) {
1764:bluetooth_rxtx.c **** 			if (i<16) time_buf1[i] = CLK100NS;
1765:bluetooth_rxtx.c **** 			if (15<i && i<32) time_buf2[i-16] = CLK100NS;
1766:bluetooth_rxtx.c **** 			if (31<i && i<48) time_buf3[i-32] = CLK100NS;
1767:bluetooth_rxtx.c **** 			if (47<i) time_buf4[i-48] = CLK100NS;
1768:bluetooth_rxtx.c **** 			rssi_buf[i] = (u8)(cc2400_get(RSSI) >> 8);
1769:bluetooth_rxtx.c **** 			//rssi_buf[i] = (u8)(cc2400_get_rev(FREQEST));
1770:bluetooth_rxtx.c **** 			volatile u32 j = 1314; while (--j); // empty for loop ~= 70ns, 598 empty while loop ~= 41.8us, 1
1771:bluetooth_rxtx.c **** 		}
1772:bluetooth_rxtx.c **** 
1773:bluetooth_rxtx.c **** 		RXLED_SET;
1774:bluetooth_rxtx.c **** 
1775:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
1776:bluetooth_rxtx.c **** 		enqueue_with_ts(RSSI_TRACK, (uint8_t *)rssi_buf, CLK100NS);
1777:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf1);
ARM GAS  /tmp/ccCuKxzC.s 			page 46


1778:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf2);
1779:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf3);
1780:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf4);
1781:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
1782:bluetooth_rxtx.c **** 	
1783:bluetooth_rxtx.c **** 		if (overflow == 0) {
1784:bluetooth_rxtx.c **** 			if ((clkn & 0xffffff) > stop_at)
1785:bluetooth_rxtx.c **** 				goto cleanup;
1786:bluetooth_rxtx.c **** 		} else {
1787:bluetooth_rxtx.c **** 			if ((clkn & 0xffffff) < now_sync && (clkn & 0xffffff) > stop_at)
1788:bluetooth_rxtx.c **** 				goto cleanup;
1789:bluetooth_rxtx.c **** 		}
1790:bluetooth_rxtx.c **** 	
1791:bluetooth_rxtx.c **** 	}
1792:bluetooth_rxtx.c **** cleanup:
1793:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
1794:bluetooth_rxtx.c **** 	cc2400_idle();
1795:bluetooth_rxtx.c **** 	dio_ssp_stop ();
1796:bluetooth_rxtx.c **** 	cs_trigger_disable();
1797:bluetooth_rxtx.c **** }
1798:bluetooth_rxtx.c **** 
1799:bluetooth_rxtx.c **** 
1800:bluetooth_rxtx.c **** void bt_le_sync(u8 active_mode)
1801:bluetooth_rxtx.c **** {
1802:bluetooth_rxtx.c **** 	int i;
1803:bluetooth_rxtx.c **** 	int8_t rssi;
1804:bluetooth_rxtx.c **** 	static int restart_jamming = 0;
1805:bluetooth_rxtx.c **** 	int sync_flag = 0; //JWHUR to detect packet with pdu sync
1806:bluetooth_rxtx.c **** 
1807:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
1808:bluetooth_rxtx.c **** 	mode = active_mode;
1809:bluetooth_rxtx.c **** 
1810:bluetooth_rxtx.c **** 	le.link_state = LINK_LISTENING;
1811:bluetooth_rxtx.c **** 
1812:bluetooth_rxtx.c **** 	// enable USB interrupts
1813:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
1814:bluetooth_rxtx.c **** 
1815:bluetooth_rxtx.c **** 	RXLED_CLR;
1816:bluetooth_rxtx.c **** 
1817:bluetooth_rxtx.c **** 	queue_init();
1818:bluetooth_rxtx.c **** 	dio_ssp_init();
1819:bluetooth_rxtx.c **** 	dma_init_le();
1820:bluetooth_rxtx.c **** 	dio_ssp_start();
1821:bluetooth_rxtx.c **** 
1822:bluetooth_rxtx.c **** 	cc2400_rx_sync(rbit(le.access_address)); // bit-reversed access address
1823:bluetooth_rxtx.c **** 
1824:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
1825:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
1826:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1827:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
1828:bluetooth_rxtx.c **** 
1829:bluetooth_rxtx.c **** 			/* Retune */
1830:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
1831:bluetooth_rxtx.c **** 
1832:bluetooth_rxtx.c **** 			/* Wait for lock */
1833:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
1834:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
ARM GAS  /tmp/ccCuKxzC.s 			page 47


1835:bluetooth_rxtx.c **** 
1836:bluetooth_rxtx.c **** 			/* RX mode */
1837:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
1838:bluetooth_rxtx.c **** 
1839:bluetooth_rxtx.c **** 			requested_channel = 0;
1840:bluetooth_rxtx.c **** 		}
1841:bluetooth_rxtx.c **** 
1842:bluetooth_rxtx.c **** 		RXLED_CLR;
1843:bluetooth_rxtx.c **** 
1844:bluetooth_rxtx.c **** 		/* Wait for DMA. Meanwhile keep track of RSSI. */
1845:bluetooth_rxtx.c **** 		rssi_reset();
1846:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)	;
1847:bluetooth_rxtx.c **** 
1848:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
1849:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
1850:bluetooth_rxtx.c **** 
1851:bluetooth_rxtx.c **** 		if (requested_mode != active_mode) {
1852:bluetooth_rxtx.c **** 			goto cleanup;
1853:bluetooth_rxtx.c **** 		}
1854:bluetooth_rxtx.c **** 
1855:bluetooth_rxtx.c **** 		if (rx_err) {
1856:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
1857:bluetooth_rxtx.c **** 		}
1858:bluetooth_rxtx.c **** 
1859:bluetooth_rxtx.c **** 		if (do_hop)
1860:bluetooth_rxtx.c **** 			goto rx_flush;
1861:bluetooth_rxtx.c **** 
1862:bluetooth_rxtx.c **** 		/* No DMA transfer? */
1863:bluetooth_rxtx.c **** 		if (!rx_tc)
1864:bluetooth_rxtx.c **** 			continue;
1865:bluetooth_rxtx.c **** 
1866:bluetooth_rxtx.c **** 		/////////////////////
1867:bluetooth_rxtx.c **** 		// process the packet
1868:bluetooth_rxtx.c **** 
1869:bluetooth_rxtx.c **** 		uint32_t packet[48/4+1] = { 0, };
1870:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
1871:bluetooth_rxtx.c **** 		packet[0] = le.access_address;
1872:bluetooth_rxtx.c **** 
1873:bluetooth_rxtx.c **** 		const uint32_t *whit = whitening_word[btle_channel_index(channel-2402)];
1874:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
1875:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
1876:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1877:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1878:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1879:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
1880:bluetooth_rxtx.c **** 		}
1881:bluetooth_rxtx.c **** 
1882:bluetooth_rxtx.c **** 		u8 len = (p[5] & 0x3f) + 2;
1883:bluetooth_rxtx.c **** 		if (len > 39)
1884:bluetooth_rxtx.c **** 			goto rx_flush;
1885:bluetooth_rxtx.c **** 
1886:bluetooth_rxtx.c **** 		// transfer the minimum number of bytes from the CC2400
1887:bluetooth_rxtx.c **** 		// this allows us enough time to resume RX for subsequent packets on the same channel
1888:bluetooth_rxtx.c **** 		unsigned total_transfers = ((len + 3) + 4 - 1) / 4;
1889:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
1890:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
1891:bluetooth_rxtx.c **** 				;
ARM GAS  /tmp/ccCuKxzC.s 			page 48


1892:bluetooth_rxtx.c **** 		} else { // max transfers? just wait till DMA's done
1893:bluetooth_rxtx.c **** 			while (DMACC0Config & DMACCxConfig_E && rx_err == 0)
1894:bluetooth_rxtx.c **** 				;
1895:bluetooth_rxtx.c **** 		}
1896:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1897:bluetooth_rxtx.c **** 
1898:bluetooth_rxtx.c **** 		// strobe SFSON to allow the resync to occur while we process the packet
1899:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1900:bluetooth_rxtx.c **** 
1901:bluetooth_rxtx.c **** 		// unwhiten the rest of the packet
1902:bluetooth_rxtx.c **** 		for (i = 4; i < 44; i += 4) {
1903:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
1904:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
1905:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
1906:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
1907:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
1908:bluetooth_rxtx.c **** 		}
1909:bluetooth_rxtx.c **** 
1910:bluetooth_rxtx.c **** 		
1911:bluetooth_rxtx.c **** 		if (le.crc_verify) {
1912:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
1913:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
1914:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
1915:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
1916:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
1917:bluetooth_rxtx.c **** 				goto rx_flush;
1918:bluetooth_rxtx.c **** 		}
1919:bluetooth_rxtx.c **** 
1920:bluetooth_rxtx.c **** 		//JWHUR rssi sampling synchronization test
1921:bluetooth_rxtx.c **** 		//If a BLE advertising packet with pdu preamble 0xff, data SYNC received, after 100ms goto le_syn
1922:bluetooth_rxtx.c **** 		if (p[23] == 0xff && p[24] == 0x53 && p[25] == 0x59 && p[26] == 0x4e && p[27] == 0x43) {
1923:bluetooth_rxtx.c **** 			sync_flag = 1;
1924:bluetooth_rxtx.c **** 			now_sync = (clkn & 0xffffff);
1925:bluetooth_rxtx.c **** 			start_sync = now_sync + 100 * 10000 / 3125; // wait for 100 ms
1926:bluetooth_rxtx.c **** //			sync_channel = (u16)p[28];
1927:bluetooth_rxtx.c **** 		}
1928:bluetooth_rxtx.c **** 
1929:bluetooth_rxtx.c **** 
1930:bluetooth_rxtx.c **** 		RXLED_SET;
1931:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
1932:bluetooth_rxtx.c **** 
1933:bluetooth_rxtx.c **** 		// disable USB interrupts while we touch USB data structures
1934:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
1935:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
1936:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
1937:bluetooth_rxtx.c **** 
1938:bluetooth_rxtx.c **** 		le.last_packet = CLK100NS;
1939:bluetooth_rxtx.c **** 
1940:bluetooth_rxtx.c **** 		//JWHUR if sync_flag receive
1941:bluetooth_rxtx.c **** 		if (sync_flag == 1) {
1942:bluetooth_rxtx.c **** 			requested_mode = MODE_BT_RSSI_LE;
1943:bluetooth_rxtx.c **** 			bt_le_sync_rssi(MODE_BT_RSSI_LE);
1944:bluetooth_rxtx.c **** 			goto cleanup;
1945:bluetooth_rxtx.c **** 		}
1946:bluetooth_rxtx.c **** 	
1947:bluetooth_rxtx.c **** 	rx_flush:
1948:bluetooth_rxtx.c **** 		// this might happen twice, but it's safe to do so
ARM GAS  /tmp/ccCuKxzC.s 			page 49


1949:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
1950:bluetooth_rxtx.c **** 
1951:bluetooth_rxtx.c **** 		// flush any excess bytes from the SSP's buffer
1952:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
1953:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
1954:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
1955:bluetooth_rxtx.c **** 		}
1956:bluetooth_rxtx.c **** 
1957:bluetooth_rxtx.c **** 		// timeout - FIXME this is an ugly hack
1958:bluetooth_rxtx.c **** 		u32 now = CLK100NS;
1959:bluetooth_rxtx.c **** 		if (now < le.last_packet)
1960:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
1961:bluetooth_rxtx.c **** 		if  ( // timeout
1962:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
1963:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
1964:bluetooth_rxtx.c **** 			// jam finished
1965:bluetooth_rxtx.c **** 			|| (le_jam_count == 1)
1966:bluetooth_rxtx.c **** 			)
1967:bluetooth_rxtx.c **** 		{
1968:bluetooth_rxtx.c **** 			reset_le();
1969:bluetooth_rxtx.c **** 			le_jam_count = 0;
1970:bluetooth_rxtx.c **** 			TXLED_CLR;
1971:bluetooth_rxtx.c **** 
1972:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
1973:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
1974:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
1975:bluetooth_rxtx.c **** 				goto cleanup;
1976:bluetooth_rxtx.c **** 			}
1977:bluetooth_rxtx.c **** 
1978:bluetooth_rxtx.c **** 			// go back to promisc if the connection dies
1979:bluetooth_rxtx.c **** 			if (active_mode == MODE_BT_PROMISC_LE)
1980:bluetooth_rxtx.c **** 				goto cleanup;
1981:bluetooth_rxtx.c **** 
1982:bluetooth_rxtx.c **** 			le.link_state = LINK_LISTENING;
1983:bluetooth_rxtx.c **** 
1984:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
1985:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
1986:bluetooth_rxtx.c **** 
1987:bluetooth_rxtx.c **** 			/* Retune */
1988:bluetooth_rxtx.c **** 			channel = le_adv_channel != 0 ? le_adv_channel : 2402;
1989:bluetooth_rxtx.c **** 			restart_jamming = 1;
1990:bluetooth_rxtx.c **** 		}
1991:bluetooth_rxtx.c **** 
1992:bluetooth_rxtx.c **** 		cc2400_set(SYNCL, le.syncl);
1993:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
1994:bluetooth_rxtx.c **** 
1995:bluetooth_rxtx.c **** 		if (do_hop)
1996:bluetooth_rxtx.c **** 			hop();
1997:bluetooth_rxtx.c **** 
1998:bluetooth_rxtx.c **** 		//  you can jam but you keep turning off the light 
1999:bluetooth_rxtx.c **** 		if (le_jam_count > 0) {
2000:bluetooth_rxtx.c **** 			le_jam();
2001:bluetooth_rxtx.c **** 			--le_jam_count;
2002:bluetooth_rxtx.c **** 		} else {
2003:bluetooth_rxtx.c **** 			/* RX mode */
2004:bluetooth_rxtx.c **** 			dma_init_le();
2005:bluetooth_rxtx.c **** 			dio_ssp_start();
ARM GAS  /tmp/ccCuKxzC.s 			page 50


2006:bluetooth_rxtx.c **** 
2007:bluetooth_rxtx.c **** 			if (restart_jamming) {
2008:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
2009:bluetooth_rxtx.c **** 				restart_jamming = 0;
2010:bluetooth_rxtx.c **** 			} else {
2011:bluetooth_rxtx.c **** 				// wait till we're in FSLOCK before strobing RX
2012:bluetooth_rxtx.c **** 				while (!(cc2400_status() & FS_LOCK));
2013:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
2014:bluetooth_rxtx.c **** 			}
2015:bluetooth_rxtx.c **** 		}
2016:bluetooth_rxtx.c **** 
2017:bluetooth_rxtx.c **** 		rx_tc = 0;
2018:bluetooth_rxtx.c **** 		rx_err = 0;
2019:bluetooth_rxtx.c **** 	}
2020:bluetooth_rxtx.c **** 
2021:bluetooth_rxtx.c **** cleanup:
2022:bluetooth_rxtx.c **** 
2023:bluetooth_rxtx.c **** 	// disable USB interrupts
2024:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
2025:bluetooth_rxtx.c **** 
2026:bluetooth_rxtx.c **** 	// reset the radio completely
2027:bluetooth_rxtx.c **** 	cc2400_idle();
2028:bluetooth_rxtx.c **** 	dio_ssp_stop();
2029:bluetooth_rxtx.c **** 	cs_trigger_disable();
2030:bluetooth_rxtx.c **** }
2031:bluetooth_rxtx.c **** 
2032:bluetooth_rxtx.c **** //JWHUR cfo estimation tracking
2033:bluetooth_rxtx.c **** void bt_le_sync_cfo(u8 active_mode) 
2034:bluetooth_rxtx.c **** {
2035:bluetooth_rxtx.c **** 	int i;
2036:bluetooth_rxtx.c **** 	int8_t rssi;
2037:bluetooth_rxtx.c **** 	static int restart_jamming = 0;
2038:bluetooth_rxtx.c **** 	u8 cfo_buf[DMA_SIZE] = {0, };
2039:bluetooth_rxtx.c **** 
2040:bluetooth_rxtx.c **** 	modulation = MOD_BT_LOW_ENERGY;
2041:bluetooth_rxtx.c **** 	mode = active_mode;
2042:bluetooth_rxtx.c **** 
2043:bluetooth_rxtx.c **** 	le.link_state = LINK_LISTENING;
2044:bluetooth_rxtx.c **** 
2045:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
2046:bluetooth_rxtx.c **** 	RXLED_CLR;
2047:bluetooth_rxtx.c **** 	queue_init();
2048:bluetooth_rxtx.c **** 	dio_ssp_init();
2049:bluetooth_rxtx.c **** 	dma_init_le();
2050:bluetooth_rxtx.c **** 	dio_ssp_start();
2051:bluetooth_rxtx.c **** 
2052:bluetooth_rxtx.c **** 	cc2400_rx_sync(rbit(le.access_address));
2053:bluetooth_rxtx.c **** 
2054:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
2055:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
2056:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
2057:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
2058:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
2059:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
2060:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
2061:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
2062:bluetooth_rxtx.c **** 			requested_channel = 0;
ARM GAS  /tmp/ccCuKxzC.s 			page 51


2063:bluetooth_rxtx.c **** 		}
2064:bluetooth_rxtx.c **** 		RXLED_CLR;
2065:bluetooth_rxtx.c **** 		rssi_reset();
2066:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode) ;
2067:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
2068:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
2069:bluetooth_rxtx.c **** 
2070:bluetooth_rxtx.c **** 		if (requested_mode != active_mode) {
2071:bluetooth_rxtx.c **** 			goto cleanup;
2072:bluetooth_rxtx.c **** 		}
2073:bluetooth_rxtx.c **** 		if (rx_err) {
2074:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
2075:bluetooth_rxtx.c **** 		}
2076:bluetooth_rxtx.c **** 		if (do_hop)
2077:bluetooth_rxtx.c **** 			goto rx_flush;
2078:bluetooth_rxtx.c **** 		if (!rx_tc)
2079:bluetooth_rxtx.c **** 			continue;
2080:bluetooth_rxtx.c **** 		
2081:bluetooth_rxtx.c **** 		uint32_t packet[48/4+1] = {0, };
2082:bluetooth_rxtx.c **** 		uint32_t whiten_packet[48/4+1] = {0, };
2083:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
2084:bluetooth_rxtx.c **** 
2085:bluetooth_rxtx.c **** 		//JWHUR buffering carrier frequency offset estimation
2086:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; i++) {
2087:bluetooth_rxtx.c **** 			cfo_buf[i] = cc2400_get_rev(FREQEST);
2088:bluetooth_rxtx.c **** 		}
2089:bluetooth_rxtx.c **** 
2090:bluetooth_rxtx.c **** 		packet[0] = le.access_address;
2091:bluetooth_rxtx.c **** 		
2092:bluetooth_rxtx.c **** 		const uint32_t *whit = whitening_word[btle_channel_index(channel-2402)];
2093:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
2094:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
2095:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
2096:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
2097:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
2098:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
2099:bluetooth_rxtx.c **** 			whiten_packet[i/4+1] = rbit(v);
2100:bluetooth_rxtx.c **** 		}
2101:bluetooth_rxtx.c **** 
2102:bluetooth_rxtx.c **** 		unsigned len = (p[5] & 0x3f) + 2;
2103:bluetooth_rxtx.c **** 		cfo_buf[DMA_SIZE - 1] = p[5];
2104:bluetooth_rxtx.c **** 
2105:bluetooth_rxtx.c **** 		if (len > 39)
2106:bluetooth_rxtx.c **** 			goto rx_flush;
2107:bluetooth_rxtx.c **** 
2108:bluetooth_rxtx.c **** 		unsigned total_transfers = ((len + 3) + 4 - 1) / 4;
2109:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
2110:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0) ;
2111:bluetooth_rxtx.c **** 		} else { while (DMACC0Config & DMACCxConfig_E && rx_err == 0) ;
2112:bluetooth_rxtx.c **** 		}
2113:bluetooth_rxtx.c **** 
2114:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
2115:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
2116:bluetooth_rxtx.c **** 
2117:bluetooth_rxtx.c **** 		for (i=4; i<44; i+=4) {
2118:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
2119:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
ARM GAS  /tmp/ccCuKxzC.s 			page 52


2120:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
2121:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
2122:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
2123:bluetooth_rxtx.c **** 			whiten_packet[i/4+1] = rbit(v);
2124:bluetooth_rxtx.c **** 		}
2125:bluetooth_rxtx.c **** 
2126:bluetooth_rxtx.c **** 		if (le.crc_verify) {
2127:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
2128:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
2129:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
2130:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
2131:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc)
2132:bluetooth_rxtx.c **** 				goto rx_flush;
2133:bluetooth_rxtx.c **** 		}
2134:bluetooth_rxtx.c **** 
2135:bluetooth_rxtx.c **** 		RXLED_SET;
2136:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
2137:bluetooth_rxtx.c **** 
2138:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
2139:bluetooth_rxtx.c **** 		if (p[10] == 0x55 && p[11] == 0xec) {
2140:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, (uint8_t *)packet);
2141:bluetooth_rxtx.c **** 			enqueue(CFO_TRACK, (uint8_t *)cfo_buf);
2142:bluetooth_rxtx.c **** 			//enqueue(MESSAGE, (uint8_t *)whiten_packet);
2143:bluetooth_rxtx.c **** 		}
2144:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
2145:bluetooth_rxtx.c **** 
2146:bluetooth_rxtx.c **** 		le.last_packet = CLK100NS;
2147:bluetooth_rxtx.c **** 
2148:bluetooth_rxtx.c **** 	rx_flush:
2149:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
2150:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
2151:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
2152:bluetooth_rxtx.c **** 			u8 tmp = (u8) DIO_SSP_DR;
2153:bluetooth_rxtx.c **** 		}
2154:bluetooth_rxtx.c **** 		u32 now = CLK100NS;
2155:bluetooth_rxtx.c **** 		if (now <le.last_packet)
2156:bluetooth_rxtx.c **** 			now += 3276800000;
2157:bluetooth_rxtx.c **** 		if ( ((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING) && (now - le.last_p
2158:bluetooth_rxtx.c **** 			reset_le();
2159:bluetooth_rxtx.c **** 			le_jam_count = 0;
2160:bluetooth_rxtx.c **** 			TXLED_CLR;
2161:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
2162:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
2163:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
2164:bluetooth_rxtx.c **** 				goto cleanup;
2165:bluetooth_rxtx.c **** 			}
2166:bluetooth_rxtx.c **** 			le.link_state = LINK_LISTENING;
2167:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
2168:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
2169:bluetooth_rxtx.c **** 
2170:bluetooth_rxtx.c **** 			channel = le_adv_channel != 0 ? le_adv_channel : 2402;
2171:bluetooth_rxtx.c **** 			restart_jamming = 1;
2172:bluetooth_rxtx.c **** 		}
2173:bluetooth_rxtx.c **** 
2174:bluetooth_rxtx.c **** 		cc2400_set(SYNCL, le.syncl);
2175:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
2176:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccCuKxzC.s 			page 53


2177:bluetooth_rxtx.c **** 		if (do_hop)
2178:bluetooth_rxtx.c **** 			hop();
2179:bluetooth_rxtx.c **** 		if (le_jam_count > 0) {
2180:bluetooth_rxtx.c **** 			le_jam();
2181:bluetooth_rxtx.c **** 			--le_jam_count;
2182:bluetooth_rxtx.c **** 		} else {
2183:bluetooth_rxtx.c **** 			dma_init_le();
2184:bluetooth_rxtx.c **** 			dio_ssp_start();
2185:bluetooth_rxtx.c **** 
2186:bluetooth_rxtx.c **** 			if (restart_jamming) {
2187:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
2188:bluetooth_rxtx.c **** 				restart_jamming = 0;
2189:bluetooth_rxtx.c **** 			} else {
2190:bluetooth_rxtx.c **** 				while (!(cc2400_status() & FS_LOCK));
2191:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
2192:bluetooth_rxtx.c **** 			}
2193:bluetooth_rxtx.c **** 		}
2194:bluetooth_rxtx.c **** 		rx_tc = 0;
2195:bluetooth_rxtx.c **** 		rx_err = 0;
2196:bluetooth_rxtx.c **** 
2197:bluetooth_rxtx.c **** 	}
2198:bluetooth_rxtx.c **** 	goto cleanup;
2199:bluetooth_rxtx.c **** 
2200:bluetooth_rxtx.c **** cleanup:
2201:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
2202:bluetooth_rxtx.c **** 	cc2400_idle();
2203:bluetooth_rxtx.c **** 	dio_ssp_stop ();
2204:bluetooth_rxtx.c **** 	cs_trigger_disable();
2205:bluetooth_rxtx.c **** }
2206:bluetooth_rxtx.c **** 
2207:bluetooth_rxtx.c **** /* low energy connection following
2208:bluetooth_rxtx.c ****  * follows a known AA around */
2209:bluetooth_rxtx.c **** int cb_follow_le() {
 680              		.loc 1 2209 0
 681              		.cfi_startproc
 682              		@ args = 0, pretend = 0, frame = 0
 683              		@ frame_needed = 0, uses_anonymous_args = 0
 684 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 685              		.cfi_def_cfa_offset 32
 686              		.cfi_offset 3, -32
 687              		.cfi_offset 4, -28
 688              		.cfi_offset 5, -24
 689              		.cfi_offset 6, -20
 690              		.cfi_offset 7, -16
 691              		.cfi_offset 8, -12
 692              		.cfi_offset 9, -8
 693              		.cfi_offset 14, -4
2210:bluetooth_rxtx.c **** 	int i, j, k;
2211:bluetooth_rxtx.c **** 	int idx = whitening_index[btle_channel_index(channel-2402)];
 694              		.loc 1 2211 0
 695 0004 394C     		ldr	r4, .L72
 696 0006 2088     		ldrh	r0, [r4]
 697 0008 2646     		mov	r6, r4
 698 000a 80B2     		uxth	r0, r0
 699 000c 6238     		subs	r0, r0, #98
 700 000e C0B2     		uxtb	r0, r0
 701 0010 FFF7FEFF 		bl	btle_channel_index
ARM GAS  /tmp/ccCuKxzC.s 			page 54


 702              	.LVL62:
 703 0014 3649     		ldr	r1, .L72+4
2212:bluetooth_rxtx.c **** 
2213:bluetooth_rxtx.c **** 	u32 access_address = 0;
 704              		.loc 1 2213 0
 705 0016 0022     		movs	r2, #0
2211:bluetooth_rxtx.c **** 
 706              		.loc 1 2211 0
 707 0018 0D5C     		ldrb	r5, [r1, r0]	@ zero_extendqisi2
 708              	.LVL63:
2214:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 709              		.loc 1 2214 0
 710 001a 1346     		mov	r3, r2
 711 001c 8C46     		mov	ip, r1
 712              	.LVL64:
 713              	.L53:
2215:bluetooth_rxtx.c **** 		access_address >>= 1;
2216:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
 714              		.loc 1 2216 0 discriminator 2
 715 001e 354F     		ldr	r7, .L72+8
 716 0020 D95D     		ldrb	r1, [r3, r7]	@ zero_extendqisi2
2214:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 717              		.loc 1 2214 0 discriminator 2
 718 0022 0133     		adds	r3, r3, #1
 719              	.LVL65:
 720              		.loc 1 2216 0 discriminator 2
 721 0024 C907     		lsls	r1, r1, #31
2214:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 722              		.loc 1 2214 0 discriminator 2
 723 0026 1F2B     		cmp	r3, #31
 724              		.loc 1 2216 0 discriminator 2
 725 0028 41EA5202 		orr	r2, r1, r2, lsr #1
 726              	.LVL66:
2214:bluetooth_rxtx.c **** 	for (i = 0; i < 31; ++i) {
 727              		.loc 1 2214 0 discriminator 2
 728 002c F7D1     		bne	.L53
2217:bluetooth_rxtx.c **** 	}
2218:bluetooth_rxtx.c **** 
2219:bluetooth_rxtx.c **** 	for (i = 31; i < DMA_SIZE * 8 + 32; i++) {
2220:bluetooth_rxtx.c **** 		access_address >>= 1;
2221:bluetooth_rxtx.c **** 		access_address |= (unpacked[i] << 31);
2222:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 729              		.loc 1 2222 0
 730 002e 7168     		ldr	r1, [r6, #4]
 731              	.L65:
 732              	.LVL67:
2221:bluetooth_rxtx.c **** 		if (access_address == le.access_address) {
 733              		.loc 1 2221 0
 734 0030 F85C     		ldrb	r0, [r7, r3]	@ zero_extendqisi2
 735 0032 C007     		lsls	r0, r0, #31
 736 0034 40EA5202 		orr	r2, r0, r2, lsr #1
 737              	.LVL68:
 738              		.loc 1 2222 0
 739 0038 8A42     		cmp	r2, r1
 740 003a 4FD1     		bne	.L54
 741 003c 0022     		movs	r2, #0
 742              	.LVL69:
ARM GAS  /tmp/ccCuKxzC.s 			page 55


 743              	.L55:
 744 003e 07EB0308 		add	r8, r7, r3
2214:bluetooth_rxtx.c **** 		access_address >>= 1;
 745              		.loc 1 2214 0 discriminator 1
 746 0042 0020     		movs	r0, #0
 747 0044 08EBC208 		add	r8, r8, r2, lsl #3
 748 0048 0146     		mov	r1, r0
 749              	.LVL70:
 750              	.L60:
 751 004a 08EB0104 		add	r4, r8, r1
 752              	.LBB6:
 753              	.LBB7:
2223:bluetooth_rxtx.c **** 			for (j = 0; j < 46; ++j) {
2224:bluetooth_rxtx.c **** 				u8 byte = 0;
2225:bluetooth_rxtx.c **** 				for (k = 0; k < 8; k++) {
2226:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
2227:bluetooth_rxtx.c **** 					if (offset >= DMA_SIZE*8*2) break;
2228:bluetooth_rxtx.c **** 					int bit = unpacked[offset];
2229:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 754              		.loc 1 2229 0
 755 004e 032A     		cmp	r2, #3
2228:bluetooth_rxtx.c **** 					if (j >= 4) { // unwhiten data bytes
 756              		.loc 1 2228 0
 757 0050 14F81F4C 		ldrb	r4, [r4, #-31]	@ zero_extendqisi2
 758              	.LVL71:
 759              		.loc 1 2229 0
 760 0054 0CDD     		ble	.L57
2230:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 761              		.loc 1 2230 0
 762 0056 0CEB050E 		add	lr, ip, r5
 763 005a 9EF828E0 		ldrb	lr, [lr, #40]	@ zero_extendqisi2
2231:bluetooth_rxtx.c **** 						idx = (idx + 1) % sizeof(whitening);
 764              		.loc 1 2231 0
 765 005e 0135     		adds	r5, r5, #1
 766              	.LVL72:
2230:bluetooth_rxtx.c **** 						bit ^= whitening[idx];
 767              		.loc 1 2230 0
 768 0060 84EA0E04 		eor	r4, r4, lr
 769              	.LVL73:
 770              		.loc 1 2231 0
 771 0064 4FF07F0E 		mov	lr, #127
 772 0068 B5FBFEF9 		udiv	r9, r5, lr
 773 006c 0EFB1955 		mls	r5, lr, r9, r5
 774              	.LVL74:
 775              	.L57:
2232:bluetooth_rxtx.c **** 					}
2233:bluetooth_rxtx.c **** 					byte |= bit << k;
 776              		.loc 1 2233 0
 777 0070 8C40     		lsls	r4, r4, r1
 778              	.LVL75:
 779              	.LBE7:
2225:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 780              		.loc 1 2225 0
 781 0072 0131     		adds	r1, r1, #1
 782              	.LVL76:
 783              	.LBB8:
 784              		.loc 1 2233 0
ARM GAS  /tmp/ccCuKxzC.s 			page 56


 785 0074 2043     		orrs	r0, r0, r4
 786              	.LVL77:
 787              	.LBE8:
2225:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 788              		.loc 1 2225 0
 789 0076 0829     		cmp	r1, #8
 790              	.LBB9:
 791              		.loc 1 2233 0
 792 0078 C0B2     		uxtb	r0, r0
 793              	.LVL78:
 794              	.LBE9:
2225:bluetooth_rxtx.c **** 					int offset = k + (j * 8) + i - 31;
 795              		.loc 1 2225 0
 796 007a E6D1     		bne	.L60
2234:bluetooth_rxtx.c **** 				}
2235:bluetooth_rxtx.c **** 				idle_rxbuf[j] = byte;
 797              		.loc 1 2235 0
 798 007c 1E4C     		ldr	r4, .L72+12
 799 007e 2168     		ldr	r1, [r4]
 800              	.LVL79:
 801 0080 8854     		strb	r0, [r1, r2]
 802              	.LBE6:
2223:bluetooth_rxtx.c **** 				u8 byte = 0;
 803              		.loc 1 2223 0
 804 0082 0132     		adds	r2, r2, #1
 805              	.LVL80:
 806 0084 2E2A     		cmp	r2, #46
 807 0086 DAD1     		bne	.L55
2236:bluetooth_rxtx.c **** 			}
2237:bluetooth_rxtx.c **** 
2238:bluetooth_rxtx.c **** 			// verify CRC
2239:bluetooth_rxtx.c **** 			if (le.crc_verify) {
 808              		.loc 1 2239 0
 809 0088 7369     		ldr	r3, [r6, #20]
 810              	.LVL81:
 811 008a 5BB9     		cbnz	r3, .L61
 812              	.LVL82:
 813              	.L63:
2240:bluetooth_rxtx.c **** 				int len		 = (idle_rxbuf[5] & 0x3f) + 2;
2241:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
2242:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
2243:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
2244:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
2245:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
2246:bluetooth_rxtx.c **** 					break;
2247:bluetooth_rxtx.c **** 			}
2248:bluetooth_rxtx.c **** 
2249:bluetooth_rxtx.c **** 			// send to PC
2250:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
 814              		.loc 1 2250 0
 815 008c 2168     		ldr	r1, [r4]
 816 008e 0120     		movs	r0, #1
 817 0090 FFF7FEFF 		bl	enqueue
 818              	.LVL83:
2251:bluetooth_rxtx.c **** 			RXLED_SET;
 819              		.loc 1 2251 0
 820 0094 194B     		ldr	r3, .L72+16
ARM GAS  /tmp/ccCuKxzC.s 			page 57


 821 0096 1022     		movs	r2, #16
 822 0098 1A60     		str	r2, [r3]
2252:bluetooth_rxtx.c **** 
2253:bluetooth_rxtx.c **** 			packet_cb((uint8_t*)idle_rxbuf);
 823              		.loc 1 2253 0
 824 009a 194B     		ldr	r3, .L72+20
 825 009c 2068     		ldr	r0, [r4]
 826 009e 9B69     		ldr	r3, [r3, #24]
 827 00a0 9847     		blx	r3
 828              	.LVL84:
2254:bluetooth_rxtx.c **** 
2255:bluetooth_rxtx.c **** 			break;
 829              		.loc 1 2255 0
 830 00a2 1FE0     		b	.L62
 831              	.LVL85:
 832              	.L61:
 833              	.LBB10:
2240:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
 834              		.loc 1 2240 0
 835 00a4 2368     		ldr	r3, [r4]
 836 00a6 5D79     		ldrb	r5, [r3, #5]	@ zero_extendqisi2
 837              	.LVL86:
2241:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 838              		.loc 1 2241 0
 839 00a8 104B     		ldr	r3, .L72
 840 00aa 2168     		ldr	r1, [r4]
2240:bluetooth_rxtx.c **** 				u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, (uint8_t*)idle_rxbuf + 4, len);
 841              		.loc 1 2240 0
 842 00ac 05F03F05 		and	r5, r5, #63
 843              	.LVL87:
2241:bluetooth_rxtx.c **** 				u32 wire_crc = (idle_rxbuf[4+len+2] << 16)
 844              		.loc 1 2241 0
 845 00b0 AA1C     		adds	r2, r5, #2
 846              	.LVL88:
 847 00b2 1869     		ldr	r0, [r3, #16]
 848              	.LVL89:
 849 00b4 0431     		adds	r1, r1, #4
 850 00b6 FFF7FEFF 		bl	btle_crcgen_lut
 851              	.LVL90:
2242:bluetooth_rxtx.c **** 							 | (idle_rxbuf[4+len+1] << 8)
 852              		.loc 1 2242 0
 853 00ba 2268     		ldr	r2, [r4]
 854 00bc 05F10803 		add	r3, r5, #8
 855 00c0 D15C     		ldrb	r1, [r2, r3]	@ zero_extendqisi2
2243:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
 856              		.loc 1 2243 0
 857 00c2 2268     		ldr	r2, [r4]
 858 00c4 EB1D     		adds	r3, r5, #7
 859 00c6 D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
2244:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 860              		.loc 1 2244 0
 861 00c8 2268     		ldr	r2, [r4]
 862 00ca 0635     		adds	r5, r5, #6
 863              	.LVL91:
 864 00cc 525D     		ldrb	r2, [r2, r5]	@ zero_extendqisi2
 865              	.LVL92:
2243:bluetooth_rxtx.c **** 							 |  idle_rxbuf[4+len+0];
ARM GAS  /tmp/ccCuKxzC.s 			page 58


 866              		.loc 1 2243 0
 867 00ce 1B02     		lsls	r3, r3, #8
 868              	.LVL93:
 869 00d0 43EA0143 		orr	r3, r3, r1, lsl #16
2244:bluetooth_rxtx.c **** 				if (calc_crc != wire_crc) // skip packets with a bad CRC
 870              		.loc 1 2244 0
 871 00d4 1343     		orrs	r3, r3, r2
2245:bluetooth_rxtx.c **** 					break;
 872              		.loc 1 2245 0
 873 00d6 9842     		cmp	r0, r3
 874 00d8 04D1     		bne	.L62
 875 00da D7E7     		b	.L63
 876              	.LVL94:
 877              	.L54:
 878              	.LBE10:
2219:bluetooth_rxtx.c **** 		access_address >>= 1;
 879              		.loc 1 2219 0
 880 00dc 0133     		adds	r3, r3, #1
 881              	.LVL95:
 882 00de B3F5D87F 		cmp	r3, #432
 883 00e2 A5D1     		bne	.L65
 884              	.LVL96:
 885              	.L62:
2256:bluetooth_rxtx.c **** 		}
2257:bluetooth_rxtx.c **** 	}
2258:bluetooth_rxtx.c **** 
2259:bluetooth_rxtx.c **** 	return 1;
2260:bluetooth_rxtx.c **** }
 886              		.loc 1 2260 0
 887 00e4 0120     		movs	r0, #1
 888 00e6 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 889              	.L73:
 890 00ea 00BF     		.align	2
 891              	.L72:
 892 00ec 00000000 		.word	.LANCHOR1
 893 00f0 00000000 		.word	.LANCHOR2
 894 00f4 00000000 		.word	unpacked
 895 00f8 00000000 		.word	idle_rxbuf
 896 00fc 38C00920 		.word	537509944
 897 0100 00000000 		.word	.LANCHOR0
 898              		.cfi_endproc
 899              	.LFE26:
 901              		.section	.text.connection_follow_cb,"ax",%progbits
 902              		.align	1
 903              		.global	connection_follow_cb
 904              		.thumb
 905              		.thumb_func
 907              	connection_follow_cb:
 908              	.LFB27:
2261:bluetooth_rxtx.c **** 
2262:bluetooth_rxtx.c **** /**
2263:bluetooth_rxtx.c ****  * Called when we receive a packet in connection following mode.
2264:bluetooth_rxtx.c ****  */
2265:bluetooth_rxtx.c **** void connection_follow_cb(u8 *packet) {
 909              		.loc 1 2265 0
 910              		.cfi_startproc
 911              		@ args = 0, pretend = 0, frame = 0
ARM GAS  /tmp/ccCuKxzC.s 			page 59


 912              		@ frame_needed = 0, uses_anonymous_args = 0
 913              	.LVL97:
 914 0000 38B5     		push	{r3, r4, r5, lr}
 915              		.cfi_def_cfa_offset 16
 916              		.cfi_offset 3, -16
 917              		.cfi_offset 4, -12
 918              		.cfi_offset 5, -8
 919              		.cfi_offset 14, -4
 920              	.LVL98:
2266:bluetooth_rxtx.c **** 	int i;
2267:bluetooth_rxtx.c **** 	u32 aa = 0;
2268:bluetooth_rxtx.c **** 
2269:bluetooth_rxtx.c **** #define ADV_ADDRESS_IDX 0
2270:bluetooth_rxtx.c **** #define HEADER_IDX 4
2271:bluetooth_rxtx.c **** #define DATA_LEN_IDX 5
2272:bluetooth_rxtx.c **** #define DATA_START_IDX 6
2273:bluetooth_rxtx.c **** 
2274:bluetooth_rxtx.c **** 	// u8 *adv_addr = &packet[ADV_ADDRESS_IDX];
2275:bluetooth_rxtx.c **** 	u8 header = packet[HEADER_IDX];
2276:bluetooth_rxtx.c **** 	u8 *data_len = &packet[DATA_LEN_IDX];
2277:bluetooth_rxtx.c **** 	u8 *data = &packet[DATA_START_IDX];
2278:bluetooth_rxtx.c **** 	// u8 *crc = &packet[DATA_START_IDX + *data_len];
2279:bluetooth_rxtx.c **** 
2280:bluetooth_rxtx.c **** 	if (le.link_state == LINK_CONN_PENDING) {
 921              		.loc 1 2280 0
 922 0002 584B     		ldr	r3, .L92
2265:bluetooth_rxtx.c **** 	int i;
 923              		.loc 1 2265 0
 924 0004 0546     		mov	r5, r0
 925              		.loc 1 2280 0
 926 0006 1A7E     		ldrb	r2, [r3, #24]	@ zero_extendqisi2
2275:bluetooth_rxtx.c **** 	u8 *data_len = &packet[DATA_LEN_IDX];
 927              		.loc 1 2275 0
 928 0008 0179     		ldrb	r1, [r0, #4]	@ zero_extendqisi2
 929              	.LVL99:
 930              		.loc 1 2280 0
 931 000a 022A     		cmp	r2, #2
 932 000c 1C46     		mov	r4, r3
 933 000e 13D1     		bne	.L75
2281:bluetooth_rxtx.c **** 		// We received a packet in the connection pending state, so now the device *should* be connected
2282:bluetooth_rxtx.c **** 		le.link_state = LINK_CONNECTED;
 934              		.loc 1 2282 0
 935 0010 0322     		movs	r2, #3
 936 0012 1A76     		strb	r2, [r3, #24]
 937              	.LVL100:
2283:bluetooth_rxtx.c **** 		le.conn_epoch = clkn;
 938              		.loc 1 2283 0
 939 0014 544A     		ldr	r2, .L92+4
 940 0016 1268     		ldr	r2, [r2]
 941 0018 DA61     		str	r2, [r3, #28]
2284:bluetooth_rxtx.c **** 		le.interval_timer = le.conn_interval - 1;
 942              		.loc 1 2284 0
 943 001a 5A8C     		ldrh	r2, [r3, #34]
 944 001c 013A     		subs	r2, r2, #1
 945 001e 92B2     		uxth	r2, r2
 946 0020 1A84     		strh	r2, [r3, #32]	@ movhi
2285:bluetooth_rxtx.c **** 		le.conn_count = 0;
ARM GAS  /tmp/ccCuKxzC.s 			page 60


 947              		.loc 1 2285 0
 948 0022 0022     		movs	r2, #0
 949 0024 9A84     		strh	r2, [r3, #36]	@ movhi
2286:bluetooth_rxtx.c **** 		le.update_pending = 0;
 950              		.loc 1 2286 0
 951 0026 DA62     		str	r2, [r3, #44]
2287:bluetooth_rxtx.c **** 
2288:bluetooth_rxtx.c **** 		// hue hue hue
2289:bluetooth_rxtx.c **** 		if (jam_mode != JAM_NONE)
 952              		.loc 1 2289 0
 953 0028 504B     		ldr	r3, .L92+8
 954 002a DA7C     		ldrb	r2, [r3, #19]	@ zero_extendqisi2
 955 002c 002A     		cmp	r2, #0
 956 002e 00F09880 		beq	.L74
2290:bluetooth_rxtx.c **** 			le_jam_count = JAM_COUNT_DEFAULT;
 957              		.loc 1 2290 0
 958 0032 2822     		movs	r2, #40
 959 0034 DA61     		str	r2, [r3, #28]
 960 0036 38BD     		pop	{r3, r4, r5, pc}
 961              	.LVL101:
 962              	.L75:
2291:bluetooth_rxtx.c **** 
2292:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_CONNECTED) {
 963              		.loc 1 2292 0
 964 0038 032A     		cmp	r2, #3
 965 003a 3BD1     		bne	.L78
 966              	.LBB11:
2293:bluetooth_rxtx.c **** 		u8 llid =  header & 0x03;
2294:bluetooth_rxtx.c **** 
2295:bluetooth_rxtx.c **** 		// Apply any connection parameter update if necessary
2296:bluetooth_rxtx.c **** 		if (le.update_pending && le.conn_count == le.update_instant) {
 967              		.loc 1 2296 0
 968 003c DB6A     		ldr	r3, [r3, #44]
2293:bluetooth_rxtx.c **** 		u8 llid =  header & 0x03;
 969              		.loc 1 2293 0
 970 003e 01F00301 		and	r1, r1, #3
 971              	.LVL102:
 972              		.loc 1 2296 0
 973 0042 A3B1     		cbz	r3, .L79
 974              		.loc 1 2296 0 is_stmt 0 discriminator 1
 975 0044 A38C     		ldrh	r3, [r4, #36]
 976 0046 228E     		ldrh	r2, [r4, #48]
 977 0048 9BB2     		uxth	r3, r3
 978 004a 9A42     		cmp	r2, r3
 979 004c 0FD1     		bne	.L79
2297:bluetooth_rxtx.c **** 			// This is the first packet received in the connection interval for which the new parameters app
2298:bluetooth_rxtx.c **** 			le.conn_epoch = clkn;
 980              		.loc 1 2298 0 is_stmt 1
 981 004e 464B     		ldr	r3, .L92+4
 982 0050 1B68     		ldr	r3, [r3]
 983 0052 E361     		str	r3, [r4, #28]
 984              	.LVL103:
2299:bluetooth_rxtx.c **** 			le.conn_interval = le.interval_update;
 985              		.loc 1 2299 0
 986 0054 638E     		ldrh	r3, [r4, #50]
 987 0056 6384     		strh	r3, [r4, #34]	@ movhi
2300:bluetooth_rxtx.c **** 			le.interval_timer = le.interval_update - 1;
ARM GAS  /tmp/ccCuKxzC.s 			page 61


 988              		.loc 1 2300 0
 989 0058 013B     		subs	r3, r3, #1
 990 005a 9BB2     		uxth	r3, r3
 991 005c 2384     		strh	r3, [r4, #32]	@ movhi
2301:bluetooth_rxtx.c **** 			le.win_size = le.win_size_update;
 992              		.loc 1 2301 0
 993 005e 94F83430 		ldrb	r3, [r4, #52]	@ zero_extendqisi2
 994 0062 84F82630 		strb	r3, [r4, #38]
2302:bluetooth_rxtx.c **** 			le.win_offset = le.win_offset_update;
 995              		.loc 1 2302 0
 996 0066 E38E     		ldrh	r3, [r4, #54]
 997 0068 2385     		strh	r3, [r4, #40]	@ movhi
2303:bluetooth_rxtx.c **** 			le.update_pending = 0;
 998              		.loc 1 2303 0
 999 006a 0023     		movs	r3, #0
 1000 006c E362     		str	r3, [r4, #44]
 1001              	.L79:
2304:bluetooth_rxtx.c **** 		}
2305:bluetooth_rxtx.c **** 
2306:bluetooth_rxtx.c **** 		if (llid == 0x03 && data[0] == 0x00) {
 1002              		.loc 1 2306 0
 1003 006e 0329     		cmp	r1, #3
 1004 0070 77D1     		bne	.L74
 1005              		.loc 1 2306 0 is_stmt 0 discriminator 1
 1006 0072 AB79     		ldrb	r3, [r5, #6]	@ zero_extendqisi2
 1007 0074 002B     		cmp	r3, #0
 1008 0076 74D1     		bne	.L74
2307:bluetooth_rxtx.c **** 			// This is a CONNECTION_UPDATE_REQ.
2308:bluetooth_rxtx.c **** 			// The host is changing the connection parameters.
2309:bluetooth_rxtx.c **** 			le.win_size_update = packet[7];
 1009              		.loc 1 2309 0 is_stmt 1
 1010 0078 EB79     		ldrb	r3, [r5, #7]	@ zero_extendqisi2
 1011 007a 84F83430 		strb	r3, [r4, #52]
2310:bluetooth_rxtx.c **** 			le.win_offset_update = packet[8] + ((u16)packet[9] << 8);
 1012              		.loc 1 2310 0
 1013 007e 6A7A     		ldrb	r2, [r5, #9]	@ zero_extendqisi2
 1014 0080 2B7A     		ldrb	r3, [r5, #8]	@ zero_extendqisi2
 1015 0082 03EB0223 		add	r3, r3, r2, lsl #8
 1016 0086 E386     		strh	r3, [r4, #54]	@ movhi
2311:bluetooth_rxtx.c **** 			le.interval_update = packet[10] + ((u16)packet[11] << 8);
 1017              		.loc 1 2311 0
 1018 0088 EA7A     		ldrb	r2, [r5, #11]	@ zero_extendqisi2
 1019 008a AB7A     		ldrb	r3, [r5, #10]	@ zero_extendqisi2
 1020 008c 03EB0223 		add	r3, r3, r2, lsl #8
 1021 0090 6386     		strh	r3, [r4, #50]	@ movhi
2312:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 1022              		.loc 1 2312 0
 1023 0092 6A7C     		ldrb	r2, [r5, #17]	@ zero_extendqisi2
 1024 0094 2B7C     		ldrb	r3, [r5, #16]	@ zero_extendqisi2
 1025 0096 03EB0223 		add	r3, r3, r2, lsl #8
2313:bluetooth_rxtx.c **** 			if (le.update_instant - le.conn_count < 32767)
 1026              		.loc 1 2313 0
 1027 009a A28C     		ldrh	r2, [r4, #36]
2312:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 1028              		.loc 1 2312 0
 1029 009c 9BB2     		uxth	r3, r3
 1030              		.loc 1 2313 0
ARM GAS  /tmp/ccCuKxzC.s 			page 62


 1031 009e 92B2     		uxth	r2, r2
2312:bluetooth_rxtx.c **** 			le.update_instant = packet[16] + ((u16)packet[17] << 8);
 1032              		.loc 1 2312 0
 1033 00a0 2386     		strh	r3, [r4, #48]	@ movhi
 1034              		.loc 1 2313 0
 1035 00a2 9B1A     		subs	r3, r3, r2
 1036 00a4 47F6FE72 		movw	r2, #32766
 1037 00a8 9342     		cmp	r3, r2
 1038 00aa 5ADC     		bgt	.L74
2314:bluetooth_rxtx.c **** 				le.update_pending = 1;
 1039              		.loc 1 2314 0
 1040 00ac 2D4B     		ldr	r3, .L92
 1041 00ae 0122     		movs	r2, #1
 1042 00b0 DA62     		str	r2, [r3, #44]
 1043 00b2 38BD     		pop	{r3, r4, r5, pc}
 1044              	.LVL104:
 1045              	.L78:
 1046              	.LBE11:
2315:bluetooth_rxtx.c **** 		}
2316:bluetooth_rxtx.c **** 
2317:bluetooth_rxtx.c **** 	} else if (le.link_state == LINK_LISTENING) {
 1047              		.loc 1 2317 0
 1048 00b4 012A     		cmp	r2, #1
 1049 00b6 54D1     		bne	.L74
 1050              	.LVL105:
 1051              	.LBB12:
2318:bluetooth_rxtx.c **** 		u8 pkt_type = packet[4] & 0x0F;
2319:bluetooth_rxtx.c **** 		if (pkt_type == 0x05) {
 1052              		.loc 1 2319 0
 1053 00b8 01F00F01 		and	r1, r1, #15
 1054              	.LVL106:
 1055 00bc 0529     		cmp	r1, #5
 1056 00be 50D1     		bne	.L74
 1057              	.LBB13:
2320:bluetooth_rxtx.c **** 			uint16_t conn_interval;
2321:bluetooth_rxtx.c **** 
2322:bluetooth_rxtx.c **** 			// ignore packets with incorrect length
2323:bluetooth_rxtx.c **** 			if (*data_len != 34)
 1058              		.loc 1 2323 0
 1059 00c0 4379     		ldrb	r3, [r0, #5]	@ zero_extendqisi2
 1060 00c2 222B     		cmp	r3, #34
 1061 00c4 4DD1     		bne	.L74
 1062              	.LVL107:
2324:bluetooth_rxtx.c **** 				return;
2325:bluetooth_rxtx.c **** 
2326:bluetooth_rxtx.c **** 			// conn interval must be [7.5 ms, 4.0s] in units of 1.25 ms
2327:bluetooth_rxtx.c **** 			conn_interval = (packet[29] << 8) | packet[28];
 1063              		.loc 1 2327 0
 1064 00c6 037F     		ldrb	r3, [r0, #28]	@ zero_extendqisi2
 1065 00c8 427F     		ldrb	r2, [r0, #29]	@ zero_extendqisi2
 1066 00ca 43EA0222 		orr	r2, r3, r2, lsl #8
2328:bluetooth_rxtx.c **** 			if (conn_interval < 6 || conn_interval > 3200)
 1067              		.loc 1 2328 0
 1068 00ce 063A     		subs	r2, r2, #6
 1069 00d0 92B2     		uxth	r2, r2
 1070 00d2 40F67A43 		movw	r3, #3194
 1071 00d6 9A42     		cmp	r2, r3
ARM GAS  /tmp/ccCuKxzC.s 			page 63


 1072 00d8 43D8     		bhi	.L74
2329:bluetooth_rxtx.c **** 				return;
2330:bluetooth_rxtx.c **** 
2331:bluetooth_rxtx.c **** 			// This is a connect packet
2332:bluetooth_rxtx.c **** 			// if we have a target, see if InitA or AdvA matches
2333:bluetooth_rxtx.c **** 			if (le.target_set &&
 1073              		.loc 1 2333 0
 1074 00da 236C     		ldr	r3, [r4, #64]
 1075 00dc 2BB9     		cbnz	r3, .L81
 1076              	.LVL108:
 1077              	.L83:
2334:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
2335:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
2336:bluetooth_rxtx.c **** 				return;
2337:bluetooth_rxtx.c **** 			}
2338:bluetooth_rxtx.c **** 
2339:bluetooth_rxtx.c **** 			le.link_state = LINK_CONN_PENDING;
 1078              		.loc 1 2339 0
 1079 00de 0223     		movs	r3, #2
2340:bluetooth_rxtx.c **** 			le.crc_verify = 0; // we will drop many packets if we attempt to filter by CRC
 1080              		.loc 1 2340 0
 1081 00e0 0020     		movs	r0, #0
2339:bluetooth_rxtx.c **** 			le.crc_verify = 0; // we will drop many packets if we attempt to filter by CRC
 1082              		.loc 1 2339 0
 1083 00e2 2376     		strb	r3, [r4, #24]
 1084              		.loc 1 2340 0
 1085 00e4 6061     		str	r0, [r4, #20]
 1086              	.LVL109:
2341:bluetooth_rxtx.c **** 
2342:bluetooth_rxtx.c **** 			for (i = 0; i < 4; ++i)
 1087              		.loc 1 2342 0
 1088 00e6 0346     		mov	r3, r0
 1089 00e8 11E0     		b	.L82
 1090              	.LVL110:
 1091              	.L81:
2334:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
 1092              		.loc 1 2334 0 discriminator 1
 1093 00ea 04F13800 		add	r0, r4, #56
 1094              	.LVL111:
 1095 00ee A91D     		adds	r1, r5, #6
 1096 00f0 0622     		movs	r2, #6
 1097 00f2 FFF7FEFF 		bl	memcmp
 1098              	.LVL112:
2333:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[6], 6) &&  // Target address doesn't match Initiator.
 1099              		.loc 1 2333 0 discriminator 1
 1100 00f6 0028     		cmp	r0, #0
 1101 00f8 F1D0     		beq	.L83
2335:bluetooth_rxtx.c **** 				return;
 1102              		.loc 1 2335 0
 1103 00fa 04F13800 		add	r0, r4, #56
 1104 00fe 05F10C01 		add	r1, r5, #12
 1105 0102 0622     		movs	r2, #6
 1106 0104 FFF7FEFF 		bl	memcmp
 1107              	.LVL113:
2334:bluetooth_rxtx.c **** 				memcmp(le.target, &packet[12], 6)) {  // Target address doesn't match Advertiser.
 1108              		.loc 1 2334 0
 1109 0108 0028     		cmp	r0, #0
ARM GAS  /tmp/ccCuKxzC.s 			page 64


 1110 010a E8D0     		beq	.L83
 1111 010c 38BD     		pop	{r3, r4, r5, pc}
 1112              	.LVL114:
 1113              	.L82:
 1114 010e EA18     		adds	r2, r5, r3
2343:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1115              		.loc 1 2343 0 discriminator 2
 1116 0110 917C     		ldrb	r1, [r2, #18]	@ zero_extendqisi2
 1117 0112 DA00     		lsls	r2, r3, #3
 1118 0114 01FA02F2 		lsl	r2, r1, r2
2342:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1119              		.loc 1 2342 0 discriminator 2
 1120 0118 0133     		adds	r3, r3, #1
 1121              	.LVL115:
 1122 011a 042B     		cmp	r3, #4
 1123              		.loc 1 2343 0 discriminator 2
 1124 011c 40EA0200 		orr	r0, r0, r2
 1125              	.LVL116:
2342:bluetooth_rxtx.c **** 				aa |= packet[18+i] << (i*8);
 1126              		.loc 1 2342 0 discriminator 2
 1127 0120 F5D1     		bne	.L82
2344:bluetooth_rxtx.c **** 			le_set_access_address(aa);
 1128              		.loc 1 2344 0
 1129 0122 FFF7FEFF 		bl	le_set_access_address
 1130              	.LVL117:
2345:bluetooth_rxtx.c **** 
2346:bluetooth_rxtx.c **** #define CRC_INIT (2+4+6+6+4)
2347:bluetooth_rxtx.c **** 			le.crc_init = (packet[CRC_INIT+2] << 16)
2348:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1131              		.loc 1 2348 0
 1132 0126 E87D     		ldrb	r0, [r5, #23]	@ zero_extendqisi2
2347:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1133              		.loc 1 2347 0
 1134 0128 2B7E     		ldrb	r3, [r5, #24]	@ zero_extendqisi2
 1135              		.loc 1 2348 0
 1136 012a 0002     		lsls	r0, r0, #8
 1137 012c 40EA0340 		orr	r0, r0, r3, lsl #16
2349:bluetooth_rxtx.c **** 						|  packet[CRC_INIT+0];
 1138              		.loc 1 2349 0
 1139 0130 AB7D     		ldrb	r3, [r5, #22]	@ zero_extendqisi2
 1140 0132 1843     		orrs	r0, r0, r3
2347:bluetooth_rxtx.c **** 						| (packet[CRC_INIT+1] << 8)
 1141              		.loc 1 2347 0
 1142 0134 E060     		str	r0, [r4, #12]
2350:bluetooth_rxtx.c **** 			le.crc_init_reversed = rbit(le.crc_init);
 1143              		.loc 1 2350 0
 1144 0136 FFF7FEFF 		bl	rbit
 1145              	.LVL118:
2351:bluetooth_rxtx.c **** 
2352:bluetooth_rxtx.c **** #define WIN_SIZE (2+4+6+6+4+3)
2353:bluetooth_rxtx.c **** 			le.win_size = packet[WIN_SIZE];
 1146              		.loc 1 2353 0
 1147 013a 6B7E     		ldrb	r3, [r5, #25]	@ zero_extendqisi2
2350:bluetooth_rxtx.c **** 			le.crc_init_reversed = rbit(le.crc_init);
 1148              		.loc 1 2350 0
 1149 013c 2061     		str	r0, [r4, #16]
 1150              		.loc 1 2353 0
ARM GAS  /tmp/ccCuKxzC.s 			page 65


 1151 013e 84F82630 		strb	r3, [r4, #38]
2354:bluetooth_rxtx.c **** 
2355:bluetooth_rxtx.c **** #define WIN_OFFSET (2+4+6+6+4+3+1)
2356:bluetooth_rxtx.c **** 			le.win_offset = packet[WIN_OFFSET];
 1152              		.loc 1 2356 0
 1153 0142 AB7E     		ldrb	r3, [r5, #26]	@ zero_extendqisi2
 1154 0144 2385     		strh	r3, [r4, #40]	@ movhi
2357:bluetooth_rxtx.c **** 
2358:bluetooth_rxtx.c **** #define CONN_INTERVAL (2+4+6+6+4+3+1+2)
2359:bluetooth_rxtx.c **** 			le.conn_interval = (packet[CONN_INTERVAL+1] << 8)
 1155              		.loc 1 2359 0
 1156 0146 6A7F     		ldrb	r2, [r5, #29]	@ zero_extendqisi2
 1157 0148 2B7F     		ldrb	r3, [r5, #28]	@ zero_extendqisi2
 1158 014a 43EA0223 		orr	r3, r3, r2, lsl #8
 1159 014e 6384     		strh	r3, [r4, #34]	@ movhi
2360:bluetooth_rxtx.c **** 							 |  packet[CONN_INTERVAL+0];
2361:bluetooth_rxtx.c **** 
2362:bluetooth_rxtx.c **** #define CHANNEL_INC (2+4+6+6+4+3+1+2+2+2+2+5)
2363:bluetooth_rxtx.c **** 			le.channel_increment = packet[CHANNEL_INC] & 0x1f;
 1160              		.loc 1 2363 0
 1161 0150 95F82730 		ldrb	r3, [r5, #39]	@ zero_extendqisi2
2364:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
2365:bluetooth_rxtx.c **** 
2366:bluetooth_rxtx.c **** 			// Hop to the initial channel immediately
2367:bluetooth_rxtx.c **** 			do_hop = 1;
 1162              		.loc 1 2367 0
 1163 0154 0122     		movs	r2, #1
2363:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
 1164              		.loc 1 2363 0
 1165 0156 03F01F03 		and	r3, r3, #31
 1166 015a A376     		strb	r3, [r4, #26]
2364:bluetooth_rxtx.c **** 			le.channel_idx = le.channel_increment;
 1167              		.loc 1 2364 0
 1168 015c 6376     		strb	r3, [r4, #25]
 1169              		.loc 1 2367 0
 1170 015e 034B     		ldr	r3, .L92+8
 1171 0160 DA72     		strb	r2, [r3, #11]
 1172              	.L74:
 1173 0162 38BD     		pop	{r3, r4, r5, pc}
 1174              	.LVL119:
 1175              	.L93:
 1176              		.align	2
 1177              	.L92:
 1178 0164 00000000 		.word	.LANCHOR1
 1179 0168 00000000 		.word	clkn
 1180 016c 00000000 		.word	.LANCHOR0
 1181              	.LBE13:
 1182              	.LBE12:
 1183              		.cfi_endproc
 1184              	.LFE27:
 1186              		.global	__aeabi_llsl
 1187              		.section	.text.vendor_request_handler,"ax",%progbits
 1188              		.align	1
 1189              		.thumb
 1190              		.thumb_func
 1192              	vendor_request_handler:
 1193              	.LFB3:
ARM GAS  /tmp/ccCuKxzC.s 			page 66


 205:bluetooth_rxtx.c **** 	uint32_t clock;
 1194              		.loc 1 205 0
 1195              		.cfi_startproc
 1196              		@ args = 0, pretend = 0, frame = 0
 1197              		@ frame_needed = 0, uses_anonymous_args = 0
 1198              	.LVL120:
 1199 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1200              		.cfi_def_cfa_offset 24
 1201              		.cfi_offset 4, -24
 1202              		.cfi_offset 5, -20
 1203              		.cfi_offset 6, -16
 1204              		.cfi_offset 7, -12
 1205              		.cfi_offset 8, -8
 1206              		.cfi_offset 14, -4
 1207              	.LVL121:
 211:bluetooth_rxtx.c **** 
 1208              		.loc 1 211 0
 1209 0004 974C     		ldr	r4, .L250
 205:bluetooth_rxtx.c **** 	uint32_t clock;
 1210              		.loc 1 205 0
 1211 0006 1D46     		mov	r5, r3
 211:bluetooth_rxtx.c **** 
 1212              		.loc 1 211 0
 1213 0008 1B68     		ldr	r3, [r3]
 1214              	.LVL122:
 205:bluetooth_rxtx.c **** 	uint32_t clock;
 1215              		.loc 1 205 0
 1216 000a 0F46     		mov	r7, r1
 1217 000c 1646     		mov	r6, r2
 211:bluetooth_rxtx.c **** 
 1218              		.loc 1 211 0
 1219 000e 2362     		str	r3, [r4, #32]
 213:bluetooth_rxtx.c **** 
 1220              		.loc 1 213 0
 1221 0010 4828     		cmp	r0, #72
 1222 0012 00F22F83 		bhi	.L209
 1223 0016 DFE810F0 		tbh	[pc, r0, lsl #1]
 1224              	.LVL123:
 1225              	.L97:
 1226 001a 0001     		.2byte	(.L226-.L97)/2
 1227 001c 4B00     		.2byte	(.L98-.L97)/2
 1228 001e 4F00     		.2byte	(.L99-.L97)/2
 1229 0020 5200     		.2byte	(.L100-.L97)/2
 1230 0022 5700     		.2byte	(.L101-.L97)/2
 1231 0024 5A00     		.2byte	(.L102-.L97)/2
 1232 0026 5F00     		.2byte	(.L103-.L97)/2
 1233 0028 6200     		.2byte	(.L104-.L97)/2
 1234 002a 6400     		.2byte	(.L105-.L97)/2
 1235 002c 6800     		.2byte	(.L106-.L97)/2
 1236 002e 6D00     		.2byte	(.L107-.L97)/2
 1237 0030 C000     		.2byte	(.L108-.L97)/2
 1238 0032 C700     		.2byte	(.L109-.L97)/2
 1239 0034 0501     		.2byte	(.L241-.L97)/2
 1240 0036 7B00     		.2byte	(.L111-.L97)/2
 1241 0038 7600     		.2byte	(.L112-.L97)/2
 1242 003a 8000     		.2byte	(.L113-.L97)/2
 1243 003c 8500     		.2byte	(.L114-.L97)/2
ARM GAS  /tmp/ccCuKxzC.s 			page 67


 1244 003e 8800     		.2byte	(.L115-.L97)/2
 1245 0040 8D00     		.2byte	(.L116-.L97)/2
 1246 0042 9500     		.2byte	(.L117-.L97)/2
 1247 0044 B900     		.2byte	(.L118-.L97)/2
 1248 0046 BB00     		.2byte	(.L119-.L97)/2
 1249 0048 BD00     		.2byte	(.L120-.L97)/2
 1250 004a FE00     		.2byte	(.L121-.L97)/2
 1251 004c 0201     		.2byte	(.L122-.L97)/2
 1252 004e 2D03     		.2byte	(.L209-.L97)/2
 1253 0050 0701     		.2byte	(.L123-.L97)/2
 1254 0052 9800     		.2byte	(.L124-.L97)/2
 1255 0054 9F00     		.2byte	(.L125-.L97)/2
 1256 0056 A900     		.2byte	(.L126-.L97)/2
 1257 0058 A700     		.2byte	(.L127-.L97)/2
 1258 005a AB00     		.2byte	(.L128-.L97)/2
 1259 005c 4B01     		.2byte	(.L129-.L97)/2
 1260 005e 3D01     		.2byte	(.L130-.L97)/2
 1261 0060 6801     		.2byte	(.L131-.L97)/2
 1262 0062 6B01     		.2byte	(.L132-.L97)/2
 1263 0064 6F01     		.2byte	(.L133-.L97)/2
 1264 0066 7301     		.2byte	(.L134-.L97)/2
 1265 0068 A601     		.2byte	(.L135-.L97)/2
 1266 006a DB01     		.2byte	(.L136-.L97)/2
 1267 006c FF01     		.2byte	(.L137-.L97)/2
 1268 006e 3F02     		.2byte	(.L138-.L97)/2
 1269 0070 5202     		.2byte	(.L139-.L97)/2
 1270 0072 5D02     		.2byte	(.L140-.L97)/2
 1271 0074 2A03     		.2byte	(.L202-.L97)/2
 1272 0076 6C02     		.2byte	(.L142-.L97)/2
 1273 0078 7102     		.2byte	(.L143-.L97)/2
 1274 007a 7702     		.2byte	(.L144-.L97)/2
 1275 007c 7E02     		.2byte	(.L145-.L97)/2
 1276 007e 8D02     		.2byte	(.L146-.L97)/2
 1277 0080 E801     		.2byte	(.L147-.L97)/2
 1278 0082 F501     		.2byte	(.L148-.L97)/2
 1279 0084 9302     		.2byte	(.L149-.L97)/2
 1280 0086 EA02     		.2byte	(.L150-.L97)/2
 1281 0088 5A01     		.2byte	(.L151-.L97)/2
 1282 008a 0C03     		.2byte	(.L152-.L97)/2
 1283 008c 2D03     		.2byte	(.L209-.L97)/2
 1284 008e 9B02     		.2byte	(.L153-.L97)/2
 1285 0090 2303     		.2byte	(.L154-.L97)/2
 1286 0092 2603     		.2byte	(.L155-.L97)/2
 1287 0094 C501     		.2byte	(.L156-.L97)/2
 1288 0096 D701     		.2byte	(.L157-.L97)/2
 1289 0098 0A02     		.2byte	(.L158-.L97)/2
 1290 009a 2D03     		.2byte	(.L209-.L97)/2
 1291 009c 4900     		.2byte	(.L159-.L97)/2
 1292 009e D102     		.2byte	(.L160-.L97)/2
 1293 00a0 3B01     		.2byte	(.L161-.L97)/2
 1294 00a2 E102     		.2byte	(.L162-.L97)/2
 1295 00a4 1102     		.2byte	(.L163-.L97)/2
 1296 00a6 4602     		.2byte	(.L164-.L97)/2
 1297 00a8 4C02     		.2byte	(.L165-.L97)/2
 1298 00aa F502     		.2byte	(.L166-.L97)/2
 1299              	.L159:
 1300 00ac 0024     		movs	r4, #0
ARM GAS  /tmp/ccCuKxzC.s 			page 68


 1301 00ae 75E2     		b	.L167
 1302              	.L98:
 220:bluetooth_rxtx.c **** 		*data_len = 0;
 1303              		.loc 1 220 0
 1304 00b0 0120     		movs	r0, #1
 1305              	.LVL124:
 1306 00b2 A074     		strb	r0, [r4, #18]
 221:bluetooth_rxtx.c **** 		break;
 1307              		.loc 1 221 0
 1308 00b4 0023     		movs	r3, #0
 1309 00b6 A2E1     		b	.L219
 1310              	.LVL125:
 1311              	.L99:
 225:bluetooth_rxtx.c **** 		requested_mode = MODE_TX_SYMBOLS;
 1312              		.loc 1 225 0
 1313 00b8 0223     		movs	r3, #2
 1314 00ba A372     		strb	r3, [r4, #10]
 1315 00bc F6E0     		b	.L242
 1316              	.L100:
 231:bluetooth_rxtx.c **** 		*data_len = 1;
 1317              		.loc 1 231 0
 1318 00be 6A4B     		ldr	r3, .L250+4
 1319 00c0 1B68     		ldr	r3, [r3]
 1320 00c2 C3F34003 		ubfx	r3, r3, #1, #1
 1321 00c6 19E1     		b	.L220
 1322              	.L101:
 236:bluetooth_rxtx.c **** 			USRLED_SET;
 1323              		.loc 1 236 0
 1324 00c8 0A88     		ldrh	r2, [r1]
 1325 00ca 0223     		movs	r3, #2
 1326 00cc 15E0     		b	.L238
 1327              	.L102:
 243:bluetooth_rxtx.c **** 		*data_len = 1;
 1328              		.loc 1 243 0
 1329 00ce 664B     		ldr	r3, .L250+4
 1330 00d0 1B68     		ldr	r3, [r3]
 1331 00d2 C3F30013 		ubfx	r3, r3, #4, #1
 1332 00d6 11E1     		b	.L220
 1333              	.L103:
 248:bluetooth_rxtx.c **** 			RXLED_SET;
 1334              		.loc 1 248 0
 1335 00d8 0A88     		ldrh	r2, [r1]
 1336 00da 1023     		movs	r3, #16
 1337 00dc 0DE0     		b	.L238
 1338              	.L104:
 255:bluetooth_rxtx.c **** 		*data_len = 1;
 1339              		.loc 1 255 0
 1340 00de 624B     		ldr	r3, .L250+4
 1341 00e0 24E0     		b	.L244
 1342              	.L105:
 260:bluetooth_rxtx.c **** 			TXLED_SET;
 1343              		.loc 1 260 0
 1344 00e2 0A88     		ldrh	r2, [r1]
 1345 00e4 4FF48073 		mov	r3, #256
 1346 00e8 07E0     		b	.L238
 1347              	.L106:
 267:bluetooth_rxtx.c **** 		*data_len = 1;
ARM GAS  /tmp/ccCuKxzC.s 			page 69


 1348              		.loc 1 267 0
 1349 00ea 5F4B     		ldr	r3, .L250+4
 1350 00ec 1B68     		ldr	r3, [r3]
 1351 00ee C3F34023 		ubfx	r3, r3, #9, #1
 1352 00f2 03E1     		b	.L220
 1353              	.L107:
 272:bluetooth_rxtx.c **** 			CC1V8_SET;
 1354              		.loc 1 272 0
 1355 00f4 0A88     		ldrh	r2, [r1]
 1356 00f6 4FF40073 		mov	r3, #512
 1357              	.L238:
 1358 00fa 12B9     		cbnz	r2, .L249
 263:bluetooth_rxtx.c **** 		break;
 1359              		.loc 1 263 0
 1360 00fc 5B4A     		ldr	r2, .L250+8
 1361              	.L222:
 1362 00fe 1360     		str	r3, [r2]
 1363 0100 B5E2     		b	.L202
 1364              	.L249:
 273:bluetooth_rxtx.c **** 		else
 1365              		.loc 1 273 0
 1366 0102 5B4A     		ldr	r2, .L250+12
 1367 0104 FBE7     		b	.L222
 1368              	.L112:
 279:bluetooth_rxtx.c **** 		break;
 1369              		.loc 1 279 0
 1370 0106 3046     		mov	r0, r6
 1371              	.LVL126:
 1372 0108 2946     		mov	r1, r5
 1373              	.LVL127:
 1374 010a FFF7FEFF 		bl	get_part_num
 1375              	.LVL128:
 1376 010e AEE2     		b	.L202
 1377              	.LVL129:
 1378              	.L111:
 287:bluetooth_rxtx.c **** 		break;
 1379              		.loc 1 287 0
 1380 0110 3046     		mov	r0, r6
 1381              	.LVL130:
 1382 0112 2946     		mov	r1, r5
 1383              	.LVL131:
 1384 0114 FFF7FEFF 		bl	get_device_serial
 1385              	.LVL132:
 1386 0118 A9E2     		b	.L202
 1387              	.LVL133:
 1388              	.L113:
 292:bluetooth_rxtx.c **** 		*data_len = 1;
 1389              		.loc 1 292 0
 1390 011a 564B     		ldr	r3, .L250+16
 1391 011c 1B68     		ldr	r3, [r3]
 1392 011e C3F3C013 		ubfx	r3, r3, #7, #1
 1393 0122 EBE0     		b	.L220
 1394              	.L114:
 297:bluetooth_rxtx.c **** 			PAEN_SET;
 1395              		.loc 1 297 0
 1396 0124 0A88     		ldrh	r2, [r1]
 1397 0126 8023     		movs	r3, #128
ARM GAS  /tmp/ccCuKxzC.s 			page 70


 1398 0128 07E0     		b	.L240
 1399              	.L115:
 304:bluetooth_rxtx.c **** 		*data_len = 1;
 1400              		.loc 1 304 0
 1401 012a 524B     		ldr	r3, .L250+16
 1402              	.L244:
 1403 012c 1B68     		ldr	r3, [r3]
 1404 012e C3F30023 		ubfx	r3, r3, #8, #1
 1405 0132 E3E0     		b	.L220
 1406              	.L116:
 309:bluetooth_rxtx.c **** 			HGM_SET;
 1407              		.loc 1 309 0
 1408 0134 0A88     		ldrh	r2, [r1]
 1409 0136 4FF48073 		mov	r3, #256
 1410              	.L240:
 1411 013a 0AB1     		cbz	r2, .L173
 310:bluetooth_rxtx.c **** 		else
 1412              		.loc 1 310 0
 1413 013c 4E4A     		ldr	r2, .L250+20
 1414 013e DEE7     		b	.L222
 1415              	.L173:
 312:bluetooth_rxtx.c **** 		break;
 1416              		.loc 1 312 0
 1417 0140 4E4A     		ldr	r2, .L250+24
 1418 0142 DCE7     		b	.L222
 1419              	.L117:
 318:bluetooth_rxtx.c **** 		break;
 1420              		.loc 1 318 0
 1421 0144 0323     		movs	r3, #3
 1422              	.LVL134:
 1423              	.L225:
 1424 0146 A374     		strb	r3, [r4, #18]
 1425 0148 91E2     		b	.L202
 1426              	.LVL135:
 1427              	.L124:
 322:bluetooth_rxtx.c **** 		*data_len = 1;
 1428              		.loc 1 322 0
 1429 014a 0520     		movs	r0, #5
 1430              	.LVL136:
 1431 014c FFF7FEFF 		bl	cc2400_get
 1432              	.LVL137:
 1433 0150 00F00700 		and	r0, r0, #7
 1434 0154 3070     		strb	r0, [r6]
 1435 0156 E9E1     		b	.L216
 1436              	.LVL138:
 1437              	.L125:
 327:bluetooth_rxtx.c **** 			cc2400_set(FREND, 8 | request_params[0]);
 1438              		.loc 1 327 0
 1439 0158 0988     		ldrh	r1, [r1]
 1440              	.LVL139:
 1441 015a 0729     		cmp	r1, #7
 1442 015c 00F28A82 		bhi	.L209
 328:bluetooth_rxtx.c **** 		} else {
 1443              		.loc 1 328 0
 1444 0160 0520     		movs	r0, #5
 1445              	.LVL140:
 1446 0162 41F00801 		orr	r1, r1, #8
ARM GAS  /tmp/ccCuKxzC.s 			page 71


 1447 0166 F5E1     		b	.L230
 1448              	.LVL141:
 1449              	.L127:
 335:bluetooth_rxtx.c **** 		break;
 1450              		.loc 1 335 0
 1451 0168 0523     		movs	r3, #5
 1452 016a ECE7     		b	.L225
 1453              	.L126:
 339:bluetooth_rxtx.c **** 		break;
 1454              		.loc 1 339 0
 1455 016c 0623     		movs	r3, #6
 1456 016e EAE7     		b	.L225
 1457              	.L128:
 344:bluetooth_rxtx.c **** 		data[1] = rr.request_pa;
 1458              		.loc 1 344 0
 1459 0170 434B     		ldr	r3, .L250+28
 1460 0172 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1461 0174 3270     		strb	r2, [r6]
 345:bluetooth_rxtx.c **** 		data[2] = rr.request_num;
 1462              		.loc 1 345 0
 1463 0176 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 1464 0178 7270     		strb	r2, [r6, #1]
 346:bluetooth_rxtx.c **** 		data[3] = rr.reply_pa;
 1465              		.loc 1 346 0
 1466 017a 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 1467 017c B270     		strb	r2, [r6, #2]
 347:bluetooth_rxtx.c **** 		data[4] = rr.reply_num;
 1468              		.loc 1 347 0
 1469 017e DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 1470 0180 F270     		strb	r2, [r6, #3]
 348:bluetooth_rxtx.c **** 		*data_len = 5;
 1471              		.loc 1 348 0
 1472 0182 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 1473 0184 3371     		strb	r3, [r6, #4]
 349:bluetooth_rxtx.c **** 		break;
 1474              		.loc 1 349 0
 1475 0186 0523     		movs	r3, #5
 1476              	.LVL142:
 1477              	.L228:
 1478 0188 2B60     		str	r3, [r5]
 1479 018a 70E2     		b	.L202
 1480              	.LVL143:
 1481              	.L118:
 353:bluetooth_rxtx.c **** 		break;
 1482              		.loc 1 353 0
 1483 018c 0023     		movs	r3, #0
 1484 018e DAE7     		b	.L225
 1485              	.L119:
 357:bluetooth_rxtx.c **** 		*data_len = 1;
 1486              		.loc 1 357 0
 1487 0190 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 1488 0192 B3E0     		b	.L220
 1489              	.L120:
 362:bluetooth_rxtx.c **** 		break;
 1490              		.loc 1 362 0
 1491 0194 0B78     		ldrb	r3, [r1]	@ zero_extendqisi2
 1492 0196 2370     		strb	r3, [r4]
ARM GAS  /tmp/ccCuKxzC.s 			page 72


 1493 0198 69E2     		b	.L202
 1494              	.L108:
 366:bluetooth_rxtx.c **** 		data[1] = (channel >> 8) & 0xFF;
 1495              		.loc 1 366 0
 1496 019a 3A4B     		ldr	r3, .L250+32
 1497 019c 1A88     		ldrh	r2, [r3]
 1498 019e 3270     		strb	r2, [r6]
 367:bluetooth_rxtx.c **** 		*data_len = 2;
 1499              		.loc 1 367 0
 1500 01a0 1B88     		ldrh	r3, [r3]
 1501 01a2 C3F30723 		ubfx	r3, r3, #8, #8
 1502 01a6 A7E1     		b	.L248
 1503              	.L109:
 372:bluetooth_rxtx.c **** 		/* bluetooth band sweep mode, start at channel 2402 */
 1504              		.loc 1 372 0
 1505 01a8 0A88     		ldrh	r2, [r1]
 1506 01aa 2E4B     		ldr	r3, .L250
 1507 01ac E281     		strh	r2, [r4, #14]	@ movhi
 374:bluetooth_rxtx.c **** 			hop_mode = HOP_SWEEP;
 1508              		.loc 1 374 0
 1509 01ae E189     		ldrh	r1, [r4, #14]
 1510              	.LVL144:
 1511 01b0 40F6EA22 		movw	r2, #2794
 1512 01b4 89B2     		uxth	r1, r1
 1513 01b6 9142     		cmp	r1, r2
 1514 01b8 05D9     		bls	.L174
 375:bluetooth_rxtx.c **** 			requested_channel = 2402;
 1515              		.loc 1 375 0
 1516 01ba 0122     		movs	r2, #1
 1517 01bc 9A72     		strb	r2, [r3, #10]
 376:bluetooth_rxtx.c **** 		}
 1518              		.loc 1 376 0
 1519 01be 40F66212 		movw	r2, #2402
 1520 01c2 DA81     		strh	r2, [r3, #14]	@ movhi
 1521 01c4 17E0     		b	.L175
 1522              	.L174:
 380:bluetooth_rxtx.c **** 			requested_channel = MAX(requested_channel, MIN_FREQ);
 1523              		.loc 1 380 0
 1524 01c6 0022     		movs	r2, #0
 1525 01c8 9A72     		strb	r2, [r3, #10]
 381:bluetooth_rxtx.c **** 			requested_channel = MIN(requested_channel, MAX_FREQ);
 1526              		.loc 1 381 0
 1527 01ca D989     		ldrh	r1, [r3, #14]
 1528 01cc 40F6DC02 		movw	r2, #2268
 1529 01d0 89B2     		uxth	r1, r1
 1530 01d2 9142     		cmp	r1, r2
 1531 01d4 8ABF     		itet	hi
 1532 01d6 DB89     		ldrhhi	r3, [r3, #14]
 1533 01d8 1346     		movls	r3, r2
 1534 01da 9BB2     		uxthhi	r3, r3
 1535 01dc E381     		strh	r3, [r4, #14]	@ movhi
 382:bluetooth_rxtx.c **** 		}
 1536              		.loc 1 382 0
 1537 01de E289     		ldrh	r2, [r4, #14]
 1538 01e0 40F6E923 		movw	r3, #2793
 1539 01e4 92B2     		uxth	r2, r2
 1540 01e6 9A42     		cmp	r2, r3
ARM GAS  /tmp/ccCuKxzC.s 			page 73


 1541 01e8 97BF     		itett	ls
 1542 01ea 1E4B     		ldrls	r3, .L250
 1543 01ec 40F6EA23 		movwhi	r3, #2794
 1544 01f0 DB89     		ldrhls	r3, [r3, #14]
 1545 01f2 9BB2     		uxthls	r3, r3
 1546 01f4 E381     		strh	r3, [r4, #14]	@ movhi
 1547              	.L175:
 385:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 1548              		.loc 1 385 0
 1549 01f6 E189     		ldrh	r1, [r4, #14]
 1550 01f8 224B     		ldr	r3, .L250+32
 1551 01fa 89B2     		uxth	r1, r1
 1552 01fc A3F84A10 		strh	r1, [r3, #74]	@ movhi
 386:bluetooth_rxtx.c **** 			channel = requested_channel;
 1553              		.loc 1 386 0
 1554 0200 617C     		ldrb	r1, [r4, #17]	@ zero_extendqisi2
 385:bluetooth_rxtx.c **** 		if (mode != MODE_BT_FOLLOW_LE) {
 1555              		.loc 1 385 0
 1556 0202 184A     		ldr	r2, .L250
 386:bluetooth_rxtx.c **** 			channel = requested_channel;
 1557              		.loc 1 386 0
 1558 0204 0929     		cmp	r1, #9
 1559 0206 00F03282 		beq	.L202
 387:bluetooth_rxtx.c **** 			requested_channel = 0;
 1560              		.loc 1 387 0
 1561 020a D189     		ldrh	r1, [r2, #14]
 1562 020c 89B2     		uxth	r1, r1
 1563 020e 1980     		strh	r1, [r3]	@ movhi
 388:bluetooth_rxtx.c **** 
 1564              		.loc 1 388 0
 1565 0210 0021     		movs	r1, #0
 1566 0212 D181     		strh	r1, [r2, #14]	@ movhi
 1567 0214 08E2     		b	.L232
 1568              	.LVL145:
 1569              	.L121:
 397:bluetooth_rxtx.c **** 		*data_len = 0; /* should never return */
 1570              		.loc 1 397 0
 1571 0216 FFF7FEFF 		bl	set_isp
 1572              	.LVL146:
 1573              	.L226:
 398:bluetooth_rxtx.c **** 		break;
 1574              		.loc 1 398 0
 1575 021a 0023     		movs	r3, #0
 1576 021c B4E7     		b	.L228
 1577              	.LVL147:
 1578              	.L122:
 402:bluetooth_rxtx.c **** 		requested_mode = MODE_RESET;
 1579              		.loc 1 402 0
 1580 021e 1A4A     		ldr	r2, .L250+36
 1581 0220 1A4B     		ldr	r3, .L250+40
 1582 0222 1A60     		str	r2, [r3]
 1583              	.L241:
 403:bluetooth_rxtx.c **** 		break;
 1584              		.loc 1 403 0
 1585 0224 0B23     		movs	r3, #11
 1586 0226 8EE7     		b	.L225
 1587              	.L123:
ARM GAS  /tmp/ccCuKxzC.s 			page 74


 407:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 1588              		.loc 1 407 0
 1589 0228 0A88     		ldrh	r2, [r1]
 1590 022a 6FF4006C 		mvn	ip, #2048
 1591 022e 02EB0C03 		add	r3, r2, ip
 1592 0232 40F2FF31 		movw	r1, #1023
 1593              	.LVL148:
 1594 0236 9BB2     		uxth	r3, r3
 1595 0238 8B42     		cmp	r3, r1
 1596 023a 00F21B82 		bhi	.L209
 408:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1597              		.loc 1 408 0 discriminator 1
 1598 023e 7B88     		ldrh	r3, [r7, #2]
 407:bluetooth_rxtx.c **** 				request_params[1] < 2049 || request_params[1] > 3072 ||
 1599              		.loc 1 407 0 discriminator 1
 1600 0240 6FF40066 		mvn	r6, #2048
 1601              	.LVL149:
 1602 0244 9819     		adds	r0, r3, r6
 1603              	.LVL150:
 1604 0246 80B2     		uxth	r0, r0
 1605 0248 8842     		cmp	r0, r1
 1606 024a 00F21382 		bhi	.L209
 408:bluetooth_rxtx.c **** 				request_params[1] < request_params[0])
 1607              		.loc 1 408 0 discriminator 1
 1608 024e 9342     		cmp	r3, r2
 1609 0250 C0F01082 		bcc	.L209
 411:bluetooth_rxtx.c **** 		high_freq = request_params[1];
 1610              		.loc 1 411 0
 1611 0254 0B49     		ldr	r1, .L250+32
 1612 0256 A1F84C20 		strh	r2, [r1, #76]	@ movhi
 412:bluetooth_rxtx.c **** 		requested_mode = MODE_SPECAN;
 1613              		.loc 1 412 0
 1614 025a A1F84E30 		strh	r3, [r1, #78]	@ movhi
 413:bluetooth_rxtx.c **** 		*data_len = 0;
 1615              		.loc 1 413 0
 1616 025e 0423     		movs	r3, #4
 1617 0260 24E0     		b	.L242
 1618              	.L251:
 1619 0262 00BF     		.align	2
 1620              	.L250:
 1621 0264 00000000 		.word	.LANCHOR0
 1622 0268 34C00920 		.word	537509940
 1623 026c 3CC00920 		.word	537509948
 1624 0270 38C00920 		.word	537509944
 1625 0274 54C00920 		.word	537509972
 1626 0278 58C00920 		.word	537509976
 1627 027c 5CC00920 		.word	537509980
 1628 0280 00000000 		.word	rr
 1629 0284 00000000 		.word	.LANCHOR1
 1630 0288 21BB0543 		.word	1124449057
 1631 028c 00000000 		.word	bootloader_ctrl
 1632              	.LVL151:
 1633              	.L161:
 418:bluetooth_rxtx.c **** 		*data_len = 0;
 1634              		.loc 1 418 0
 1635 0290 0F23     		movs	r3, #15
 1636 0292 0BE0     		b	.L242
ARM GAS  /tmp/ccCuKxzC.s 			page 75


 1637              	.L130:
 423:bluetooth_rxtx.c **** 			return 0;
 1638              		.loc 1 423 0
 1639 0294 0B88     		ldrh	r3, [r1]
 1640 0296 B3F5807F 		cmp	r3, #256
 1641 029a 00F2EB81 		bhi	.L209
 425:bluetooth_rxtx.c **** 		requested_mode = MODE_LED_SPECAN;
 1642              		.loc 1 425 0
 1643 029e C3F13603 		rsb	r3, r3, #54
 1644 02a2 AE4A     		ldr	r2, .L252
 1645 02a4 DBB2     		uxtb	r3, r3
 1646 02a6 82F85030 		strb	r3, [r2, #80]
 426:bluetooth_rxtx.c **** 		*data_len = 0;
 1647              		.loc 1 426 0
 1648 02aa 0723     		movs	r3, #7
 1649              	.LVL152:
 1650              	.L242:
 1651 02ac A374     		strb	r3, [r4, #18]
 1652 02ae B4E7     		b	.L226
 1653              	.LVL153:
 1654              	.L129:
 431:bluetooth_rxtx.c **** 		data[1] = 0x00;
 1655              		.loc 1 431 0
 1656 02b0 0023     		movs	r3, #0
 1657 02b2 3370     		strb	r3, [r6]
 432:bluetooth_rxtx.c **** 
 1658              		.loc 1 432 0
 1659 02b4 7370     		strb	r3, [r6, #1]
 434:bluetooth_rxtx.c **** 		data[2] = length;
 1660              		.loc 1 434 0
 1661 02b6 AA48     		ldr	r0, .L252+4
 1662              	.LVL154:
 1663 02b8 FFF7FEFF 		bl	strlen
 1664              	.LVL155:
 1665 02bc C4B2     		uxtb	r4, r0
 1666              	.LVL156:
 435:bluetooth_rxtx.c **** 
 1667              		.loc 1 435 0
 1668 02be B470     		strb	r4, [r6, #2]
 437:bluetooth_rxtx.c **** 
 1669              		.loc 1 437 0
 1670 02c0 2246     		mov	r2, r4
 1671 02c2 F01C     		adds	r0, r6, #3
 1672 02c4 A649     		ldr	r1, .L252+4
 1673 02c6 FFF7FEFF 		bl	memcpy
 1674              	.LVL157:
 439:bluetooth_rxtx.c **** 		break;
 1675              		.loc 1 439 0
 1676 02ca 0334     		adds	r4, r4, #3
 1677              	.LVL158:
 1678 02cc 0BE0     		b	.L231
 1679              	.LVL159:
 1680              	.L151:
 443:bluetooth_rxtx.c **** 		data[0] = length;
 1681              		.loc 1 443 0
 1682 02ce A548     		ldr	r0, .L252+8
 1683              	.LVL160:
ARM GAS  /tmp/ccCuKxzC.s 			page 76


 1684 02d0 FFF7FEFF 		bl	strlen
 1685              	.LVL161:
 1686 02d4 C4B2     		uxtb	r4, r0
 1687              	.LVL162:
 444:bluetooth_rxtx.c **** 		memcpy(&data[1], compile_info, length);
 1688              		.loc 1 444 0
 1689 02d6 3046     		mov	r0, r6
 1690 02d8 00F8014B 		strb	r4, [r0], #1
 445:bluetooth_rxtx.c **** 		*data_len = 1 + length;
 1691              		.loc 1 445 0
 1692 02dc 2246     		mov	r2, r4
 1693 02de A149     		ldr	r1, .L252+8
 1694 02e0 FFF7FEFF 		bl	memcpy
 1695              	.LVL163:
 446:bluetooth_rxtx.c **** 		break;
 1696              		.loc 1 446 0
 1697 02e4 0134     		adds	r4, r4, #1
 1698              	.LVL164:
 1699              	.L231:
 1700 02e6 2C60     		str	r4, [r5]
 1701 02e8 C1E1     		b	.L202
 1702              	.LVL165:
 1703              	.L131:
 450:bluetooth_rxtx.c **** 		*data_len = 1;
 1704              		.loc 1 450 0
 1705 02ea 0120     		movs	r0, #1
 1706              	.LVL166:
 1707 02ec 3070     		strb	r0, [r6]
 1708 02ee 1EE1     		b	.L217
 1709              	.LVL167:
 1710              	.L132:
 455:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1711              		.loc 1 455 0
 1712 02f0 0A88     		ldrh	r2, [r1]
 1713 02f2 9D4B     		ldr	r3, .L252+12
 1714 02f4 1A70     		strb	r2, [r3]
 1715 02f6 96E1     		b	.L229
 1716              	.L133:
 460:bluetooth_rxtx.c **** 		*data_len = 1;
 1717              		.loc 1 460 0
 1718 02f8 9B4B     		ldr	r3, .L252+12
 1719 02fa 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1720              	.L220:
 1721 02fc 3370     		strb	r3, [r6]
 1722 02fe 15E1     		b	.L216
 1723              	.L134:
 465:bluetooth_rxtx.c **** 		target.syncword = 0;
 1724              		.loc 1 465 0
 1725 0300 9A4F     		ldr	r7, .L252+16
 1726 0302 0024     		movs	r4, #0
 1727 0304 0025     		movs	r5, #0
 1728              	.LVL168:
 1729 0306 C7E90045 		strd	r4, [r7]
 466:bluetooth_rxtx.c **** 		for(int i=0; i < 8; i++) {
 1730              		.loc 1 466 0
 1731 030a C7E90245 		strd	r4, [r7, #8]
 1732              	.LVL169:
ARM GAS  /tmp/ccCuKxzC.s 			page 77


 1733              	.LBB14:
 467:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1734              		.loc 1 467 0
 1735 030e 4FF00008 		mov	r8, #0
 1736              	.LVL170:
 1737              	.L180:
 468:bluetooth_rxtx.c **** 		}
 1738              		.loc 1 468 0 discriminator 2
 1739 0312 16F80800 		ldrb	r0, [r6, r8]	@ zero_extendqisi2
 1740 0316 4FEAC802 		lsl	r2, r8, #3
 1741 031a 0021     		movs	r1, #0
 1742 031c FFF7FEFF 		bl	__aeabi_llsl
 1743              	.LVL171:
 1744 0320 D7E90045 		ldrd	r4, [r7]
 467:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1745              		.loc 1 467 0 discriminator 2
 1746 0324 08F10108 		add	r8, r8, #1
 1747              	.LVL172:
 468:bluetooth_rxtx.c **** 		}
 1748              		.loc 1 468 0 discriminator 2
 1749 0328 2043     		orrs	r0, r0, r4
 1750 032a 2943     		orrs	r1, r1, r5
 467:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1751              		.loc 1 467 0 discriminator 2
 1752 032c B8F1080F 		cmp	r8, #8
 468:bluetooth_rxtx.c **** 		}
 1753              		.loc 1 468 0 discriminator 2
 1754 0330 C7E90001 		strd	r0, [r7]
 467:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1755              		.loc 1 467 0 discriminator 2
 1756 0334 EDD1     		bne	.L180
 467:bluetooth_rxtx.c **** 			target.address |= (uint64_t)data[i] << 8*i;
 1757              		.loc 1 467 0 is_stmt 0
 1758 0336 4FF00008 		mov	r8, #0
 1759              	.LVL173:
 1760              	.L182:
 1761 033a 06EB0803 		add	r3, r6, r8
 1762              	.LBE14:
 1763              	.LBB15:
 471:bluetooth_rxtx.c **** 		}
 1764              		.loc 1 471 0 is_stmt 1 discriminator 2
 1765 033e 187A     		ldrb	r0, [r3, #8]	@ zero_extendqisi2
 1766 0340 4FEAC802 		lsl	r2, r8, #3
 1767 0344 0021     		movs	r1, #0
 1768 0346 FFF7FEFF 		bl	__aeabi_llsl
 1769              	.LVL174:
 1770 034a D7E90245 		ldrd	r4, [r7, #8]
 470:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1771              		.loc 1 470 0 discriminator 2
 1772 034e 08F10108 		add	r8, r8, #1
 1773              	.LVL175:
 471:bluetooth_rxtx.c **** 		}
 1774              		.loc 1 471 0 discriminator 2
 1775 0352 2043     		orrs	r0, r0, r4
 1776 0354 2943     		orrs	r1, r1, r5
 470:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1777              		.loc 1 470 0 discriminator 2
ARM GAS  /tmp/ccCuKxzC.s 			page 78


 1778 0356 B8F1080F 		cmp	r8, #8
 471:bluetooth_rxtx.c **** 		}
 1779              		.loc 1 471 0 discriminator 2
 1780 035a C7E90201 		strd	r0, [r7, #8]
 470:bluetooth_rxtx.c **** 			target.syncword |= (uint64_t)data[i+8] << 8*i;
 1781              		.loc 1 470 0 discriminator 2
 1782 035e ECD1     		bne	.L182
 1783              	.LBE15:
 473:bluetooth_rxtx.c **** 		break;
 1784              		.loc 1 473 0
 1785 0360 FFF7FEFF 		bl	precalc
 1786              	.LVL176:
 1787 0364 83E1     		b	.L202
 1788              	.LVL177:
 1789              	.L135:
 477:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 1790              		.loc 1 477 0
 1791 0366 824A     		ldr	r2, .L252+20
 1792 0368 0023     		movs	r3, #0
 1793 036a 1360     		str	r3, [r2]
 1794              	.LVL178:
 1795              	.L184:
 1796              	.LBB16:
 479:bluetooth_rxtx.c **** 			clkn_offset |= data[i];
 1797              		.loc 1 479 0 discriminator 2
 1798 036c 1168     		ldr	r1, [r2]
 1799 036e 0902     		lsls	r1, r1, #8
 1800 0370 1160     		str	r1, [r2]
 480:bluetooth_rxtx.c **** 		}
 1801              		.loc 1 480 0 discriminator 2
 1802 0372 F05C     		ldrb	r0, [r6, r3]	@ zero_extendqisi2
 1803 0374 1168     		ldr	r1, [r2]
 478:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1804              		.loc 1 478 0 discriminator 2
 1805 0376 0133     		adds	r3, r3, #1
 1806              	.LVL179:
 480:bluetooth_rxtx.c **** 		}
 1807              		.loc 1 480 0 discriminator 2
 1808 0378 0143     		orrs	r1, r1, r0
 478:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1809              		.loc 1 478 0 discriminator 2
 1810 037a 042B     		cmp	r3, #4
 480:bluetooth_rxtx.c **** 		}
 1811              		.loc 1 480 0 discriminator 2
 1812 037c 1160     		str	r1, [r2]
 478:bluetooth_rxtx.c **** 			clkn_offset <<= 8;
 1813              		.loc 1 478 0 discriminator 2
 1814 037e F5D1     		bne	.L184
 1815              	.LBE16:
 482:bluetooth_rxtx.c **** 		dma_discard = 1;
 1816              		.loc 1 482 0
 1817 0380 0223     		movs	r3, #2
 1818              	.LVL180:
 1819 0382 A372     		strb	r3, [r4, #10]
 484:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1820              		.loc 1 484 0
 1821 0384 7B4B     		ldr	r3, .L252+24
ARM GAS  /tmp/ccCuKxzC.s 			page 79


 483:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1822              		.loc 1 483 0
 1823 0386 0120     		movs	r0, #1
 484:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1824              		.loc 1 484 0
 1825 0388 4FF08052 		mov	r2, #268435456
 483:bluetooth_rxtx.c **** 		DIO_SSEL_SET;
 1826              		.loc 1 483 0
 1827 038c 2074     		strb	r0, [r4, #16]
 484:bluetooth_rxtx.c **** 		clk100ns_offset = (data[4] << 8) | (data[5] << 0);
 1828              		.loc 1 484 0
 1829 038e 1A60     		str	r2, [r3]
 485:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW;
 1830              		.loc 1 485 0
 1831 0390 7379     		ldrb	r3, [r6, #5]	@ zero_extendqisi2
 1832 0392 3279     		ldrb	r2, [r6, #4]	@ zero_extendqisi2
 1833 0394 43EA0222 		orr	r2, r3, r2, lsl #8
 1834 0398 774B     		ldr	r3, .L252+28
 1835 039a 1A80     		strh	r2, [r3]	@ movhi
 486:bluetooth_rxtx.c **** 		break;
 1836              		.loc 1 486 0
 1837 039c 0823     		movs	r3, #8
 1838 039e A374     		strb	r3, [r4, #18]
 487:bluetooth_rxtx.c **** 
 1839              		.loc 1 487 0
 1840 03a0 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1841              	.LVL181:
 1842              	.L156:
 490:bluetooth_rxtx.c **** 		requested_mode = MODE_AFH;
 1843              		.loc 1 490 0
 1844 03a4 0523     		movs	r3, #5
 1845 03a6 A372     		strb	r3, [r4, #10]
 491:bluetooth_rxtx.c **** 
 1846              		.loc 1 491 0
 1847 03a8 0E23     		movs	r3, #14
 1848 03aa A374     		strb	r3, [r4, #18]
 1849              	.LVL182:
 1850              	.LBB17:
 493:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1851              		.loc 1 493 0
 1852 03ac 0023     		movs	r3, #0
 1853              	.LVL183:
 1854              	.L186:
 494:bluetooth_rxtx.c **** 		}
 1855              		.loc 1 494 0 discriminator 2
 1856 03ae 7349     		ldr	r1, .L252+32
 1857 03b0 0022     		movs	r2, #0
 1858 03b2 5A54     		strb	r2, [r3, r1]
 493:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1859              		.loc 1 493 0 discriminator 2
 1860 03b4 0133     		adds	r3, r3, #1
 1861              	.LVL184:
 1862 03b6 0A2B     		cmp	r3, #10
 1863 03b8 F9D1     		bne	.L186
 1864              	.LBE17:
 496:bluetooth_rxtx.c **** 		afh_enabled = 1;
 1865              		.loc 1 496 0
ARM GAS  /tmp/ccCuKxzC.s 			page 80


 1866 03ba 714B     		ldr	r3, .L252+36
 1867              	.LVL185:
 497:bluetooth_rxtx.c **** 		break;
 1868              		.loc 1 497 0
 1869 03bc 0120     		movs	r0, #1
 1870              	.LVL186:
 496:bluetooth_rxtx.c **** 		afh_enabled = 1;
 1871              		.loc 1 496 0
 1872 03be 1A70     		strb	r2, [r3]
 497:bluetooth_rxtx.c **** 		break;
 1873              		.loc 1 497 0
 1874 03c0 704B     		ldr	r3, .L252+40
 1875 03c2 1870     		strb	r0, [r3]
 498:bluetooth_rxtx.c **** 
 1876              		.loc 1 498 0
 1877 03c4 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1878              	.LVL187:
 1879              	.L157:
 501:bluetooth_rxtx.c **** 		break;
 1880              		.loc 1 501 0
 1881 03c8 0120     		movs	r0, #1
 1882              	.LVL188:
 1883 03ca E072     		strb	r0, [r4, #11]
 502:bluetooth_rxtx.c **** 
 1884              		.loc 1 502 0
 1885 03cc BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1886              	.LVL189:
 1887              	.L136:
 505:bluetooth_rxtx.c **** 		clkn = clock;
 1888              		.loc 1 505 0
 1889 03d0 B278     		ldrb	r2, [r6, #2]	@ zero_extendqisi2
 1890 03d2 7378     		ldrb	r3, [r6, #1]	@ zero_extendqisi2
 1891 03d4 1204     		lsls	r2, r2, #16
 1892 03d6 42EA0322 		orr	r2, r2, r3, lsl #8
 1893 03da 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 1894 03dc 1A43     		orrs	r2, r2, r3
 1895 03de F378     		ldrb	r3, [r6, #3]	@ zero_extendqisi2
 1896 03e0 42EA0362 		orr	r2, r2, r3, lsl #24
 1897              	.LVL190:
 506:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 1898              		.loc 1 506 0
 1899 03e4 684B     		ldr	r3, .L252+44
 1900 03e6 1A60     		str	r2, [r3]
 1901 03e8 1DE1     		b	.L229
 1902              	.LVL191:
 1903              	.L147:
 213:bluetooth_rxtx.c **** 
 1904              		.loc 1 213 0
 1905 03ea 0023     		movs	r3, #0
 1906              	.LVL192:
 1907              	.L188:
 1908              	.LBB18:
 512:bluetooth_rxtx.c **** 		}
 1909              		.loc 1 512 0 discriminator 2
 1910 03ec F15C     		ldrb	r1, [r6, r3]	@ zero_extendqisi2
 1911 03ee 634A     		ldr	r2, .L252+32
 1912 03f0 9954     		strb	r1, [r3, r2]
ARM GAS  /tmp/ccCuKxzC.s 			page 81


 511:bluetooth_rxtx.c **** 			afh_map[i] = data[i];
 1913              		.loc 1 511 0 discriminator 2
 1914 03f2 0133     		adds	r3, r3, #1
 1915              	.LVL193:
 1916 03f4 0A2B     		cmp	r3, #10
 1917 03f6 F9D1     		bne	.L188
 1918              	.LBE18:
 514:bluetooth_rxtx.c **** 		*data_len = 10;
 1919              		.loc 1 514 0
 1920 03f8 624A     		ldr	r2, .L252+40
 1921 03fa 0120     		movs	r0, #1
 1922              	.LVL194:
 1923 03fc 1070     		strb	r0, [r2]
 1924              	.LVL195:
 1925              	.L219:
 515:bluetooth_rxtx.c **** 		break;
 1926              		.loc 1 515 0
 1927 03fe 2B60     		str	r3, [r5]
 516:bluetooth_rxtx.c **** 
 1928              		.loc 1 516 0
 1929 0400 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1930              	.LVL196:
 1931              	.L148:
 213:bluetooth_rxtx.c **** 
 1932              		.loc 1 213 0
 1933 0404 0023     		movs	r3, #0
 1934              	.LVL197:
 1935              	.L190:
 1936              	.LBB19:
 520:bluetooth_rxtx.c **** 		}
 1937              		.loc 1 520 0 discriminator 2
 1938 0406 5D49     		ldr	r1, .L252+32
 1939 0408 0022     		movs	r2, #0
 1940 040a 5A54     		strb	r2, [r3, r1]
 519:bluetooth_rxtx.c **** 			afh_map[i] = 0;
 1941              		.loc 1 519 0 discriminator 2
 1942 040c 0133     		adds	r3, r3, #1
 1943              	.LVL198:
 1944 040e 0A2B     		cmp	r3, #10
 1945 0410 F9D1     		bne	.L190
 1946              	.LBE19:
 522:bluetooth_rxtx.c **** 		*data_len = 10;
 1947              		.loc 1 522 0
 1948 0412 5C49     		ldr	r1, .L252+40
 1949 0414 0A70     		strb	r2, [r1]
 1950 0416 B7E6     		b	.L228
 1951              	.LVL199:
 1952              	.L137:
 527:bluetooth_rxtx.c **** 		for(int i=0; i < 4; i++) {
 1953              		.loc 1 527 0
 1954 0418 5B4B     		ldr	r3, .L252+44
 1955 041a 1968     		ldr	r1, [r3]
 1956              	.LVL200:
 1957              	.LBB20:
 528:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1958              		.loc 1 528 0
 1959 041c 0023     		movs	r3, #0
ARM GAS  /tmp/ccCuKxzC.s 			page 82


 1960              	.LVL201:
 1961              	.L192:
 1962 041e DA00     		lsls	r2, r3, #3
 529:bluetooth_rxtx.c **** 		}
 1963              		.loc 1 529 0 discriminator 2
 1964 0420 21FA02F2 		lsr	r2, r1, r2
 1965 0424 F254     		strb	r2, [r6, r3]
 528:bluetooth_rxtx.c **** 			data[i] = (clock >> (8*i)) & 0xff;
 1966              		.loc 1 528 0 discriminator 2
 1967 0426 0133     		adds	r3, r3, #1
 1968              	.LVL202:
 1969 0428 042B     		cmp	r3, #4
 1970 042a F8D1     		bne	.L192
 1971 042c ACE6     		b	.L228
 1972              	.LVL203:
 1973              	.L158:
 1974              	.LBE20:
 535:bluetooth_rxtx.c **** 		break;
 1975              		.loc 1 535 0
 1976 042e 7378     		ldrb	r3, [r6, #1]	@ zero_extendqisi2
 1977 0430 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 1978 0432 43EA0222 		orr	r2, r3, r2, lsl #8
 1979 0436 504B     		ldr	r3, .L252+28
 1980 0438 1A80     		strh	r2, [r3]	@ movhi
 1981 043a 18E1     		b	.L202
 1982              	.L163:
 539:bluetooth_rxtx.c **** 
 1983              		.loc 1 539 0
 1984 043c 534B     		ldr	r3, .L252+48
 1985 043e 3078     		ldrb	r0, [r6]	@ zero_extendqisi2
 1986              	.LVL204:
 1987 0440 1988     		ldrh	r1, [r3]
 1988              	.LVL205:
 1989 0442 7278     		ldrb	r2, [r6, #1]	@ zero_extendqisi2
 1990 0444 89B2     		uxth	r1, r1
 1991 0446 42EA0022 		orr	r2, r2, r0, lsl #8
 1992 044a 0A44     		add	r2, r2, r1
 1993 044c 92B2     		uxth	r2, r2
 1994 044e 1A80     		strh	r2, [r3]	@ movhi
 542:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / (uint16_t)(-clk_drift_ppm);
 1995              		.loc 1 542 0
 1996 0450 1A88     		ldrh	r2, [r3]
 1997 0452 4F49     		ldr	r1, .L252+52
 1998 0454 12B2     		sxth	r2, r2
 1999 0456 002A     		cmp	r2, #0
 2000 0458 4E4A     		ldr	r2, .L252+56
 2001 045a 07DA     		bge	.L193
 543:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2002              		.loc 1 543 0
 2003 045c 1B88     		ldrh	r3, [r3]
 2004 045e 4FF4A070 		mov	r0, #320
 2005 0462 5B42     		negs	r3, r3
 2006 0464 9BB2     		uxth	r3, r3
 2007 0466 90FBF3F3 		sdiv	r3, r0, r3
 2008 046a 0AE0     		b	.L245
 2009              	.L193:
 547:bluetooth_rxtx.c **** 			clk_drift_correction = 320 / clk_drift_ppm;
ARM GAS  /tmp/ccCuKxzC.s 			page 83


 2010              		.loc 1 547 0
 2011 046c 1888     		ldrh	r0, [r3]
 2012 046e 00B2     		sxth	r0, r0
 2013 0470 0028     		cmp	r0, #0
 2014 0472 0DDD     		ble	.L194
 548:bluetooth_rxtx.c **** 			clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2015              		.loc 1 548 0
 2016 0474 1B88     		ldrh	r3, [r3]
 2017 0476 4FF4A070 		mov	r0, #320
 2018 047a 1BB2     		sxth	r3, r3
 2019 047c 90FBF3F3 		sdiv	r3, r0, r3
 2020 0480 9BB2     		uxth	r3, r3
 2021              	.L245:
 2022 0482 1380     		strh	r3, [r2]	@ movhi
 549:bluetooth_rxtx.c **** 		}
 2023              		.loc 1 549 0
 2024 0484 444B     		ldr	r3, .L252+60
 2025 0486 1868     		ldr	r0, [r3]
 2026 0488 1388     		ldrh	r3, [r2]
 2027 048a 9BB2     		uxth	r3, r3
 2028 048c 0344     		add	r3, r3, r0
 2029 048e 01E0     		b	.L223
 2030              	.L194:
 553:bluetooth_rxtx.c **** 			clkn_next_drift_fix = 0;
 2031              		.loc 1 553 0
 2032 0490 0023     		movs	r3, #0
 2033 0492 1380     		strh	r3, [r2]	@ movhi
 2034              	.L223:
 554:bluetooth_rxtx.c **** 		}
 2035              		.loc 1 554 0
 2036 0494 0B60     		str	r3, [r1]
 2037 0496 EAE0     		b	.L202
 2038              	.LVL206:
 2039              	.L138:
 560:bluetooth_rxtx.c **** 
 2040              		.loc 1 560 0
 2041 0498 0023     		movs	r3, #0
 2042 049a 2B60     		str	r3, [r5]
 562:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 2043              		.loc 1 562 0
 2044 049c E372     		strb	r3, [r4, #11]
 563:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_FOLLOW_LE;
 2045              		.loc 1 563 0
 2046 049e 0323     		movs	r3, #3
 2047 04a0 A372     		strb	r3, [r4, #10]
 564:bluetooth_rxtx.c **** 
 2048              		.loc 1 564 0
 2049 04a2 0923     		movs	r3, #9
 2050 04a4 4AE0     		b	.L246
 2051              	.L164:
 572:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 2052              		.loc 1 572 0
 2053 04a6 0023     		movs	r3, #0
 2054 04a8 E372     		strb	r3, [r4, #11]
 573:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_CFO_LE;
 2055              		.loc 1 573 0
 2056 04aa 0323     		movs	r3, #3
ARM GAS  /tmp/ccCuKxzC.s 			page 84


 2057 04ac A372     		strb	r3, [r4, #10]
 574:bluetooth_rxtx.c **** 
 2058              		.loc 1 574 0
 2059 04ae 1123     		movs	r3, #17
 2060 04b0 44E0     		b	.L246
 2061              	.L165:
 581:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 2062              		.loc 1 581 0
 2063 04b2 0023     		movs	r3, #0
 2064 04b4 E372     		strb	r3, [r4, #11]
 582:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_RSSI_LE;
 2065              		.loc 1 582 0
 2066 04b6 0323     		movs	r3, #3
 2067 04b8 A372     		strb	r3, [r4, #10]
 583:bluetooth_rxtx.c **** 
 2068              		.loc 1 583 0
 2069 04ba 1223     		movs	r3, #18
 2070 04bc 3EE0     		b	.L246
 2071              	.L139:
 213:bluetooth_rxtx.c **** 
 2072              		.loc 1 213 0
 2073 04be 0023     		movs	r3, #0
 2074              	.LVL207:
 2075              	.L196:
 2076              	.LBB21:
 591:bluetooth_rxtx.c **** 		}
 2077              		.loc 1 591 0 discriminator 2
 2078 04c0 2649     		ldr	r1, .L252
 2079 04c2 DA00     		lsls	r2, r3, #3
 2080 04c4 4968     		ldr	r1, [r1, #4]
 2081 04c6 21FA02F2 		lsr	r2, r1, r2
 2082 04ca F254     		strb	r2, [r6, r3]
 590:bluetooth_rxtx.c **** 			data[i] = (le.access_address >> (8*i)) & 0xff;
 2083              		.loc 1 590 0 discriminator 2
 2084 04cc 0133     		adds	r3, r3, #1
 2085              	.LVL208:
 2086 04ce 042B     		cmp	r3, #4
 2087 04d0 F6D1     		bne	.L196
 2088 04d2 59E6     		b	.L228
 2089              	.LVL209:
 2090              	.L140:
 2091              	.LBE21:
 597:bluetooth_rxtx.c **** 		le.target_set = 1;
 2092              		.loc 1 597 0
 2093 04d4 B378     		ldrb	r3, [r6, #2]	@ zero_extendqisi2
 2094 04d6 7278     		ldrb	r2, [r6, #1]	@ zero_extendqisi2
 2095 04d8 1B04     		lsls	r3, r3, #16
 2096 04da 43EA0223 		orr	r3, r3, r2, lsl #8
 2097 04de 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 2098 04e0 F078     		ldrb	r0, [r6, #3]	@ zero_extendqisi2
 2099              	.LVL210:
 2100 04e2 1343     		orrs	r3, r3, r2
 2101 04e4 43EA0060 		orr	r0, r3, r0, lsl #24
 2102 04e8 FFF7FEFF 		bl	le_set_access_address
 2103              	.LVL211:
 598:bluetooth_rxtx.c **** 		break;
 2104              		.loc 1 598 0
ARM GAS  /tmp/ccCuKxzC.s 			page 85


 2105 04ec 0120     		movs	r0, #1
 2106 04ee 1B4B     		ldr	r3, .L252
 2107 04f0 B3E0     		b	.L218
 2108              	.LVL212:
 2109              	.L142:
 608:bluetooth_rxtx.c **** 		data[1] = 0x37;
 2110              		.loc 1 608 0
 2111 04f2 1323     		movs	r3, #19
 2112 04f4 3370     		strb	r3, [r6]
 609:bluetooth_rxtx.c **** 		*data_len = 2;
 2113              		.loc 1 609 0
 2114 04f6 3723     		movs	r3, #55
 2115              	.L248:
 2116 04f8 7370     		strb	r3, [r6, #1]
 2117 04fa 27E0     		b	.L243
 2118              	.L143:
 614:bluetooth_rxtx.c **** 		*data_len = 1;
 2119              		.loc 1 614 0
 2120 04fc 174B     		ldr	r3, .L252
 2121 04fe 5B69     		ldr	r3, [r3, #20]
 2122 0500 0033     		adds	r3, r3, #0
 2123 0502 18BF     		it	ne
 2124 0504 0123     		movne	r3, #1
 2125 0506 F9E6     		b	.L220
 2126              	.L144:
 619:bluetooth_rxtx.c **** 		break;
 2127              		.loc 1 619 0
 2128 0508 0A88     		ldrh	r2, [r1]
 2129 050a 144B     		ldr	r3, .L252
 2130 050c 0032     		adds	r2, r2, #0
 2131 050e 18BF     		it	ne
 2132 0510 0122     		movne	r2, #1
 2133 0512 5A61     		str	r2, [r3, #20]
 2134 0514 ABE0     		b	.L202
 2135              	.L145:
 623:bluetooth_rxtx.c **** 		if (p != NULL) {
 2136              		.loc 1 623 0
 2137 0516 FFF7FEFF 		bl	dequeue
 2138              	.LVL213:
 624:bluetooth_rxtx.c **** 			memcpy(data, (void *)p, sizeof(usb_pkt_rx));
 2139              		.loc 1 624 0
 2140 051a 0146     		mov	r1, r0
 2141 051c 28B1     		cbz	r0, .L197
 625:bluetooth_rxtx.c **** 			*data_len = sizeof(usb_pkt_rx);
 2142              		.loc 1 625 0
 2143 051e 3046     		mov	r0, r6
 2144              	.LVL214:
 2145 0520 4022     		movs	r2, #64
 2146 0522 FFF7FEFF 		bl	memcpy
 2147              	.LVL215:
 626:bluetooth_rxtx.c **** 		} else {
 2148              		.loc 1 626 0
 2149 0526 4023     		movs	r3, #64
 2150 0528 2EE6     		b	.L228
 2151              	.LVL216:
 2152              	.L197:
 628:bluetooth_rxtx.c **** 			*data_len = 1;
ARM GAS  /tmp/ccCuKxzC.s 			page 86


 2153              		.loc 1 628 0
 2154 052a 3070     		strb	r0, [r6]
 2155              	.LVL217:
 2156              	.L216:
 629:bluetooth_rxtx.c **** 		}
 2157              		.loc 1 629 0
 2158 052c 0120     		movs	r0, #1
 2159              	.L217:
 2160 052e 2860     		str	r0, [r5]
 2161 0530 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2162              	.LVL218:
 2163              	.L146:
 634:bluetooth_rxtx.c **** 
 2164              		.loc 1 634 0
 2165 0534 0023     		movs	r3, #0
 2166 0536 2B60     		str	r3, [r5]
 636:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_PROMISC_LE;
 2167              		.loc 1 636 0
 2168 0538 A372     		strb	r3, [r4, #10]
 637:bluetooth_rxtx.c **** 
 2169              		.loc 1 637 0
 2170 053a 0A23     		movs	r3, #10
 2171              	.L246:
 2172 053c A374     		strb	r3, [r4, #18]
 2173 053e 70E0     		b	.L227
 2174              	.L149:
 644:bluetooth_rxtx.c **** 		data[0] = (reg_val >> 8) & 0xff;
 2175              		.loc 1 644 0
 2176 0540 0878     		ldrb	r0, [r1]	@ zero_extendqisi2
 2177              	.LVL219:
 2178 0542 FFF7FEFF 		bl	cc2400_get
 2179              	.LVL220:
 645:bluetooth_rxtx.c **** 		data[1] = reg_val & 0xff;
 2180              		.loc 1 645 0
 2181 0546 030A     		lsrs	r3, r0, #8
 2182 0548 3370     		strb	r3, [r6]
 646:bluetooth_rxtx.c **** 		*data_len = 2;
 2183              		.loc 1 646 0
 2184 054a 7070     		strb	r0, [r6, #1]
 2185              	.LVL221:
 2186              	.L243:
 647:bluetooth_rxtx.c **** 		break;
 2187              		.loc 1 647 0
 2188 054c 0223     		movs	r3, #2
 2189 054e 1BE6     		b	.L228
 2190              	.LVL222:
 2191              	.L153:
 651:bluetooth_rxtx.c **** 		break;
 2192              		.loc 1 651 0
 2193 0550 0878     		ldrb	r0, [r1]	@ zero_extendqisi2
 2194              	.LVL223:
 2195 0552 4988     		ldrh	r1, [r1, #2]
 2196              	.LVL224:
 2197              	.L230:
 2198 0554 FFF7FEFF 		bl	cc2400_set
 2199              	.LVL225:
 2200 0558 89E0     		b	.L202
ARM GAS  /tmp/ccCuKxzC.s 			page 87


 2201              	.L253:
 2202 055a 00BF     		.align	2
 2203              	.L252:
 2204 055c 00000000 		.word	.LANCHOR1
 2205 0560 00000000 		.word	.LC5
 2206 0564 A7000000 		.word	.LANCHOR2+167
 2207 0568 00000000 		.word	cs_threshold_req
 2208 056c 00000000 		.word	target
 2209 0570 00000000 		.word	clkn_offset
 2210 0574 98C00920 		.word	537510040
 2211 0578 00000000 		.word	clk100ns_offset
 2212 057c 00000000 		.word	afh_map
 2213 0580 00000000 		.word	used_channels
 2214 0584 00000000 		.word	afh_enabled
 2215 0588 00000000 		.word	clkn
 2216 058c 00000000 		.word	clk_drift_ppm
 2217 0590 00000000 		.word	clkn_next_drift_fix
 2218 0594 00000000 		.word	clk_drift_correction
 2219 0598 00000000 		.word	clkn_last_drift_fix
 2220              	.L167:
 2221              	.LVL226:
 655:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2222              		.loc 1 655 0 discriminator 1
 2223 059c 3B88     		ldrh	r3, [r7]
 2224 059e A342     		cmp	r3, r4
 2225 05a0 65D9     		bls	.L202
 656:bluetooth_rxtx.c **** 			cc2400_set(data[i*3], reg_val);
 2226              		.loc 1 656 0 discriminator 2
 2227 05a2 0323     		movs	r3, #3
 2228 05a4 6343     		muls	r3, r4, r3
 2229              	.LVL227:
 2230 05a6 F218     		adds	r2, r6, r3
 2231              	.LVL228:
 2232 05a8 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
 2233 05aa 9278     		ldrb	r2, [r2, #2]	@ zero_extendqisi2
 2234              	.LVL229:
 657:bluetooth_rxtx.c **** 		}
 2235              		.loc 1 657 0 discriminator 2
 2236 05ac F05C     		ldrb	r0, [r6, r3]	@ zero_extendqisi2
 2237 05ae 42EA0121 		orr	r1, r2, r1, lsl #8
 655:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2238              		.loc 1 655 0 discriminator 2
 2239 05b2 0134     		adds	r4, r4, #1
 2240              	.LVL230:
 657:bluetooth_rxtx.c **** 		}
 2241              		.loc 1 657 0 discriminator 2
 2242 05b4 FFF7FEFF 		bl	cc2400_set
 2243              	.LVL231:
 655:bluetooth_rxtx.c **** 			reg_val = (data[(i*3)+1] << 8) | data[(i*3)+2];
 2244              		.loc 1 655 0 discriminator 2
 2245 05b8 E4B2     		uxtb	r4, r4
 2246              	.LVL232:
 2247 05ba EFE7     		b	.L167
 2248              	.LVL233:
 2249              	.L160:
 213:bluetooth_rxtx.c **** 
 2250              		.loc 1 213 0
ARM GAS  /tmp/ccCuKxzC.s 			page 88


 2251 05bc 0024     		movs	r4, #0
 2252              	.LVL234:
 2253              	.L201:
 664:bluetooth_rxtx.c **** 			data[i*3] = i;
 2254              		.loc 1 664 0 discriminator 2
 2255 05be 2046     		mov	r0, r4
 2256 05c0 FFF7FEFF 		bl	cc2400_get
 2257              	.LVL235:
 665:bluetooth_rxtx.c **** 			data[(i*3)+1] = (reg_val >> 8) & 0xff;
 2258              		.loc 1 665 0 discriminator 2
 2259 05c4 3470     		strb	r4, [r6]
 663:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2260              		.loc 1 663 0 discriminator 2
 2261 05c6 0134     		adds	r4, r4, #1
 2262              	.LVL236:
 2263 05c8 E4B2     		uxtb	r4, r4
 2264              	.LVL237:
 666:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2265              		.loc 1 666 0 discriminator 2
 2266 05ca 030A     		lsrs	r3, r0, #8
 663:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2267              		.loc 1 663 0 discriminator 2
 2268 05cc 2E2C     		cmp	r4, #46
 666:bluetooth_rxtx.c **** 			data[(i*3)+2] = reg_val & 0xff;
 2269              		.loc 1 666 0 discriminator 2
 2270 05ce 7370     		strb	r3, [r6, #1]
 667:bluetooth_rxtx.c **** 		}
 2271              		.loc 1 667 0 discriminator 2
 2272 05d0 B070     		strb	r0, [r6, #2]
 2273 05d2 06F10306 		add	r6, r6, #3
 663:bluetooth_rxtx.c **** 			reg_val = cc2400_get(i);
 2274              		.loc 1 663 0 discriminator 2
 2275 05d6 F2D1     		bne	.L201
 669:bluetooth_rxtx.c **** 		break;
 2276              		.loc 1 669 0
 2277 05d8 8723     		movs	r3, #135
 2278 05da D5E5     		b	.L228
 2279              	.LVL238:
 2280              	.L162:
 673:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2281              		.loc 1 673 0
 2282 05dc B279     		ldrb	r2, [r6, #6]	@ zero_extendqisi2
 674:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2283              		.loc 1 674 0
 2284 05de 2748     		ldr	r0, .L254
 2285              	.LVL239:
 673:bluetooth_rxtx.c **** 		memcpy(&tx_pkt, data, i);
 2286              		.loc 1 673 0
 2287 05e0 0732     		adds	r2, r2, #7
 674:bluetooth_rxtx.c **** 		//tx_pkt.channel = data[4] << 8 | data[5];
 2288              		.loc 1 674 0
 2289 05e2 3146     		mov	r1, r6
 2290              	.LVL240:
 2291 05e4 D2B2     		uxtb	r2, r2
 2292 05e6 FFF7FEFF 		bl	memcpy
 2293              	.LVL241:
 676:bluetooth_rxtx.c **** 		*data_len = 0;
ARM GAS  /tmp/ccCuKxzC.s 			page 89


 2294              		.loc 1 676 0
 2295 05ea 1023     		movs	r3, #16
 2296 05ec 5EE6     		b	.L242
 2297              	.LVL242:
 2298              	.L150:
 681:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2299              		.loc 1 681 0
 2300 05ee 1846     		mov	r0, r3
 2301              	.LVL243:
 2302 05f0 FFF7FEFF 		bl	malloc
 2303              	.LVL244:
 2304 05f4 224B     		ldr	r3, .L254+4
 682:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 2305              		.loc 1 682 0
 2306 05f6 3146     		mov	r1, r6
 2307 05f8 226A     		ldr	r2, [r4, #32]
 681:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, dlen);
 2308              		.loc 1 681 0
 2309 05fa 1860     		str	r0, [r3]
 682:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SLAVE_LE;
 2310              		.loc 1 682 0
 2311 05fc FFF7FEFF 		bl	memcpy
 2312              	.LVL245:
 683:bluetooth_rxtx.c **** 		break;
 2313              		.loc 1 683 0
 2314 0600 0C23     		movs	r3, #12
 2315 0602 A0E5     		b	.L225
 2316              	.LVL246:
 2317              	.L166:
 688:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, 6);
 2318              		.loc 1 688 0
 2319 0604 0620     		movs	r0, #6
 2320              	.LVL247:
 2321 0606 FFF7FEFF 		bl	malloc
 2322              	.LVL248:
 2323 060a 1D4B     		ldr	r3, .L254+4
 689:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SYNC_LE;
 2324              		.loc 1 689 0
 2325 060c 3146     		mov	r1, r6
 2326 060e 0622     		movs	r2, #6
 688:bluetooth_rxtx.c **** 		memcpy(slave_mac_address_data, data, 6);
 2327              		.loc 1 688 0
 2328 0610 1860     		str	r0, [r3]
 689:bluetooth_rxtx.c **** 		requested_mode = MODE_BT_SYNC_LE;
 2329              		.loc 1 689 0
 2330 0612 FFF7FEFF 		bl	memcpy
 2331              	.LVL249:
 690:bluetooth_rxtx.c **** 		do_hop = 0;
 2332              		.loc 1 690 0
 2333 0616 1323     		movs	r3, #19
 2334 0618 A374     		strb	r3, [r4, #18]
 691:bluetooth_rxtx.c **** 		hop_mode = HOP_BTLE;
 2335              		.loc 1 691 0
 2336 061a 0023     		movs	r3, #0
 2337 061c E372     		strb	r3, [r4, #11]
 692:bluetooth_rxtx.c **** 		queue_init();
 2338              		.loc 1 692 0
ARM GAS  /tmp/ccCuKxzC.s 			page 90


 2339 061e 0323     		movs	r3, #3
 2340 0620 A372     		strb	r3, [r4, #10]
 2341              	.L227:
 693:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
 2342              		.loc 1 693 0
 2343 0622 FFF7FEFF 		bl	queue_init
 2344              	.LVL250:
 2345              	.L229:
 694:bluetooth_rxtx.c **** 		break;
 2346              		.loc 1 694 0
 2347 0626 174B     		ldr	r3, .L254+8
 2348              	.L232:
 2349 0628 1888     		ldrh	r0, [r3]
 2350 062a 80B2     		uxth	r0, r0
 2351 062c FFF7FEFF 		bl	cs_threshold_calc_and_set
 2352              	.LVL251:
 2353 0630 1DE0     		b	.L202
 2354              	.LVL252:
 2355              	.L152:
 700:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 2356              		.loc 1 700 0
 2357 0632 7279     		ldrb	r2, [r6, #5]	@ zero_extendqisi2
 2358 0634 134B     		ldr	r3, .L254+8
 706:bluetooth_rxtx.c **** 		break;
 2359              		.loc 1 706 0
 2360 0636 0120     		movs	r0, #1
 2361              	.LVL253:
 700:bluetooth_rxtx.c **** 		le.target[1] = data[4];
 2362              		.loc 1 700 0
 2363 0638 83F83820 		strb	r2, [r3, #56]
 701:bluetooth_rxtx.c **** 		le.target[2] = data[3];
 2364              		.loc 1 701 0
 2365 063c 3279     		ldrb	r2, [r6, #4]	@ zero_extendqisi2
 2366 063e 83F83920 		strb	r2, [r3, #57]
 702:bluetooth_rxtx.c **** 		le.target[3] = data[2];
 2367              		.loc 1 702 0
 2368 0642 F278     		ldrb	r2, [r6, #3]	@ zero_extendqisi2
 2369 0644 83F83A20 		strb	r2, [r3, #58]
 703:bluetooth_rxtx.c **** 		le.target[4] = data[1];
 2370              		.loc 1 703 0
 2371 0648 B278     		ldrb	r2, [r6, #2]	@ zero_extendqisi2
 2372 064a 83F83B20 		strb	r2, [r3, #59]
 704:bluetooth_rxtx.c **** 		le.target[5] = data[0];
 2373              		.loc 1 704 0
 2374 064e 7278     		ldrb	r2, [r6, #1]	@ zero_extendqisi2
 2375 0650 83F83C20 		strb	r2, [r3, #60]
 705:bluetooth_rxtx.c **** 		le.target_set = 1;
 2376              		.loc 1 705 0
 2377 0654 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 2378 0656 83F83D20 		strb	r2, [r3, #61]
 2379              	.LVL254:
 2380              	.L218:
 706:bluetooth_rxtx.c **** 		break;
 2381              		.loc 1 706 0
 2382 065a 1864     		str	r0, [r3, #64]
 707:bluetooth_rxtx.c **** 
 2383              		.loc 1 707 0
ARM GAS  /tmp/ccCuKxzC.s 			page 91


 2384 065c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2385              	.LVL255:
 2386              	.L154:
 711:bluetooth_rxtx.c **** 		break;
 2387              		.loc 1 711 0
 2388 0660 0B78     		ldrb	r3, [r1]	@ zero_extendqisi2
 2389 0662 E374     		strb	r3, [r4, #19]
 2390 0664 03E0     		b	.L202
 2391              	.L155:
 720:bluetooth_rxtx.c **** 		ego_mode = request_params[0];
 2392              		.loc 1 720 0
 2393 0666 0D23     		movs	r3, #13
 2394 0668 A374     		strb	r3, [r4, #18]
 721:bluetooth_rxtx.c **** 		break;
 2395              		.loc 1 721 0
 2396 066a 0B78     		ldrb	r3, [r1]	@ zero_extendqisi2
 2397 066c 2375     		strb	r3, [r4, #20]
 2398              	.LVL256:
 2399              	.L202:
 727:bluetooth_rxtx.c **** }
 2400              		.loc 1 727 0
 2401 066e 0120     		movs	r0, #1
 2402 0670 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2403              	.LVL257:
 2404              	.L209:
 330:bluetooth_rxtx.c **** 		}
 2405              		.loc 1 330 0
 2406 0674 0020     		movs	r0, #0
 728:bluetooth_rxtx.c **** 
 2407              		.loc 1 728 0
 2408 0676 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2409              	.LVL258:
 2410              	.L255:
 2411 067a 00BF     		.align	2
 2412              	.L254:
 2413 067c 00000000 		.word	tx_pkt
 2414 0680 00000000 		.word	slave_mac_address_data
 2415 0684 00000000 		.word	.LANCHOR1
 2416              		.cfi_endproc
 2417              	.LFE3:
 2419              		.section	.text.enqueue_time,"ax",%progbits
 2420              		.align	1
 2421              		.thumb
 2422              		.thumb_func
 2424              	enqueue_time:
 2425              	.LFB1:
 166:bluetooth_rxtx.c **** 	usb_time_rx* f = usb_enqueue_time();
 2426              		.loc 1 166 0
 2427              		.cfi_startproc
 2428              		@ args = 0, pretend = 0, frame = 0
 2429              		@ frame_needed = 0, uses_anonymous_args = 0
 2430              	.LVL259:
 2431 0000 10B5     		push	{r4, lr}
 2432              		.cfi_def_cfa_offset 8
 2433              		.cfi_offset 4, -8
 2434              		.cfi_offset 14, -4
 166:bluetooth_rxtx.c **** 	usb_time_rx* f = usb_enqueue_time();
ARM GAS  /tmp/ccCuKxzC.s 			page 92


 2435              		.loc 1 166 0
 2436 0002 0446     		mov	r4, r0
 167:bluetooth_rxtx.c **** 	if  (f == NULL) {
 2437              		.loc 1 167 0
 2438 0004 FFF7FEFF 		bl	usb_enqueue_time
 2439              	.LVL260:
 168:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 2440              		.loc 1 168 0
 2441 0008 28B9     		cbnz	r0, .L257
 2442              	.LVL261:
 2443              	.LBB24:
 2444              	.LBB25:
 169:bluetooth_rxtx.c **** 		return 0;
 2445              		.loc 1 169 0
 2446 000a 064B     		ldr	r3, .L259
 2447 000c 5978     		ldrb	r1, [r3, #1]	@ zero_extendqisi2
 2448 000e 41F00401 		orr	r1, r1, #4
 2449 0012 5970     		strb	r1, [r3, #1]
 2450 0014 10BD     		pop	{r4, pc}
 2451              	.LVL262:
 2452              	.L257:
 2453              	.LBE25:
 2454              	.LBE24:
 172:bluetooth_rxtx.c **** 	return 1;
 2455              		.loc 1 172 0
 2456 0016 2146     		mov	r1, r4
 2457 0018 4022     		movs	r2, #64
 2458 001a FFF7FEFF 		bl	memcpy
 2459              	.LVL263:
 173:bluetooth_rxtx.c **** }
 2460              		.loc 1 173 0
 2461 001e 0120     		movs	r0, #1
 174:bluetooth_rxtx.c **** //
 2462              		.loc 1 174 0
 2463 0020 10BD     		pop	{r4, pc}
 2464              	.LVL264:
 2465              	.L260:
 2466 0022 00BF     		.align	2
 2467              	.L259:
 2468 0024 00000000 		.word	.LANCHOR0
 2469              		.cfi_endproc
 2470              	.LFE1:
 2472              		.section	.text.enqueue_with_ts,"ax",%progbits
 2473              		.align	1
 2474              		.global	enqueue_with_ts
 2475              		.thumb
 2476              		.thumb_func
 2478              	enqueue_with_ts:
 2479              	.LFB2:
 178:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2480              		.loc 1 178 0
 2481              		.cfi_startproc
 2482              		@ args = 0, pretend = 0, frame = 0
 2483              		@ frame_needed = 0, uses_anonymous_args = 0
 2484              	.LVL265:
 2485 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2486              		.cfi_def_cfa_offset 24
ARM GAS  /tmp/ccCuKxzC.s 			page 93


 2487              		.cfi_offset 4, -24
 2488              		.cfi_offset 5, -20
 2489              		.cfi_offset 6, -16
 2490              		.cfi_offset 7, -12
 2491              		.cfi_offset 8, -8
 2492              		.cfi_offset 14, -4
 178:bluetooth_rxtx.c **** 	usb_pkt_rx* f = usb_enqueue();
 2493              		.loc 1 178 0
 2494 0004 0646     		mov	r6, r0
 2495 0006 0F46     		mov	r7, r1
 2496 0008 9046     		mov	r8, r2
 179:bluetooth_rxtx.c **** 
 2497              		.loc 1 179 0
 2498 000a FFF7FEFF 		bl	usb_enqueue
 2499              	.LVL266:
 2500 000e 104D     		ldr	r5, .L264
 182:bluetooth_rxtx.c **** 		status |= FIFO_OVERFLOW;
 2501              		.loc 1 182 0
 2502 0010 0446     		mov	r4, r0
 2503 0012 28B9     		cbnz	r0, .L262
 183:bluetooth_rxtx.c **** 		return 0;
 2504              		.loc 1 183 0
 2505 0014 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 2506 0016 43F00403 		orr	r3, r3, #4
 2507 001a 6B70     		strb	r3, [r5, #1]
 184:bluetooth_rxtx.c **** 	}
 2508              		.loc 1 184 0
 2509 001c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2510              	.LVL267:
 2511              	.L262:
 192:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2512              		.loc 1 192 0
 2513 0020 0C4B     		ldr	r3, .L264+4
 187:bluetooth_rxtx.c **** 
 2514              		.loc 1 187 0
 2515 0022 0670     		strb	r6, [r0]
 192:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2516              		.loc 1 192 0
 2517 0024 1B88     		ldrh	r3, [r3]
 189:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2518              		.loc 1 189 0
 2519 0026 0026     		movs	r6, #0
 192:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2520              		.loc 1 192 0
 2521 0028 9BB2     		uxth	r3, r3
 2522 002a 623B     		subs	r3, r3, #98
 189:bluetooth_rxtx.c **** 	f->clk100ns = ts;
 2523              		.loc 1 189 0
 2524 002c C670     		strb	r6, [r0, #3]
 190:bluetooth_rxtx.c **** 
 2525              		.loc 1 190 0
 2526 002e C0F80480 		str	r8, [r0, #4]
 192:bluetooth_rxtx.c **** 	f->rssi_avg = 0;
 2527              		.loc 1 192 0
 2528 0032 8370     		strb	r3, [r0, #2]
 193:bluetooth_rxtx.c **** 	f->rssi_count = 0;
 2529              		.loc 1 193 0
ARM GAS  /tmp/ccCuKxzC.s 			page 94


 2530 0034 8672     		strb	r6, [r0, #10]
 194:bluetooth_rxtx.c **** 
 2531              		.loc 1 194 0
 2532 0036 C672     		strb	r6, [r0, #11]
 196:bluetooth_rxtx.c **** 
 2533              		.loc 1 196 0
 2534 0038 3946     		mov	r1, r7
 2535 003a 3222     		movs	r2, #50
 2536 003c 0E30     		adds	r0, r0, #14
 2537              	.LVL268:
 2538 003e FFF7FEFF 		bl	memcpy
 2539              	.LVL269:
 198:bluetooth_rxtx.c **** 	status = 0;
 2540              		.loc 1 198 0
 2541 0042 6B78     		ldrb	r3, [r5, #1]	@ zero_extendqisi2
 199:bluetooth_rxtx.c **** 
 2542              		.loc 1 199 0
 2543 0044 6E70     		strb	r6, [r5, #1]
 198:bluetooth_rxtx.c **** 	status = 0;
 2544              		.loc 1 198 0
 2545 0046 6370     		strb	r3, [r4, #1]
 201:bluetooth_rxtx.c **** }
 2546              		.loc 1 201 0
 2547 0048 0120     		movs	r0, #1
 202:bluetooth_rxtx.c **** 
 2548              		.loc 1 202 0
 2549 004a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2550              	.LVL270:
 2551              	.L265:
 2552 004e 00BF     		.align	2
 2553              	.L264:
 2554 0050 00000000 		.word	.LANCHOR0
 2555 0054 00000000 		.word	.LANCHOR1
 2556              		.cfi_endproc
 2557              	.LFE2:
 2559              		.section	.text.TIMER0_IRQHandler,"ax",%progbits
 2560              		.align	1
 2561              		.global	TIMER0_IRQHandler
 2562              		.thumb
 2563              		.thumb_func
 2565              	TIMER0_IRQHandler:
 2566              	.LFB4:
 732:bluetooth_rxtx.c **** 	if (T0IR & TIR_MR0_Interrupt) {
 2567              		.loc 1 732 0
 2568              		.cfi_startproc
 2569              		@ args = 0, pretend = 0, frame = 0
 2570              		@ frame_needed = 0, uses_anonymous_args = 0
 2571 0000 70B5     		push	{r4, r5, r6, lr}
 2572              		.cfi_def_cfa_offset 16
 2573              		.cfi_offset 4, -16
 2574              		.cfi_offset 5, -12
 2575              		.cfi_offset 6, -8
 2576              		.cfi_offset 14, -4
 733:bluetooth_rxtx.c **** 
 2577              		.loc 1 733 0
 2578 0002 4FF04023 		mov	r3, #1073758208
 2579 0006 1B68     		ldr	r3, [r3]
ARM GAS  /tmp/ccCuKxzC.s 			page 95


 2580 0008 DB07     		lsls	r3, r3, #31
 2581 000a 7FD5     		bpl	.L266
 2582              	.LBB26:
 735:bluetooth_rxtx.c **** 		clkn_offset = 0;
 2583              		.loc 1 735 0
 2584 000c 4049     		ldr	r1, .L289
 2585 000e 414B     		ldr	r3, .L289+4
 2586 0010 0868     		ldr	r0, [r1]
 2587 0012 1A68     		ldr	r2, [r3]
 2588 0014 0244     		add	r2, r2, r0
 2589 0016 0132     		adds	r2, r2, #1
 2590 0018 0A60     		str	r2, [r1]
 736:bluetooth_rxtx.c **** 
 2591              		.loc 1 736 0
 2592 001a 0022     		movs	r2, #0
 2593 001c 1A60     		str	r2, [r3]
 743:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2594              		.loc 1 743 0
 2595 001e 3E4A     		ldr	r2, .L289+8
 738:bluetooth_rxtx.c **** 
 2596              		.loc 1 738 0
 2597 0020 0C68     		ldr	r4, [r1]
 2598 0022 3E4B     		ldr	r3, .L289+12
 743:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2599              		.loc 1 743 0
 2600 0024 967A     		ldrb	r6, [r2, #10]	@ zero_extendqisi2
 738:bluetooth_rxtx.c **** 
 2601              		.loc 1 738 0
 2602 0026 D869     		ldr	r0, [r3, #28]
 2603              	.LVL271:
 2604 0028 1546     		mov	r5, r2
 743:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2605              		.loc 1 743 0
 2606 002a 16B1     		cbz	r6, .L268
 743:bluetooth_rxtx.c **** 			if ((clkn & 0x7f) == 0)
 2607              		.loc 1 743 0 is_stmt 0 discriminator 1
 2608 002c 967A     		ldrb	r6, [r2, #10]	@ zero_extendqisi2
 2609 002e 012E     		cmp	r6, #1
 2610 0030 05D1     		bne	.L269
 2611              	.L268:
 744:bluetooth_rxtx.c **** 				do_hop = 1;
 2612              		.loc 1 744 0 is_stmt 1
 2613 0032 0B68     		ldr	r3, [r1]
 2614 0034 5E06     		lsls	r6, r3, #25
 2615 0036 37D1     		bne	.L270
 745:bluetooth_rxtx.c **** 		}
 2616              		.loc 1 745 0
 2617 0038 0123     		movs	r3, #1
 2618 003a EB72     		strb	r3, [r5, #11]
 2619 003c 34E0     		b	.L270
 2620              	.L269:
 748:bluetooth_rxtx.c **** 			if ((clkn & 0x1) == 0)
 2621              		.loc 1 748 0
 2622 003e 957A     		ldrb	r5, [r2, #10]	@ zero_extendqisi2
 2623 0040 022D     		cmp	r5, #2
 2624 0042 03D1     		bne	.L271
 749:bluetooth_rxtx.c **** 				do_hop = 1;
ARM GAS  /tmp/ccCuKxzC.s 			page 96


 2625              		.loc 1 749 0
 2626 0044 0B68     		ldr	r3, [r1]
 2627 0046 DC07     		lsls	r4, r3, #31
 2628              	.LVL272:
 2629 0048 2ED4     		bmi	.L270
 2630 004a 2BE0     		b	.L287
 2631              	.LVL273:
 2632              	.L271:
 753:bluetooth_rxtx.c **** 			// Only hop if connected
 2633              		.loc 1 753 0
 2634 004c 957A     		ldrb	r5, [r2, #10]	@ zero_extendqisi2
 2635 004e 032D     		cmp	r5, #3
 2636 0050 1CD1     		bne	.L272
 755:bluetooth_rxtx.c **** 				--le.interval_timer;
 2637              		.loc 1 755 0
 2638 0052 1D7E     		ldrb	r5, [r3, #24]	@ zero_extendqisi2
 2639 0054 032D     		cmp	r5, #3
 2640 0056 27D1     		bne	.L270
 738:bluetooth_rxtx.c **** 
 2641              		.loc 1 738 0 discriminator 1
 2642 0058 201A     		subs	r0, r4, r0
 2643              	.LVL274:
 755:bluetooth_rxtx.c **** 				--le.interval_timer;
 2644              		.loc 1 755 0 discriminator 1
 2645 005a 8007     		lsls	r0, r0, #30
 2646 005c 24D1     		bne	.L270
 756:bluetooth_rxtx.c **** 				if (le.interval_timer == 0) {
 2647              		.loc 1 756 0
 2648 005e 188C     		ldrh	r0, [r3, #32]
 2649 0060 80B2     		uxth	r0, r0
 2650 0062 0138     		subs	r0, r0, #1
 2651 0064 80B2     		uxth	r0, r0
 2652 0066 1884     		strh	r0, [r3, #32]	@ movhi
 757:bluetooth_rxtx.c **** 					do_hop = 1;
 2653              		.loc 1 757 0
 2654 0068 188C     		ldrh	r0, [r3, #32]
 2655 006a 80B2     		uxth	r0, r0
 2656 006c 48B9     		cbnz	r0, .L273
 758:bluetooth_rxtx.c **** 					++le.conn_count;
 2657              		.loc 1 758 0
 2658 006e 0120     		movs	r0, #1
 2659 0070 D072     		strb	r0, [r2, #11]
 759:bluetooth_rxtx.c **** 					le.interval_timer = le.conn_interval;
 2660              		.loc 1 759 0
 2661 0072 9A8C     		ldrh	r2, [r3, #36]
 2662 0074 92B2     		uxth	r2, r2
 2663 0076 0244     		add	r2, r2, r0
 2664 0078 92B2     		uxth	r2, r2
 2665 007a 9A84     		strh	r2, [r3, #36]	@ movhi
 760:bluetooth_rxtx.c **** 				} else {
 2666              		.loc 1 760 0
 2667 007c 5A8C     		ldrh	r2, [r3, #34]
 2668 007e 1A84     		strh	r2, [r3, #32]	@ movhi
 2669 0080 12E0     		b	.L270
 2670              	.L273:
 762:bluetooth_rxtx.c **** 				}
 2671              		.loc 1 762 0
ARM GAS  /tmp/ccCuKxzC.s 			page 97


 2672 0082 274B     		ldr	r3, .L289+16
 2673 0084 4FF48072 		mov	r2, #256
 2674 0088 1A60     		str	r2, [r3]
 2675 008a 0DE0     		b	.L270
 2676              	.LVL275:
 2677              	.L272:
 766:bluetooth_rxtx.c **** 			if( (last_hop + hop_timeout) == clkn ) {
 2678              		.loc 1 766 0
 2679 008c 907A     		ldrb	r0, [r2, #10]	@ zero_extendqisi2
 2680              	.LVL276:
 2681 008e 0528     		cmp	r0, #5
 2682 0090 0AD1     		bne	.L270
 767:bluetooth_rxtx.c **** 				do_hop = 1;
 2683              		.loc 1 767 0
 2684 0092 2448     		ldr	r0, .L289+20
 2685 0094 0468     		ldr	r4, [r0]
 2686              	.LVL277:
 2687 0096 B3F84800 		ldrh	r0, [r3, #72]
 2688 009a 0B68     		ldr	r3, [r1]
 2689 009c 80B2     		uxth	r0, r0
 2690 009e 2044     		add	r0, r0, r4
 2691 00a0 9842     		cmp	r0, r3
 2692 00a2 01D1     		bne	.L270
 2693              	.L287:
 768:bluetooth_rxtx.c **** 			}
 2694              		.loc 1 768 0
 2695 00a4 0123     		movs	r3, #1
 2696 00a6 D372     		strb	r3, [r2, #11]
 2697              	.L270:
 773:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2698              		.loc 1 773 0
 2699 00a8 1F4A     		ldr	r2, .L289+24
 2700 00aa 204B     		ldr	r3, .L289+28
 2701 00ac 1068     		ldr	r0, [r2]
 2702 00ae C0B1     		cbz	r0, .L274
 773:bluetooth_rxtx.c **** 			if(clkn >= clkn_next_drift_fix) {
 2703              		.loc 1 773 0 is_stmt 0 discriminator 1
 2704 00b0 1888     		ldrh	r0, [r3]
 2705 00b2 80B2     		uxth	r0, r0
 2706 00b4 A8B9     		cbnz	r0, .L274
 774:bluetooth_rxtx.c **** 
 2707              		.loc 1 774 0 is_stmt 1
 2708 00b6 0C68     		ldr	r4, [r1]
 2709 00b8 1068     		ldr	r0, [r2]
 2710 00ba 8442     		cmp	r4, r0
 2711 00bc 11D3     		bcc	.L274
 777:bluetooth_rxtx.c **** 					clk100ns_offset = 1;
 2712              		.loc 1 777 0
 2713 00be 1C48     		ldr	r0, .L289+32
 2714 00c0 0088     		ldrh	r0, [r0]
 2715 00c2 00B2     		sxth	r0, r0
 2716 00c4 0028     		cmp	r0, #0
 778:bluetooth_rxtx.c **** 				}
 2717              		.loc 1 778 0
 2718 00c6 ACBF     		ite	ge
 2719 00c8 0120     		movge	r0, #1
 783:bluetooth_rxtx.c **** 				}
ARM GAS  /tmp/ccCuKxzC.s 			page 98


 2720              		.loc 1 783 0
 2721 00ca 41F66900 		movwlt	r0, #6249
 2722 00ce 1880     		strh	r0, [r3]	@ movhi
 785:bluetooth_rxtx.c **** 				clkn_next_drift_fix = clkn_last_drift_fix + clk_drift_correction;
 2723              		.loc 1 785 0
 2724 00d0 0C68     		ldr	r4, [r1]
 2725 00d2 1848     		ldr	r0, .L289+36
 2726 00d4 0460     		str	r4, [r0]
 786:bluetooth_rxtx.c **** 			}
 2727              		.loc 1 786 0
 2728 00d6 0468     		ldr	r4, [r0]
 2729 00d8 1748     		ldr	r0, .L289+40
 2730 00da 0088     		ldrh	r0, [r0]
 2731 00dc 80B2     		uxth	r0, r0
 2732 00de 2044     		add	r0, r0, r4
 2733 00e0 1060     		str	r0, [r2]
 2734              	.L274:
 791:bluetooth_rxtx.c **** 			clkn += 2;
 2735              		.loc 1 791 0
 2736 00e2 1888     		ldrh	r0, [r3]
 2737 00e4 40F63442 		movw	r2, #3124
 2738 00e8 80B2     		uxth	r0, r0
 2739 00ea 9042     		cmp	r0, r2
 2740 00ec 02D9     		bls	.L277
 792:bluetooth_rxtx.c **** 
 2741              		.loc 1 792 0
 2742 00ee 0A68     		ldr	r2, [r1]
 2743 00f0 0232     		adds	r2, r2, #2
 2744 00f2 0A60     		str	r2, [r1]
 2745              	.L277:
 794:bluetooth_rxtx.c **** 		clk100ns_offset = 0;
 2746              		.loc 1 794 0
 2747 00f4 1988     		ldrh	r1, [r3]
 2748 00f6 114A     		ldr	r2, .L289+44
 2749 00f8 89B2     		uxth	r1, r1
 2750 00fa 01F63441 		addw	r1, r1, #3124
 2751 00fe 1160     		str	r1, [r2]
 795:bluetooth_rxtx.c **** 
 2752              		.loc 1 795 0
 2753 0100 0022     		movs	r2, #0
 2754 0102 1A80     		strh	r2, [r3]	@ movhi
 798:bluetooth_rxtx.c **** 	}
 2755              		.loc 1 798 0
 2756 0104 0122     		movs	r2, #1
 2757 0106 4FF04023 		mov	r3, #1073758208
 2758 010a 1A60     		str	r2, [r3]
 2759              	.L266:
 2760 010c 70BD     		pop	{r4, r5, r6, pc}
 2761              	.L290:
 2762 010e 00BF     		.align	2
 2763              	.L289:
 2764 0110 00000000 		.word	clkn
 2765 0114 00000000 		.word	clkn_offset
 2766 0118 00000000 		.word	.LANCHOR0
 2767 011c 00000000 		.word	.LANCHOR1
 2768 0120 3CC00920 		.word	537509948
 2769 0124 00000000 		.word	last_hop
ARM GAS  /tmp/ccCuKxzC.s 			page 99


 2770 0128 00000000 		.word	clkn_next_drift_fix
 2771 012c 00000000 		.word	clk100ns_offset
 2772 0130 00000000 		.word	clk_drift_ppm
 2773 0134 00000000 		.word	clkn_last_drift_fix
 2774 0138 00000000 		.word	clk_drift_correction
 2775 013c 18400040 		.word	1073758232
 2776              	.LBE26:
 2777              		.cfi_endproc
 2778              	.LFE4:
 2780              		.section	.text.EINT3_IRQHandler,"ax",%progbits
 2781              		.align	1
 2782              		.global	EINT3_IRQHandler
 2783              		.thumb
 2784              		.thumb_func
 2786              	EINT3_IRQHandler:
 2787              	.LFB5:
 805:bluetooth_rxtx.c **** 	/* TODO - check specific source of shared interrupt */
 2788              		.loc 1 805 0
 2789              		.cfi_startproc
 2790              		@ args = 0, pretend = 0, frame = 0
 2791              		@ frame_needed = 0, uses_anonymous_args = 0
 2792              		@ link register save eliminated.
 807:bluetooth_rxtx.c **** 	DIO_SSEL_CLR;           // enable SPI
 2793              		.loc 1 807 0
 2794 0000 084B     		ldr	r3, .L293
 2795 0002 0422     		movs	r2, #4
 2796 0004 1A60     		str	r2, [r3]
 808:bluetooth_rxtx.c **** 	cs_trigger  = 1;        // signal trigger
 2797              		.loc 1 808 0
 2798 0006 084B     		ldr	r3, .L293+4
 2799 0008 4FF08052 		mov	r2, #268435456
 2800 000c 1A60     		str	r2, [r3]
 809:bluetooth_rxtx.c **** 	if (hop_mode == HOP_BLUETOOTH)
 2801              		.loc 1 809 0
 2802 000e 074B     		ldr	r3, .L293+8
 2803 0010 0122     		movs	r2, #1
 2804 0012 1A70     		strb	r2, [r3]
 810:bluetooth_rxtx.c **** 		dma_discard = 0; 
 2805              		.loc 1 810 0
 2806 0014 064B     		ldr	r3, .L293+12
 2807 0016 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 2808 0018 022A     		cmp	r2, #2
 811:bluetooth_rxtx.c **** 
 2809              		.loc 1 811 0
 2810 001a 04BF     		itt	eq
 2811 001c 0022     		moveq	r2, #0
 2812 001e 1A74     		strbeq	r2, [r3, #16]
 2813 0020 7047     		bx	lr
 2814              	.L294:
 2815 0022 00BF     		.align	2
 2816              	.L293:
 2817 0024 AC800240 		.word	1073905836
 2818 0028 9CC00920 		.word	537510044
 2819 002c 00000000 		.word	cs_trigger
 2820 0030 00000000 		.word	.LANCHOR0
 2821              		.cfi_endproc
 2822              	.LFE5:
ARM GAS  /tmp/ccCuKxzC.s 			page 100


 2824              		.section	.text.DMA_IRQHandler,"ax",%progbits
 2825              		.align	1
 2826              		.global	DMA_IRQHandler
 2827              		.thumb
 2828              		.thumb_func
 2830              	DMA_IRQHandler:
 2831              	.LFB7:
 835:bluetooth_rxtx.c **** 	if ( mode == MODE_RX_SYMBOLS
 2832              		.loc 1 835 0
 2833              		.cfi_startproc
 2834              		@ args = 0, pretend = 0, frame = 0
 2835              		@ frame_needed = 0, uses_anonymous_args = 0
 2836 0000 10B5     		push	{r4, lr}
 2837              		.cfi_def_cfa_offset 8
 2838              		.cfi_offset 4, -8
 2839              		.cfi_offset 14, -4
 836:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW
 2840              		.loc 1 836 0
 2841 0002 2D4B     		ldr	r3, .L340
 2842 0004 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2843 0006 012A     		cmp	r2, #1
 2844 0008 1AD0     		beq	.L296
 837:bluetooth_rxtx.c **** 	   || mode == MODE_SPECAN
 2845              		.loc 1 837 0
 2846 000a 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2847 000c 082A     		cmp	r2, #8
 2848 000e 17D0     		beq	.L296
 838:bluetooth_rxtx.c **** 	   || mode == MODE_BT_FOLLOW_LE
 2849              		.loc 1 838 0
 2850 0010 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2851 0012 042A     		cmp	r2, #4
 2852 0014 14D0     		beq	.L296
 839:bluetooth_rxtx.c **** 	   || mode == MODE_BT_CFO_LE
 2853              		.loc 1 839 0
 2854 0016 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2855 0018 092A     		cmp	r2, #9
 2856 001a 11D0     		beq	.L296
 840:bluetooth_rxtx.c **** 	   || mode == MODE_BT_RSSI_LE
 2857              		.loc 1 840 0
 2858 001c 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2859 001e 112A     		cmp	r2, #17
 2860 0020 0ED0     		beq	.L296
 841:bluetooth_rxtx.c **** 	   || mode == MODE_BT_PROMISC_LE
 2861              		.loc 1 841 0
 2862 0022 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2863 0024 122A     		cmp	r2, #18
 2864 0026 0BD0     		beq	.L296
 842:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SLAVE_LE
 2865              		.loc 1 842 0
 2866 0028 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2867 002a 0A2A     		cmp	r2, #10
 2868 002c 08D0     		beq	.L296
 843:bluetooth_rxtx.c **** 	   || mode == MODE_BT_SYNC_LE
 2869              		.loc 1 843 0
 2870 002e 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2871 0030 0C2A     		cmp	r2, #12
 2872 0032 05D0     		beq	.L296
ARM GAS  /tmp/ccCuKxzC.s 			page 101


 844:bluetooth_rxtx.c **** 	   || mode == MODE_RX_GENERIC)
 2873              		.loc 1 844 0
 2874 0034 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2875 0036 132A     		cmp	r2, #19
 2876 0038 02D0     		beq	.L296
 845:bluetooth_rxtx.c **** 	{
 2877              		.loc 1 845 0
 2878 003a 5A7C     		ldrb	r2, [r3, #17]	@ zero_extendqisi2
 2879 003c 0F2A     		cmp	r2, #15
 2880 003e 39D1     		bne	.L295
 2881              	.L296:
 848:bluetooth_rxtx.c **** 			if (DMACIntTCStat & (1 << 0)) {
 2882              		.loc 1 848 0
 2883 0040 1E4A     		ldr	r2, .L340+4
 2884 0042 1268     		ldr	r2, [r2]
 2885 0044 D007     		lsls	r0, r2, #31
 2886 0046 35D5     		bpl	.L295
 849:bluetooth_rxtx.c **** 				DMACIntTCClear = (1 << 0);
 2887              		.loc 1 849 0
 2888 0048 1D4A     		ldr	r2, .L340+8
 2889 004a 1268     		ldr	r2, [r2]
 2890 004c D107     		lsls	r1, r2, #31
 2891 004e 26D5     		bpl	.L299
 2892              	.LBB27:
 850:bluetooth_rxtx.c **** 
 2893              		.loc 1 850 0
 2894 0050 1C4A     		ldr	r2, .L340+12
 2895 0052 0121     		movs	r1, #1
 2896 0054 1160     		str	r1, [r2]
 852:bluetooth_rxtx.c **** 					DIO_SSEL_SET;
 2897              		.loc 1 852 0
 2898 0056 9A7A     		ldrb	r2, [r3, #10]	@ zero_extendqisi2
 2899 0058 022A     		cmp	r2, #2
 2900 005a 03D1     		bne	.L300
 853:bluetooth_rxtx.c **** 
 2901              		.loc 1 853 0
 2902 005c 1A4A     		ldr	r2, .L340+16
 2903 005e 4FF08051 		mov	r1, #268435456
 2904 0062 1160     		str	r1, [r2]
 2905              	.L300:
 855:bluetooth_rxtx.c **** 				idle_buf_clkn_high = (clkn >> 20) & 0xff;
 2906              		.loc 1 855 0
 2907 0064 194A     		ldr	r2, .L340+20
 2908 0066 1A48     		ldr	r0, .L340+24
 2909 0068 1168     		ldr	r1, [r2]
 2910 006a 0068     		ldr	r0, [r0]
 2911 006c C1F31301 		ubfx	r1, r1, #0, #20
 2912 0070 40F63544 		movw	r4, #3125
 2913 0074 04FB0101 		mla	r1, r4, r1, r0
 2914 0078 5960     		str	r1, [r3, #4]
 856:bluetooth_rxtx.c **** 				idle_buf_channel   = channel;
 2915              		.loc 1 856 0
 2916 007a 1268     		ldr	r2, [r2]
 2917 007c C2F30752 		ubfx	r2, r2, #20, #8
 2918 0080 9A70     		strb	r2, [r3, #2]
 857:bluetooth_rxtx.c **** 
 2919              		.loc 1 857 0
ARM GAS  /tmp/ccCuKxzC.s 			page 102


 2920 0082 144A     		ldr	r2, .L340+28
 2921 0084 1288     		ldrh	r2, [r2]
 2922 0086 92B2     		uxth	r2, r2
 2923 0088 1A81     		strh	r2, [r3, #8]	@ movhi
 860:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 2924              		.loc 1 860 0
 2925 008a 134A     		ldr	r2, .L340+32
 861:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 2926              		.loc 1 861 0
 2927 008c 134B     		ldr	r3, .L340+36
 860:bluetooth_rxtx.c **** 				active_rxbuf = idle_rxbuf;
 2928              		.loc 1 860 0
 2929 008e 1168     		ldr	r1, [r2]
 2930              	.LVL278:
 861:bluetooth_rxtx.c **** 				idle_rxbuf = tmp;
 2931              		.loc 1 861 0
 2932 0090 1868     		ldr	r0, [r3]
 2933 0092 1060     		str	r0, [r2]
 862:bluetooth_rxtx.c **** 
 2934              		.loc 1 862 0
 2935 0094 1960     		str	r1, [r3]
 864:bluetooth_rxtx.c **** 			}
 2936              		.loc 1 864 0
 2937 0096 124B     		ldr	r3, .L340+40
 2938 0098 1A68     		ldr	r2, [r3]
 2939 009a 0132     		adds	r2, r2, #1
 2940 009c 1A60     		str	r2, [r3]
 2941              	.LVL279:
 2942              	.L299:
 2943              	.LBE27:
 866:bluetooth_rxtx.c **** 				DMACIntErrClr = (1 << 0);
 2944              		.loc 1 866 0
 2945 009e 114B     		ldr	r3, .L340+44
 2946 00a0 1B68     		ldr	r3, [r3]
 2947 00a2 DA07     		lsls	r2, r3, #31
 2948 00a4 06D5     		bpl	.L295
 867:bluetooth_rxtx.c **** 				++rx_err;
 2949              		.loc 1 867 0
 2950 00a6 104B     		ldr	r3, .L340+48
 2951 00a8 0122     		movs	r2, #1
 2952 00aa 1A60     		str	r2, [r3]
 868:bluetooth_rxtx.c **** 			}
 2953              		.loc 1 868 0
 2954 00ac 0F4B     		ldr	r3, .L340+52
 2955 00ae 1A68     		ldr	r2, [r3]
 2956 00b0 0132     		adds	r2, r2, #1
 2957 00b2 1A60     		str	r2, [r3]
 2958              	.L295:
 2959 00b4 10BD     		pop	{r4, pc}
 2960              	.L341:
 2961 00b6 00BF     		.align	2
 2962              	.L340:
 2963 00b8 00000000 		.word	.LANCHOR0
 2964 00bc 00400050 		.word	1342193664
 2965 00c0 04400050 		.word	1342193668
 2966 00c4 08400050 		.word	1342193672
 2967 00c8 98C00920 		.word	537510040
ARM GAS  /tmp/ccCuKxzC.s 			page 103


 2968 00cc 00000000 		.word	clkn
 2969 00d0 08400040 		.word	1073758216
 2970 00d4 00000000 		.word	.LANCHOR1
 2971 00d8 00000000 		.word	active_rxbuf
 2972 00dc 00000000 		.word	idle_rxbuf
 2973 00e0 00000000 		.word	rx_tc
 2974 00e4 0C400050 		.word	1342193676
 2975 00e8 10400050 		.word	1342193680
 2976 00ec 00000000 		.word	rx_err
 2977              		.cfi_endproc
 2978              	.LFE7:
 2980              		.section	.text.le_transmit,"ax",%progbits
 2981              		.align	1
 2982              		.global	le_transmit
 2983              		.thumb
 2984              		.thumb_func
 2986              	le_transmit:
 2987              	.LFB12:
1098:bluetooth_rxtx.c **** 	unsigned i, j;
 2988              		.loc 1 1098 0
 2989              		.cfi_startproc
 2990              		@ args = 0, pretend = 0, frame = 64
 2991              		@ frame_needed = 0, uses_anonymous_args = 0
 2992              	.LVL280:
 2993 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 2994              		.cfi_def_cfa_offset 32
 2995              		.cfi_offset 4, -32
 2996              		.cfi_offset 5, -28
 2997              		.cfi_offset 6, -24
 2998              		.cfi_offset 7, -20
 2999              		.cfi_offset 8, -16
 3000              		.cfi_offset 9, -12
 3001              		.cfi_offset 10, -8
 3002              		.cfi_offset 14, -4
 3003 0004 90B0     		sub	sp, sp, #64
 3004              		.cfi_def_cfa_offset 96
1098:bluetooth_rxtx.c **** 	unsigned i, j;
 3005              		.loc 1 1098 0
 3006 0006 0546     		mov	r5, r0
 3007 0008 0F46     		mov	r7, r1
 3008 000a 9046     		mov	r8, r2
1103:bluetooth_rxtx.c **** 	u8 tx_len;
 3009              		.loc 1 1103 0
 3010 000c 0021     		movs	r1, #0
 3011              	.LVL281:
 3012 000e 6846     		mov	r0, sp
 3013              	.LVL282:
 3014 0010 4022     		movs	r2, #64
 3015              	.LVL283:
1098:bluetooth_rxtx.c **** 	unsigned i, j;
 3016              		.loc 1 1098 0
 3017 0012 1E46     		mov	r6, r3
 3018              	.LVL284:
1103:bluetooth_rxtx.c **** 	u8 tx_len;
 3019              		.loc 1 1103 0
 3020 0014 FFF7FEFF 		bl	memset
 3021              	.LVL285:
ARM GAS  /tmp/ccCuKxzC.s 			page 104


 3022 0018 0DF1FF30 		add	r0, sp, #-1
 3023 001c 0DF10301 		add	r1, sp, #3
 3024              	.LVL286:
 3025              	.L346:
1114:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 3026              		.loc 1 1114 0
 3027 0020 0022     		movs	r2, #0
1112:bluetooth_rxtx.c **** 		aa >>= 8;
 3028              		.loc 1 1112 0
 3029 0022 EBB2     		uxtb	r3, r5
 3030              	.LVL287:
1114:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 3031              		.loc 1 1114 0
 3032 0024 4270     		strb	r2, [r0, #1]
1113:bluetooth_rxtx.c **** 		txbuf[i] = 0;
 3033              		.loc 1 1113 0
 3034 0026 2D0A     		lsrs	r5, r5, #8
 3035              	.LVL288:
1114:bluetooth_rxtx.c **** 		for (j = 0; j < 8; ++j) {
 3036              		.loc 1 1114 0
 3037 0028 0724     		movs	r4, #7
 3038              	.LVL289:
 3039              	.L344:
1116:bluetooth_rxtx.c **** 			byte >>= 1;
 3040              		.loc 1 1116 0 discriminator 2
 3041 002a 03F0010E 		and	lr, r3, #1
 3042 002e 0EFA04FE 		lsl	lr, lr, r4
1115:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
 3043              		.loc 1 1115 0 discriminator 2
 3044 0032 14F1FF34 		adds	r4, r4, #-1
 3045              	.LVL290:
1116:bluetooth_rxtx.c **** 			byte >>= 1;
 3046              		.loc 1 1116 0 discriminator 2
 3047 0036 4EEA0202 		orr	r2, lr, r2
 3048 003a D2B2     		uxtb	r2, r2
1117:bluetooth_rxtx.c **** 		}
 3049              		.loc 1 1117 0 discriminator 2
 3050 003c 4FEA5303 		lsr	r3, r3, #1
 3051              	.LVL291:
1115:bluetooth_rxtx.c **** 			txbuf[i] |= (byte & 1) << (7 - j);
 3052              		.loc 1 1115 0 discriminator 2
 3053 0040 F3D2     		bcs	.L344
 3054 0042 00F8012F 		strb	r2, [r0, #1]!
 3055              	.LVL292:
1111:bluetooth_rxtx.c **** 		byte = aa & 0xff;
 3056              		.loc 1 1111 0
 3057 0046 8842     		cmp	r0, r1
 3058 0048 EAD1     		bne	.L346
1122:bluetooth_rxtx.c **** 	
 3059              		.loc 1 1122 0
 3060 004a A6F16200 		sub	r0, r6, #98
 3061              	.LVL293:
 3062 004e C0B2     		uxtb	r0, r0
 3063 0050 FFF7FEFF 		bl	btle_channel_index
 3064              	.LVL294:
 3065 0054 524B     		ldr	r3, .L370
1124:bluetooth_rxtx.c **** 		byte = data[i];
ARM GAS  /tmp/ccCuKxzC.s 			page 105


 3066              		.loc 1 1124 0
 3067 0056 0024     		movs	r4, #0
1122:bluetooth_rxtx.c **** 	
 3068              		.loc 1 1122 0
 3069 0058 1B5C     		ldrb	r3, [r3, r0]	@ zero_extendqisi2
 3070              	.LVL295:
 3071              	.L347:
1124:bluetooth_rxtx.c **** 		byte = data[i];
 3072              		.loc 1 1124 0 discriminator 1
 3073 005a BC42     		cmp	r4, r7
 3074 005c 24D2     		bcs	.L369
 3075 005e 0DF1000C 		add	ip, sp, #0
1125:bluetooth_rxtx.c **** 		txbuf[i+4] = 0;
 3076              		.loc 1 1125 0
 3077 0062 18F80420 		ldrb	r2, [r8, r4]	@ zero_extendqisi2
 3078              	.LVL296:
 3079 0066 A444     		add	ip, ip, r4
 3080              	.LVL297:
 3081 0068 0720     		movs	r0, #7
 3082 006a 0021     		movs	r1, #0
 3083              	.LVL298:
 3084              	.L349:
1128:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 3085              		.loc 1 1128 0 discriminator 2
 3086 006c DFF830E1 		ldr	lr, .L370
 3087 0070 02F00109 		and	r9, r2, #1
 3088 0074 9E44     		add	lr, lr, r3
 3089 0076 9EF828E0 		ldrb	lr, [lr, #40]	@ zero_extendqisi2
1129:bluetooth_rxtx.c **** 			byte >>= 1;
 3090              		.loc 1 1129 0 discriminator 2
 3091 007a 0133     		adds	r3, r3, #1
 3092              	.LVL299:
1128:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 3093              		.loc 1 1128 0 discriminator 2
 3094 007c 89EA0E09 		eor	r9, r9, lr
 3095              	.LVL300:
1129:bluetooth_rxtx.c **** 			byte >>= 1;
 3096              		.loc 1 1129 0 discriminator 2
 3097 0080 4FF07F0E 		mov	lr, #127
 3098 0084 B3FBFEFA 		udiv	r10, r3, lr
 3099 0088 0EFB1A33 		mls	r3, lr, r10, r3
 3100              	.LVL301:
1131:bluetooth_rxtx.c **** 		}
 3101              		.loc 1 1131 0 discriminator 2
 3102 008c 09FA00FE 		lsl	lr, r9, r0
1127:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 3103              		.loc 1 1127 0 discriminator 2
 3104 0090 10F1FF30 		adds	r0, r0, #-1
 3105              	.LVL302:
1131:bluetooth_rxtx.c **** 		}
 3106              		.loc 1 1131 0 discriminator 2
 3107 0094 4EEA0101 		orr	r1, lr, r1
1130:bluetooth_rxtx.c **** 			txbuf[i+4] |= bit << (7 - j);
 3108              		.loc 1 1130 0 discriminator 2
 3109 0098 4FEA5202 		lsr	r2, r2, #1
 3110              	.LVL303:
1131:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccCuKxzC.s 			page 106


 3111              		.loc 1 1131 0 discriminator 2
 3112 009c C9B2     		uxtb	r1, r1
 3113              	.LVL304:
1127:bluetooth_rxtx.c **** 			bit = (byte & 1) ^ whitening[idx];
 3114              		.loc 1 1127 0 discriminator 2
 3115 009e E5D2     		bcs	.L349
 3116 00a0 8CF80410 		strb	r1, [ip, #4]
1124:bluetooth_rxtx.c **** 		byte = data[i];
 3117              		.loc 1 1124 0
 3118 00a4 0134     		adds	r4, r4, #1
 3119              	.LVL305:
 3120 00a6 D8E7     		b	.L347
 3121              	.LVL306:
 3122              	.L369:
1138:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3123              		.loc 1 1138 0
 3124 00a8 0D20     		movs	r0, #13
 3125 00aa 47F6FF71 		movw	r1, #32767
 3126 00ae FFF7FEFF 		bl	cc2400_set
 3127              	.LVL307:
1139:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 3128              		.loc 1 1139 0
 3129 00b2 1220     		movs	r0, #18
 3130 00b4 42F62231 		movw	r1, #11042
 3131 00b8 FFF7FEFF 		bl	cc2400_set
 3132              	.LVL308:
1140:bluetooth_rxtx.c **** 
 3133              		.loc 1 1140 0
 3134 00bc 1420     		movs	r0, #20
 3135 00be 41F24B31 		movw	r1, #4939
 3136 00c2 FFF7FEFF 		bl	cc2400_set
 3137              	.LVL309:
1142:bluetooth_rxtx.c **** 	// 0 00 01 1 001 00 0 00 0 1
 3138              		.loc 1 1142 0
 3139 00c6 2020     		movs	r0, #32
 3140 00c8 40F60141 		movw	r1, #3073
 3141 00cc FFF7FEFF 		bl	cc2400_set
 3142              	.LVL310:
1150:bluetooth_rxtx.c **** 	// JWHUR cc2400 data sheet about power control
 3143              		.loc 1 1150 0
 3144 00d0 0220     		movs	r0, #2
 3145 00d2 3146     		mov	r1, r6
 3146 00d4 FFF7FEFF 		bl	cc2400_set
 3147              	.LVL311:
1161:bluetooth_rxtx.c **** 	//cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 3148              		.loc 1 1161 0
 3149 00d8 0520     		movs	r0, #5
 3150 00da 0721     		movs	r1, #7
 3151 00dc FFF7FEFF 		bl	cc2400_set
 3152              	.LVL312:
1163:bluetooth_rxtx.c **** 	cc2400_set(INT,     0x0014);    // FIFO_THRESHOLD: 20 bytes
 3153              		.loc 1 1163 0
 3154 00e0 0320     		movs	r0, #3
 3155 00e2 4021     		movs	r1, #64
 3156 00e4 FFF7FEFF 		bl	cc2400_set
 3157              	.LVL313:
1164:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccCuKxzC.s 			page 107


 3158              		.loc 1 1164 0
 3159 00e8 1421     		movs	r1, #20
 3160 00ea 2320     		movs	r0, #35
 3161 00ec FFF7FEFF 		bl	cc2400_set
 3162              	.LVL314:
1167:bluetooth_rxtx.c **** 		cc2400_set(SYNCH,   0xaaaa);
 3163              		.loc 1 1167 0
 3164 00f0 E907     		lsls	r1, r5, #31
1168:bluetooth_rxtx.c **** 	else
 3165              		.loc 1 1168 0
 3166 00f2 4CBF     		ite	mi
 3167 00f4 4AF6AA21 		movwmi	r1, #43690
1170:bluetooth_rxtx.c **** 
 3168              		.loc 1 1170 0
 3169 00f8 45F25551 		movwpl	r1, #21845
1168:bluetooth_rxtx.c **** 	else
 3170              		.loc 1 1168 0
 3171 00fc 2D20     		movs	r0, #45
1170:bluetooth_rxtx.c **** 
 3172              		.loc 1 1170 0
 3173 00fe FFF7FEFF 		bl	cc2400_set
 3174              	.LVL315:
1173:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 3175              		.loc 1 1173 0
 3176 0102 0820     		movs	r0, #8
 3177 0104 FFF7FEFF 		bl	cc2400_get
 3178              	.LVL316:
1174:bluetooth_rxtx.c **** 
 3179              		.loc 1 1174 0
 3180 0108 C0F30801 		ubfx	r1, r0, #0, #9
1135:bluetooth_rxtx.c **** 
 3181              		.loc 1 1135 0
 3182 010c 0437     		adds	r7, r7, #4
1173:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 3183              		.loc 1 1173 0
 3184 010e 0446     		mov	r4, r0
 3185              	.LVL317:
1174:bluetooth_rxtx.c **** 
 3186              		.loc 1 1174 0
 3187 0110 41F49C41 		orr	r1, r1, #19968
 3188 0114 0820     		movs	r0, #8
1135:bluetooth_rxtx.c **** 
 3189              		.loc 1 1135 0
 3190 0116 FFB2     		uxtb	r7, r7
 3191              	.LVL318:
1174:bluetooth_rxtx.c **** 
 3192              		.loc 1 1174 0
 3193 0118 FFF7FEFF 		bl	cc2400_set
 3194              	.LVL319:
 3195              	.L354:
1176:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3196              		.loc 1 1176 0 discriminator 1
 3197 011c FFF7FEFF 		bl	cc2400_status
 3198              	.LVL320:
 3199 0120 4206     		lsls	r2, r0, #25
 3200 0122 FBD5     		bpl	.L354
1177:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
ARM GAS  /tmp/ccCuKxzC.s 			page 108


 3201              		.loc 1 1177 0
 3202 0124 6120     		movs	r0, #97
 3203 0126 FFF7FEFF 		bl	cc2400_strobe
 3204              	.LVL321:
 3205              	.L356:
1178:bluetooth_rxtx.c **** 	TXLED_SET;
 3206              		.loc 1 1178 0 discriminator 1
 3207 012a FFF7FEFF 		bl	cc2400_status
 3208              	.LVL322:
 3209 012e 4307     		lsls	r3, r0, #29
 3210 0130 FBD5     		bpl	.L356
1179:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 3211              		.loc 1 1179 0
 3212 0132 1C4B     		ldr	r3, .L370+4
 3213 0134 4FF48072 		mov	r2, #256
 3214 0138 1A60     		str	r2, [r3]
1181:bluetooth_rxtx.c **** #endif
 3215              		.loc 1 1181 0
 3216 013a 8022     		movs	r2, #128
 3217 013c 1A62     		str	r2, [r3, #32]
 3218              	.L358:
1183:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3219              		.loc 1 1183 0 discriminator 1
 3220 013e 0E20     		movs	r0, #14
 3221 0140 FFF7FEFF 		bl	cc2400_get
 3222              	.LVL323:
 3223 0144 00F01F00 		and	r0, r0, #31
 3224 0148 0F28     		cmp	r0, #15
 3225 014a F8D1     		bne	.L358
1184:bluetooth_rxtx.c **** 
 3226              		.loc 1 1184 0
 3227 014c 6320     		movs	r0, #99
 3228 014e FFF7FEFF 		bl	cc2400_strobe
 3229              	.LVL324:
 3230              	.L360:
1197:bluetooth_rxtx.c **** 	if (len > 46) len = 46;
 3231              		.loc 1 1197 0 discriminator 1
 3232 0152 154B     		ldr	r3, .L370+8
 3233 0154 1B68     		ldr	r3, [r3]
 3234 0156 5E07     		lsls	r6, r3, #29
 3235 0158 FBD4     		bmi	.L360
 3236              	.LVL325:
1199:bluetooth_rxtx.c **** 
 3237              		.loc 1 1199 0
 3238 015a 2E2F     		cmp	r7, #46
 3239 015c 34BF     		ite	cc
 3240 015e 3846     		movcc	r0, r7
 3241 0160 2E20     		movcs	r0, #46
 3242 0162 6946     		mov	r1, sp
 3243 0164 FFF7FEFF 		bl	cc2400_fifo_write
 3244              	.LVL326:
 3245              	.L362:
1201:bluetooth_rxtx.c **** 	TXLED_CLR;
 3246              		.loc 1 1201 0 discriminator 1
 3247 0168 0E20     		movs	r0, #14
 3248 016a FFF7FEFF 		bl	cc2400_get
 3249              	.LVL327:
ARM GAS  /tmp/ccCuKxzC.s 			page 109


 3250 016e 00F01F00 		and	r0, r0, #31
 3251 0172 0F28     		cmp	r0, #15
 3252 0174 F8D1     		bne	.L362
1202:bluetooth_rxtx.c **** 
 3253              		.loc 1 1202 0
 3254 0176 0D4B     		ldr	r3, .L370+12
 3255 0178 4FF48072 		mov	r2, #256
 3256 017c 1A60     		str	r2, [r3]
1204:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 3257              		.loc 1 1204 0
 3258 017e 6420     		movs	r0, #100
 3259 0180 FFF7FEFF 		bl	cc2400_strobe
 3260              	.LVL328:
 3261              	.L364:
1205:bluetooth_rxtx.c **** 
 3262              		.loc 1 1205 0 discriminator 1
 3263 0184 FFF7FEFF 		bl	cc2400_status
 3264              	.LVL329:
 3265 0188 4507     		lsls	r5, r0, #29
 3266 018a FBD4     		bmi	.L364
1208:bluetooth_rxtx.c **** #endif
 3267              		.loc 1 1208 0
 3268 018c 084B     		ldr	r3, .L370+16
 3269 018e 8022     		movs	r2, #128
 3270 0190 1A60     		str	r2, [r3]
1212:bluetooth_rxtx.c **** }
 3271              		.loc 1 1212 0
 3272 0192 0820     		movs	r0, #8
 3273 0194 2146     		mov	r1, r4
 3274 0196 FFF7FEFF 		bl	cc2400_set
 3275              	.LVL330:
1213:bluetooth_rxtx.c **** 
 3276              		.loc 1 1213 0
 3277 019a 10B0     		add	sp, sp, #64
 3278              		@ sp needed
 3279 019c BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 3280              	.LVL331:
 3281              	.L371:
 3282              		.align	2
 3283              	.L370:
 3284 01a0 00000000 		.word	.LANCHOR2
 3285 01a4 38C00920 		.word	537509944
 3286 01a8 54C00920 		.word	537509972
 3287 01ac 3CC00920 		.word	537509948
 3288 01b0 5CC00920 		.word	537509980
 3289              		.cfi_endproc
 3290              	.LFE12:
 3292              		.section	.text.le_jam,"ax",%progbits
 3293              		.align	1
 3294              		.global	le_jam
 3295              		.thumb
 3296              		.thumb_func
 3298              	le_jam:
 3299              	.LFB13:
1215:bluetooth_rxtx.c **** #ifdef TX_ENABLE
 3300              		.loc 1 1215 0
 3301              		.cfi_startproc
ARM GAS  /tmp/ccCuKxzC.s 			page 110


 3302              		@ args = 0, pretend = 0, frame = 0
 3303              		@ frame_needed = 0, uses_anonymous_args = 0
 3304 0000 08B5     		push	{r3, lr}
 3305              		.cfi_def_cfa_offset 8
 3306              		.cfi_offset 3, -8
 3307              		.cfi_offset 14, -4
1217:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 3308              		.loc 1 1217 0
 3309 0002 0D20     		movs	r0, #13
 3310 0004 47F6FF71 		movw	r1, #32767
 3311 0008 FFF7FEFF 		bl	cc2400_set
 3312              	.LVL332:
1218:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x234b);    // PRNG, 1 MHz offset
 3313              		.loc 1 1218 0
 3314 000c 1220     		movs	r0, #18
 3315 000e 42F62231 		movw	r1, #11042
 3316 0012 FFF7FEFF 		bl	cc2400_set
 3317              	.LVL333:
1219:bluetooth_rxtx.c **** 
 3318              		.loc 1 1219 0
 3319 0016 1420     		movs	r0, #20
 3320 0018 42F24B31 		movw	r1, #9035
 3321 001c FFF7FEFF 		bl	cc2400_set
 3322              	.LVL334:
1221:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 3323              		.loc 1 1221 0
 3324 0020 2020     		movs	r0, #32
 3325 0022 40F60141 		movw	r1, #3073
 3326 0026 FFF7FEFF 		bl	cc2400_set
 3327              	.LVL335:
1230:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 3328              		.loc 1 1230 0
 3329 002a 0520     		movs	r0, #5
 3330 002c 0B21     		movs	r1, #11
 3331 002e FFF7FEFF 		bl	cc2400_set
 3332              	.LVL336:
1231:bluetooth_rxtx.c **** 
 3333              		.loc 1 1231 0
 3334 0032 0320     		movs	r0, #3
 3335 0034 4021     		movs	r1, #64
 3336 0036 FFF7FEFF 		bl	cc2400_set
 3337              	.LVL337:
 3338              	.L374:
1233:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 3339              		.loc 1 1233 0 discriminator 1
 3340 003a FFF7FEFF 		bl	cc2400_status
 3341              	.LVL338:
 3342 003e 4306     		lsls	r3, r0, #25
 3343 0040 FBD5     		bpl	.L374
1234:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3344              		.loc 1 1234 0
 3345 0042 6120     		movs	r0, #97
 3346 0044 FFF7FEFF 		bl	cc2400_strobe
 3347              	.LVL339:
 3348              	.L376:
1235:bluetooth_rxtx.c **** 	TXLED_SET;
 3349              		.loc 1 1235 0 discriminator 1
ARM GAS  /tmp/ccCuKxzC.s 			page 111


 3350 0048 FFF7FEFF 		bl	cc2400_status
 3351              	.LVL340:
 3352 004c 4007     		lsls	r0, r0, #29
 3353 004e FBD5     		bpl	.L376
1236:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
 3354              		.loc 1 1236 0
 3355 0050 084B     		ldr	r3, .L379
 3356 0052 4FF48072 		mov	r2, #256
 3357 0056 1A60     		str	r2, [r3]
1238:bluetooth_rxtx.c **** #endif
 3358              		.loc 1 1238 0
 3359 0058 8022     		movs	r2, #128
 3360 005a 1A62     		str	r2, [r3, #32]
 3361              	.L378:
1240:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 3362              		.loc 1 1240 0 discriminator 1
 3363 005c 0E20     		movs	r0, #14
 3364 005e FFF7FEFF 		bl	cc2400_get
 3365              	.LVL341:
 3366 0062 00F01F00 		and	r0, r0, #31
 3367 0066 0F28     		cmp	r0, #15
 3368 0068 F8D1     		bne	.L378
1241:bluetooth_rxtx.c **** #endif
 3369              		.loc 1 1241 0
 3370 006a 6320     		movs	r0, #99
1243:bluetooth_rxtx.c **** 
 3371              		.loc 1 1243 0
 3372 006c BDE80840 		pop	{r3, lr}
1241:bluetooth_rxtx.c **** #endif
 3373              		.loc 1 1241 0
 3374 0070 FFF7FEBF 		b	cc2400_strobe
 3375              	.LVL342:
 3376              	.L380:
 3377              		.align	2
 3378              	.L379:
 3379 0074 38C00920 		.word	537509944
 3380              		.cfi_endproc
 3381              	.LFE13:
 3383              		.section	.text.hop,"ax",%progbits
 3384              		.align	1
 3385              		.global	hop
 3386              		.thumb
 3387              		.thumb_func
 3389              	hop:
 3390              	.LFB14:
1248:bluetooth_rxtx.c **** 	do_hop = 0;
 3391              		.loc 1 1248 0
 3392              		.cfi_startproc
 3393              		@ args = 0, pretend = 0, frame = 0
 3394              		@ frame_needed = 0, uses_anonymous_args = 0
 3395 0000 38B5     		push	{r3, r4, r5, lr}
 3396              		.cfi_def_cfa_offset 16
 3397              		.cfi_offset 3, -16
 3398              		.cfi_offset 4, -12
 3399              		.cfi_offset 5, -8
 3400              		.cfi_offset 14, -4
1249:bluetooth_rxtx.c **** 	last_hop = clkn;
ARM GAS  /tmp/ccCuKxzC.s 			page 112


 3401              		.loc 1 1249 0
 3402 0002 5F4C     		ldr	r4, .L421
 3403 0004 0023     		movs	r3, #0
 3404 0006 E372     		strb	r3, [r4, #11]
1250:bluetooth_rxtx.c **** 
 3405              		.loc 1 1250 0
 3406 0008 5E4B     		ldr	r3, .L421+4
 3407 000a 5F4A     		ldr	r2, .L421+8
 3408 000c 1968     		ldr	r1, [r3]
 3409 000e 1160     		str	r1, [r2]
1253:bluetooth_rxtx.c **** 		if (cc2400_get(FSDIV) == (channel - 1))
 3410              		.loc 1 1253 0
 3411 0010 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3412 0012 4AB9     		cbnz	r2, .L382
1254:bluetooth_rxtx.c **** 			return;
 3413              		.loc 1 1254 0
 3414 0014 0220     		movs	r0, #2
 3415 0016 FFF7FEFF 		bl	cc2400_get
 3416              	.LVL343:
 3417 001a 5C4B     		ldr	r3, .L421+12
 3418 001c 1B88     		ldrh	r3, [r3]
 3419 001e 9BB2     		uxth	r3, r3
 3420 0020 013B     		subs	r3, r3, #1
 3421 0022 9842     		cmp	r0, r3
 3422 0024 7FD1     		bne	.L384
 3423 0026 38BD     		pop	{r3, r4, r5, pc}
 3424              	.L382:
1260:bluetooth_rxtx.c **** 		do {
 3425              		.loc 1 1260 0
 3426 0028 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3427 002a 012A     		cmp	r2, #1
 3428 002c 31D1     		bne	.L385
1265:bluetooth_rxtx.c **** 	}
 3429              		.loc 1 1265 0
 3430 002e 584B     		ldr	r3, .L421+16
 3431 0030 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 3432 0032 584B     		ldr	r3, .L421+20
 3433 0034 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 3434              	.L389:
1262:bluetooth_rxtx.c **** 			if (channel > 2480)
 3435              		.loc 1 1262 0
 3436 0036 554B     		ldr	r3, .L421+12
 3437 0038 1A88     		ldrh	r2, [r3]
 3438 003a 92B2     		uxth	r2, r2
 3439 003c 2032     		adds	r2, r2, #32
 3440 003e 92B2     		uxth	r2, r2
 3441 0040 1A80     		strh	r2, [r3]	@ movhi
1263:bluetooth_rxtx.c **** 				channel -= 79;
 3442              		.loc 1 1263 0
 3443 0042 1A88     		ldrh	r2, [r3]
 3444 0044 92B2     		uxth	r2, r2
 3445 0046 B2F51B6F 		cmp	r2, #2480
 3446 004a 04D9     		bls	.L386
1264:bluetooth_rxtx.c **** 		} while ( used_channels != 0 && afh_enabled && !( afh_map[(channel-2402)/8] & 0x1<<((channel-2402
 3447              		.loc 1 1264 0
 3448 004c 1A88     		ldrh	r2, [r3]
 3449 004e 92B2     		uxth	r2, r2
ARM GAS  /tmp/ccCuKxzC.s 			page 113


 3450 0050 4F3A     		subs	r2, r2, #79
 3451 0052 92B2     		uxth	r2, r2
 3452 0054 1A80     		strh	r2, [r3]	@ movhi
 3453              	.L386:
1265:bluetooth_rxtx.c **** 	}
 3454              		.loc 1 1265 0
 3455 0056 0029     		cmp	r1, #0
 3456 0058 65D0     		beq	.L384
1265:bluetooth_rxtx.c **** 	}
 3457              		.loc 1 1265 0 is_stmt 0 discriminator 1
 3458 005a 0028     		cmp	r0, #0
 3459 005c 63D0     		beq	.L384
 3460 005e 1A88     		ldrh	r2, [r3]
 3461 0060 1D88     		ldrh	r5, [r3]
 3462 0062 92B2     		uxth	r2, r2
 3463 0064 A2F66213 		subw	r3, r2, #2402
 3464 0068 0822     		movs	r2, #8
 3465 006a 93FBF2F3 		sdiv	r3, r3, r2
 3466 006e 4A4A     		ldr	r2, .L421+24
 3467 0070 ADB2     		uxth	r5, r5
 3468 0072 D25C     		ldrb	r2, [r2, r3]	@ zero_extendqisi2
 3469 0074 494B     		ldr	r3, .L421+28
 3470 0076 A5F66215 		subw	r5, r5, #2402
 3471 007a 2B40     		ands	r3, r3, r5
 3472 007c 002B     		cmp	r3, #0
 3473 007e 03DA     		bge	.L388
 3474 0080 013B     		subs	r3, r3, #1
 3475 0082 63F00703 		orn	r3, r3, #7
 3476 0086 0133     		adds	r3, r3, #1
 3477              	.L388:
 3478 0088 42FA03F3 		asr	r3, r2, r3
 3479 008c DD07     		lsls	r5, r3, #31
 3480 008e D2D5     		bpl	.L389
 3481 0090 49E0     		b	.L384
 3482              	.L385:
1271:bluetooth_rxtx.c **** 		do {
 3483              		.loc 1 1271 0 is_stmt 1
 3484 0092 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3485 0094 052A     		cmp	r2, #5
 3486 0096 2DD1     		bne	.L390
1276:bluetooth_rxtx.c **** 	}
 3487              		.loc 1 1276 0
 3488 0098 3D4B     		ldr	r3, .L421+16
 3489 009a 1978     		ldrb	r1, [r3]	@ zero_extendqisi2
 3490              	.L393:
1273:bluetooth_rxtx.c **** 			if (channel > 2480)
 3491              		.loc 1 1273 0
 3492 009c 3B4B     		ldr	r3, .L421+12
 3493 009e 1A88     		ldrh	r2, [r3]
 3494 00a0 92B2     		uxth	r2, r2
 3495 00a2 2032     		adds	r2, r2, #32
 3496 00a4 92B2     		uxth	r2, r2
 3497 00a6 1A80     		strh	r2, [r3]	@ movhi
1274:bluetooth_rxtx.c **** 				channel -= 79;
 3498              		.loc 1 1274 0
 3499 00a8 1A88     		ldrh	r2, [r3]
 3500 00aa 92B2     		uxth	r2, r2
ARM GAS  /tmp/ccCuKxzC.s 			page 114


 3501 00ac B2F51B6F 		cmp	r2, #2480
 3502 00b0 04D9     		bls	.L391
1275:bluetooth_rxtx.c **** 		} while( used_channels != 79 && (afh_map[(channel-2402)/8] & 0x1<<((channel-2402)%8)) );
 3503              		.loc 1 1275 0
 3504 00b2 1A88     		ldrh	r2, [r3]
 3505 00b4 92B2     		uxth	r2, r2
 3506 00b6 4F3A     		subs	r2, r2, #79
 3507 00b8 92B2     		uxth	r2, r2
 3508 00ba 1A80     		strh	r2, [r3]	@ movhi
 3509              	.L391:
1276:bluetooth_rxtx.c **** 	}
 3510              		.loc 1 1276 0
 3511 00bc 4F29     		cmp	r1, #79
 3512 00be 32D0     		beq	.L384
1276:bluetooth_rxtx.c **** 	}
 3513              		.loc 1 1276 0 is_stmt 0 discriminator 1
 3514 00c0 1A88     		ldrh	r2, [r3]
 3515 00c2 1888     		ldrh	r0, [r3]
 3516 00c4 92B2     		uxth	r2, r2
 3517 00c6 A2F66213 		subw	r3, r2, #2402
 3518 00ca 0822     		movs	r2, #8
 3519 00cc 93FBF2F3 		sdiv	r3, r3, r2
 3520 00d0 314A     		ldr	r2, .L421+24
 3521 00d2 80B2     		uxth	r0, r0
 3522 00d4 D25C     		ldrb	r2, [r2, r3]	@ zero_extendqisi2
 3523 00d6 314B     		ldr	r3, .L421+28
 3524 00d8 A0F66210 		subw	r0, r0, #2402
 3525 00dc 0340     		ands	r3, r3, r0
 3526 00de 002B     		cmp	r3, #0
 3527 00e0 03DA     		bge	.L392
 3528 00e2 013B     		subs	r3, r3, #1
 3529 00e4 63F00703 		orn	r3, r3, #7
 3530 00e8 0133     		adds	r3, r3, #1
 3531              	.L392:
 3532 00ea 42FA03F3 		asr	r3, r2, r3
 3533 00ee D807     		lsls	r0, r3, #31
 3534 00f0 D4D4     		bmi	.L393
 3535 00f2 18E0     		b	.L384
 3536              	.L390:
1279:bluetooth_rxtx.c **** 		channel = next_hop(clkn);
 3537              		.loc 1 1279 0 is_stmt 1
 3538 00f4 A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
 3539 00f6 022A     		cmp	r2, #2
 3540 00f8 05D1     		bne	.L394
1280:bluetooth_rxtx.c **** 	}
 3541              		.loc 1 1280 0
 3542 00fa 1868     		ldr	r0, [r3]
 3543 00fc FFF7FEFF 		bl	next_hop
 3544              	.LVL344:
 3545 0100 224B     		ldr	r3, .L421+12
 3546 0102 1880     		strh	r0, [r3]	@ movhi
 3547 0104 0FE0     		b	.L384
 3548              	.L394:
1283:bluetooth_rxtx.c **** 		channel = btle_next_hop(&le);
 3549              		.loc 1 1283 0
 3550 0106 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3551 0108 032B     		cmp	r3, #3
ARM GAS  /tmp/ccCuKxzC.s 			page 115


 3552 010a 05D1     		bne	.L395
1284:bluetooth_rxtx.c **** 	}
 3553              		.loc 1 1284 0
 3554 010c 1F4D     		ldr	r5, .L421+12
 3555 010e 281D     		adds	r0, r5, #4
 3556 0110 FFF7FEFF 		bl	btle_next_hop
 3557              	.LVL345:
 3558 0114 2880     		strh	r0, [r5]	@ movhi
 3559 0116 06E0     		b	.L384
 3560              	.L395:
1287:bluetooth_rxtx.c **** 		channel = hop_direct_channel;
 3561              		.loc 1 1287 0
 3562 0118 A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3563 011a 042B     		cmp	r3, #4
 3564 011c 03D1     		bne	.L384
1288:bluetooth_rxtx.c **** 	}
 3565              		.loc 1 1288 0
 3566 011e A289     		ldrh	r2, [r4, #12]
 3567 0120 1A4B     		ldr	r3, .L421+12
 3568 0122 92B2     		uxth	r2, r2
 3569 0124 1A80     		strh	r2, [r3]	@ movhi
 3570              	.L384:
1291:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 3571              		.loc 1 1291 0
 3572 0126 6420     		movs	r0, #100
 3573 0128 FFF7FEFF 		bl	cc2400_strobe
 3574              	.LVL346:
 3575              	.L397:
1292:bluetooth_rxtx.c **** 
 3576              		.loc 1 1292 0 discriminator 1
 3577 012c FFF7FEFF 		bl	cc2400_status
 3578              	.LVL347:
 3579 0130 4107     		lsls	r1, r0, #29
 3580 0132 FBD4     		bmi	.L397
 3581 0134 154D     		ldr	r5, .L421+12
1295:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3582              		.loc 1 1295 0
 3583 0136 607C     		ldrb	r0, [r4, #17]	@ zero_extendqisi2
1296:bluetooth_rxtx.c **** 	else
 3584              		.loc 1 1296 0
 3585 0138 2988     		ldrh	r1, [r5]
1295:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channel);
 3586              		.loc 1 1295 0
 3587 013a C0B2     		uxtb	r0, r0
 3588 013c 0228     		cmp	r0, #2
1296:bluetooth_rxtx.c **** 	else
 3589              		.loc 1 1296 0
 3590 013e 89B2     		uxth	r1, r1
1298:bluetooth_rxtx.c **** 
 3591              		.loc 1 1298 0
 3592 0140 1EBF     		ittt	ne
 3593 0142 01F1FF31 		addne	r1, r1, #-1
 3594 0146 0220     		movne	r0, #2
 3595 0148 89B2     		uxthne	r1, r1
 3596 014a FFF7FEFF 		bl	cc2400_set
 3597              	.LVL348:
1301:bluetooth_rxtx.c **** 		cs_threshold_calc_and_set(channel);
ARM GAS  /tmp/ccCuKxzC.s 			page 116


 3598              		.loc 1 1301 0
 3599 014e A37A     		ldrb	r3, [r4, #10]	@ zero_extendqisi2
 3600 0150 1BB1     		cbz	r3, .L400
1302:bluetooth_rxtx.c **** 	}
 3601              		.loc 1 1302 0
 3602 0152 2888     		ldrh	r0, [r5]
 3603 0154 80B2     		uxth	r0, r0
 3604 0156 FFF7FEFF 		bl	cs_threshold_calc_and_set
 3605              	.LVL349:
 3606              	.L400:
1306:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 3607              		.loc 1 1306 0
 3608 015a 6120     		movs	r0, #97
 3609 015c FFF7FEFF 		bl	cc2400_strobe
 3610              	.LVL350:
 3611              	.L402:
1307:bluetooth_rxtx.c **** 
 3612              		.loc 1 1307 0 discriminator 1
 3613 0160 FFF7FEFF 		bl	cc2400_status
 3614              	.LVL351:
 3615 0164 4207     		lsls	r2, r0, #29
 3616 0166 FBD5     		bpl	.L402
1309:bluetooth_rxtx.c **** 
 3617              		.loc 1 1309 0
 3618 0168 0123     		movs	r3, #1
 3619 016a 2374     		strb	r3, [r4, #16]
1311:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 3620              		.loc 1 1311 0
 3621 016c 637C     		ldrb	r3, [r4, #17]	@ zero_extendqisi2
 3622 016e 022B     		cmp	r3, #2
1312:bluetooth_rxtx.c **** 	else
 3623              		.loc 1 1312 0
 3624 0170 0CBF     		ite	eq
 3625 0172 6320     		moveq	r0, #99
1314:bluetooth_rxtx.c **** }
 3626              		.loc 1 1314 0
 3627 0174 6220     		movne	r0, #98
1315:bluetooth_rxtx.c **** 
 3628              		.loc 1 1315 0
 3629 0176 BDE83840 		pop	{r3, r4, r5, lr}
1314:bluetooth_rxtx.c **** }
 3630              		.loc 1 1314 0
 3631 017a FFF7FEBF 		b	cc2400_strobe
 3632              	.LVL352:
 3633              	.L422:
 3634 017e 00BF     		.align	2
 3635              	.L421:
 3636 0180 00000000 		.word	.LANCHOR0
 3637 0184 00000000 		.word	clkn
 3638 0188 00000000 		.word	last_hop
 3639 018c 00000000 		.word	.LANCHOR1
 3640 0190 00000000 		.word	used_channels
 3641 0194 00000000 		.word	afh_enabled
 3642 0198 00000000 		.word	afh_map
 3643 019c 07000080 		.word	-2147483641
 3644              		.cfi_endproc
 3645              	.LFE14:
ARM GAS  /tmp/ccCuKxzC.s 			page 117


 3647              		.section	.text.bt_stream_rx,"ax",%progbits
 3648              		.align	1
 3649              		.global	bt_stream_rx
 3650              		.thumb
 3651              		.thumb_func
 3653              	bt_stream_rx:
 3654              	.LFB15:
1319:bluetooth_rxtx.c **** 	int8_t rssi;
 3655              		.loc 1 1319 0
 3656              		.cfi_startproc
 3657              		@ args = 0, pretend = 0, frame = 0
 3658              		@ frame_needed = 0, uses_anonymous_args = 0
 3659 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 3660              		.cfi_def_cfa_offset 32
 3661              		.cfi_offset 3, -32
 3662              		.cfi_offset 4, -28
 3663              		.cfi_offset 5, -24
 3664              		.cfi_offset 6, -20
 3665              		.cfi_offset 7, -16
 3666              		.cfi_offset 8, -12
 3667              		.cfi_offset 9, -8
 3668              		.cfi_offset 14, -4
1323:bluetooth_rxtx.c **** 
 3669              		.loc 1 1323 0
 3670 0004 494B     		ldr	r3, .L457
 3671 0006 1022     		movs	r2, #16
 3672 0008 1A60     		str	r2, [r3]
1325:bluetooth_rxtx.c **** 	dio_ssp_init();
 3673              		.loc 1 1325 0
 3674 000a FFF7FEFF 		bl	queue_init
 3675              	.LVL353:
1326:bluetooth_rxtx.c **** 	dma_init();
 3676              		.loc 1 1326 0
 3677 000e FFF7FEFF 		bl	dio_ssp_init
 3678              	.LVL354:
1327:bluetooth_rxtx.c **** 	dio_ssp_start();
 3679              		.loc 1 1327 0
 3680 0012 FFF7FEFF 		bl	dma_init
 3681              	.LVL355:
1328:bluetooth_rxtx.c **** 
 3682              		.loc 1 1328 0
 3683 0016 FFF7FEFF 		bl	dio_ssp_start
 3684              	.LVL356:
1330:bluetooth_rxtx.c **** 
 3685              		.loc 1 1330 0
 3686 001a FFF7FEFF 		bl	cc2400_rx
 3687              	.LVL357:
1332:bluetooth_rxtx.c **** 
 3688              		.loc 1 1332 0
 3689 001e FFF7FEFF 		bl	cs_trigger_enable
 3690              	.LVL358:
 3691              	.L424:
1334:bluetooth_rxtx.c **** 	{
 3692              		.loc 1 1334 0 discriminator 1
 3693 0022 434C     		ldr	r4, .L457+4
 3694 0024 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 3695 0026 A146     		mov	r9, r4
ARM GAS  /tmp/ccCuKxzC.s 			page 118


 3696 0028 012B     		cmp	r3, #1
 3697 002a 75D1     		bne	.L455
 3698              	.L436:
1337:bluetooth_rxtx.c **** 
 3699              		.loc 1 1337 0
 3700 002c 3F4B     		ldr	r3, .L457
 3701 002e 1022     		movs	r2, #16
 3702 0030 1A60     		str	r2, [r3]
1349:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 3703              		.loc 1 1349 0
 3704 0032 FFF7FEFF 		bl	rssi_reset
 3705              	.LVL359:
1350:bluetooth_rxtx.c **** 		while (!rx_tc) {
 3706              		.loc 1 1350 0
 3707 0036 8025     		movs	r5, #128
 3708              	.LVL360:
 3709              	.L425:
1351:bluetooth_rxtx.c **** 			rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 3710              		.loc 1 1351 0 discriminator 1
 3711 0038 3E4F     		ldr	r7, .L457+8
 3712 003a 3F4E     		ldr	r6, .L457+12
 3713 003c 3B68     		ldr	r3, [r7]
 3714 003e DFF81881 		ldr	r8, .L457+44
 3715 0042 2BBB     		cbnz	r3, .L456
1352:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 3716              		.loc 1 1352 0
 3717 0044 0620     		movs	r0, #6
 3718 0046 FFF7FEFF 		bl	cc2400_get
 3719              	.LVL361:
1353:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3720              		.loc 1 1353 0
 3721 004a 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
1352:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 3722              		.loc 1 1352 0
 3723 004c C0F30720 		ubfx	r0, r0, #8, #8
 3724              	.LVL362:
1353:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3725              		.loc 1 1353 0
 3726 0050 63B1     		cbz	r3, .L426
1353:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 3727              		.loc 1 1353 0 is_stmt 0 discriminator 1
 3728 0052 6BB2     		sxtb	r3, r5
 3729 0054 8033     		adds	r3, r3, #128
 3730 0056 09D1     		bne	.L426
1354:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 3731              		.loc 1 1354 0 is_stmt 1
 3732 0058 384B     		ldr	r3, .L457+16
 3733 005a 40B2     		sxtb	r0, r0
 3734              	.LVL363:
 3735 005c 93F90050 		ldrsb	r5, [r3]
 3736              	.LVL364:
 3737 0060 3635     		adds	r5, r5, #54
 3738 0062 A842     		cmp	r0, r5
 3739 0064 A8BF     		it	ge
 3740 0066 0546     		movge	r5, r0
 3741 0068 EDB2     		uxtb	r5, r5
1355:bluetooth_rxtx.c **** 			}
ARM GAS  /tmp/ccCuKxzC.s 			page 119


 3742              		.loc 1 1355 0
 3743 006a 2846     		mov	r0, r5
 3744              	.L426:
 3745              	.LVL365:
1357:bluetooth_rxtx.c **** 
 3746              		.loc 1 1357 0
 3747 006c 40B2     		sxtb	r0, r0
 3748              	.LVL366:
 3749 006e FFF7FEFF 		bl	rssi_add
 3750              	.LVL367:
1359:bluetooth_rxtx.c **** 
 3751              		.loc 1 1359 0
 3752 0072 D8F80000 		ldr	r0, [r8]
 3753 0076 FFF7FEFF 		bl	handle_usb
 3754              	.LVL368:
1362:bluetooth_rxtx.c **** 				hop();
 3755              		.loc 1 1362 0
 3756 007a 99F80B30 		ldrb	r3, [r9, #11]	@ zero_extendqisi2
 3757 007e 13B1     		cbz	r3, .L427
1363:bluetooth_rxtx.c **** 			} else {
 3758              		.loc 1 1363 0
 3759 0080 FFF7FEFF 		bl	hop
 3760              	.LVL369:
 3761 0084 D8E7     		b	.L425
 3762              	.L427:
1365:bluetooth_rxtx.c **** 			}
 3763              		.loc 1 1365 0
 3764 0086 294B     		ldr	r3, .L457
 3765 0088 4FF48072 		mov	r2, #256
 3766 008c 1A60     		str	r2, [r3]
 3767 008e D3E7     		b	.L425
 3768              	.L456:
1371:bluetooth_rxtx.c **** 
 3769              		.loc 1 1371 0
 3770 0090 2B4B     		ldr	r3, .L457+20
 3771 0092 1022     		movs	r2, #16
1373:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 3772              		.loc 1 1373 0
 3773 0094 2B4D     		ldr	r5, .L457+24
 3774              	.LVL370:
1371:bluetooth_rxtx.c **** 
 3775              		.loc 1 1371 0
 3776 0096 1A60     		str	r2, [r3]
1373:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 3777              		.loc 1 1373 0
 3778 0098 2B68     		ldr	r3, [r5]
 3779 009a 1BB1     		cbz	r3, .L430
1374:bluetooth_rxtx.c **** 		}
 3780              		.loc 1 1374 0
 3781 009c 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3782 009e 43F00203 		orr	r3, r3, #2
 3783 00a2 6370     		strb	r3, [r4, #1]
 3784              	.L430:
1378:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 3785              		.loc 1 1378 0
 3786 00a4 3B68     		ldr	r3, [r7]
 3787 00a6 012B     		cmp	r3, #1
ARM GAS  /tmp/ccCuKxzC.s 			page 120


 3788 00a8 03D9     		bls	.L431
1379:bluetooth_rxtx.c **** 
 3789              		.loc 1 1379 0
 3790 00aa 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3791 00ac 43F00103 		orr	r3, r3, #1
 3792 00b0 6370     		strb	r3, [r4, #1]
 3793              	.L431:
1381:bluetooth_rxtx.c **** 			status |= DISCARD;
 3794              		.loc 1 1381 0
 3795 00b2 227C     		ldrb	r2, [r4, #16]	@ zero_extendqisi2
 3796 00b4 1E4B     		ldr	r3, .L457+4
 3797 00b6 2AB1     		cbz	r2, .L432
1382:bluetooth_rxtx.c **** 			dma_discard = 0;
 3798              		.loc 1 1382 0
 3799 00b8 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 3800 00ba 42F02002 		orr	r2, r2, #32
 3801 00be 5A70     		strb	r2, [r3, #1]
1383:bluetooth_rxtx.c **** 		}
 3802              		.loc 1 1383 0
 3803 00c0 0022     		movs	r2, #0
 3804 00c2 1A74     		strb	r2, [r3, #16]
 3805              	.L432:
1386:bluetooth_rxtx.c **** 
 3806              		.loc 1 1386 0
 3807 00c4 204B     		ldr	r3, .L457+28
 3808 00c6 1888     		ldrh	r0, [r3]
 3809 00c8 80B2     		uxth	r0, r0
 3810 00ca FFF7FEFF 		bl	rssi_iir_update
 3811              	.LVL371:
1392:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 3812              		.loc 1 1392 0
 3813 00ce 3378     		ldrb	r3, [r6]	@ zero_extendqisi2
 3814 00d0 13B9     		cbnz	r3, .L433
1392:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 3815              		.loc 1 1392 0 is_stmt 0 discriminator 1
 3816 00d2 1E4B     		ldr	r3, .L457+32
 3817 00d4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 3818 00d6 2BB1     		cbz	r3, .L434
 3819              	.L433:
1393:bluetooth_rxtx.c **** 			cs_trigger = 0;
 3820              		.loc 1 1393 0 is_stmt 1
 3821 00d8 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3822 00da 43F00803 		orr	r3, r3, #8
 3823 00de 6370     		strb	r3, [r4, #1]
1394:bluetooth_rxtx.c **** 		}
 3824              		.loc 1 1394 0
 3825 00e0 0023     		movs	r3, #0
 3826 00e2 3370     		strb	r3, [r6]
 3827              	.L434:
1397:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 3828              		.loc 1 1397 0
 3829 00e4 154B     		ldr	r3, .L457+16
 3830 00e6 93F90020 		ldrsb	r2, [r3]
 3831 00ea 194B     		ldr	r3, .L457+36
 3832 00ec 3532     		adds	r2, r2, #53
 3833 00ee 93F90030 		ldrsb	r3, [r3]
 3834 00f2 9A42     		cmp	r2, r3
ARM GAS  /tmp/ccCuKxzC.s 			page 121


 3835 00f4 03DA     		bge	.L435
1398:bluetooth_rxtx.c **** 		}
 3836              		.loc 1 1398 0
 3837 00f6 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 3838 00f8 43F01003 		orr	r3, r3, #16
 3839 00fc 6370     		strb	r3, [r4, #1]
 3840              	.L435:
1401:bluetooth_rxtx.c **** 
 3841              		.loc 1 1401 0
 3842 00fe 154B     		ldr	r3, .L457+40
 3843 0100 0020     		movs	r0, #0
 3844 0102 1968     		ldr	r1, [r3]
 3845 0104 FFF7FEFF 		bl	enqueue
 3846              	.LVL372:
1403:bluetooth_rxtx.c **** 		rx_tc = 0;
 3847              		.loc 1 1403 0
 3848 0108 D8F80000 		ldr	r0, [r8]
 3849 010c FFF7FEFF 		bl	handle_usb
 3850              	.LVL373:
1404:bluetooth_rxtx.c **** 		rx_err = 0;
 3851              		.loc 1 1404 0
 3852 0110 0023     		movs	r3, #0
 3853 0112 3B60     		str	r3, [r7]
1405:bluetooth_rxtx.c **** 	}
 3854              		.loc 1 1405 0
 3855 0114 2B60     		str	r3, [r5]
 3856 0116 84E7     		b	.L424
 3857              	.L455:
1334:bluetooth_rxtx.c **** 	{
 3858              		.loc 1 1334 0 discriminator 2
 3859 0118 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 3860 011a 082B     		cmp	r3, #8
 3861 011c 86D0     		beq	.L436
1412:bluetooth_rxtx.c **** 	cs_trigger_disable();
 3862              		.loc 1 1412 0
 3863 011e FFF7FEFF 		bl	dio_ssp_stop
 3864              	.LVL374:
1414:bluetooth_rxtx.c **** 
 3865              		.loc 1 1414 0
 3866 0122 BDE8F843 		pop	{r3, r4, r5, r6, r7, r8, r9, lr}
1413:bluetooth_rxtx.c **** }
 3867              		.loc 1 1413 0
 3868 0126 FFF7FEBF 		b	cs_trigger_disable
 3869              	.LVL375:
 3870              	.L458:
 3871 012a 00BF     		.align	2
 3872              	.L457:
 3873 012c 3CC00920 		.word	537509948
 3874 0130 00000000 		.word	.LANCHOR0
 3875 0134 00000000 		.word	rx_tc
 3876 0138 00000000 		.word	cs_trigger
 3877 013c 00000000 		.word	cs_threshold_cur
 3878 0140 38C00920 		.word	537509944
 3879 0144 00000000 		.word	rx_err
 3880 0148 00000000 		.word	.LANCHOR1
 3881 014c 00000000 		.word	cs_no_squelch
 3882 0150 00000000 		.word	rssi_max
ARM GAS  /tmp/ccCuKxzC.s 			page 122


 3883 0154 00000000 		.word	idle_rxbuf
 3884 0158 00000000 		.word	clkn
 3885              		.cfi_endproc
 3886              	.LFE15:
 3888              		.section	.text.br_transmit,"ax",%progbits
 3889              		.align	1
 3890              		.global	br_transmit
 3891              		.thumb
 3892              		.thumb_func
 3894              	br_transmit:
 3895              	.LFB18:
1446:bluetooth_rxtx.c **** 	uint16_t gio_save;
 3896              		.loc 1 1446 0
 3897              		.cfi_startproc
 3898              		@ args = 0, pretend = 0, frame = 16
 3899              		@ frame_needed = 0, uses_anonymous_args = 0
 3900 0000 2DE9FF41 		push	{r0, r1, r2, r3, r4, r5, r6, r7, r8, lr}
 3901              		.cfi_def_cfa_offset 40
 3902              		.cfi_offset 0, -40
 3903              		.cfi_offset 1, -36
 3904              		.cfi_offset 2, -32
 3905              		.cfi_offset 3, -28
 3906              		.cfi_offset 4, -24
 3907              		.cfi_offset 5, -20
 3908              		.cfi_offset 6, -16
 3909              		.cfi_offset 7, -12
 3910              		.cfi_offset 8, -8
 3911              		.cfi_offset 14, -4
 3912              	.LVL376:
1451:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 3913              		.loc 1 1451 0
 3914 0004 954B     		ldr	r3, .L495
 3915 0006 0122     		movs	r2, #1
 3916 0008 D3E90245 		ldrd	r4, [r3, #8]
 3917 000c 0023     		movs	r3, #0
 3918 000e 2240     		ands	r2, r2, r4
 3919 0010 2B40     		ands	r3, r3, r5
 3920 0012 52EA0301 		orrs	r1, r2, r3
1452:bluetooth_rxtx.c **** 
 3921              		.loc 1 1452 0
 3922 0016 4FF00007 		mov	r7, #0
1451:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 3923              		.loc 1 1451 0
 3924 001a 45F25553 		movw	r3, #21845
1452:bluetooth_rxtx.c **** 
 3925              		.loc 1 1452 0
 3926 001e 4FEAD576 		lsr	r6, r5, #31
1451:bluetooth_rxtx.c **** 	uint8_t trailer = ((target.syncword >> 63) & 1) == 1 ? 0xaa : 0x55;
 3927              		.loc 1 1451 0
 3928 0022 4AF6AA28 		movw	r8, #43690
 3929 0026 18BF     		it	ne
 3930 0028 9846     		movne	r8, r3
 3931              	.LVL377:
1455:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 3932              		.loc 1 1455 0
 3933 002a E0B2     		uxtb	r0, r4
1452:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccCuKxzC.s 			page 123


 3934              		.loc 1 1452 0
 3935 002c 002F     		cmp	r7, #0
 3936 002e 08BF     		it eq
 3937 0030 012E     		cmpeq	r6, #1
 3938 0032 14BF     		ite	ne
 3939 0034 5526     		movne	r6, #85
 3940 0036 AA26     		moveq	r6, #170
 3941              	.LVL378:
1455:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 8) & 0xFF),
 3942              		.loc 1 1455 0
 3943 0038 FFF7FEFF 		bl	reverse8
 3944              	.LVL379:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3945              		.loc 1 1454 0
 3946 003c 8DF80000 		strb	r0, [sp]
1456:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 16) & 0xFF),
 3947              		.loc 1 1456 0
 3948 0040 C4F30720 		ubfx	r0, r4, #8, #8
 3949 0044 FFF7FEFF 		bl	reverse8
 3950              	.LVL380:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3951              		.loc 1 1454 0
 3952 0048 8DF80100 		strb	r0, [sp, #1]
1457:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 24) & 0xFF),
 3953              		.loc 1 1457 0
 3954 004c C4F30740 		ubfx	r0, r4, #16, #8
 3955 0050 FFF7FEFF 		bl	reverse8
 3956              	.LVL381:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3957              		.loc 1 1454 0
 3958 0054 8DF80200 		strb	r0, [sp, #2]
1458:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 32) & 0xFF),
 3959              		.loc 1 1458 0
 3960 0058 200E     		lsrs	r0, r4, #24
 3961 005a FFF7FEFF 		bl	reverse8
 3962              	.LVL382:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3963              		.loc 1 1454 0
 3964 005e 8DF80300 		strb	r0, [sp, #3]
1459:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 40) & 0xFF),
 3965              		.loc 1 1459 0
 3966 0062 E8B2     		uxtb	r0, r5
 3967 0064 FFF7FEFF 		bl	reverse8
 3968              	.LVL383:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3969              		.loc 1 1454 0
 3970 0068 8DF80400 		strb	r0, [sp, #4]
1460:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 48) & 0xFF),
 3971              		.loc 1 1460 0
 3972 006c C5F30720 		ubfx	r0, r5, #8, #8
 3973 0070 FFF7FEFF 		bl	reverse8
 3974              	.LVL384:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3975              		.loc 1 1454 0
 3976 0074 8DF80500 		strb	r0, [sp, #5]
1461:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 56) & 0xFF),
 3977              		.loc 1 1461 0
ARM GAS  /tmp/ccCuKxzC.s 			page 124


 3978 0078 C5F30740 		ubfx	r0, r5, #16, #8
 3979 007c FFF7FEFF 		bl	reverse8
 3980              	.LVL385:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3981              		.loc 1 1454 0
 3982 0080 8DF80600 		strb	r0, [sp, #6]
1462:bluetooth_rxtx.c **** 		reverse8(trailer),
 3983              		.loc 1 1462 0
 3984 0084 280E     		lsrs	r0, r5, #24
 3985 0086 FFF7FEFF 		bl	reverse8
 3986              	.LVL386:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3987              		.loc 1 1454 0
 3988 008a 8DF80700 		strb	r0, [sp, #7]
1463:bluetooth_rxtx.c **** 		reverse8(0x77),
 3989              		.loc 1 1463 0
 3990 008e 3046     		mov	r0, r6
 3991 0090 FFF7FEFF 		bl	reverse8
 3992              	.LVL387:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3993              		.loc 1 1454 0
 3994 0094 8DF80800 		strb	r0, [sp, #8]
1464:bluetooth_rxtx.c **** 		reverse8(0x66),
 3995              		.loc 1 1464 0
 3996 0098 7720     		movs	r0, #119
 3997 009a FFF7FEFF 		bl	reverse8
 3998              	.LVL388:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 3999              		.loc 1 1454 0
 4000 009e 8DF80900 		strb	r0, [sp, #9]
1465:bluetooth_rxtx.c **** 		reverse8(0x55),
 4001              		.loc 1 1465 0
 4002 00a2 6620     		movs	r0, #102
 4003 00a4 FFF7FEFF 		bl	reverse8
 4004              	.LVL389:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4005              		.loc 1 1454 0
 4006 00a8 8DF80A00 		strb	r0, [sp, #10]
1466:bluetooth_rxtx.c **** 		reverse8(0x44),
 4007              		.loc 1 1466 0
 4008 00ac 5520     		movs	r0, #85
 4009 00ae FFF7FEFF 		bl	reverse8
 4010              	.LVL390:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4011              		.loc 1 1454 0
 4012 00b2 8DF80B00 		strb	r0, [sp, #11]
1467:bluetooth_rxtx.c **** 		reverse8(0x33),
 4013              		.loc 1 1467 0
 4014 00b6 4420     		movs	r0, #68
 4015 00b8 FFF7FEFF 		bl	reverse8
 4016              	.LVL391:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4017              		.loc 1 1454 0
 4018 00bc 8DF80C00 		strb	r0, [sp, #12]
1468:bluetooth_rxtx.c **** 		reverse8(0x22),
 4019              		.loc 1 1468 0
 4020 00c0 3320     		movs	r0, #51
ARM GAS  /tmp/ccCuKxzC.s 			page 125


 4021 00c2 FFF7FEFF 		bl	reverse8
 4022              	.LVL392:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4023              		.loc 1 1454 0
 4024 00c6 8DF80D00 		strb	r0, [sp, #13]
1469:bluetooth_rxtx.c **** 		reverse8(0x11)
 4025              		.loc 1 1469 0
 4026 00ca 2220     		movs	r0, #34
 4027 00cc FFF7FEFF 		bl	reverse8
 4028              	.LVL393:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4029              		.loc 1 1454 0
 4030 00d0 8DF80E00 		strb	r0, [sp, #14]
1470:bluetooth_rxtx.c **** 	};
 4031              		.loc 1 1470 0
 4032 00d4 1120     		movs	r0, #17
 4033 00d6 FFF7FEFF 		bl	reverse8
 4034              	.LVL394:
 4035              	.LBB33:
 4036              	.LBB34:
1430:bluetooth_rxtx.c **** 
 4037              		.loc 1 1430 0
 4038 00da 3C46     		mov	r4, r7
 4039              	.LBE34:
 4040              	.LBE33:
1454:bluetooth_rxtx.c **** 		reverse8((target.syncword >> 0) & 0xFF),
 4041              		.loc 1 1454 0
 4042 00dc 8DF80F00 		strb	r0, [sp, #15]
 4043              	.LVL395:
 4044              	.LBB37:
 4045              	.LBB36:
 4046              	.LBB35:
1432:bluetooth_rxtx.c **** 	{
 4047              		.loc 1 1432 0
 4048 00e0 3B46     		mov	r3, r7
 4049              	.LVL396:
 4050              	.L463:
1434:bluetooth_rxtx.c **** 	}
 4051              		.loc 1 1434 0
 4052 00e2 48FA03F2 		asr	r2, r8, r3
 4053 00e6 C3F10F01 		rsb	r1, r3, #15
 4054 00ea 02F00102 		and	r2, r2, #1
 4055 00ee 8A40     		lsls	r2, r2, r1
1432:bluetooth_rxtx.c **** 	{
 4056              		.loc 1 1432 0
 4057 00f0 0133     		adds	r3, r3, #1
 4058              	.LVL397:
1434:bluetooth_rxtx.c **** 	}
 4059              		.loc 1 1434 0
 4060 00f2 1443     		orrs	r4, r4, r2
 4061              	.LVL398:
1432:bluetooth_rxtx.c **** 	{
 4062              		.loc 1 1432 0
 4063 00f4 102B     		cmp	r3, #16
1434:bluetooth_rxtx.c **** 	}
 4064              		.loc 1 1434 0
 4065 00f6 A4B2     		uxth	r4, r4
ARM GAS  /tmp/ccCuKxzC.s 			page 126


 4066              	.LVL399:
1432:bluetooth_rxtx.c **** 	{
 4067              		.loc 1 1432 0
 4068 00f8 F3D1     		bne	.L463
 4069              	.LVL400:
 4070              	.LBE35:
 4071              	.LBE36:
 4072              	.LBE37:
 4073              	.LBB38:
 4074              	.LBB39:
1047:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);    // LNA and receive mixers test register
 4075              		.loc 1 1047 0
 4076 00fa 0D20     		movs	r0, #13
 4077 00fc 47F6FF71 		movw	r1, #32767
 4078 0100 FFF7FEFF 		bl	cc2400_set
 4079              	.LVL401:
1048:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);    // no PRNG
 4080              		.loc 1 1048 0
 4081 0104 1220     		movs	r0, #18
 4082 0106 42F62231 		movw	r1, #11042
 4083 010a FFF7FEFF 		bl	cc2400_set
 4084              	.LVL402:
1049:bluetooth_rxtx.c **** 
 4085              		.loc 1 1049 0
 4086 010e 1420     		movs	r0, #20
 4087 0110 41F24B31 		movw	r1, #4939
 4088 0114 FFF7FEFF 		bl	cc2400_set
 4089              	.LVL403:
1051:bluetooth_rxtx.c **** 	// 0 00 01 1 000 00 0 00 0 1
 4090              		.loc 1 1051 0
 4091 0118 2020     		movs	r0, #32
 4092 011a 40F60141 		movw	r1, #3073
 4093 011e FFF7FEFF 		bl	cc2400_set
 4094              	.LVL404:
1059:bluetooth_rxtx.c **** 	cc2400_set(SYNCH,   (sync >> 16) & 0xffff);
 4095              		.loc 1 1059 0
 4096 0122 2146     		mov	r1, r4
 4097 0124 2C20     		movs	r0, #44
 4098 0126 FFF7FEFF 		bl	cc2400_set
 4099              	.LVL405:
1060:bluetooth_rxtx.c **** 
 4100              		.loc 1 1060 0
 4101 012a 2D20     		movs	r0, #45
 4102 012c 0021     		movs	r1, #0
 4103 012e FFF7FEFF 		bl	cc2400_set
 4104              	.LVL406:
1062:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 4105              		.loc 1 1062 0
 4106 0132 4B4B     		ldr	r3, .L495+4
 4107 0134 0220     		movs	r0, #2
 4108 0136 1988     		ldrh	r1, [r3]
1065:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 4109              		.loc 1 1065 0
 4110 0138 4A4C     		ldr	r4, .L495+8
 4111              	.LVL407:
1062:bluetooth_rxtx.c **** 	cc2400_set(FREND,   0b1011);    // amplifier level (-7 dBm, picked from hat)
 4112              		.loc 1 1062 0
ARM GAS  /tmp/ccCuKxzC.s 			page 127


 4113 013a 89B2     		uxth	r1, r1
 4114 013c FFF7FEFF 		bl	cc2400_set
 4115              	.LVL408:
1063:bluetooth_rxtx.c **** 
 4116              		.loc 1 1063 0
 4117 0140 0520     		movs	r0, #5
 4118 0142 0B21     		movs	r1, #11
 4119 0144 FFF7FEFF 		bl	cc2400_set
 4120              	.LVL409:
1065:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0029);    // 160 kHz frequency deviation
 4121              		.loc 1 1065 0
 4122 0148 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4123 014a 13B9     		cbnz	r3, .L464
1066:bluetooth_rxtx.c **** 	} else if (modulation == MOD_BT_LOW_ENERGY) {
 4124              		.loc 1 1066 0
 4125 014c 0320     		movs	r0, #3
 4126 014e 2921     		movs	r1, #41
 4127 0150 04E0     		b	.L493
 4128              	.L464:
1067:bluetooth_rxtx.c **** 		cc2400_set(MDMCTRL, 0x0040);    // 250 kHz frequency deviation
 4129              		.loc 1 1067 0
 4130 0152 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 4131 0154 012B     		cmp	r3, #1
 4132 0156 1DD1     		bne	.L466
1068:bluetooth_rxtx.c **** 	} else {
 4133              		.loc 1 1068 0
 4134 0158 0320     		movs	r0, #3
 4135 015a 4021     		movs	r1, #64
 4136              	.L493:
 4137 015c FFF7FEFF 		bl	cc2400_set
 4138              	.LVL410:
1074:bluetooth_rxtx.c **** 
 4139              		.loc 1 1074 0
 4140 0160 FFF7FEFF 		bl	clkn_start
 4141              	.LVL411:
 4142              	.L468:
1076:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 4143              		.loc 1 1076 0
 4144 0164 FFF7FEFF 		bl	cc2400_status
 4145              	.LVL412:
 4146 0168 4506     		lsls	r5, r0, #25
 4147 016a FBD5     		bpl	.L468
1077:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 4148              		.loc 1 1077 0
 4149 016c 6120     		movs	r0, #97
 4150 016e FFF7FEFF 		bl	cc2400_strobe
 4151              	.LVL413:
 4152              	.L470:
1078:bluetooth_rxtx.c **** 
 4153              		.loc 1 1078 0
 4154 0172 FFF7FEFF 		bl	cc2400_status
 4155              	.LVL414:
 4156 0176 4007     		lsls	r0, r0, #29
 4157 0178 FBD5     		bpl	.L470
1081:bluetooth_rxtx.c **** #endif
 4158              		.loc 1 1081 0
 4159 017a 3B4B     		ldr	r3, .L495+12
ARM GAS  /tmp/ccCuKxzC.s 			page 128


 4160 017c 8022     		movs	r2, #128
 4161 017e 1A60     		str	r2, [r3]
 4162              	.L472:
1084:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 4163              		.loc 1 1084 0
 4164 0180 0E20     		movs	r0, #14
 4165 0182 FFF7FEFF 		bl	cc2400_get
 4166              	.LVL415:
 4167 0186 00F01F00 		and	r0, r0, #31
 4168 018a 0F28     		cmp	r0, #15
 4169 018c F8D1     		bne	.L472
1085:bluetooth_rxtx.c **** 
 4170              		.loc 1 1085 0
 4171 018e 6320     		movs	r0, #99
 4172 0190 FFF7FEFF 		bl	cc2400_strobe
 4173              	.LVL416:
 4174              	.L466:
 4175              	.LBE39:
 4176              	.LBE38:
1475:bluetooth_rxtx.c **** 
 4177              		.loc 1 1475 0 discriminator 3
 4178 0194 1421     		movs	r1, #20
 4179 0196 2320     		movs	r0, #35
 4180 0198 FFF7FEFF 		bl	cc2400_set
 4181              	.LVL417:
1478:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4182              		.loc 1 1478 0 discriminator 3
 4183 019c 0820     		movs	r0, #8
 4184 019e FFF7FEFF 		bl	cc2400_get
 4185              	.LVL418:
1479:bluetooth_rxtx.c **** 
 4186              		.loc 1 1479 0 discriminator 3
 4187 01a2 C0F30801 		ubfx	r1, r0, #0, #9
1478:bluetooth_rxtx.c **** 	cc2400_set(IOCFG, (GIO_FIFO_FULL << 9) | (gio_save & 0x1ff));
 4188              		.loc 1 1478 0 discriminator 3
 4189 01a6 0546     		mov	r5, r0
 4190              	.LVL419:
1479:bluetooth_rxtx.c **** 
 4191              		.loc 1 1479 0 discriminator 3
 4192 01a8 41F49C41 		orr	r1, r1, #19968
 4193 01ac 0820     		movs	r0, #8
 4194              	.LVL420:
 4195 01ae FFF7FEFF 		bl	cc2400_set
 4196              	.LVL421:
1449:bluetooth_rxtx.c **** 
 4197              		.loc 1 1449 0 discriminator 3
 4198 01b2 0026     		movs	r6, #0
 4199              	.LVL422:
 4200              	.L473:
1481:bluetooth_rxtx.c **** 	{
 4201              		.loc 1 1481 0 discriminator 1
 4202 01b4 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4203 01b6 022B     		cmp	r3, #2
 4204 01b8 45D1     		bne	.L487
1484:bluetooth_rxtx.c **** 
 4205              		.loc 1 1484 0
 4206 01ba 7608     		lsrs	r6, r6, #1
ARM GAS  /tmp/ccCuKxzC.s 			page 129


 4207              	.LVL423:
 4208              	.L475:
1484:bluetooth_rxtx.c **** 
 4209              		.loc 1 1484 0 is_stmt 0 discriminator 1
 4210 01bc 2B4F     		ldr	r7, .L495+16
 4211 01be 3B68     		ldr	r3, [r7]
 4212 01c0 B6EB530F 		cmp	r6, r3, lsr #1
 4213 01c4 05D1     		bne	.L494
 4214              	.L476:
1487:bluetooth_rxtx.c **** 				hop();
 4215              		.loc 1 1487 0 is_stmt 1
 4216 01c6 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4217 01c8 002B     		cmp	r3, #0
 4218 01ca F7D0     		beq	.L475
1488:bluetooth_rxtx.c **** 			}
 4219              		.loc 1 1488 0
 4220 01cc FFF7FEFF 		bl	hop
 4221              	.LVL424:
 4222 01d0 F4E7     		b	.L475
 4223              	.L494:
1484:bluetooth_rxtx.c **** 
 4224              		.loc 1 1484 0 discriminator 2
 4225 01d2 274B     		ldr	r3, .L495+20
 4226 01d4 1A68     		ldr	r2, [r3]
 4227 01d6 40F6C903 		movw	r3, #2249
 4228 01da 9A42     		cmp	r2, r3
 4229 01dc F3D9     		bls	.L476
1494:bluetooth_rxtx.c **** 
 4230              		.loc 1 1494 0
 4231 01de 254B     		ldr	r3, .L495+24
 4232 01e0 4FF48072 		mov	r2, #256
1492:bluetooth_rxtx.c **** 
 4233              		.loc 1 1492 0
 4234 01e4 3E68     		ldr	r6, [r7]
 4235              	.LVL425:
1496:bluetooth_rxtx.c **** 
 4236              		.loc 1 1496 0
 4237 01e6 1020     		movs	r0, #16
1494:bluetooth_rxtx.c **** 
 4238              		.loc 1 1494 0
 4239 01e8 1A60     		str	r2, [r3]
1496:bluetooth_rxtx.c **** 
 4240              		.loc 1 1496 0
 4241 01ea 6946     		mov	r1, sp
 4242 01ec FFF7FEFF 		bl	cc2400_fifo_write
 4243              	.LVL426:
 4244              	.L478:
1498:bluetooth_rxtx.c **** 		TXLED_CLR;
 4245              		.loc 1 1498 0 discriminator 1
 4246 01f0 0E20     		movs	r0, #14
 4247 01f2 FFF7FEFF 		bl	cc2400_get
 4248              	.LVL427:
 4249 01f6 00F01F00 		and	r0, r0, #31
 4250 01fa 0F28     		cmp	r0, #15
 4251 01fc F8D1     		bne	.L478
1499:bluetooth_rxtx.c **** 
 4252              		.loc 1 1499 0
ARM GAS  /tmp/ccCuKxzC.s 			page 130


 4253 01fe 1E4B     		ldr	r3, .L495+28
 4254 0200 4FF48072 		mov	r2, #256
 4255 0204 1A60     		str	r2, [r3]
1501:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 4256              		.loc 1 1501 0
 4257 0206 6420     		movs	r0, #100
 4258 0208 FFF7FEFF 		bl	cc2400_strobe
 4259              	.LVL428:
 4260              	.L480:
1502:bluetooth_rxtx.c **** 
 4261              		.loc 1 1502 0 discriminator 1
 4262 020c FFF7FEFF 		bl	cc2400_status
 4263              	.LVL429:
 4264 0210 4107     		lsls	r1, r0, #29
 4265 0212 FBD4     		bmi	.L480
 4266              	.L482:
1504:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 4267              		.loc 1 1504 0
 4268 0214 FFF7FEFF 		bl	cc2400_status
 4269              	.LVL430:
 4270 0218 4206     		lsls	r2, r0, #25
 4271 021a FBD5     		bpl	.L482
1505:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
 4272              		.loc 1 1505 0
 4273 021c 6120     		movs	r0, #97
 4274 021e FFF7FEFF 		bl	cc2400_strobe
 4275              	.LVL431:
 4276              	.L484:
1506:bluetooth_rxtx.c **** 
 4277              		.loc 1 1506 0 discriminator 1
 4278 0222 FFF7FEFF 		bl	cc2400_status
 4279              	.LVL432:
 4280 0226 4307     		lsls	r3, r0, #29
 4281 0228 FBD5     		bpl	.L484
 4282              	.L486:
1508:bluetooth_rxtx.c **** 		cc2400_strobe(STX);
 4283              		.loc 1 1508 0
 4284 022a 0E20     		movs	r0, #14
 4285 022c FFF7FEFF 		bl	cc2400_get
 4286              	.LVL433:
 4287 0230 00F01F00 		and	r0, r0, #31
 4288 0234 0F28     		cmp	r0, #15
 4289 0236 F8D1     		bne	.L486
1509:bluetooth_rxtx.c **** 
 4290              		.loc 1 1509 0
 4291 0238 6320     		movs	r0, #99
 4292 023a FFF7FEFF 		bl	cc2400_strobe
 4293              	.LVL434:
1511:bluetooth_rxtx.c **** 	}
 4294              		.loc 1 1511 0
 4295 023e 3868     		ldr	r0, [r7]
 4296 0240 FFF7FEFF 		bl	handle_usb
 4297              	.LVL435:
 4298 0244 B6E7     		b	.L473
 4299              	.L487:
1515:bluetooth_rxtx.c **** #endif
 4300              		.loc 1 1515 0
ARM GAS  /tmp/ccCuKxzC.s 			page 131


 4301 0246 0D4B     		ldr	r3, .L495+32
 4302 0248 8022     		movs	r2, #128
 4303 024a 1A60     		str	r2, [r3]
1519:bluetooth_rxtx.c **** }
 4304              		.loc 1 1519 0
 4305 024c 0820     		movs	r0, #8
 4306 024e 2946     		mov	r1, r5
 4307 0250 FFF7FEFF 		bl	cc2400_set
 4308              	.LVL436:
1520:bluetooth_rxtx.c **** 
 4309              		.loc 1 1520 0
 4310 0254 04B0     		add	sp, sp, #16
 4311              		@ sp needed
 4312 0256 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 4313              	.LVL437:
 4314              	.L496:
 4315 025a 00BF     		.align	2
 4316              	.L495:
 4317 025c 00000000 		.word	target
 4318 0260 00000000 		.word	.LANCHOR1
 4319 0264 00000000 		.word	.LANCHOR0
 4320 0268 58C00920 		.word	537509976
 4321 026c 00000000 		.word	clkn
 4322 0270 08400040 		.word	1073758216
 4323 0274 38C00920 		.word	537509944
 4324 0278 3CC00920 		.word	537509948
 4325 027c 5CC00920 		.word	537509980
 4326              		.cfi_endproc
 4327              	.LFE18:
 4329              		.section	.text.reset_le,"ax",%progbits
 4330              		.align	1
 4331              		.global	reset_le
 4332              		.thumb
 4333              		.thumb_func
 4335              	reset_le:
 4336              	.LFB20:
1533:bluetooth_rxtx.c **** 	le_set_access_address(0x8e89bed6);     // advertising channel access address
 4337              		.loc 1 1533 0
 4338              		.cfi_startproc
 4339              		@ args = 0, pretend = 0, frame = 0
 4340              		@ frame_needed = 0, uses_anonymous_args = 0
 4341 0000 08B5     		push	{r3, lr}
 4342              		.cfi_def_cfa_offset 8
 4343              		.cfi_offset 3, -8
 4344              		.cfi_offset 14, -4
1534:bluetooth_rxtx.c **** 	le.crc_init  = 0x555555;               // advertising channel CRCInit
 4345              		.loc 1 1534 0
 4346 0002 0F48     		ldr	r0, .L498
 4347 0004 FFF7FEFF 		bl	le_set_access_address
 4348              	.LVL438:
1535:bluetooth_rxtx.c **** 	le.crc_init_reversed = 0xAAAAAA;
 4349              		.loc 1 1535 0
 4350 0008 0E4B     		ldr	r3, .L498+4
 4351 000a 0F4A     		ldr	r2, .L498+8
 4352 000c DA60     		str	r2, [r3, #12]
1536:bluetooth_rxtx.c **** 	//JWHUR crc verify on
 4353              		.loc 1 1536 0
ARM GAS  /tmp/ccCuKxzC.s 			page 132


 4354 000e 0F4A     		ldr	r2, .L498+12
 4355 0010 1A61     		str	r2, [r3, #16]
1538:bluetooth_rxtx.c **** 	le.last_packet = 0;
 4356              		.loc 1 1538 0
 4357 0012 0122     		movs	r2, #1
 4358 0014 5A61     		str	r2, [r3, #20]
1539:bluetooth_rxtx.c **** 
 4359              		.loc 1 1539 0
 4360 0016 0022     		movs	r2, #0
1547:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 4361              		.loc 1 1547 0
 4362 0018 1A84     		strh	r2, [r3, #32]	@ movhi
1539:bluetooth_rxtx.c **** 
 4363              		.loc 1 1539 0
 4364 001a 5A64     		str	r2, [r3, #68]
1550:bluetooth_rxtx.c **** 
 4365              		.loc 1 1550 0
 4366 001c 9A84     		strh	r2, [r3, #36]	@ movhi
1541:bluetooth_rxtx.c **** 
 4367              		.loc 1 1541 0
 4368 001e 1A76     		strb	r2, [r3, #24]
1543:bluetooth_rxtx.c **** 	le.channel_increment = 0;
 4369              		.loc 1 1543 0
 4370 0020 5A76     		strb	r2, [r3, #25]
1544:bluetooth_rxtx.c **** 
 4371              		.loc 1 1544 0
 4372 0022 9A76     		strb	r2, [r3, #26]
1546:bluetooth_rxtx.c **** 	le.interval_timer = 0;
 4373              		.loc 1 1546 0
 4374 0024 DA61     		str	r2, [r3, #28]
1548:bluetooth_rxtx.c **** 	le.conn_interval = 0;
 4375              		.loc 1 1548 0
 4376 0026 5A84     		strh	r2, [r3, #34]	@ movhi
1552:bluetooth_rxtx.c **** 	le.win_offset = 0;
 4377              		.loc 1 1552 0
 4378 0028 83F82620 		strb	r2, [r3, #38]
1553:bluetooth_rxtx.c **** 
 4379              		.loc 1 1553 0
 4380 002c 1A85     		strh	r2, [r3, #40]	@ movhi
1555:bluetooth_rxtx.c **** 	le.update_instant = 0;
 4381              		.loc 1 1555 0
 4382 002e DA62     		str	r2, [r3, #44]
1556:bluetooth_rxtx.c **** 	le.interval_update = 0;
 4383              		.loc 1 1556 0
 4384 0030 1A86     		strh	r2, [r3, #48]	@ movhi
1557:bluetooth_rxtx.c **** 	le.win_size_update = 0;
 4385              		.loc 1 1557 0
 4386 0032 5A86     		strh	r2, [r3, #50]	@ movhi
1558:bluetooth_rxtx.c **** 	le.win_offset_update = 0;
 4387              		.loc 1 1558 0
 4388 0034 83F83420 		strb	r2, [r3, #52]
1559:bluetooth_rxtx.c **** 
 4389              		.loc 1 1559 0
 4390 0038 DA86     		strh	r2, [r3, #54]	@ movhi
1561:bluetooth_rxtx.c **** }
 4391              		.loc 1 1561 0
 4392 003a 054B     		ldr	r3, .L498+16
ARM GAS  /tmp/ccCuKxzC.s 			page 133


 4393 003c DA72     		strb	r2, [r3, #11]
 4394 003e 08BD     		pop	{r3, pc}
 4395              	.L499:
 4396              		.align	2
 4397              	.L498:
 4398 0040 D6BE898E 		.word	-1903575338
 4399 0044 00000000 		.word	.LANCHOR1
 4400 0048 55555500 		.word	5592405
 4401 004c AAAAAA00 		.word	11184810
 4402 0050 00000000 		.word	.LANCHOR0
 4403              		.cfi_endproc
 4404              	.LFE20:
 4406              		.section	.text.reset_le_promisc,"ax",%progbits
 4407              		.align	1
 4408              		.global	reset_le_promisc
 4409              		.thumb
 4410              		.thumb_func
 4412              	reset_le_promisc:
 4413              	.LFB21:
1565:bluetooth_rxtx.c **** 	memset(&le_promisc, 0, sizeof(le_promisc));
 4414              		.loc 1 1565 0
 4415              		.cfi_startproc
 4416              		@ args = 0, pretend = 0, frame = 0
 4417              		@ frame_needed = 0, uses_anonymous_args = 0
 4418 0000 10B5     		push	{r4, lr}
 4419              		.cfi_def_cfa_offset 8
 4420              		.cfi_offset 4, -8
 4421              		.cfi_offset 14, -4
1566:bluetooth_rxtx.c **** 	le_promisc.smallest_hop_interval = 0xffffffff;
 4422              		.loc 1 1566 0
 4423 0002 064C     		ldr	r4, .L501
 4424 0004 0021     		movs	r1, #0
 4425 0006 2046     		mov	r0, r4
 4426 0008 4FF48472 		mov	r2, #264
 4427 000c FFF7FEFF 		bl	memset
 4428              	.LVL439:
1567:bluetooth_rxtx.c **** }
 4429              		.loc 1 1567 0
 4430 0010 4FF0FF33 		mov	r3, #-1
 4431 0014 C4F80031 		str	r3, [r4, #256]
 4432 0018 10BD     		pop	{r4, pc}
 4433              	.L502:
 4434 001a 00BF     		.align	2
 4435              	.L501:
 4436 001c 00000000 		.word	le_promisc
 4437              		.cfi_endproc
 4438              	.LFE21:
 4440              		.section	.text.bt_generic_le,"ax",%progbits
 4441              		.align	1
 4442              		.global	bt_generic_le
 4443              		.thumb
 4444              		.thumb_func
 4446              	bt_generic_le:
 4447              	.LFB22:
1572:bluetooth_rxtx.c **** 	u8 hold;
 4448              		.loc 1 1572 0
 4449              		.cfi_startproc
ARM GAS  /tmp/ccCuKxzC.s 			page 134


 4450              		@ args = 0, pretend = 0, frame = 0
 4451              		@ frame_needed = 0, uses_anonymous_args = 0
 4452              	.LVL440:
 4453 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 4454              		.cfi_def_cfa_offset 32
 4455              		.cfi_offset 3, -32
 4456              		.cfi_offset 4, -28
 4457              		.cfi_offset 5, -24
 4458              		.cfi_offset 6, -20
 4459              		.cfi_offset 7, -16
 4460              		.cfi_offset 8, -12
 4461              		.cfi_offset 9, -8
 4462              		.cfi_offset 14, -4
1577:bluetooth_rxtx.c **** 	mode = active_mode;
 4463              		.loc 1 1577 0
 4464 0004 694C     		ldr	r4, .L548
 4465 0006 0123     		movs	r3, #1
1572:bluetooth_rxtx.c **** 	u8 hold;
 4466              		.loc 1 1572 0
 4467 0008 8046     		mov	r8, r0
1577:bluetooth_rxtx.c **** 	mode = active_mode;
 4468              		.loc 1 1577 0
 4469 000a 2370     		strb	r3, [r4]
1578:bluetooth_rxtx.c **** 
 4470              		.loc 1 1578 0
 4471 000c 6074     		strb	r0, [r4, #17]
1580:bluetooth_rxtx.c **** 
 4472              		.loc 1 1580 0
 4473 000e FFF7FEFF 		bl	reset_le
 4474              	.LVL441:
1583:bluetooth_rxtx.c **** 
 4475              		.loc 1 1583 0
 4476 0012 674B     		ldr	r3, .L548+4
 4477 0014 4FF08072 		mov	r2, #16777216
 4478 0018 1A60     		str	r2, [r3]
1585:bluetooth_rxtx.c **** 
 4479              		.loc 1 1585 0
 4480 001a 664B     		ldr	r3, .L548+8
 4481 001c 1022     		movs	r2, #16
 4482 001e 1A60     		str	r2, [r3]
1587:bluetooth_rxtx.c **** 	dio_ssp_init();
 4483              		.loc 1 1587 0
 4484 0020 FFF7FEFF 		bl	queue_init
 4485              	.LVL442:
1588:bluetooth_rxtx.c **** 	dma_init();
 4486              		.loc 1 1588 0
 4487 0024 FFF7FEFF 		bl	dio_ssp_init
 4488              	.LVL443:
1589:bluetooth_rxtx.c **** 	dio_ssp_start();
 4489              		.loc 1 1589 0
 4490 0028 FFF7FEFF 		bl	dma_init
 4491              	.LVL444:
1590:bluetooth_rxtx.c **** 	cc2400_rx();
 4492              		.loc 1 1590 0
 4493 002c FFF7FEFF 		bl	dio_ssp_start
 4494              	.LVL445:
1591:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccCuKxzC.s 			page 135


 4495              		.loc 1 1591 0
 4496 0030 FFF7FEFF 		bl	cc2400_rx
 4497              	.LVL446:
1593:bluetooth_rxtx.c **** 
 4498              		.loc 1 1593 0
 4499 0034 FFF7FEFF 		bl	cs_trigger_enable
 4500              	.LVL447:
1595:bluetooth_rxtx.c **** 
 4501              		.loc 1 1595 0
 4502 0038 0025     		movs	r5, #0
 4503              	.LVL448:
 4504              	.L504:
1597:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 4505              		.loc 1 1597 0 discriminator 1
 4506 003a A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4507 003c 4345     		cmp	r3, r8
 4508 003e 40F0A380 		bne	.L528
 4509              	.LBB40:
1598:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 4510              		.loc 1 1598 0
 4511 0042 5A4B     		ldr	r3, .L548
 4512 0044 DB89     		ldrh	r3, [r3, #14]
 4513 0046 9BB2     		uxth	r3, r3
 4514 0048 D3B1     		cbz	r3, .L505
1599:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 4515              		.loc 1 1599 0
 4516 004a 6420     		movs	r0, #100
 4517 004c FFF7FEFF 		bl	cc2400_strobe
 4518              	.LVL449:
 4519              	.L507:
1600:bluetooth_rxtx.c **** 
 4520              		.loc 1 1600 0 discriminator 1
 4521 0050 FFF7FEFF 		bl	cc2400_status
 4522              	.LVL450:
 4523 0054 4707     		lsls	r7, r0, #29
 4524 0056 FBD4     		bmi	.L507
1603:bluetooth_rxtx.c **** 
 4525              		.loc 1 1603 0
 4526 0058 574B     		ldr	r3, .L548+12
 4527 005a 0220     		movs	r0, #2
 4528 005c 1988     		ldrh	r1, [r3]
 4529 005e 89B2     		uxth	r1, r1
 4530 0060 0139     		subs	r1, r1, #1
 4531 0062 89B2     		uxth	r1, r1
 4532 0064 FFF7FEFF 		bl	cc2400_set
 4533              	.LVL451:
1606:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 4534              		.loc 1 1606 0
 4535 0068 6120     		movs	r0, #97
 4536 006a FFF7FEFF 		bl	cc2400_strobe
 4537              	.LVL452:
 4538              	.L509:
1607:bluetooth_rxtx.c **** 
 4539              		.loc 1 1607 0 discriminator 1
 4540 006e FFF7FEFF 		bl	cc2400_status
 4541              	.LVL453:
 4542 0072 4607     		lsls	r6, r0, #29
ARM GAS  /tmp/ccCuKxzC.s 			page 136


 4543 0074 FBD5     		bpl	.L509
1610:bluetooth_rxtx.c **** 
 4544              		.loc 1 1610 0
 4545 0076 6220     		movs	r0, #98
 4546 0078 FFF7FEFF 		bl	cc2400_strobe
 4547              	.LVL454:
1612:bluetooth_rxtx.c **** 		}
 4548              		.loc 1 1612 0
 4549 007c 0023     		movs	r3, #0
 4550 007e E381     		strh	r3, [r4, #14]	@ movhi
 4551              	.L505:
1615:bluetooth_rxtx.c **** 			hop();
 4552              		.loc 1 1615 0
 4553 0080 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 4554 0082 4C4E     		ldr	r6, .L548+8
 4555 0084 13B1     		cbz	r3, .L510
1616:bluetooth_rxtx.c **** 		} else {
 4556              		.loc 1 1616 0
 4557 0086 FFF7FEFF 		bl	hop
 4558              	.LVL455:
 4559 008a 02E0     		b	.L511
 4560              	.L510:
1618:bluetooth_rxtx.c **** 		}
 4561              		.loc 1 1618 0
 4562 008c 4FF48073 		mov	r3, #256
 4563 0090 3360     		str	r3, [r6]
 4564              	.L511:
1621:bluetooth_rxtx.c **** 
 4565              		.loc 1 1621 0
 4566 0092 1023     		movs	r3, #16
 4567 0094 3360     		str	r3, [r6]
1624:bluetooth_rxtx.c **** 		rssi_at_trigger = INT8_MIN;
 4568              		.loc 1 1624 0
 4569 0096 FFF7FEFF 		bl	rssi_reset
 4570              	.LVL456:
1625:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0))
 4571              		.loc 1 1625 0
 4572 009a 8027     		movs	r7, #128
 4573              	.LVL457:
 4574              	.L512:
1626:bluetooth_rxtx.c **** 		{
 4575              		.loc 1 1626 0 discriminator 1
 4576 009c 474B     		ldr	r3, .L548+16
 4577 009e 484E     		ldr	r6, .L548+20
 4578 00a0 1A68     		ldr	r2, [r3]
 4579 00a2 9946     		mov	r9, r3
 4580 00a4 D2B9     		cbnz	r2, .L514
1626:bluetooth_rxtx.c **** 		{
 4581              		.loc 1 1626 0 is_stmt 0 discriminator 2
 4582 00a6 3368     		ldr	r3, [r6]
 4583 00a8 C3B9     		cbnz	r3, .L514
1628:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4584              		.loc 1 1628 0 is_stmt 1
 4585 00aa 0620     		movs	r0, #6
 4586 00ac FFF7FEFF 		bl	cc2400_get
 4587              	.LVL458:
1629:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
ARM GAS  /tmp/ccCuKxzC.s 			page 137


 4588              		.loc 1 1629 0
 4589 00b0 444B     		ldr	r3, .L548+24
1628:bluetooth_rxtx.c **** 			if (cs_trigger && (rssi_at_trigger == INT8_MIN)) {
 4590              		.loc 1 1628 0
 4591 00b2 C0F30720 		ubfx	r0, r0, #8, #8
 4592              	.LVL459:
1629:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4593              		.loc 1 1629 0
 4594 00b6 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 4595 00b8 63B1     		cbz	r3, .L513
1629:bluetooth_rxtx.c **** 				rssi = MAX(rssi,(cs_threshold_cur+54));
 4596              		.loc 1 1629 0 is_stmt 0 discriminator 1
 4597 00ba 7BB2     		sxtb	r3, r7
 4598 00bc 8033     		adds	r3, r3, #128
 4599 00be 09D1     		bne	.L513
1630:bluetooth_rxtx.c **** 				rssi_at_trigger = rssi;
 4600              		.loc 1 1630 0 is_stmt 1
 4601 00c0 414B     		ldr	r3, .L548+28
 4602 00c2 40B2     		sxtb	r0, r0
 4603              	.LVL460:
 4604 00c4 93F90070 		ldrsb	r7, [r3]
 4605              	.LVL461:
 4606 00c8 3637     		adds	r7, r7, #54
 4607 00ca B842     		cmp	r0, r7
 4608 00cc A8BF     		it	ge
 4609 00ce 0746     		movge	r7, r0
 4610 00d0 FFB2     		uxtb	r7, r7
1631:bluetooth_rxtx.c **** 			}
 4611              		.loc 1 1631 0
 4612 00d2 3846     		mov	r0, r7
 4613              	.L513:
 4614              	.LVL462:
1633:bluetooth_rxtx.c **** 		}
 4615              		.loc 1 1633 0
 4616 00d4 40B2     		sxtb	r0, r0
 4617              	.LVL463:
 4618 00d6 FFF7FEFF 		bl	rssi_add
 4619              	.LVL464:
 4620 00da DFE7     		b	.L512
 4621              	.L514:
1636:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 4622              		.loc 1 1636 0
 4623 00dc 3368     		ldr	r3, [r6]
 4624 00de 1BB1     		cbz	r3, .L516
1637:bluetooth_rxtx.c **** 		}
 4625              		.loc 1 1637 0
 4626 00e0 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4627 00e2 43F00203 		orr	r3, r3, #2
 4628 00e6 6370     		strb	r3, [r4, #1]
 4629              	.L516:
1641:bluetooth_rxtx.c **** 			goto rx_continue;
 4630              		.loc 1 1641 0
 4631 00e8 D9F80030 		ldr	r3, [r9]
 4632 00ec 002B     		cmp	r3, #0
 4633 00ee 57D0     		beq	.L517
1645:bluetooth_rxtx.c **** 			status |= DMA_OVERFLOW;
 4634              		.loc 1 1645 0
ARM GAS  /tmp/ccCuKxzC.s 			page 138


 4635 00f0 324B     		ldr	r3, .L548+16
 4636 00f2 1B68     		ldr	r3, [r3]
 4637 00f4 012B     		cmp	r3, #1
 4638 00f6 03D9     		bls	.L518
1646:bluetooth_rxtx.c **** 
 4639              		.loc 1 1646 0
 4640 00f8 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 4641 00fa 43F00103 		orr	r3, r3, #1
 4642 00fe 6370     		strb	r3, [r4, #1]
 4643              	.L518:
1648:bluetooth_rxtx.c **** 
 4644              		.loc 1 1648 0
 4645 0100 2D4B     		ldr	r3, .L548+12
 4646 0102 1888     		ldrh	r0, [r3]
 4647 0104 80B2     		uxth	r0, r0
 4648 0106 FFF7FEFF 		bl	rssi_iir_update
 4649              	.LVL465:
1654:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4650              		.loc 1 1654 0
 4651 010a 2E4B     		ldr	r3, .L548+24
 4652 010c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 4653 010e 12B9     		cbnz	r2, .L519
1654:bluetooth_rxtx.c **** 			status |= CS_TRIGGER;
 4654              		.loc 1 1654 0 is_stmt 0 discriminator 1
 4655 0110 2E4A     		ldr	r2, .L548+32
 4656 0112 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 4657 0114 32B1     		cbz	r2, .L520
 4658              	.L519:
1655:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4659              		.loc 1 1655 0 is_stmt 1
 4660 0116 6278     		ldrb	r2, [r4, #1]	@ zero_extendqisi2
1656:bluetooth_rxtx.c **** 			cs_trigger = 0;
 4661              		.loc 1 1656 0
 4662 0118 0225     		movs	r5, #2
 4663              	.LVL466:
1655:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4664              		.loc 1 1655 0
 4665 011a 42F00802 		orr	r2, r2, #8
 4666 011e 6270     		strb	r2, [r4, #1]
 4667              	.LVL467:
1657:bluetooth_rxtx.c **** 		}
 4668              		.loc 1 1657 0
 4669 0120 0022     		movs	r2, #0
 4670 0122 1A70     		strb	r2, [r3]
 4671              	.LVL468:
 4672              	.L520:
1660:bluetooth_rxtx.c **** 			status |= RSSI_TRIGGER;
 4673              		.loc 1 1660 0
 4674 0124 284B     		ldr	r3, .L548+28
 4675 0126 93F90020 		ldrsb	r2, [r3]
 4676 012a 294B     		ldr	r3, .L548+36
 4677 012c 3532     		adds	r2, r2, #53
 4678 012e 93F90030 		ldrsb	r3, [r3]
 4679 0132 9A42     		cmp	r2, r3
 4680 0134 05DA     		bge	.L521
1661:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4681              		.loc 1 1661 0
ARM GAS  /tmp/ccCuKxzC.s 			page 139


 4682 0136 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
1662:bluetooth_rxtx.c **** 		}
 4683              		.loc 1 1662 0
 4684 0138 0225     		movs	r5, #2
 4685              	.LVL469:
1661:bluetooth_rxtx.c **** 			hold = CS_HOLD_TIME;
 4686              		.loc 1 1661 0
 4687 013a 43F01003 		orr	r3, r3, #16
 4688 013e 6370     		strb	r3, [r4, #1]
 4689              	.LVL470:
 4690 0140 00E0     		b	.L522
 4691              	.LVL471:
 4692              	.L521:
1666:bluetooth_rxtx.c **** 			goto rx_continue;
 4693              		.loc 1 1666 0
 4694 0142 6DB3     		cbz	r5, .L517
 4695              	.LVL472:
 4696              	.L522:
1672:bluetooth_rxtx.c **** 
 4697              		.loc 1 1672 0
 4698 0144 2348     		ldr	r0, .L548+40
1669:bluetooth_rxtx.c **** 
 4699              		.loc 1 1669 0
 4700 0146 013D     		subs	r5, r5, #1
 4701              	.LVL473:
1672:bluetooth_rxtx.c **** 
 4702              		.loc 1 1672 0
 4703 0148 00F5C871 		add	r1, r0, #400
 4704 014c 4FF4C872 		mov	r2, #400
 4705 0150 FFF7FEFF 		bl	memcpy
 4706              	.LVL474:
1669:bluetooth_rxtx.c **** 
 4707              		.loc 1 1669 0
 4708 0154 EDB2     		uxtb	r5, r5
 4709              	.LVL475:
1675:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 4710              		.loc 1 1675 0
 4711 0156 0023     		movs	r3, #0
 4712              	.LVL476:
 4713              	.L523:
 4714 0158 1F48     		ldr	r0, .L548+44
1662:bluetooth_rxtx.c **** 		}
 4715              		.loc 1 1662 0 discriminator 1
 4716 015a 0022     		movs	r2, #0
 4717 015c 00EBC300 		add	r0, r0, r3, lsl #3
 4718              	.LVL477:
 4719              	.L526:
1678:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4720              		.loc 1 1678 0 discriminator 2
 4721 0160 1E49     		ldr	r1, .L548+48
 4722 0162 0F68     		ldr	r7, [r1]
 4723 0164 FF5C     		ldrb	r7, [r7, r3]	@ zero_extendqisi2
1679:bluetooth_rxtx.c **** 			}
 4724              		.loc 1 1679 0 discriminator 2
 4725 0166 0968     		ldr	r1, [r1]
1678:bluetooth_rxtx.c **** 				idle_rxbuf[i] <<= 1;
 4726              		.loc 1 1678 0 discriminator 2
ARM GAS  /tmp/ccCuKxzC.s 			page 140


 4727 0168 FF09     		lsrs	r7, r7, #7
 4728 016a 8754     		strb	r7, [r0, r2]
1679:bluetooth_rxtx.c **** 			}
 4729              		.loc 1 1679 0 discriminator 2
 4730 016c CF5C     		ldrb	r7, [r1, r3]	@ zero_extendqisi2
1677:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4731              		.loc 1 1677 0 discriminator 2
 4732 016e 0132     		adds	r2, r2, #1
 4733              	.LVL478:
1679:bluetooth_rxtx.c **** 			}
 4734              		.loc 1 1679 0 discriminator 2
 4735 0170 7F00     		lsls	r7, r7, #1
 4736 0172 FFB2     		uxtb	r7, r7
1677:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4737              		.loc 1 1677 0 discriminator 2
 4738 0174 082A     		cmp	r2, #8
1679:bluetooth_rxtx.c **** 			}
 4739              		.loc 1 1679 0 discriminator 2
 4740 0176 CF54     		strb	r7, [r1, r3]
1677:bluetooth_rxtx.c **** 				unpacked[DMA_SIZE*8 + i * 8 + j] = (idle_rxbuf[i] & 0x80) >> 7;
 4741              		.loc 1 1677 0 discriminator 2
 4742 0178 F2D1     		bne	.L526
1675:bluetooth_rxtx.c **** 			/* output one byte for each received symbol (0x00 or 0x01) */
 4743              		.loc 1 1675 0
 4744 017a 0133     		adds	r3, r3, #1
 4745              	.LVL479:
 4746 017c 322B     		cmp	r3, #50
 4747 017e EBD1     		bne	.L523
1683:bluetooth_rxtx.c **** 		if (!ret) break;
 4748              		.loc 1 1683 0
 4749 0180 636A     		ldr	r3, [r4, #36]
 4750              	.LVL480:
 4751 0182 1448     		ldr	r0, .L548+40
 4752 0184 9847     		blx	r3
 4753              	.LVL481:
1684:bluetooth_rxtx.c **** 
 4754              		.loc 1 1684 0
 4755 0186 58B9     		cbnz	r0, .L517
 4756              	.LVL482:
 4757              	.L528:
 4758              	.LBE40:
1692:bluetooth_rxtx.c **** 
 4759              		.loc 1 1692 0
 4760 0188 154B     		ldr	r3, .L548+52
 4761 018a 4FF08072 		mov	r2, #16777216
 4762 018e 1A60     		str	r2, [r3]
1695:bluetooth_rxtx.c **** 	dio_ssp_stop();
 4763              		.loc 1 1695 0
 4764 0190 FFF7FEFF 		bl	cc2400_idle
 4765              	.LVL483:
1696:bluetooth_rxtx.c **** 	cs_trigger_disable();
 4766              		.loc 1 1696 0
 4767 0194 FFF7FEFF 		bl	dio_ssp_stop
 4768              	.LVL484:
1698:bluetooth_rxtx.c **** 
 4769              		.loc 1 1698 0
 4770 0198 BDE8F843 		pop	{r3, r4, r5, r6, r7, r8, r9, lr}
ARM GAS  /tmp/ccCuKxzC.s 			page 141


1697:bluetooth_rxtx.c **** }
 4771              		.loc 1 1697 0
 4772 019c FFF7FEBF 		b	cs_trigger_disable
 4773              	.LVL485:
 4774              	.L517:
 4775              	.LBB41:
1687:bluetooth_rxtx.c **** 		rx_err = 0;
 4776              		.loc 1 1687 0
 4777 01a0 0023     		movs	r3, #0
 4778 01a2 C9F80030 		str	r3, [r9]
1688:bluetooth_rxtx.c **** 	}
 4779              		.loc 1 1688 0
 4780 01a6 3360     		str	r3, [r6]
 4781 01a8 47E7     		b	.L504
 4782              	.L549:
 4783 01aa 00BF     		.align	2
 4784              	.L548:
 4785 01ac 00000000 		.word	.LANCHOR0
 4786 01b0 00E100E0 		.word	-536813312
 4787 01b4 3CC00920 		.word	537509948
 4788 01b8 00000000 		.word	.LANCHOR1
 4789 01bc 00000000 		.word	rx_tc
 4790 01c0 00000000 		.word	rx_err
 4791 01c4 00000000 		.word	cs_trigger
 4792 01c8 00000000 		.word	cs_threshold_cur
 4793 01cc 00000000 		.word	cs_no_squelch
 4794 01d0 00000000 		.word	rssi_max
 4795 01d4 00000000 		.word	unpacked
 4796 01d8 90010000 		.word	unpacked+400
 4797 01dc 00000000 		.word	idle_rxbuf
 4798 01e0 80E100E0 		.word	-536813184
 4799              	.LBE41:
 4800              		.cfi_endproc
 4801              	.LFE22:
 4803              		.section	.text.bt_le_sync_rssi,"ax",%progbits
 4804              		.align	1
 4805              		.global	bt_le_sync_rssi
 4806              		.thumb
 4807              		.thumb_func
 4809              	bt_le_sync_rssi:
 4810              	.LFB23:
1702:bluetooth_rxtx.c **** 	int i;
 4811              		.loc 1 1702 0
 4812              		.cfi_startproc
 4813              		@ args = 0, pretend = 0, frame = 312
 4814              		@ frame_needed = 0, uses_anonymous_args = 0
 4815              	.LVL486:
 4816 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 4817              		.cfi_def_cfa_offset 36
 4818              		.cfi_offset 4, -36
 4819              		.cfi_offset 5, -32
 4820              		.cfi_offset 6, -28
 4821              		.cfi_offset 7, -24
 4822              		.cfi_offset 8, -20
 4823              		.cfi_offset 9, -16
 4824              		.cfi_offset 10, -12
 4825              		.cfi_offset 11, -8
ARM GAS  /tmp/ccCuKxzC.s 			page 142


 4826              		.cfi_offset 14, -4
 4827 0004 CFB0     		sub	sp, sp, #316
 4828              		.cfi_def_cfa_offset 352
1709:bluetooth_rxtx.c **** 		start_sync -= ((uint32_t)1<<28);
 4829              		.loc 1 1709 0
 4830 0006 894C     		ldr	r4, .L576
1707:bluetooth_rxtx.c **** 
 4831              		.loc 1 1707 0
 4832 0008 0DF10408 		add	r8, sp, #4
1702:bluetooth_rxtx.c **** 	int i;
 4833              		.loc 1 1702 0
 4834 000c 0746     		mov	r7, r0
1707:bluetooth_rxtx.c **** 
 4835              		.loc 1 1707 0
 4836 000e 0021     		movs	r1, #0
 4837 0010 4046     		mov	r0, r8
 4838              	.LVL487:
 4839 0012 3222     		movs	r2, #50
 4840 0014 FFF7FEFF 		bl	memset
 4841              	.LVL488:
1709:bluetooth_rxtx.c **** 		start_sync -= ((uint32_t)1<<28);
 4842              		.loc 1 1709 0
 4843 0018 A36A     		ldr	r3, [r4, #40]
 4844 001a 854D     		ldr	r5, .L576+4
 4845 001c B3F1805F 		cmp	r3, #268435456
 4846 0020 36D3     		bcc	.L556
1710:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) >= now_sync || (clkn & 0xffffff) < start_sync);
 4847              		.loc 1 1710 0
 4848 0022 03F17043 		add	r3, r3, #-268435456
1711:bluetooth_rxtx.c **** 	} else {
 4849              		.loc 1 1711 0
 4850 0026 E16A     		ldr	r1, [r4, #44]
1710:bluetooth_rxtx.c **** 		while ((clkn & 0xffffff) >= now_sync || (clkn & 0xffffff) < start_sync);
 4851              		.loc 1 1710 0
 4852 0028 A362     		str	r3, [r4, #40]
 4853              	.L552:
1711:bluetooth_rxtx.c **** 	} else {
 4854              		.loc 1 1711 0 discriminator 1
 4855 002a 2A68     		ldr	r2, [r5]
 4856 002c 22F07F42 		bic	r2, r2, #-16777216
 4857 0030 8A42     		cmp	r2, r1
 4858 0032 FAD2     		bcs	.L552
1711:bluetooth_rxtx.c **** 	} else {
 4859              		.loc 1 1711 0 is_stmt 0 discriminator 2
 4860 0034 7E4A     		ldr	r2, .L576+4
 4861 0036 1268     		ldr	r2, [r2]
 4862 0038 22F07F42 		bic	r2, r2, #-16777216
 4863 003c 9A42     		cmp	r2, r3
 4864 003e F4D3     		bcc	.L552
 4865              	.L555:
1717:bluetooth_rxtx.c **** 	uint32_t stop_at = now + 3000 * 10000 / 3125; // millis -> clkn ticks
 4866              		.loc 1 1717 0 is_stmt 1
 4867 0040 2B68     		ldr	r3, [r5]
 4868              	.LVL489:
1730:bluetooth_rxtx.c **** 
 4869              		.loc 1 1730 0
 4870 0042 7C4E     		ldr	r6, .L576+8
ARM GAS  /tmp/ccCuKxzC.s 			page 143


1717:bluetooth_rxtx.c **** 	uint32_t stop_at = now + 3000 * 10000 / 3125; // millis -> clkn ticks
 4871              		.loc 1 1717 0
 4872 0044 23F07F4A 		bic	r10, r3, #-16777216
 4873              	.LVL490:
1732:bluetooth_rxtx.c **** 	RXLED_CLR;
 4874              		.loc 1 1732 0
 4875 0048 7B4B     		ldr	r3, .L576+12
1726:bluetooth_rxtx.c **** 	requested_mode = active_mode;
 4876              		.loc 1 1726 0
 4877 004a 4FF00109 		mov	r9, #1
1732:bluetooth_rxtx.c **** 	RXLED_CLR;
 4878              		.loc 1 1732 0
 4879 004e 4FF08072 		mov	r2, #16777216
1726:bluetooth_rxtx.c **** 	requested_mode = active_mode;
 4880              		.loc 1 1726 0
 4881 0052 84F80090 		strb	r9, [r4]
1730:bluetooth_rxtx.c **** 
 4882              		.loc 1 1730 0
 4883 0056 86F81890 		strb	r9, [r6, #24]
1727:bluetooth_rxtx.c **** 	mode = active_mode;
 4884              		.loc 1 1727 0
 4885 005a A774     		strb	r7, [r4, #18]
1728:bluetooth_rxtx.c **** 
 4886              		.loc 1 1728 0
 4887 005c 6774     		strb	r7, [r4, #17]
1732:bluetooth_rxtx.c **** 	RXLED_CLR;
 4888              		.loc 1 1732 0
 4889 005e 1A60     		str	r2, [r3]
1733:bluetooth_rxtx.c **** 	queue_init();
 4890              		.loc 1 1733 0
 4891 0060 764B     		ldr	r3, .L576+16
 4892 0062 1022     		movs	r2, #16
 4893 0064 1A60     		str	r2, [r3]
1734:bluetooth_rxtx.c **** 	dio_ssp_init();
 4894              		.loc 1 1734 0
 4895 0066 FFF7FEFF 		bl	queue_init
 4896              	.LVL491:
1735:bluetooth_rxtx.c **** 	dma_init_le();
 4897              		.loc 1 1735 0
 4898 006a FFF7FEFF 		bl	dio_ssp_init
 4899              	.LVL492:
1736:bluetooth_rxtx.c **** 	dio_ssp_start();
 4900              		.loc 1 1736 0
 4901 006e FFF7FEFF 		bl	dma_init_le
 4902              	.LVL493:
1737:bluetooth_rxtx.c **** 
 4903              		.loc 1 1737 0
 4904 0072 FFF7FEFF 		bl	dio_ssp_start
 4905              	.LVL494:
1739:bluetooth_rxtx.c **** 
 4906              		.loc 1 1739 0
 4907 0076 7068     		ldr	r0, [r6, #4]
 4908 0078 FFF7FEFF 		bl	rbit
 4909              	.LVL495:
 4910 007c FFF7FEFF 		bl	cc2400_rx_sync
 4911              	.LVL496:
1742:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
ARM GAS  /tmp/ccCuKxzC.s 			page 144


 4912              		.loc 1 1742 0
 4913 0080 40F69E13 		movw	r3, #2462
1741:bluetooth_rxtx.c **** 	channel = 2462;
 4914              		.loc 1 1741 0
 4915 0084 A4F80E90 		strh	r9, [r4, #14]	@ movhi
1718:bluetooth_rxtx.c **** 	int overflow = 0;
 4916              		.loc 1 1718 0
 4917 0088 0AF5165A 		add	r10, r10, #9600
 4918              	.LVL497:
1742:bluetooth_rxtx.c **** 	while (requested_mode == active_mode) {
 4919              		.loc 1 1742 0
 4920 008c 3380     		strh	r3, [r6]	@ movhi
1743:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 4921              		.loc 1 1743 0
 4922 008e ABE0     		b	.L554
 4923              	.LVL498:
 4924              	.L556:
1713:bluetooth_rxtx.c **** 	}
 4925              		.loc 1 1713 0
 4926 0090 2A68     		ldr	r2, [r5]
 4927 0092 22F07F42 		bic	r2, r2, #-16777216
 4928 0096 9A42     		cmp	r2, r3
 4929 0098 FAD3     		bcc	.L556
 4930 009a D1E7     		b	.L555
 4931              	.LVL499:
 4932              	.L572:
 4933              	.LBB42:
1744:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 4934              		.loc 1 1744 0
 4935 009c 634B     		ldr	r3, .L576
 4936 009e DB89     		ldrh	r3, [r3, #14]
 4937 00a0 9BB2     		uxth	r3, r3
 4938 00a2 C3B1     		cbz	r3, .L557
1745:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 4939              		.loc 1 1745 0
 4940 00a4 6420     		movs	r0, #100
 4941 00a6 FFF7FEFF 		bl	cc2400_strobe
 4942              	.LVL500:
 4943              	.L559:
1746:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel);
 4944              		.loc 1 1746 0 discriminator 1
 4945 00aa FFF7FEFF 		bl	cc2400_status
 4946              	.LVL501:
 4947 00ae 4207     		lsls	r2, r0, #29
 4948 00b0 FBD4     		bmi	.L559
1747:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 4949              		.loc 1 1747 0
 4950 00b2 604B     		ldr	r3, .L576+8
 4951 00b4 0220     		movs	r0, #2
 4952 00b6 1988     		ldrh	r1, [r3]
 4953 00b8 89B2     		uxth	r1, r1
 4954 00ba FFF7FEFF 		bl	cc2400_set
 4955              	.LVL502:
1748:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 4956              		.loc 1 1748 0
 4957 00be 6120     		movs	r0, #97
 4958 00c0 FFF7FEFF 		bl	cc2400_strobe
ARM GAS  /tmp/ccCuKxzC.s 			page 145


 4959              	.LVL503:
 4960              	.L561:
1749:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 4961              		.loc 1 1749 0 discriminator 1
 4962 00c4 FFF7FEFF 		bl	cc2400_status
 4963              	.LVL504:
 4964 00c8 4307     		lsls	r3, r0, #29
 4965 00ca FBD5     		bpl	.L561
1750:bluetooth_rxtx.c **** 			requested_channel = 0;
 4966              		.loc 1 1750 0
 4967 00cc 6220     		movs	r0, #98
 4968 00ce FFF7FEFF 		bl	cc2400_strobe
 4969              	.LVL505:
1751:bluetooth_rxtx.c **** 		}
 4970              		.loc 1 1751 0
 4971 00d2 0023     		movs	r3, #0
 4972 00d4 E381     		strh	r3, [r4, #14]	@ movhi
 4973              	.L557:
1753:bluetooth_rxtx.c **** 		if (requested_mode != active_mode) {
 4974              		.loc 1 1753 0
 4975 00d6 594B     		ldr	r3, .L576+16
 4976 00d8 1022     		movs	r2, #16
 4977 00da 1A60     		str	r2, [r3]
1754:bluetooth_rxtx.c **** 			goto cleanup;
 4978              		.loc 1 1754 0
 4979 00dc A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 4980 00de BB42     		cmp	r3, r7
 4981 00e0 40F09780 		bne	.L571
1759:bluetooth_rxtx.c **** 		u32 time_buf2[16] = {0, };
 4982              		.loc 1 1759 0
 4983 00e4 0DF13809 		add	r9, sp, #56
 4984 00e8 0021     		movs	r1, #0
 4985 00ea 4022     		movs	r2, #64
 4986 00ec 4846     		mov	r0, r9
 4987 00ee FFF7FEFF 		bl	memset
 4988              	.LVL506:
1760:bluetooth_rxtx.c **** 		u32 time_buf3[16] = {0, };
 4989              		.loc 1 1760 0
 4990 00f2 0021     		movs	r1, #0
 4991 00f4 4022     		movs	r2, #64
 4992 00f6 1EA8     		add	r0, sp, #120
 4993 00f8 FFF7FEFF 		bl	memset
 4994              	.LVL507:
1761:bluetooth_rxtx.c **** 		u32 time_buf4[16] = {0, };
 4995              		.loc 1 1761 0
 4996 00fc 0021     		movs	r1, #0
 4997 00fe 4022     		movs	r2, #64
 4998 0100 2EA8     		add	r0, sp, #184
 4999 0102 FFF7FEFF 		bl	memset
 5000              	.LVL508:
1762:bluetooth_rxtx.c **** 		for (i = 0; i < DMA_SIZE; i++) {
 5001              		.loc 1 1762 0
 5002 0106 3EA8     		add	r0, sp, #248
 5003 0108 0021     		movs	r1, #0
 5004 010a 4022     		movs	r2, #64
 5005 010c FFF7FEFF 		bl	memset
 5006              	.LVL509:
ARM GAS  /tmp/ccCuKxzC.s 			page 146


 5007 0110 4FF0000B 		mov	fp, #0
1763:bluetooth_rxtx.c **** 			if (i<16) time_buf1[i] = CLK100NS;
 5008              		.loc 1 1763 0
 5009 0114 5E46     		mov	r6, fp
 5010              	.LVL510:
 5011              	.L570:
 5012              	.LBB43:
1764:bluetooth_rxtx.c **** 			if (15<i && i<32) time_buf2[i-16] = CLK100NS;
 5013              		.loc 1 1764 0
 5014 0116 0F2E     		cmp	r6, #15
 5015 0118 0ADC     		bgt	.L563
1764:bluetooth_rxtx.c **** 			if (15<i && i<32) time_buf2[i-16] = CLK100NS;
 5016              		.loc 1 1764 0 is_stmt 0 discriminator 1
 5017 011a 4949     		ldr	r1, .L576+20
 5018 011c 2A68     		ldr	r2, [r5]
 5019 011e 0968     		ldr	r1, [r1]
 5020 0120 C2F31302 		ubfx	r2, r2, #0, #20
 5021 0124 40F63540 		movw	r0, #3125
 5022 0128 00FB0212 		mla	r2, r0, r2, r1
 5023 012c 49F80B20 		str	r2, [r9, fp]
 5024              	.L563:
 5025 0130 A6F11002 		sub	r2, r6, #16
1765:bluetooth_rxtx.c **** 			if (31<i && i<48) time_buf3[i-32] = CLK100NS;
 5026              		.loc 1 1765 0 is_stmt 1
 5027 0134 0F2A     		cmp	r2, #15
 5028 0136 0CD8     		bhi	.L564
1765:bluetooth_rxtx.c **** 			if (31<i && i<48) time_buf3[i-32] = CLK100NS;
 5029              		.loc 1 1765 0 is_stmt 0 discriminator 1
 5030 0138 414A     		ldr	r2, .L576+20
 5031 013a 2968     		ldr	r1, [r5]
 5032 013c 1068     		ldr	r0, [r2]
 5033 013e C1F31301 		ubfx	r1, r1, #0, #20
 5034 0142 40F6354E 		movw	lr, #3125
 5035 0146 0EFB0101 		mla	r1, lr, r1, r0
 5036 014a 1EAA     		add	r2, sp, #120
 5037 014c 5A44     		add	r2, r2, fp
 5038 014e 42F8401C 		str	r1, [r2, #-64]
 5039              	.L564:
 5040 0152 A6F12002 		sub	r2, r6, #32
1766:bluetooth_rxtx.c **** 			if (47<i) time_buf4[i-48] = CLK100NS;
 5041              		.loc 1 1766 0 is_stmt 1
 5042 0156 0F2A     		cmp	r2, #15
 5043 0158 4BD8     		bhi	.L565
1766:bluetooth_rxtx.c **** 			if (47<i) time_buf4[i-48] = CLK100NS;
 5044              		.loc 1 1766 0 is_stmt 0 discriminator 1
 5045 015a 394A     		ldr	r2, .L576+20
 5046 015c 2968     		ldr	r1, [r5]
 5047 015e 1068     		ldr	r0, [r2]
 5048 0160 C1F31301 		ubfx	r1, r1, #0, #20
 5049 0164 40F6354E 		movw	lr, #3125
 5050 0168 0EFB0101 		mla	r1, lr, r1, r0
 5051 016c 2EAA     		add	r2, sp, #184
 5052 016e 5A44     		add	r2, r2, fp
 5053 0170 42F8801C 		str	r1, [r2, #-128]
 5054              	.L566:
1768:bluetooth_rxtx.c **** 			//rssi_buf[i] = (u8)(cc2400_get_rev(FREQEST));
 5055              		.loc 1 1768 0 is_stmt 1
ARM GAS  /tmp/ccCuKxzC.s 			page 147


 5056 0174 0620     		movs	r0, #6
 5057 0176 FFF7FEFF 		bl	cc2400_get
 5058              	.LVL511:
1770:bluetooth_rxtx.c **** 		}
 5059              		.loc 1 1770 0
 5060 017a 40F22252 		movw	r2, #1314
1768:bluetooth_rxtx.c **** 			//rssi_buf[i] = (u8)(cc2400_get_rev(FREQEST));
 5061              		.loc 1 1768 0
 5062 017e 000A     		lsrs	r0, r0, #8
 5063 0180 08F80600 		strb	r0, [r8, r6]
1770:bluetooth_rxtx.c **** 		}
 5064              		.loc 1 1770 0
 5065 0184 0092     		str	r2, [sp]
 5066              	.L568:
1770:bluetooth_rxtx.c **** 		}
 5067              		.loc 1 1770 0 is_stmt 0 discriminator 1
 5068 0186 009A     		ldr	r2, [sp]
 5069 0188 013A     		subs	r2, r2, #1
 5070 018a 0092     		str	r2, [sp]
 5071 018c 002A     		cmp	r2, #0
 5072 018e FAD1     		bne	.L568
 5073              	.LBE43:
1763:bluetooth_rxtx.c **** 			if (i<16) time_buf1[i] = CLK100NS;
 5074              		.loc 1 1763 0 is_stmt 1
 5075 0190 0136     		adds	r6, r6, #1
 5076              	.LVL512:
 5077 0192 322E     		cmp	r6, #50
 5078 0194 0BF1040B 		add	fp, fp, #4
 5079 0198 BDD1     		bne	.L570
1773:bluetooth_rxtx.c **** 
 5080              		.loc 1 1773 0
 5081 019a 2A4B     		ldr	r3, .L576+24
 5082 019c 1022     		movs	r2, #16
 5083 019e 1A60     		str	r2, [r3]
1775:bluetooth_rxtx.c **** 		enqueue_with_ts(RSSI_TRACK, (uint8_t *)rssi_buf, CLK100NS);
 5084              		.loc 1 1775 0
 5085 01a0 294B     		ldr	r3, .L576+28
 5086 01a2 4FF08076 		mov	r6, #16777216
 5087              	.LVL513:
 5088 01a6 1E60     		str	r6, [r3]
1776:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf1);
 5089              		.loc 1 1776 0
 5090 01a8 254B     		ldr	r3, .L576+20
 5091 01aa 2A68     		ldr	r2, [r5]
 5092 01ac 1B68     		ldr	r3, [r3]
 5093 01ae 40F6354E 		movw	lr, #3125
 5094 01b2 C2F31302 		ubfx	r2, r2, #0, #20
 5095 01b6 0EFB0232 		mla	r2, lr, r2, r3
 5096 01ba 4146     		mov	r1, r8
 5097 01bc 0820     		movs	r0, #8
 5098 01be FFF7FEFF 		bl	enqueue_with_ts
 5099              	.LVL514:
1777:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf2);
 5100              		.loc 1 1777 0
 5101 01c2 4846     		mov	r0, r9
 5102 01c4 FFF7FEFF 		bl	enqueue_time
 5103              	.LVL515:
ARM GAS  /tmp/ccCuKxzC.s 			page 148


1778:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf3);
 5104              		.loc 1 1778 0
 5105 01c8 1EA8     		add	r0, sp, #120
 5106 01ca FFF7FEFF 		bl	enqueue_time
 5107              	.LVL516:
1779:bluetooth_rxtx.c **** 		enqueue_time((uint8_t *) time_buf4);
 5108              		.loc 1 1779 0
 5109 01ce 2EA8     		add	r0, sp, #184
 5110 01d0 FFF7FEFF 		bl	enqueue_time
 5111              	.LVL517:
1780:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 5112              		.loc 1 1780 0
 5113 01d4 3EA8     		add	r0, sp, #248
 5114 01d6 FFF7FEFF 		bl	enqueue_time
 5115              	.LVL518:
1781:bluetooth_rxtx.c **** 	
 5116              		.loc 1 1781 0
 5117 01da 174B     		ldr	r3, .L576+12
 5118 01dc 1E60     		str	r6, [r3]
1784:bluetooth_rxtx.c **** 				goto cleanup;
 5119              		.loc 1 1784 0
 5120 01de 2B68     		ldr	r3, [r5]
 5121 01e0 23F07F43 		bic	r3, r3, #-16777216
 5122 01e4 5345     		cmp	r3, r10
 5123 01e6 14D8     		bhi	.L571
 5124              	.L554:
 5125              	.LBE42:
1743:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 5126              		.loc 1 1743 0 discriminator 1
 5127 01e8 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 5128 01ea BB42     		cmp	r3, r7
 5129 01ec 3FF456AF 		beq	.L572
 5130 01f0 0FE0     		b	.L571
 5131              	.LVL519:
 5132              	.L565:
 5133              	.LBB45:
 5134              	.LBB44:
1767:bluetooth_rxtx.c **** 			rssi_buf[i] = (u8)(cc2400_get(RSSI) >> 8);
 5135              		.loc 1 1767 0
 5136 01f2 2F2E     		cmp	r6, #47
 5137 01f4 BEDD     		ble	.L566
1767:bluetooth_rxtx.c **** 			rssi_buf[i] = (u8)(cc2400_get(RSSI) >> 8);
 5138              		.loc 1 1767 0 is_stmt 0 discriminator 1
 5139 01f6 124A     		ldr	r2, .L576+20
 5140 01f8 2968     		ldr	r1, [r5]
 5141 01fa 1068     		ldr	r0, [r2]
 5142 01fc C1F31301 		ubfx	r1, r1, #0, #20
 5143 0200 40F6354E 		movw	lr, #3125
 5144 0204 0EFB0101 		mla	r1, lr, r1, r0
 5145 0208 3EAA     		add	r2, sp, #248
 5146 020a 5A44     		add	r2, r2, fp
 5147 020c 42F8C01C 		str	r1, [r2, #-192]
 5148 0210 B0E7     		b	.L566
 5149              	.LVL520:
 5150              	.L571:
 5151              	.LBE44:
 5152              	.LBE45:
ARM GAS  /tmp/ccCuKxzC.s 			page 149


1793:bluetooth_rxtx.c **** 	cc2400_idle();
 5153              		.loc 1 1793 0 is_stmt 1
 5154 0212 0D4B     		ldr	r3, .L576+28
 5155 0214 4FF08072 		mov	r2, #16777216
 5156 0218 1A60     		str	r2, [r3]
1794:bluetooth_rxtx.c **** 	dio_ssp_stop ();
 5157              		.loc 1 1794 0
 5158 021a FFF7FEFF 		bl	cc2400_idle
 5159              	.LVL521:
1795:bluetooth_rxtx.c **** 	cs_trigger_disable();
 5160              		.loc 1 1795 0
 5161 021e FFF7FEFF 		bl	dio_ssp_stop
 5162              	.LVL522:
1796:bluetooth_rxtx.c **** }
 5163              		.loc 1 1796 0
 5164 0222 FFF7FEFF 		bl	cs_trigger_disable
 5165              	.LVL523:
1797:bluetooth_rxtx.c **** 
 5166              		.loc 1 1797 0
 5167 0226 4FB0     		add	sp, sp, #316
 5168              		@ sp needed
 5169 0228 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 5170              	.LVL524:
 5171              	.L577:
 5172              		.align	2
 5173              	.L576:
 5174 022c 00000000 		.word	.LANCHOR0
 5175 0230 00000000 		.word	clkn
 5176 0234 00000000 		.word	.LANCHOR1
 5177 0238 00E100E0 		.word	-536813312
 5178 023c 3CC00920 		.word	537509948
 5179 0240 08400040 		.word	1073758216
 5180 0244 38C00920 		.word	537509944
 5181 0248 80E100E0 		.word	-536813184
 5182              		.cfi_endproc
 5183              	.LFE23:
 5185              		.section	.text.bt_le_sync,"ax",%progbits
 5186              		.align	1
 5187              		.global	bt_le_sync
 5188              		.thumb
 5189              		.thumb_func
 5191              	bt_le_sync:
 5192              	.LFB24:
1801:bluetooth_rxtx.c **** 	int i;
 5193              		.loc 1 1801 0
 5194              		.cfi_startproc
 5195              		@ args = 0, pretend = 0, frame = 64
 5196              		@ frame_needed = 0, uses_anonymous_args = 0
 5197              	.LVL525:
 5198 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 5199              		.cfi_def_cfa_offset 36
 5200              		.cfi_offset 4, -36
 5201              		.cfi_offset 5, -32
 5202              		.cfi_offset 6, -28
 5203              		.cfi_offset 7, -24
 5204              		.cfi_offset 8, -20
 5205              		.cfi_offset 9, -16
ARM GAS  /tmp/ccCuKxzC.s 			page 150


 5206              		.cfi_offset 10, -12
 5207              		.cfi_offset 11, -8
 5208              		.cfi_offset 14, -4
 5209 0004 91B0     		sub	sp, sp, #68
 5210              		.cfi_def_cfa_offset 104
 5211              	.LVL526:
1807:bluetooth_rxtx.c **** 	mode = active_mode;
 5212              		.loc 1 1807 0
 5213 0006 A74C     		ldr	r4, .L645
1810:bluetooth_rxtx.c **** 
 5214              		.loc 1 1810 0
 5215 0008 A74D     		ldr	r5, .L645+4
1807:bluetooth_rxtx.c **** 	mode = active_mode;
 5216              		.loc 1 1807 0
 5217 000a 0123     		movs	r3, #1
 5218 000c 2370     		strb	r3, [r4]
1810:bluetooth_rxtx.c **** 
 5219              		.loc 1 1810 0
 5220 000e 2B76     		strb	r3, [r5, #24]
1813:bluetooth_rxtx.c **** 
 5221              		.loc 1 1813 0
 5222 0010 A64B     		ldr	r3, .L645+8
 5223 0012 4FF08072 		mov	r2, #16777216
1808:bluetooth_rxtx.c **** 
 5224              		.loc 1 1808 0
 5225 0016 6074     		strb	r0, [r4, #17]
1813:bluetooth_rxtx.c **** 
 5226              		.loc 1 1813 0
 5227 0018 1A60     		str	r2, [r3]
1815:bluetooth_rxtx.c **** 
 5228              		.loc 1 1815 0
 5229 001a A54B     		ldr	r3, .L645+12
 5230 001c 1022     		movs	r2, #16
 5231 001e 1A60     		str	r2, [r3]
1801:bluetooth_rxtx.c **** 	int i;
 5232              		.loc 1 1801 0
 5233 0020 0746     		mov	r7, r0
1817:bluetooth_rxtx.c **** 	dio_ssp_init();
 5234              		.loc 1 1817 0
 5235 0022 FFF7FEFF 		bl	queue_init
 5236              	.LVL527:
1818:bluetooth_rxtx.c **** 	dma_init_le();
 5237              		.loc 1 1818 0
 5238 0026 FFF7FEFF 		bl	dio_ssp_init
 5239              	.LVL528:
1819:bluetooth_rxtx.c **** 	dio_ssp_start();
 5240              		.loc 1 1819 0
 5241 002a FFF7FEFF 		bl	dma_init_le
 5242              	.LVL529:
1820:bluetooth_rxtx.c **** 
 5243              		.loc 1 1820 0
 5244 002e FFF7FEFF 		bl	dio_ssp_start
 5245              	.LVL530:
1822:bluetooth_rxtx.c **** 
 5246              		.loc 1 1822 0
 5247 0032 6868     		ldr	r0, [r5, #4]
 5248 0034 FFF7FEFF 		bl	rbit
ARM GAS  /tmp/ccCuKxzC.s 			page 151


 5249              	.LVL531:
 5250 0038 FFF7FEFF 		bl	cc2400_rx_sync
 5251              	.LVL532:
 5252              	.L579:
1824:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 5253              		.loc 1 1824 0 discriminator 1
 5254 003c A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 5255 003e BB42     		cmp	r3, r7
 5256 0040 40F0CE81 		bne	.L619
 5257              	.LBB46:
1825:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 5258              		.loc 1 1825 0
 5259 0044 974B     		ldr	r3, .L645
 5260 0046 DB89     		ldrh	r3, [r3, #14]
 5261 0048 9BB2     		uxth	r3, r3
 5262 004a CBB1     		cbz	r3, .L580
1826:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK)); // need to wait for unlock?
 5263              		.loc 1 1826 0
 5264 004c 6420     		movs	r0, #100
 5265 004e FFF7FEFF 		bl	cc2400_strobe
 5266              	.LVL533:
 5267              	.L582:
1827:bluetooth_rxtx.c **** 
 5268              		.loc 1 1827 0 discriminator 1
 5269 0052 FFF7FEFF 		bl	cc2400_status
 5270              	.LVL534:
 5271 0056 4107     		lsls	r1, r0, #29
 5272 0058 FBD4     		bmi	.L582
1830:bluetooth_rxtx.c **** 
 5273              		.loc 1 1830 0
 5274 005a 2988     		ldrh	r1, [r5]
 5275 005c 0220     		movs	r0, #2
 5276 005e 89B2     		uxth	r1, r1
 5277 0060 0139     		subs	r1, r1, #1
 5278 0062 89B2     		uxth	r1, r1
 5279 0064 FFF7FEFF 		bl	cc2400_set
 5280              	.LVL535:
1833:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 5281              		.loc 1 1833 0
 5282 0068 6120     		movs	r0, #97
 5283 006a FFF7FEFF 		bl	cc2400_strobe
 5284              	.LVL536:
 5285              	.L584:
1834:bluetooth_rxtx.c **** 
 5286              		.loc 1 1834 0 discriminator 1
 5287 006e FFF7FEFF 		bl	cc2400_status
 5288              	.LVL537:
 5289 0072 4207     		lsls	r2, r0, #29
 5290 0074 FBD5     		bpl	.L584
1837:bluetooth_rxtx.c **** 
 5291              		.loc 1 1837 0
 5292 0076 6220     		movs	r0, #98
 5293 0078 FFF7FEFF 		bl	cc2400_strobe
 5294              	.LVL538:
1839:bluetooth_rxtx.c **** 		}
 5295              		.loc 1 1839 0
 5296 007c 0023     		movs	r3, #0
ARM GAS  /tmp/ccCuKxzC.s 			page 152


 5297 007e E381     		strh	r3, [r4, #14]	@ movhi
 5298              	.L580:
1842:bluetooth_rxtx.c **** 
 5299              		.loc 1 1842 0
 5300 0080 8B4B     		ldr	r3, .L645+12
 5301 0082 1022     		movs	r2, #16
 5302 0084 1A60     		str	r2, [r3]
1845:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode)	;
 5303              		.loc 1 1845 0
 5304 0086 FFF7FEFF 		bl	rssi_reset
 5305              	.LVL539:
 5306              	.L586:
1846:bluetooth_rxtx.c **** 
 5307              		.loc 1 1846 0 discriminator 1
 5308 008a 8A4B     		ldr	r3, .L645+16
 5309 008c 1A68     		ldr	r2, [r3]
 5310 008e 9A46     		mov	r10, r3
 5311 0090 42B9     		cbnz	r2, .L585
1846:bluetooth_rxtx.c **** 
 5312              		.loc 1 1846 0 is_stmt 0 discriminator 2
 5313 0092 894B     		ldr	r3, .L645+20
 5314 0094 1B68     		ldr	r3, [r3]
 5315 0096 2BB9     		cbnz	r3, .L585
1846:bluetooth_rxtx.c **** 
 5316              		.loc 1 1846 0 discriminator 1
 5317 0098 E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 5318 009a 1BB9     		cbnz	r3, .L585
 5319 009c 814B     		ldr	r3, .L645
 5320 009e 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 5321 00a0 BB42     		cmp	r3, r7
 5322 00a2 F2D0     		beq	.L586
 5323              	.L585:
1848:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 5324              		.loc 1 1848 0 is_stmt 1
 5325 00a4 0620     		movs	r0, #6
 5326 00a6 FFF7FEFF 		bl	cc2400_get
 5327              	.LVL540:
1849:bluetooth_rxtx.c **** 
 5328              		.loc 1 1849 0
 5329 00aa 844B     		ldr	r3, .L645+24
1848:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 5330              		.loc 1 1848 0
 5331 00ac C0F30720 		ubfx	r0, r0, #8, #8
 5332              	.LVL541:
1849:bluetooth_rxtx.c **** 
 5333              		.loc 1 1849 0
 5334 00b0 1870     		strb	r0, [r3]
 5335 00b2 834B     		ldr	r3, .L645+28
1851:bluetooth_rxtx.c **** 			goto cleanup;
 5336              		.loc 1 1851 0
 5337 00b4 7B4A     		ldr	r2, .L645
1849:bluetooth_rxtx.c **** 
 5338              		.loc 1 1849 0
 5339 00b6 1870     		strb	r0, [r3]
1851:bluetooth_rxtx.c **** 			goto cleanup;
 5340              		.loc 1 1851 0
 5341 00b8 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
ARM GAS  /tmp/ccCuKxzC.s 			page 153


 5342 00ba BB42     		cmp	r3, r7
 5343 00bc 40F09081 		bne	.L619
1855:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 5344              		.loc 1 1855 0
 5345 00c0 DFF8F491 		ldr	r9, .L645+20
 5346 00c4 D9F80010 		ldr	r1, [r9]
 5347 00c8 CB46     		mov	fp, r9
 5348 00ca 19B1     		cbz	r1, .L588
1856:bluetooth_rxtx.c **** 		}
 5349              		.loc 1 1856 0
 5350 00cc 5178     		ldrb	r1, [r2, #1]	@ zero_extendqisi2
 5351 00ce 41F00201 		orr	r1, r1, #2
 5352 00d2 5170     		strb	r1, [r2, #1]
 5353              	.L588:
1859:bluetooth_rxtx.c **** 			goto rx_flush;
 5354              		.loc 1 1859 0
 5355 00d4 E27A     		ldrb	r2, [r4, #11]	@ zero_extendqisi2
 5356 00d6 02F0FF01 		and	r1, r2, #255
 5357 00da 002A     		cmp	r2, #0
 5358 00dc 40F0D380 		bne	.L589
1863:bluetooth_rxtx.c **** 			continue;
 5359              		.loc 1 1863 0
 5360 00e0 DAF80020 		ldr	r2, [r10]
 5361 00e4 002A     		cmp	r2, #0
 5362 00e6 A9D0     		beq	.L579
1869:bluetooth_rxtx.c **** 		u8 *p = (u8 *)packet;
 5363              		.loc 1 1869 0
 5364 00e8 3422     		movs	r2, #52
 5365 00ea 03A8     		add	r0, sp, #12
 5366              	.LVL542:
 5367 00ec FFF7FEFF 		bl	memset
 5368              	.LVL543:
1873:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5369              		.loc 1 1873 0
 5370 00f0 2888     		ldrh	r0, [r5]
1871:bluetooth_rxtx.c **** 
 5371              		.loc 1 1871 0
 5372 00f2 6A68     		ldr	r2, [r5, #4]
1873:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5373              		.loc 1 1873 0
 5374 00f4 80B2     		uxth	r0, r0
 5375 00f6 6238     		subs	r0, r0, #98
 5376 00f8 C0B2     		uxtb	r0, r0
1871:bluetooth_rxtx.c **** 
 5377              		.loc 1 1871 0
 5378 00fa 0392     		str	r2, [sp, #12]
1873:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5379              		.loc 1 1873 0
 5380 00fc FFF7FEFF 		bl	btle_channel_index
 5381              	.LVL544:
 5382 0100 4FF03008 		mov	r8, #48
 5383 0104 08FB00F8 		mul	r8, r8, r0
 5384 0108 6E4A     		ldr	r2, .L645+32
 5385              	.LBB47:
1875:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5386              		.loc 1 1875 0
 5387 010a 6F4E     		ldr	r6, .L645+36
ARM GAS  /tmp/ccCuKxzC.s 			page 154


 5388              	.LBE47:
1873:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5389              		.loc 1 1873 0
 5390 010c 02EB0801 		add	r1, r2, r8
 5391              	.LBB48:
1875:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5392              		.loc 1 1875 0
 5393 0110 96F800C0 		ldrb	ip, [r6]	@ zero_extendqisi2
 5394              	.LBE48:
1873:bluetooth_rxtx.c **** 		for (i = 0; i < 4; i+= 4) {
 5395              		.loc 1 1873 0
 5396 0114 0191     		str	r1, [sp, #4]
 5397              	.LVL545:
 5398              	.LBB49:
1876:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5399              		.loc 1 1876 0
 5400 0116 7178     		ldrb	r1, [r6, #1]	@ zero_extendqisi2
 5401              	.LVL546:
1877:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5402              		.loc 1 1877 0
 5403 0118 B078     		ldrb	r0, [r6, #2]	@ zero_extendqisi2
1876:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5404              		.loc 1 1876 0
 5405 011a 0904     		lsls	r1, r1, #16
1878:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5406              		.loc 1 1878 0
 5407 011c 96F803E0 		ldrb	lr, [r6, #3]	@ zero_extendqisi2
 5408              	.LVL547:
1876:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5409              		.loc 1 1876 0
 5410 0120 41EA0C61 		orr	r1, r1, ip, lsl #24
1877:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5411              		.loc 1 1877 0
 5412 0124 41EA0E01 		orr	r1, r1, lr
1879:bluetooth_rxtx.c **** 		}
 5413              		.loc 1 1879 0
 5414 0128 41EA0020 		orr	r0, r1, r0, lsl #8
 5415 012c 0092     		str	r2, [sp]
 5416 012e FFF7FEFF 		bl	rbit
 5417              	.LVL548:
 5418 0132 009A     		ldr	r2, [sp]
 5419 0134 52F80820 		ldr	r2, [r2, r8]
 5420 0138 5040     		eors	r0, r0, r2
 5421              	.LBE49:
1882:bluetooth_rxtx.c **** 		if (len > 39)
 5422              		.loc 1 1882 0
 5423 013a C0F30528 		ubfx	r8, r0, #8, #6
 5424 013e 08F10208 		add	r8, r8, #2
1883:bluetooth_rxtx.c **** 			goto rx_flush;
 5425              		.loc 1 1883 0
 5426 0142 B8F1270F 		cmp	r8, #39
 5427              	.LBB50:
1879:bluetooth_rxtx.c **** 		}
 5428              		.loc 1 1879 0
 5429 0146 0490     		str	r0, [sp, #16]
 5430              	.LVL549:
 5431              	.LBE50:
ARM GAS  /tmp/ccCuKxzC.s 			page 155


1883:bluetooth_rxtx.c **** 			goto rx_flush;
 5432              		.loc 1 1883 0
 5433 0148 00F29D80 		bhi	.L589
1888:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
 5434              		.loc 1 1888 0
 5435 014c 08F10602 		add	r2, r8, #6
 5436 0150 9210     		asrs	r2, r2, #2
 5437              	.LVL550:
1889:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0)
 5438              		.loc 1 1889 0
 5439 0152 0B2A     		cmp	r2, #11
 5440 0154 0DD0     		beq	.L595
1890:bluetooth_rxtx.c **** 				;
 5441              		.loc 1 1890 0
 5442 0156 06EB8206 		add	r6, r6, r2, lsl #2
 5443              	.LVL551:
 5444              	.L594:
 5445 015a 5C4A     		ldr	r2, .L645+40
 5446 015c 1268     		ldr	r2, [r2]
 5447 015e B242     		cmp	r2, r6
 5448 0160 0BD2     		bcs	.L593
1890:bluetooth_rxtx.c **** 				;
 5449              		.loc 1 1890 0 is_stmt 0 discriminator 2
 5450 0162 DBF80010 		ldr	r1, [fp]
 5451 0166 0029     		cmp	r1, #0
 5452 0168 F7D0     		beq	.L594
 5453 016a 06E0     		b	.L593
 5454              	.L643:
1893:bluetooth_rxtx.c **** 				;
 5455              		.loc 1 1893 0 is_stmt 1 discriminator 2
 5456 016c DBF80020 		ldr	r2, [fp]
 5457 0170 1AB9     		cbnz	r2, .L593
 5458              	.L595:
1893:bluetooth_rxtx.c **** 				;
 5459              		.loc 1 1893 0 is_stmt 0
 5460 0172 574A     		ldr	r2, .L645+44
 5461 0174 1268     		ldr	r2, [r2]
 5462 0176 D307     		lsls	r3, r2, #31
 5463 0178 F8D4     		bmi	.L643
 5464              	.L593:
1896:bluetooth_rxtx.c **** 
 5465              		.loc 1 1896 0 is_stmt 1
 5466 017a 564B     		ldr	r3, .L645+48
1899:bluetooth_rxtx.c **** 
 5467              		.loc 1 1899 0
 5468 017c 6120     		movs	r0, #97
1896:bluetooth_rxtx.c **** 
 5469              		.loc 1 1896 0
 5470 017e 1A68     		ldr	r2, [r3]
1902:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5471              		.loc 1 1902 0
 5472 0180 0426     		movs	r6, #4
1896:bluetooth_rxtx.c **** 
 5473              		.loc 1 1896 0
 5474 0182 22F00102 		bic	r2, r2, #1
 5475 0186 1A60     		str	r2, [r3]
1899:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccCuKxzC.s 			page 156


 5476              		.loc 1 1899 0
 5477 0188 FFF7FEFF 		bl	cc2400_strobe
 5478              	.LVL552:
 5479              	.L597:
 5480              	.LBB51:
1903:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 5481              		.loc 1 1903 0 discriminator 2
 5482 018c 4E4B     		ldr	r3, .L645+36
 5483 018e 721C     		adds	r2, r6, #1
 5484 0190 13F806E0 		ldrb	lr, [r3, r6]	@ zero_extendqisi2
1904:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5485              		.loc 1 1904 0 discriminator 2
 5486 0194 995C     		ldrb	r1, [r3, r2]	@ zero_extendqisi2
 5487 0196 B21C     		adds	r2, r6, #2
1905:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5488              		.loc 1 1905 0 discriminator 2
 5489 0198 985C     		ldrb	r0, [r3, r2]	@ zero_extendqisi2
 5490 019a F21C     		adds	r2, r6, #3
1906:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 5491              		.loc 1 1906 0 discriminator 2
 5492 019c 9A5C     		ldrb	r2, [r3, r2]	@ zero_extendqisi2
 5493              	.LVL553:
1907:bluetooth_rxtx.c **** 		}
 5494              		.loc 1 1907 0 discriminator 2
 5495 019e 4FEAA60B 		asr	fp, r6, #2
1904:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 5496              		.loc 1 1904 0 discriminator 2
 5497 01a2 42EA0E62 		orr	r2, r2, lr, lsl #24
 5498              	.LVL554:
1905:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 5499              		.loc 1 1905 0 discriminator 2
 5500 01a6 42EA0142 		orr	r2, r2, r1, lsl #16
1907:bluetooth_rxtx.c **** 		}
 5501              		.loc 1 1907 0 discriminator 2
 5502 01aa 42EA0020 		orr	r0, r2, r0, lsl #8
 5503 01ae FFF7FEFF 		bl	rbit
 5504              	.LVL555:
 5505 01b2 0199     		ldr	r1, [sp, #4]
 5506 01b4 10AB     		add	r3, sp, #64
 5507 01b6 03EB8B02 		add	r2, r3, fp, lsl #2
 5508 01ba 51F82B30 		ldr	r3, [r1, fp, lsl #2]
 5509              	.LBE51:
1902:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5510              		.loc 1 1902 0 discriminator 2
 5511 01be 0436     		adds	r6, r6, #4
 5512              	.LVL556:
 5513              	.LBB52:
1907:bluetooth_rxtx.c **** 		}
 5514              		.loc 1 1907 0 discriminator 2
 5515 01c0 5840     		eors	r0, r0, r3
 5516              	.LBE52:
1902:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5517              		.loc 1 1902 0 discriminator 2
 5518 01c2 2C2E     		cmp	r6, #44
 5519              	.LBB53:
1907:bluetooth_rxtx.c **** 		}
 5520              		.loc 1 1907 0 discriminator 2
ARM GAS  /tmp/ccCuKxzC.s 			page 157


 5521 01c4 42F8300C 		str	r0, [r2, #-48]
 5522              	.LBE53:
1902:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 5523              		.loc 1 1902 0 discriminator 2
 5524 01c8 E0D1     		bne	.L597
1911:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
 5525              		.loc 1 1911 0
 5526 01ca 6B69     		ldr	r3, [r5, #20]
 5527 01cc 33B9     		cbnz	r3, .L598
 5528              	.L601:
1922:bluetooth_rxtx.c **** 			sync_flag = 1;
 5529              		.loc 1 1922 0
 5530 01ce 9DF82330 		ldrb	r3, [sp, #35]	@ zero_extendqisi2
 5531 01d2 DFF81881 		ldr	r8, .L645+72
 5532              	.LVL557:
 5533 01d6 FF2B     		cmp	r3, #255
 5534 01d8 30D1     		bne	.L624
 5535 01da 15E0     		b	.L599
 5536              	.LVL558:
 5537              	.L598:
 5538              	.LBB54:
1912:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
 5539              		.loc 1 1912 0
 5540 01dc 324B     		ldr	r3, .L645+4
 5541 01de 04A9     		add	r1, sp, #16
 5542 01e0 1869     		ldr	r0, [r3, #16]
 5543 01e2 4246     		mov	r2, r8
 5544 01e4 FFF7FEFF 		bl	btle_crcgen_lut
 5545              	.LVL559:
1914:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5546              		.loc 1 1914 0
 5547 01e8 10AB     		add	r3, sp, #64
 5548 01ea 4344     		add	r3, r3, r8
1913:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 5549              		.loc 1 1913 0
 5550 01ec 13F82E1C 		ldrb	r1, [r3, #-46]	@ zero_extendqisi2
1914:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5551              		.loc 1 1914 0
 5552 01f0 13F82F2C 		ldrb	r2, [r3, #-47]	@ zero_extendqisi2
1913:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 5553              		.loc 1 1913 0
 5554 01f4 0904     		lsls	r1, r1, #16
1914:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 5555              		.loc 1 1914 0
 5556 01f6 41EA0221 		orr	r1, r1, r2, lsl #8
1915:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc) // skip packets with a bad CRC
 5557              		.loc 1 1915 0
 5558 01fa 13F8302C 		ldrb	r2, [r3, #-48]	@ zero_extendqisi2
 5559 01fe 41EA0203 		orr	r3, r1, r2
1916:bluetooth_rxtx.c **** 				goto rx_flush;
 5560              		.loc 1 1916 0
 5561 0202 9842     		cmp	r0, r3
 5562 0204 3FD1     		bne	.L589
 5563 0206 E2E7     		b	.L601
 5564              	.LVL560:
 5565              	.L599:
 5566              	.LBE54:
ARM GAS  /tmp/ccCuKxzC.s 			page 158


1922:bluetooth_rxtx.c **** 			sync_flag = 1;
 5567              		.loc 1 1922 0 discriminator 1
 5568 0208 9DF82430 		ldrb	r3, [sp, #36]	@ zero_extendqisi2
 5569 020c 532B     		cmp	r3, #83
 5570 020e 15D1     		bne	.L624
 5571 0210 9DF82530 		ldrb	r3, [sp, #37]	@ zero_extendqisi2
 5572 0214 592B     		cmp	r3, #89
 5573 0216 11D1     		bne	.L624
 5574 0218 9DF82630 		ldrb	r3, [sp, #38]	@ zero_extendqisi2
 5575 021c 4E2B     		cmp	r3, #78
 5576 021e 0DD1     		bne	.L624
 5577 0220 9DF82730 		ldrb	r3, [sp, #39]	@ zero_extendqisi2
 5578 0224 432B     		cmp	r3, #67
 5579 0226 09D1     		bne	.L624
 5580              	.LVL561:
1924:bluetooth_rxtx.c **** 			start_sync = now_sync + 100 * 10000 / 3125; // wait for 100 ms
 5581              		.loc 1 1924 0
 5582 0228 D8F80030 		ldr	r3, [r8]
1923:bluetooth_rxtx.c **** 			now_sync = (clkn & 0xffffff);
 5583              		.loc 1 1923 0
 5584 022c 0126     		movs	r6, #1
 5585              	.LVL562:
1924:bluetooth_rxtx.c **** 			start_sync = now_sync + 100 * 10000 / 3125; // wait for 100 ms
 5586              		.loc 1 1924 0
 5587 022e 23F07F43 		bic	r3, r3, #-16777216
 5588 0232 E362     		str	r3, [r4, #44]
1925:bluetooth_rxtx.c **** //			sync_channel = (u16)p[28];
 5589              		.loc 1 1925 0
 5590 0234 03F5A073 		add	r3, r3, #320
 5591 0238 A362     		str	r3, [r4, #40]
 5592 023a 00E0     		b	.L600
 5593              	.LVL563:
 5594              	.L624:
 5595 023c 0026     		movs	r6, #0
 5596              	.LVL564:
 5597              	.L600:
1930:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
 5598              		.loc 1 1930 0
 5599 023e 264B     		ldr	r3, .L645+52
 5600 0240 1022     		movs	r2, #16
 5601 0242 1A60     		str	r2, [r3]
1931:bluetooth_rxtx.c **** 
 5602              		.loc 1 1931 0
 5603 0244 03A8     		add	r0, sp, #12
 5604              	.LVL565:
 5605 0246 A369     		ldr	r3, [r4, #24]
 5606 0248 9847     		blx	r3
 5607              	.LVL566:
1934:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t *)packet);
 5608              		.loc 1 1934 0
 5609 024a 244B     		ldr	r3, .L645+56
 5610 024c 4FF0807B 		mov	fp, #16777216
 5611 0250 C3F800B0 		str	fp, [r3]
1935:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 5612              		.loc 1 1935 0
 5613 0254 03A9     		add	r1, sp, #12
 5614              	.LVL567:
ARM GAS  /tmp/ccCuKxzC.s 			page 159


 5615 0256 0120     		movs	r0, #1
 5616 0258 FFF7FEFF 		bl	enqueue
 5617              	.LVL568:
1936:bluetooth_rxtx.c **** 
 5618              		.loc 1 1936 0
 5619 025c 134B     		ldr	r3, .L645+8
1938:bluetooth_rxtx.c **** 
 5620              		.loc 1 1938 0
 5621 025e 204A     		ldr	r2, .L645+60
1936:bluetooth_rxtx.c **** 
 5622              		.loc 1 1936 0
 5623 0260 C3F800B0 		str	fp, [r3]
1938:bluetooth_rxtx.c **** 
 5624              		.loc 1 1938 0
 5625 0264 D8F80030 		ldr	r3, [r8]
 5626 0268 1268     		ldr	r2, [r2]
 5627 026a C3F31303 		ubfx	r3, r3, #0, #20
 5628 026e 40F63541 		movw	r1, #3125
 5629 0272 01FB0323 		mla	r3, r1, r3, r2
 5630 0276 6B64     		str	r3, [r5, #68]
1941:bluetooth_rxtx.c **** 			requested_mode = MODE_BT_RSSI_LE;
 5631              		.loc 1 1941 0
 5632 0278 2EB1     		cbz	r6, .L589
 5633              	.LVL569:
1942:bluetooth_rxtx.c **** 			bt_le_sync_rssi(MODE_BT_RSSI_LE);
 5634              		.loc 1 1942 0
 5635 027a 0A4B     		ldr	r3, .L645
 5636 027c 1220     		movs	r0, #18
 5637 027e 9874     		strb	r0, [r3, #18]
1943:bluetooth_rxtx.c **** 			goto cleanup;
 5638              		.loc 1 1943 0
 5639 0280 FFF7FEFF 		bl	bt_le_sync_rssi
 5640              	.LVL570:
1944:bluetooth_rxtx.c **** 		}
 5641              		.loc 1 1944 0
 5642 0284 ACE0     		b	.L619
 5643              	.LVL571:
 5644              	.L589:
 5645              	.LDL1:
1949:bluetooth_rxtx.c **** 
 5646              		.loc 1 1949 0
 5647 0286 6120     		movs	r0, #97
 5648 0288 FFF7FEFF 		bl	cc2400_strobe
 5649              	.LVL572:
1952:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
 5650              		.loc 1 1952 0
 5651 028c 114B     		ldr	r3, .L645+48
 5652 028e 1A68     		ldr	r2, [r3]
 5653 0290 22F00102 		bic	r2, r2, #1
 5654 0294 1A60     		str	r2, [r3]
 5655              	.L603:
1953:bluetooth_rxtx.c **** 			u8 tmp = (u8)DIO_SSP_DR;
 5656              		.loc 1 1953 0 discriminator 1
 5657 0296 134B     		ldr	r3, .L645+64
 5658 0298 1B68     		ldr	r3, [r3]
 5659 029a 5E07     		lsls	r6, r3, #29
 5660 029c 28D5     		bpl	.L644
ARM GAS  /tmp/ccCuKxzC.s 			page 160


 5661              	.LBB55:
1954:bluetooth_rxtx.c **** 		}
 5662              		.loc 1 1954 0
 5663 029e 124B     		ldr	r3, .L645+68
 5664 02a0 1B68     		ldr	r3, [r3]
 5665 02a2 F8E7     		b	.L603
 5666              	.L646:
 5667              		.align	2
 5668              	.L645:
 5669 02a4 00000000 		.word	.LANCHOR0
 5670 02a8 00000000 		.word	.LANCHOR1
 5671 02ac 00E100E0 		.word	-536813312
 5672 02b0 3CC00920 		.word	537509948
 5673 02b4 00000000 		.word	rx_tc
 5674 02b8 00000000 		.word	rx_err
 5675 02bc 00000000 		.word	rssi_max
 5676 02c0 00000000 		.word	rssi_min
 5677 02c4 F0000000 		.word	.LANCHOR2+240
 5678 02c8 00000000 		.word	rxbuf1
 5679 02cc 04410050 		.word	1342193924
 5680 02d0 10410050 		.word	1342193936
 5681 02d4 24000340 		.word	1073938468
 5682 02d8 38C00920 		.word	537509944
 5683 02dc 80E100E0 		.word	-536813184
 5684 02e0 08400040 		.word	1073758216
 5685 02e4 0C000340 		.word	1073938444
 5686 02e8 08000340 		.word	1073938440
 5687 02ec 00000000 		.word	clkn
 5688              	.L644:
 5689              	.LBE55:
1958:bluetooth_rxtx.c **** 		if (now < le.last_packet)
 5690              		.loc 1 1958 0
 5691 02f0 424B     		ldr	r3, .L647
 5692 02f2 434A     		ldr	r2, .L647+4
 5693 02f4 1B68     		ldr	r3, [r3]
 5694 02f6 1268     		ldr	r2, [r2]
 5695 02f8 40F63541 		movw	r1, #3125
 5696 02fc C3F31303 		ubfx	r3, r3, #0, #20
 5697 0300 01FB0323 		mla	r3, r1, r3, r2
 5698              	.LVL573:
1959:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5699              		.loc 1 1959 0
 5700 0304 6A6C     		ldr	r2, [r5, #68]
1962:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
 5701              		.loc 1 1962 0
 5702 0306 297E     		ldrb	r1, [r5, #24]	@ zero_extendqisi2
1959:bluetooth_rxtx.c **** 			now += 3276800000; // handle rollover
 5703              		.loc 1 1959 0
 5704 0308 9342     		cmp	r3, r2
1962:bluetooth_rxtx.c **** 			&& (now - le.last_packet > 50000000))
 5705              		.loc 1 1962 0
 5706 030a A1F10201 		sub	r1, r1, #2
1960:bluetooth_rxtx.c **** 		if  ( // timeout
 5707              		.loc 1 1960 0
 5708 030e 38BF     		it	cc
 5709 0310 03F14343 		addcc	r3, r3, #-1023410176
 5710              	.LVL574:
ARM GAS  /tmp/ccCuKxzC.s 			page 161


1961:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5711              		.loc 1 1961 0
 5712 0314 C9B2     		uxtb	r1, r1
1960:bluetooth_rxtx.c **** 		if  ( // timeout
 5713              		.loc 1 1960 0
 5714 0316 38BF     		it	cc
 5715 0318 03F5A003 		addcc	r3, r3, #5242880
 5716              	.LVL575:
1961:bluetooth_rxtx.c **** 			((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING)
 5717              		.loc 1 1961 0
 5718 031c 0129     		cmp	r1, #1
 5719 031e 03D8     		bhi	.L606
1963:bluetooth_rxtx.c **** 			// jam finished
 5720              		.loc 1 1963 0
 5721 0320 3849     		ldr	r1, .L647+8
 5722 0322 9B1A     		subs	r3, r3, r2
 5723              	.LVL576:
 5724 0324 8B42     		cmp	r3, r1
 5725 0326 02D8     		bhi	.L607
 5726              	.L606:
1965:bluetooth_rxtx.c **** 			)
 5727              		.loc 1 1965 0
 5728 0328 E369     		ldr	r3, [r4, #28]
 5729 032a 012B     		cmp	r3, #1
 5730 032c 27D1     		bne	.L608
 5731              	.L607:
1968:bluetooth_rxtx.c **** 			le_jam_count = 0;
 5732              		.loc 1 1968 0
 5733 032e FFF7FEFF 		bl	reset_le
 5734              	.LVL577:
1970:bluetooth_rxtx.c **** 
 5735              		.loc 1 1970 0
 5736 0332 3549     		ldr	r1, .L647+12
1969:bluetooth_rxtx.c **** 			TXLED_CLR;
 5737              		.loc 1 1969 0
 5738 0334 0023     		movs	r3, #0
1970:bluetooth_rxtx.c **** 
 5739              		.loc 1 1970 0
 5740 0336 4FF48070 		mov	r0, #256
1969:bluetooth_rxtx.c **** 			TXLED_CLR;
 5741              		.loc 1 1969 0
 5742 033a E361     		str	r3, [r4, #28]
1970:bluetooth_rxtx.c **** 
 5743              		.loc 1 1970 0
 5744 033c 0860     		str	r0, [r1]
1972:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 5745              		.loc 1 1972 0
 5746 033e E17C     		ldrb	r1, [r4, #19]	@ zero_extendqisi2
1969:bluetooth_rxtx.c **** 			TXLED_CLR;
 5747              		.loc 1 1969 0
 5748 0340 324A     		ldr	r2, .L647+16
1972:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 5749              		.loc 1 1972 0
 5750 0342 0129     		cmp	r1, #1
 5751 0344 02D1     		bne	.L609
1973:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
 5752              		.loc 1 1973 0
ARM GAS  /tmp/ccCuKxzC.s 			page 162


 5753 0346 D374     		strb	r3, [r2, #19]
1974:bluetooth_rxtx.c **** 				goto cleanup;
 5754              		.loc 1 1974 0
 5755 0348 9374     		strb	r3, [r2, #18]
1975:bluetooth_rxtx.c **** 			}
 5756              		.loc 1 1975 0
 5757 034a 49E0     		b	.L619
 5758              	.L609:
1979:bluetooth_rxtx.c **** 				goto cleanup;
 5759              		.loc 1 1979 0
 5760 034c 0A2F     		cmp	r7, #10
 5761 034e 47D0     		beq	.L619
1982:bluetooth_rxtx.c **** 
 5762              		.loc 1 1982 0
 5763 0350 0123     		movs	r3, #1
1984:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5764              		.loc 1 1984 0
 5765 0352 6420     		movs	r0, #100
1982:bluetooth_rxtx.c **** 
 5766              		.loc 1 1982 0
 5767 0354 2B76     		strb	r3, [r5, #24]
1984:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5768              		.loc 1 1984 0
 5769 0356 FFF7FEFF 		bl	cc2400_strobe
 5770              	.LVL578:
 5771              	.L611:
1985:bluetooth_rxtx.c **** 
 5772              		.loc 1 1985 0 discriminator 1
 5773 035a FFF7FEFF 		bl	cc2400_status
 5774              	.LVL579:
 5775 035e 4007     		lsls	r0, r0, #29
 5776 0360 FBD4     		bmi	.L611
1988:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5777              		.loc 1 1988 0
 5778 0362 B5F84A30 		ldrh	r3, [r5, #74]
 5779 0366 9BB2     		uxth	r3, r3
 5780 0368 23B1     		cbz	r3, .L625
1988:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5781              		.loc 1 1988 0 is_stmt 0 discriminator 1
 5782 036a 294B     		ldr	r3, .L647+20
 5783 036c B3F84A30 		ldrh	r3, [r3, #74]
 5784 0370 9BB2     		uxth	r3, r3
 5785 0372 01E0     		b	.L612
 5786              	.L625:
1988:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5787              		.loc 1 1988 0
 5788 0374 40F66213 		movw	r3, #2402
 5789              	.L612:
1988:bluetooth_rxtx.c **** 			restart_jamming = 1;
 5790              		.loc 1 1988 0 discriminator 3
 5791 0378 2B80     		strh	r3, [r5]	@ movhi
1989:bluetooth_rxtx.c **** 		}
 5792              		.loc 1 1989 0 is_stmt 1 discriminator 3
 5793 037a 0123     		movs	r3, #1
 5794 037c 2363     		str	r3, [r4, #48]
 5795              	.L608:
1992:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
ARM GAS  /tmp/ccCuKxzC.s 			page 163


 5796              		.loc 1 1992 0
 5797 037e 2C20     		movs	r0, #44
 5798 0380 6989     		ldrh	r1, [r5, #10]
 5799 0382 FFF7FEFF 		bl	cc2400_set
 5800              	.LVL580:
1993:bluetooth_rxtx.c **** 
 5801              		.loc 1 1993 0
 5802 0386 2D20     		movs	r0, #45
 5803 0388 2989     		ldrh	r1, [r5, #8]
 5804 038a FFF7FEFF 		bl	cc2400_set
 5805              	.LVL581:
1995:bluetooth_rxtx.c **** 			hop();
 5806              		.loc 1 1995 0
 5807 038e E37A     		ldrb	r3, [r4, #11]	@ zero_extendqisi2
 5808 0390 0BB1     		cbz	r3, .L613
1996:bluetooth_rxtx.c **** 
 5809              		.loc 1 1996 0
 5810 0392 FFF7FEFF 		bl	hop
 5811              	.LVL582:
 5812              	.L613:
1999:bluetooth_rxtx.c **** 			le_jam();
 5813              		.loc 1 1999 0
 5814 0396 E369     		ldr	r3, [r4, #28]
 5815 0398 1C4E     		ldr	r6, .L647+16
 5816 039a 002B     		cmp	r3, #0
 5817 039c 05DD     		ble	.L614
2000:bluetooth_rxtx.c **** 			--le_jam_count;
 5818              		.loc 1 2000 0
 5819 039e FFF7FEFF 		bl	le_jam
 5820              	.LVL583:
2001:bluetooth_rxtx.c **** 		} else {
 5821              		.loc 1 2001 0
 5822 03a2 F369     		ldr	r3, [r6, #28]
 5823 03a4 013B     		subs	r3, r3, #1
 5824 03a6 F361     		str	r3, [r6, #28]
 5825 03a8 14E0     		b	.L615
 5826              	.L614:
2004:bluetooth_rxtx.c **** 			dio_ssp_start();
 5827              		.loc 1 2004 0
 5828 03aa FFF7FEFF 		bl	dma_init_le
 5829              	.LVL584:
2005:bluetooth_rxtx.c **** 
 5830              		.loc 1 2005 0
 5831 03ae FFF7FEFF 		bl	dio_ssp_start
 5832              	.LVL585:
2007:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
 5833              		.loc 1 2007 0
 5834 03b2 336B     		ldr	r3, [r6, #48]
 5835 03b4 3BB1     		cbz	r3, .L618
2008:bluetooth_rxtx.c **** 				restart_jamming = 0;
 5836              		.loc 1 2008 0
 5837 03b6 6868     		ldr	r0, [r5, #4]
 5838 03b8 FFF7FEFF 		bl	rbit
 5839              	.LVL586:
 5840 03bc FFF7FEFF 		bl	cc2400_rx_sync
 5841              	.LVL587:
2009:bluetooth_rxtx.c **** 			} else {
ARM GAS  /tmp/ccCuKxzC.s 			page 164


 5842              		.loc 1 2009 0
 5843 03c0 0023     		movs	r3, #0
 5844 03c2 3363     		str	r3, [r6, #48]
 5845 03c4 06E0     		b	.L615
 5846              	.L618:
2012:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
 5847              		.loc 1 2012 0
 5848 03c6 FFF7FEFF 		bl	cc2400_status
 5849              	.LVL588:
 5850 03ca 4107     		lsls	r1, r0, #29
 5851 03cc FBD5     		bpl	.L618
2013:bluetooth_rxtx.c **** 			}
 5852              		.loc 1 2013 0
 5853 03ce 6220     		movs	r0, #98
 5854 03d0 FFF7FEFF 		bl	cc2400_strobe
 5855              	.LVL589:
 5856              	.L615:
2017:bluetooth_rxtx.c **** 		rx_err = 0;
 5857              		.loc 1 2017 0 discriminator 1
 5858 03d4 0023     		movs	r3, #0
 5859 03d6 CAF80030 		str	r3, [r10]
2018:bluetooth_rxtx.c **** 	}
 5860              		.loc 1 2018 0 discriminator 1
 5861 03da C9F80030 		str	r3, [r9]
 5862 03de 2DE6     		b	.L579
 5863              	.LVL590:
 5864              	.L619:
 5865              	.LBE46:
2024:bluetooth_rxtx.c **** 
 5866              		.loc 1 2024 0
 5867 03e0 0C4B     		ldr	r3, .L647+24
 5868 03e2 4FF08072 		mov	r2, #16777216
 5869 03e6 1A60     		str	r2, [r3]
2027:bluetooth_rxtx.c **** 	dio_ssp_stop();
 5870              		.loc 1 2027 0
 5871 03e8 FFF7FEFF 		bl	cc2400_idle
 5872              	.LVL591:
2028:bluetooth_rxtx.c **** 	cs_trigger_disable();
 5873              		.loc 1 2028 0
 5874 03ec FFF7FEFF 		bl	dio_ssp_stop
 5875              	.LVL592:
2029:bluetooth_rxtx.c **** }
 5876              		.loc 1 2029 0
 5877 03f0 FFF7FEFF 		bl	cs_trigger_disable
 5878              	.LVL593:
2030:bluetooth_rxtx.c **** 
 5879              		.loc 1 2030 0
 5880 03f4 11B0     		add	sp, sp, #68
 5881              		@ sp needed
 5882 03f6 BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 5883              	.L648:
 5884 03fa 00BF     		.align	2
 5885              	.L647:
 5886 03fc 00000000 		.word	clkn
 5887 0400 08400040 		.word	1073758216
 5888 0404 80F0FA02 		.word	50000000
 5889 0408 3CC00920 		.word	537509948
ARM GAS  /tmp/ccCuKxzC.s 			page 165


 5890 040c 00000000 		.word	.LANCHOR0
 5891 0410 00000000 		.word	.LANCHOR1
 5892 0414 80E100E0 		.word	-536813184
 5893              		.cfi_endproc
 5894              	.LFE24:
 5896              		.section	.text.bt_le_sync_cfo,"ax",%progbits
 5897              		.align	1
 5898              		.global	bt_le_sync_cfo
 5899              		.thumb
 5900              		.thumb_func
 5902              	bt_le_sync_cfo:
 5903              	.LFB25:
2034:bluetooth_rxtx.c **** 	int i;
 5904              		.loc 1 2034 0
 5905              		.cfi_startproc
 5906              		@ args = 0, pretend = 0, frame = 112
 5907              		@ frame_needed = 0, uses_anonymous_args = 0
 5908              	.LVL594:
 5909 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 5910              		.cfi_def_cfa_offset 36
 5911              		.cfi_offset 4, -36
 5912              		.cfi_offset 5, -32
 5913              		.cfi_offset 6, -28
 5914              		.cfi_offset 7, -24
 5915              		.cfi_offset 8, -20
 5916              		.cfi_offset 9, -16
 5917              		.cfi_offset 10, -12
 5918              		.cfi_offset 11, -8
 5919              		.cfi_offset 14, -4
 5920 0004 9DB0     		sub	sp, sp, #116
 5921              		.cfi_def_cfa_offset 152
2038:bluetooth_rxtx.c **** 
 5922              		.loc 1 2038 0
 5923 0006 0021     		movs	r1, #0
2034:bluetooth_rxtx.c **** 	int i;
 5924              		.loc 1 2034 0
 5925 0008 0746     		mov	r7, r0
2038:bluetooth_rxtx.c **** 
 5926              		.loc 1 2038 0
 5927 000a 3222     		movs	r2, #50
2040:bluetooth_rxtx.c **** 	mode = active_mode;
 5928              		.loc 1 2040 0
 5929 000c A84D     		ldr	r5, .L713
2043:bluetooth_rxtx.c **** 
 5930              		.loc 1 2043 0
 5931 000e A94C     		ldr	r4, .L713+4
2038:bluetooth_rxtx.c **** 
 5932              		.loc 1 2038 0
 5933 0010 02A8     		add	r0, sp, #8
 5934              	.LVL595:
 5935 0012 FFF7FEFF 		bl	memset
 5936              	.LVL596:
2040:bluetooth_rxtx.c **** 	mode = active_mode;
 5937              		.loc 1 2040 0
 5938 0016 0123     		movs	r3, #1
 5939 0018 2B70     		strb	r3, [r5]
2043:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccCuKxzC.s 			page 166


 5940              		.loc 1 2043 0
 5941 001a 2376     		strb	r3, [r4, #24]
2045:bluetooth_rxtx.c **** 	RXLED_CLR;
 5942              		.loc 1 2045 0
 5943 001c A64B     		ldr	r3, .L713+8
 5944 001e 4FF08072 		mov	r2, #16777216
2041:bluetooth_rxtx.c **** 
 5945              		.loc 1 2041 0
 5946 0022 6F74     		strb	r7, [r5, #17]
2045:bluetooth_rxtx.c **** 	RXLED_CLR;
 5947              		.loc 1 2045 0
 5948 0024 1A60     		str	r2, [r3]
2046:bluetooth_rxtx.c **** 	queue_init();
 5949              		.loc 1 2046 0
 5950 0026 A54B     		ldr	r3, .L713+12
 5951 0028 1022     		movs	r2, #16
 5952 002a 1A60     		str	r2, [r3]
2047:bluetooth_rxtx.c **** 	dio_ssp_init();
 5953              		.loc 1 2047 0
 5954 002c FFF7FEFF 		bl	queue_init
 5955              	.LVL597:
2048:bluetooth_rxtx.c **** 	dma_init_le();
 5956              		.loc 1 2048 0
 5957 0030 FFF7FEFF 		bl	dio_ssp_init
 5958              	.LVL598:
2049:bluetooth_rxtx.c **** 	dio_ssp_start();
 5959              		.loc 1 2049 0
 5960 0034 FFF7FEFF 		bl	dma_init_le
 5961              	.LVL599:
2050:bluetooth_rxtx.c **** 
 5962              		.loc 1 2050 0
 5963 0038 FFF7FEFF 		bl	dio_ssp_start
 5964              	.LVL600:
2052:bluetooth_rxtx.c **** 
 5965              		.loc 1 2052 0
 5966 003c 6068     		ldr	r0, [r4, #4]
 5967 003e FFF7FEFF 		bl	rbit
 5968              	.LVL601:
 5969 0042 FFF7FEFF 		bl	cc2400_rx_sync
 5970              	.LVL602:
 5971              	.L650:
2054:bluetooth_rxtx.c **** 		if (requested_channel != 0) {
 5972              		.loc 1 2054 0 discriminator 1
 5973 0046 AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
 5974 0048 BB42     		cmp	r3, r7
 5975 004a 40F0CD81 		bne	.L693
 5976              	.LBB56:
2055:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 5977              		.loc 1 2055 0
 5978 004e 984B     		ldr	r3, .L713
 5979 0050 DB89     		ldrh	r3, [r3, #14]
 5980 0052 9BB2     		uxth	r3, r3
 5981 0054 CBB1     		cbz	r3, .L651
2056:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 5982              		.loc 1 2056 0
 5983 0056 6420     		movs	r0, #100
 5984 0058 FFF7FEFF 		bl	cc2400_strobe
ARM GAS  /tmp/ccCuKxzC.s 			page 167


 5985              	.LVL603:
 5986              	.L653:
2057:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, channel - 1);
 5987              		.loc 1 2057 0 discriminator 1
 5988 005c FFF7FEFF 		bl	cc2400_status
 5989              	.LVL604:
 5990 0060 4007     		lsls	r0, r0, #29
 5991 0062 FBD4     		bmi	.L653
2058:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 5992              		.loc 1 2058 0
 5993 0064 2188     		ldrh	r1, [r4]
 5994 0066 0220     		movs	r0, #2
 5995 0068 89B2     		uxth	r1, r1
 5996 006a 0139     		subs	r1, r1, #1
 5997 006c 89B2     		uxth	r1, r1
 5998 006e FFF7FEFF 		bl	cc2400_set
 5999              	.LVL605:
2059:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 6000              		.loc 1 2059 0
 6001 0072 6120     		movs	r0, #97
 6002 0074 FFF7FEFF 		bl	cc2400_strobe
 6003              	.LVL606:
 6004              	.L655:
2060:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 6005              		.loc 1 2060 0 discriminator 1
 6006 0078 FFF7FEFF 		bl	cc2400_status
 6007              	.LVL607:
 6008 007c 4107     		lsls	r1, r0, #29
 6009 007e FBD5     		bpl	.L655
2061:bluetooth_rxtx.c **** 			requested_channel = 0;
 6010              		.loc 1 2061 0
 6011 0080 6220     		movs	r0, #98
 6012 0082 FFF7FEFF 		bl	cc2400_strobe
 6013              	.LVL608:
2062:bluetooth_rxtx.c **** 		}
 6014              		.loc 1 2062 0
 6015 0086 0023     		movs	r3, #0
 6016 0088 EB81     		strh	r3, [r5, #14]	@ movhi
 6017              	.L651:
2064:bluetooth_rxtx.c **** 		rssi_reset();
 6018              		.loc 1 2064 0
 6019 008a 8C4B     		ldr	r3, .L713+12
 6020 008c 1022     		movs	r2, #16
 6021 008e 1A60     		str	r2, [r3]
2065:bluetooth_rxtx.c **** 		while ((rx_tc == 0) && (rx_err == 0) && (do_hop == 0) && requested_mode == active_mode) ;
 6022              		.loc 1 2065 0
 6023 0090 FFF7FEFF 		bl	rssi_reset
 6024              	.LVL609:
 6025              	.L657:
2066:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 6026              		.loc 1 2066 0 discriminator 1
 6027 0094 8A4B     		ldr	r3, .L713+16
 6028 0096 1A68     		ldr	r2, [r3]
 6029 0098 9946     		mov	r9, r3
 6030 009a 42B9     		cbnz	r2, .L656
2066:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 6031              		.loc 1 2066 0 is_stmt 0 discriminator 2
ARM GAS  /tmp/ccCuKxzC.s 			page 168


 6032 009c 894B     		ldr	r3, .L713+20
 6033 009e 1B68     		ldr	r3, [r3]
 6034 00a0 2BB9     		cbnz	r3, .L656
2066:bluetooth_rxtx.c **** 		rssi = (int8_t)(cc2400_get(RSSI) >> 8);
 6035              		.loc 1 2066 0 discriminator 1
 6036 00a2 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 6037 00a4 1BB9     		cbnz	r3, .L656
 6038 00a6 824B     		ldr	r3, .L713
 6039 00a8 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 6040 00aa BB42     		cmp	r3, r7
 6041 00ac F2D0     		beq	.L657
 6042              	.L656:
2067:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 6043              		.loc 1 2067 0 is_stmt 1
 6044 00ae 0620     		movs	r0, #6
 6045 00b0 FFF7FEFF 		bl	cc2400_get
 6046              	.LVL610:
2068:bluetooth_rxtx.c **** 
 6047              		.loc 1 2068 0
 6048 00b4 844B     		ldr	r3, .L713+24
2067:bluetooth_rxtx.c **** 		rssi_min = rssi_max = rssi;
 6049              		.loc 1 2067 0
 6050 00b6 C0F30720 		ubfx	r0, r0, #8, #8
 6051              	.LVL611:
2070:bluetooth_rxtx.c **** 			goto cleanup;
 6052              		.loc 1 2070 0
 6053 00ba AA7C     		ldrb	r2, [r5, #18]	@ zero_extendqisi2
2068:bluetooth_rxtx.c **** 
 6054              		.loc 1 2068 0
 6055 00bc 1870     		strb	r0, [r3]
 6056 00be 834B     		ldr	r3, .L713+28
2070:bluetooth_rxtx.c **** 			goto cleanup;
 6057              		.loc 1 2070 0
 6058 00c0 BA42     		cmp	r2, r7
2068:bluetooth_rxtx.c **** 
 6059              		.loc 1 2068 0
 6060 00c2 1870     		strb	r0, [r3]
2070:bluetooth_rxtx.c **** 			goto cleanup;
 6061              		.loc 1 2070 0
 6062 00c4 7A4B     		ldr	r3, .L713
 6063 00c6 40F08F81 		bne	.L693
2073:bluetooth_rxtx.c **** 			status |= DMA_ERROR;
 6064              		.loc 1 2073 0
 6065 00ca 7E4E     		ldr	r6, .L713+20
 6066 00cc 3268     		ldr	r2, [r6]
 6067 00ce 1AB1     		cbz	r2, .L659
2074:bluetooth_rxtx.c **** 		}
 6068              		.loc 1 2074 0
 6069 00d0 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 6070 00d2 42F00202 		orr	r2, r2, #2
 6071 00d6 5A70     		strb	r2, [r3, #1]
 6072              	.L659:
2076:bluetooth_rxtx.c **** 			goto rx_flush;
 6073              		.loc 1 2076 0
 6074 00d8 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 6075 00da 03F0FF08 		and	r8, r3, #255
 6076 00de 002B     		cmp	r3, #0
ARM GAS  /tmp/ccCuKxzC.s 			page 169


 6077 00e0 40F0D680 		bne	.L661
2078:bluetooth_rxtx.c **** 			continue;
 6078              		.loc 1 2078 0
 6079 00e4 D9F80030 		ldr	r3, [r9]
 6080 00e8 002B     		cmp	r3, #0
 6081 00ea ACD0     		beq	.L650
2081:bluetooth_rxtx.c **** 		uint32_t whiten_packet[48/4+1] = {0, };
 6082              		.loc 1 2081 0
 6083 00ec 0FA8     		add	r0, sp, #60
 6084              	.LVL612:
 6085 00ee 4146     		mov	r1, r8
 6086 00f0 3422     		movs	r2, #52
 6087 00f2 FFF7FEFF 		bl	memset
 6088              	.LVL613:
 6089              	.L665:
2087:bluetooth_rxtx.c **** 		}
 6090              		.loc 1 2087 0 discriminator 2
 6091 00f6 0720     		movs	r0, #7
 6092 00f8 FFF7FEFF 		bl	cc2400_get_rev
 6093              	.LVL614:
 6094 00fc 02AB     		add	r3, sp, #8
 6095 00fe 03F80800 		strb	r0, [r3, r8]
2086:bluetooth_rxtx.c **** 			cfo_buf[i] = cc2400_get_rev(FREQEST);
 6096              		.loc 1 2086 0 discriminator 2
 6097 0102 08F10108 		add	r8, r8, #1
 6098              	.LVL615:
 6099 0106 B8F1320F 		cmp	r8, #50
 6100 010a F4D1     		bne	.L665
2092:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 6101              		.loc 1 2092 0
 6102 010c 2088     		ldrh	r0, [r4]
2090:bluetooth_rxtx.c **** 		
 6103              		.loc 1 2090 0
 6104 010e 6368     		ldr	r3, [r4, #4]
2092:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 6105              		.loc 1 2092 0
 6106 0110 80B2     		uxth	r0, r0
 6107 0112 6238     		subs	r0, r0, #98
 6108 0114 C0B2     		uxtb	r0, r0
2090:bluetooth_rxtx.c **** 		
 6109              		.loc 1 2090 0
 6110 0116 0F93     		str	r3, [sp, #60]
2092:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 6111              		.loc 1 2092 0
 6112 0118 FFF7FEFF 		bl	btle_channel_index
 6113              	.LVL616:
 6114              	.LBB57:
2094:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 6115              		.loc 1 2094 0
 6116 011c DFF8C0B1 		ldr	fp, .L713+48
 6117              	.LBE57:
2092:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 6118              		.loc 1 2092 0
 6119 0120 4FF0300A 		mov	r10, #48
 6120              	.LBB58:
2094:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 6121              		.loc 1 2094 0
ARM GAS  /tmp/ccCuKxzC.s 			page 170


 6122 0124 9BF800E0 		ldrb	lr, [fp]	@ zero_extendqisi2
2095:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 6123              		.loc 1 2095 0
 6124 0128 9BF80180 		ldrb	r8, [fp, #1]	@ zero_extendqisi2
 6125              	.LVL617:
 6126              	.LBE58:
2092:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 6127              		.loc 1 2092 0
 6128 012c 0AFB00FA 		mul	r10, r10, r0
 6129              	.LBB59:
2096:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 6130              		.loc 1 2096 0
 6131 0130 9BF80210 		ldrb	r1, [fp, #2]	@ zero_extendqisi2
2095:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 6132              		.loc 1 2095 0
 6133 0134 4FEA0848 		lsl	r8, r8, #16
2097:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 6134              		.loc 1 2097 0
 6135 0138 9BF80300 		ldrb	r0, [fp, #3]	@ zero_extendqisi2
2095:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 6136              		.loc 1 2095 0
 6137 013c 48EA0E68 		orr	r8, r8, lr, lsl #24
 6138              	.LBE59:
2092:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 6139              		.loc 1 2092 0
 6140 0140 634A     		ldr	r2, .L713+32
 6141              	.LBB60:
2096:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 6142              		.loc 1 2096 0
 6143 0142 48EA0008 		orr	r8, r8, r0
2097:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 6144              		.loc 1 2097 0
 6145 0146 48EA0128 		orr	r8, r8, r1, lsl #8
 6146              	.LBE60:
2092:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 6147              		.loc 1 2092 0
 6148 014a 02EB0A03 		add	r3, r2, r10
 6149              	.LBB61:
2098:bluetooth_rxtx.c **** 			whiten_packet[i/4+1] = rbit(v);
 6150              		.loc 1 2098 0
 6151 014e 4046     		mov	r0, r8
 6152              	.LBE61:
2092:bluetooth_rxtx.c **** 		for (i=0; i<4; i+= 4) {
 6153              		.loc 1 2092 0
 6154 0150 0193     		str	r3, [sp, #4]
 6155              	.LVL618:
 6156              	.LBB62:
2098:bluetooth_rxtx.c **** 			whiten_packet[i/4+1] = rbit(v);
 6157              		.loc 1 2098 0
 6158 0152 0092     		str	r2, [sp]
 6159 0154 FFF7FEFF 		bl	rbit
 6160              	.LVL619:
 6161 0158 009A     		ldr	r2, [sp]
 6162 015a 52F80A20 		ldr	r2, [r2, r10]
 6163 015e 5040     		eors	r0, r0, r2
 6164 0160 1090     		str	r0, [sp, #64]
2099:bluetooth_rxtx.c **** 		}
ARM GAS  /tmp/ccCuKxzC.s 			page 171


 6165              		.loc 1 2099 0
 6166 0162 4046     		mov	r0, r8
 6167 0164 FFF7FEFF 		bl	rbit
 6168              	.LVL620:
 6169              	.LBE62:
2102:bluetooth_rxtx.c **** 		cfo_buf[DMA_SIZE - 1] = p[5];
 6170              		.loc 1 2102 0
 6171 0168 9DF84120 		ldrb	r2, [sp, #65]	@ zero_extendqisi2
 6172 016c 02F03F0A 		and	r10, r2, #63
 6173 0170 0AF10208 		add	r8, r10, #2
 6174              	.LVL621:
2105:bluetooth_rxtx.c **** 			goto rx_flush;
 6175              		.loc 1 2105 0
 6176 0174 B8F1270F 		cmp	r8, #39
2103:bluetooth_rxtx.c **** 
 6177              		.loc 1 2103 0
 6178 0178 8DF83920 		strb	r2, [sp, #57]
2105:bluetooth_rxtx.c **** 			goto rx_flush;
 6179              		.loc 1 2105 0
 6180 017c 00F28880 		bhi	.L661
2108:bluetooth_rxtx.c **** 		if (total_transfers < 11) {
 6181              		.loc 1 2108 0
 6182 0180 0AF1080A 		add	r10, r10, #8
 6183 0184 4FEA9A02 		lsr	r2, r10, #2
 6184              	.LVL622:
2109:bluetooth_rxtx.c **** 			while (DMACC0DestAddr < (uint32_t)rxbuf1 + 4 * total_transfers && rx_err == 0) ;
 6185              		.loc 1 2109 0
 6186 0188 0B2A     		cmp	r2, #11
 6187 018a 0BD0     		beq	.L670
2110:bluetooth_rxtx.c **** 		} else { while (DMACC0Config & DMACCxConfig_E && rx_err == 0) ;
 6188              		.loc 1 2110 0
 6189 018c 0BEB8203 		add	r3, fp, r2, lsl #2
 6190              	.LVL623:
 6191              	.L669:
 6192 0190 504A     		ldr	r2, .L713+36
 6193 0192 1268     		ldr	r2, [r2]
 6194 0194 9A42     		cmp	r2, r3
 6195 0196 09D2     		bcs	.L668
2110:bluetooth_rxtx.c **** 		} else { while (DMACC0Config & DMACCxConfig_E && rx_err == 0) ;
 6196              		.loc 1 2110 0 is_stmt 0 discriminator 2
 6197 0198 3168     		ldr	r1, [r6]
 6198 019a 0029     		cmp	r1, #0
 6199 019c F8D0     		beq	.L669
 6200 019e 05E0     		b	.L668
 6201              	.L710:
2111:bluetooth_rxtx.c **** 		}
 6202              		.loc 1 2111 0 is_stmt 1 discriminator 2
 6203 01a0 3368     		ldr	r3, [r6]
 6204 01a2 1BB9     		cbnz	r3, .L668
 6205              	.L670:
2111:bluetooth_rxtx.c **** 		}
 6206              		.loc 1 2111 0 is_stmt 0
 6207 01a4 4C4B     		ldr	r3, .L713+40
 6208 01a6 1B68     		ldr	r3, [r3]
 6209 01a8 DA07     		lsls	r2, r3, #31
 6210 01aa F9D4     		bmi	.L710
 6211              	.L668:
ARM GAS  /tmp/ccCuKxzC.s 			page 172


2114:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 6212              		.loc 1 2114 0 is_stmt 1
 6213 01ac 4B4B     		ldr	r3, .L713+44
2115:bluetooth_rxtx.c **** 
 6214              		.loc 1 2115 0
 6215 01ae 6120     		movs	r0, #97
2114:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 6216              		.loc 1 2114 0
 6217 01b0 1A68     		ldr	r2, [r3]
2117:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 6218              		.loc 1 2117 0
 6219 01b2 0426     		movs	r6, #4
2114:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 6220              		.loc 1 2114 0
 6221 01b4 22F00102 		bic	r2, r2, #1
 6222 01b8 1A60     		str	r2, [r3]
2115:bluetooth_rxtx.c **** 
 6223              		.loc 1 2115 0
 6224 01ba FFF7FEFF 		bl	cc2400_strobe
 6225              	.LVL624:
 6226              	.L672:
 6227              	.LBB63:
2118:bluetooth_rxtx.c **** 					   | rxbuf1[i+1] << 16
 6228              		.loc 1 2118 0 discriminator 2
 6229 01be 484B     		ldr	r3, .L713+48
 6230 01c0 721C     		adds	r2, r6, #1
 6231 01c2 985D     		ldrb	r0, [r3, r6]	@ zero_extendqisi2
 6232 01c4 06F1030E 		add	lr, r6, #3
2119:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 6233              		.loc 1 2119 0 discriminator 2
 6234 01c8 995C     		ldrb	r1, [r3, r2]	@ zero_extendqisi2
 6235 01ca B21C     		adds	r2, r6, #2
2120:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 6236              		.loc 1 2120 0 discriminator 2
 6237 01cc 9A5C     		ldrb	r2, [r3, r2]	@ zero_extendqisi2
2121:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 6238              		.loc 1 2121 0 discriminator 2
 6239 01ce 13F80E30 		ldrb	r3, [r3, lr]	@ zero_extendqisi2
2119:bluetooth_rxtx.c **** 					   | rxbuf1[i+2] << 8
 6240              		.loc 1 2119 0 discriminator 2
 6241 01d2 43EA0063 		orr	r3, r3, r0, lsl #24
2120:bluetooth_rxtx.c **** 					   | rxbuf1[i+3] << 0;
 6242              		.loc 1 2120 0 discriminator 2
 6243 01d6 43EA0143 		orr	r3, r3, r1, lsl #16
2121:bluetooth_rxtx.c **** 			packet[i/4+1] = rbit(v) ^ whit[i/4];
 6244              		.loc 1 2121 0 discriminator 2
 6245 01da 43EA022B 		orr	fp, r3, r2, lsl #8
 6246              	.LVL625:
2122:bluetooth_rxtx.c **** 			whiten_packet[i/4+1] = rbit(v);
 6247              		.loc 1 2122 0 discriminator 2
 6248 01de 5846     		mov	r0, fp
 6249 01e0 B210     		asrs	r2, r6, #2
 6250 01e2 0092     		str	r2, [sp]
 6251 01e4 FFF7FEFF 		bl	rbit
 6252              	.LVL626:
 6253 01e8 009A     		ldr	r2, [sp]
 6254 01ea 1CAB     		add	r3, sp, #112
ARM GAS  /tmp/ccCuKxzC.s 			page 173


 6255 01ec 03EB8201 		add	r1, r3, r2, lsl #2
 6256 01f0 019B     		ldr	r3, [sp, #4]
 6257              	.LBE63:
2117:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 6258              		.loc 1 2117 0 discriminator 2
 6259 01f2 0436     		adds	r6, r6, #4
 6260              	.LVL627:
 6261              	.LBB64:
2122:bluetooth_rxtx.c **** 			whiten_packet[i/4+1] = rbit(v);
 6262              		.loc 1 2122 0 discriminator 2
 6263 01f4 53F82220 		ldr	r2, [r3, r2, lsl #2]
 6264 01f8 5040     		eors	r0, r0, r2
 6265 01fa 41F8300C 		str	r0, [r1, #-48]
2123:bluetooth_rxtx.c **** 		}
 6266              		.loc 1 2123 0 discriminator 2
 6267 01fe 5846     		mov	r0, fp
 6268 0200 FFF7FEFF 		bl	rbit
 6269              	.LVL628:
 6270              	.LBE64:
2117:bluetooth_rxtx.c **** 			uint32_t v = rxbuf1[i+0] << 24
 6271              		.loc 1 2117 0 discriminator 2
 6272 0204 2C2E     		cmp	r6, #44
 6273 0206 DAD1     		bne	.L672
2126:bluetooth_rxtx.c **** 			u32 calc_crc = btle_crcgen_lut(le.crc_init_reversed, p + 4, len);
 6274              		.loc 1 2126 0
 6275 0208 6369     		ldr	r3, [r4, #20]
 6276 020a 73B9     		cbnz	r3, .L673
 6277              	.L676:
2135:bluetooth_rxtx.c **** 		packet_cb((uint8_t *)packet);
 6278              		.loc 1 2135 0
 6279 020c 354B     		ldr	r3, .L713+52
 6280 020e 1022     		movs	r2, #16
 6281 0210 1A60     		str	r2, [r3]
2136:bluetooth_rxtx.c **** 
 6282              		.loc 1 2136 0
 6283 0212 0FA8     		add	r0, sp, #60
 6284              	.LVL629:
 6285 0214 AB69     		ldr	r3, [r5, #24]
 6286 0216 9847     		blx	r3
 6287              	.LVL630:
2138:bluetooth_rxtx.c **** 		if (p[10] == 0x55 && p[11] == 0xec) {
 6288              		.loc 1 2138 0
 6289 0218 334B     		ldr	r3, .L713+56
 6290 021a 4FF08072 		mov	r2, #16777216
 6291 021e 1A60     		str	r2, [r3]
2139:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, (uint8_t *)packet);
 6292              		.loc 1 2139 0
 6293 0220 9DF84630 		ldrb	r3, [sp, #70]	@ zero_extendqisi2
 6294 0224 552B     		cmp	r3, #85
 6295 0226 24D1     		bne	.L675
 6296 0228 17E0     		b	.L711
 6297              	.L673:
 6298              	.LBB65:
2127:bluetooth_rxtx.c **** 			u32 wire_crc = (p[4+len+2] << 16)
 6299              		.loc 1 2127 0
 6300 022a 224B     		ldr	r3, .L713+4
 6301 022c 10A9     		add	r1, sp, #64
ARM GAS  /tmp/ccCuKxzC.s 			page 174


 6302 022e 1869     		ldr	r0, [r3, #16]
 6303 0230 4246     		mov	r2, r8
 6304 0232 FFF7FEFF 		bl	btle_crcgen_lut
 6305              	.LVL631:
2128:bluetooth_rxtx.c **** 						 | (p[4+len+1] << 8)
 6306              		.loc 1 2128 0
 6307 0236 1CAB     		add	r3, sp, #112
 6308 0238 5344     		add	r3, r3, r10
 6309 023a 13F8342C 		ldrb	r2, [r3, #-52]	@ zero_extendqisi2
2129:bluetooth_rxtx.c **** 						 | (p[4+len+0] << 0);
 6310              		.loc 1 2129 0
 6311 023e 1CAB     		add	r3, sp, #112
 6312 0240 4344     		add	r3, r3, r8
 6313 0242 13F82F1C 		ldrb	r1, [r3, #-47]	@ zero_extendqisi2
 6314 0246 0902     		lsls	r1, r1, #8
 6315 0248 41EA0241 		orr	r1, r1, r2, lsl #16
2130:bluetooth_rxtx.c **** 			if (calc_crc != wire_crc)
 6316              		.loc 1 2130 0
 6317 024c 13F8302C 		ldrb	r2, [r3, #-48]	@ zero_extendqisi2
 6318 0250 41EA0203 		orr	r3, r1, r2
2131:bluetooth_rxtx.c **** 				goto rx_flush;
 6319              		.loc 1 2131 0
 6320 0254 9842     		cmp	r0, r3
 6321 0256 1BD1     		bne	.L661
 6322 0258 D8E7     		b	.L676
 6323              	.LVL632:
 6324              	.L711:
 6325              	.LBE65:
2139:bluetooth_rxtx.c **** 			enqueue(LE_PACKET, (uint8_t *)packet);
 6326              		.loc 1 2139 0 discriminator 1
 6327 025a 9DF84730 		ldrb	r3, [sp, #71]	@ zero_extendqisi2
 6328 025e EC2B     		cmp	r3, #236
 6329 0260 07D1     		bne	.L675
2140:bluetooth_rxtx.c **** 			enqueue(CFO_TRACK, (uint8_t *)cfo_buf);
 6330              		.loc 1 2140 0
 6331 0262 0FA9     		add	r1, sp, #60
 6332              	.LVL633:
 6333 0264 0120     		movs	r0, #1
 6334 0266 FFF7FEFF 		bl	enqueue
 6335              	.LVL634:
2141:bluetooth_rxtx.c **** 			//enqueue(MESSAGE, (uint8_t *)whiten_packet);
 6336              		.loc 1 2141 0
 6337 026a 0720     		movs	r0, #7
 6338 026c 02A9     		add	r1, sp, #8
 6339 026e FFF7FEFF 		bl	enqueue
 6340              	.LVL635:
 6341              	.L675:
2144:bluetooth_rxtx.c **** 
 6342              		.loc 1 2144 0
 6343 0272 114B     		ldr	r3, .L713+8
 6344 0274 4FF08072 		mov	r2, #16777216
 6345 0278 1A60     		str	r2, [r3]
2146:bluetooth_rxtx.c **** 
 6346              		.loc 1 2146 0
 6347 027a 1C4B     		ldr	r3, .L713+60
 6348 027c 1C4A     		ldr	r2, .L713+64
 6349 027e 1B68     		ldr	r3, [r3]
ARM GAS  /tmp/ccCuKxzC.s 			page 175


 6350 0280 1268     		ldr	r2, [r2]
 6351 0282 C3F31303 		ubfx	r3, r3, #0, #20
 6352 0286 40F63541 		movw	r1, #3125
 6353 028a 01FB0323 		mla	r3, r1, r3, r2
 6354 028e 6364     		str	r3, [r4, #68]
 6355              	.LVL636:
 6356              	.L661:
2149:bluetooth_rxtx.c **** 		DIO_SSP_DMACR &= ~SSPDMACR_RXDMAE;
 6357              		.loc 1 2149 0
 6358 0290 6120     		movs	r0, #97
 6359 0292 FFF7FEFF 		bl	cc2400_strobe
 6360              	.LVL637:
2150:bluetooth_rxtx.c **** 		while (SSP1SR & SSPSR_RNE) {
 6361              		.loc 1 2150 0
 6362 0296 114B     		ldr	r3, .L713+44
 6363 0298 1A68     		ldr	r2, [r3]
 6364 029a 22F00102 		bic	r2, r2, #1
 6365 029e 1A60     		str	r2, [r3]
 6366              	.L677:
2151:bluetooth_rxtx.c **** 			u8 tmp = (u8) DIO_SSP_DR;
 6367              		.loc 1 2151 0 discriminator 1
 6368 02a0 144B     		ldr	r3, .L713+68
 6369 02a2 1B68     		ldr	r3, [r3]
 6370 02a4 5B07     		lsls	r3, r3, #29
 6371 02a6 29D5     		bpl	.L712
 6372              	.LBB66:
2152:bluetooth_rxtx.c **** 		}
 6373              		.loc 1 2152 0
 6374 02a8 134B     		ldr	r3, .L713+72
 6375 02aa 1B68     		ldr	r3, [r3]
 6376 02ac F8E7     		b	.L677
 6377              	.L714:
 6378 02ae 00BF     		.align	2
 6379              	.L713:
 6380 02b0 00000000 		.word	.LANCHOR0
 6381 02b4 00000000 		.word	.LANCHOR1
 6382 02b8 00E100E0 		.word	-536813312
 6383 02bc 3CC00920 		.word	537509948
 6384 02c0 00000000 		.word	rx_tc
 6385 02c4 00000000 		.word	rx_err
 6386 02c8 00000000 		.word	rssi_max
 6387 02cc 00000000 		.word	rssi_min
 6388 02d0 F0000000 		.word	.LANCHOR2+240
 6389 02d4 04410050 		.word	1342193924
 6390 02d8 10410050 		.word	1342193936
 6391 02dc 24000340 		.word	1073938468
 6392 02e0 00000000 		.word	rxbuf1
 6393 02e4 38C00920 		.word	537509944
 6394 02e8 80E100E0 		.word	-536813184
 6395 02ec 00000000 		.word	clkn
 6396 02f0 08400040 		.word	1073758216
 6397 02f4 0C000340 		.word	1073938444
 6398 02f8 08000340 		.word	1073938440
 6399              	.L712:
 6400              	.LBE66:
2154:bluetooth_rxtx.c **** 		if (now <le.last_packet)
 6401              		.loc 1 2154 0
ARM GAS  /tmp/ccCuKxzC.s 			page 176


 6402 02fc 414B     		ldr	r3, .L715
 6403 02fe 424A     		ldr	r2, .L715+4
 6404 0300 1B68     		ldr	r3, [r3]
 6405 0302 1268     		ldr	r2, [r2]
 6406 0304 40F63541 		movw	r1, #3125
 6407 0308 C3F31303 		ubfx	r3, r3, #0, #20
 6408 030c 01FB0323 		mla	r3, r1, r3, r2
 6409              	.LVL638:
2155:bluetooth_rxtx.c **** 			now += 3276800000;
 6410              		.loc 1 2155 0
 6411 0310 626C     		ldr	r2, [r4, #68]
2157:bluetooth_rxtx.c **** 			reset_le();
 6412              		.loc 1 2157 0
 6413 0312 217E     		ldrb	r1, [r4, #24]	@ zero_extendqisi2
2155:bluetooth_rxtx.c **** 			now += 3276800000;
 6414              		.loc 1 2155 0
 6415 0314 9342     		cmp	r3, r2
2157:bluetooth_rxtx.c **** 			reset_le();
 6416              		.loc 1 2157 0
 6417 0316 A1F10201 		sub	r1, r1, #2
2156:bluetooth_rxtx.c **** 		if ( ((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING) && (now - le.last_p
 6418              		.loc 1 2156 0
 6419 031a 38BF     		it	cc
 6420 031c 03F14343 		addcc	r3, r3, #-1023410176
 6421              	.LVL639:
2157:bluetooth_rxtx.c **** 			reset_le();
 6422              		.loc 1 2157 0
 6423 0320 C9B2     		uxtb	r1, r1
2156:bluetooth_rxtx.c **** 		if ( ((le.link_state == LINK_CONNECTED || le.link_state == LINK_CONN_PENDING) && (now - le.last_p
 6424              		.loc 1 2156 0
 6425 0322 38BF     		it	cc
 6426 0324 03F5A003 		addcc	r3, r3, #5242880
 6427              	.LVL640:
2157:bluetooth_rxtx.c **** 			reset_le();
 6428              		.loc 1 2157 0
 6429 0328 0129     		cmp	r1, #1
 6430 032a 03D8     		bhi	.L680
2157:bluetooth_rxtx.c **** 			reset_le();
 6431              		.loc 1 2157 0 is_stmt 0 discriminator 1
 6432 032c 3749     		ldr	r1, .L715+8
 6433 032e 9B1A     		subs	r3, r3, r2
 6434              	.LVL641:
 6435 0330 8B42     		cmp	r3, r1
 6436 0332 02D8     		bhi	.L681
 6437              	.L680:
2157:bluetooth_rxtx.c **** 			reset_le();
 6438              		.loc 1 2157 0 discriminator 2
 6439 0334 EB69     		ldr	r3, [r5, #28]
 6440 0336 012B     		cmp	r3, #1
 6441 0338 25D1     		bne	.L682
 6442              	.L681:
2158:bluetooth_rxtx.c **** 			le_jam_count = 0;
 6443              		.loc 1 2158 0 is_stmt 1
 6444 033a FFF7FEFF 		bl	reset_le
 6445              	.LVL642:
2160:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
 6446              		.loc 1 2160 0
ARM GAS  /tmp/ccCuKxzC.s 			page 177


 6447 033e 3449     		ldr	r1, .L715+12
2159:bluetooth_rxtx.c **** 			TXLED_CLR;
 6448              		.loc 1 2159 0
 6449 0340 0023     		movs	r3, #0
2160:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
 6450              		.loc 1 2160 0
 6451 0342 4FF48070 		mov	r0, #256
2159:bluetooth_rxtx.c **** 			TXLED_CLR;
 6452              		.loc 1 2159 0
 6453 0346 EB61     		str	r3, [r5, #28]
2160:bluetooth_rxtx.c **** 			if (jam_mode == JAM_ONCE) {
 6454              		.loc 1 2160 0
 6455 0348 0860     		str	r0, [r1]
2161:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 6456              		.loc 1 2161 0
 6457 034a E97C     		ldrb	r1, [r5, #19]	@ zero_extendqisi2
2159:bluetooth_rxtx.c **** 			TXLED_CLR;
 6458              		.loc 1 2159 0
 6459 034c 314A     		ldr	r2, .L715+16
2161:bluetooth_rxtx.c **** 				jam_mode = JAM_NONE;
 6460              		.loc 1 2161 0
 6461 034e 0129     		cmp	r1, #1
 6462 0350 02D1     		bne	.L683
2162:bluetooth_rxtx.c **** 				requested_mode = MODE_IDLE;
 6463              		.loc 1 2162 0
 6464 0352 D374     		strb	r3, [r2, #19]
2163:bluetooth_rxtx.c **** 				goto cleanup;
 6465              		.loc 1 2163 0
 6466 0354 9374     		strb	r3, [r2, #18]
2164:bluetooth_rxtx.c **** 			}
 6467              		.loc 1 2164 0
 6468 0356 47E0     		b	.L693
 6469              	.L683:
2166:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 6470              		.loc 1 2166 0
 6471 0358 0123     		movs	r3, #1
2167:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 6472              		.loc 1 2167 0
 6473 035a 6420     		movs	r0, #100
2166:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 6474              		.loc 1 2166 0
 6475 035c 2376     		strb	r3, [r4, #24]
2167:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 6476              		.loc 1 2167 0
 6477 035e FFF7FEFF 		bl	cc2400_strobe
 6478              	.LVL643:
 6479              	.L685:
2168:bluetooth_rxtx.c **** 
 6480              		.loc 1 2168 0 discriminator 1
 6481 0362 FFF7FEFF 		bl	cc2400_status
 6482              	.LVL644:
 6483 0366 4607     		lsls	r6, r0, #29
 6484 0368 FBD4     		bmi	.L685
2170:bluetooth_rxtx.c **** 			restart_jamming = 1;
 6485              		.loc 1 2170 0
 6486 036a B4F84A30 		ldrh	r3, [r4, #74]
 6487 036e 9BB2     		uxth	r3, r3
ARM GAS  /tmp/ccCuKxzC.s 			page 178


 6488 0370 23B1     		cbz	r3, .L695
2170:bluetooth_rxtx.c **** 			restart_jamming = 1;
 6489              		.loc 1 2170 0 is_stmt 0 discriminator 1
 6490 0372 294B     		ldr	r3, .L715+20
 6491 0374 B3F84A30 		ldrh	r3, [r3, #74]
 6492 0378 9BB2     		uxth	r3, r3
 6493 037a 01E0     		b	.L686
 6494              	.L695:
2170:bluetooth_rxtx.c **** 			restart_jamming = 1;
 6495              		.loc 1 2170 0
 6496 037c 40F66213 		movw	r3, #2402
 6497              	.L686:
2170:bluetooth_rxtx.c **** 			restart_jamming = 1;
 6498              		.loc 1 2170 0 discriminator 3
 6499 0380 2380     		strh	r3, [r4]	@ movhi
2171:bluetooth_rxtx.c **** 		}
 6500              		.loc 1 2171 0 is_stmt 1 discriminator 3
 6501 0382 0123     		movs	r3, #1
 6502 0384 6B63     		str	r3, [r5, #52]
 6503              	.L682:
2174:bluetooth_rxtx.c **** 		cc2400_set(SYNCH, le.synch);
 6504              		.loc 1 2174 0
 6505 0386 2C20     		movs	r0, #44
 6506 0388 6189     		ldrh	r1, [r4, #10]
 6507 038a FFF7FEFF 		bl	cc2400_set
 6508              	.LVL645:
2175:bluetooth_rxtx.c **** 
 6509              		.loc 1 2175 0
 6510 038e 2D20     		movs	r0, #45
 6511 0390 2189     		ldrh	r1, [r4, #8]
 6512 0392 FFF7FEFF 		bl	cc2400_set
 6513              	.LVL646:
2177:bluetooth_rxtx.c **** 			hop();
 6514              		.loc 1 2177 0
 6515 0396 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 6516 0398 0BB1     		cbz	r3, .L687
2178:bluetooth_rxtx.c **** 		if (le_jam_count > 0) {
 6517              		.loc 1 2178 0
 6518 039a FFF7FEFF 		bl	hop
 6519              	.LVL647:
 6520              	.L687:
2179:bluetooth_rxtx.c **** 			le_jam();
 6521              		.loc 1 2179 0
 6522 039e EB69     		ldr	r3, [r5, #28]
 6523 03a0 1C4E     		ldr	r6, .L715+16
 6524 03a2 002B     		cmp	r3, #0
 6525 03a4 05DD     		ble	.L688
2180:bluetooth_rxtx.c **** 			--le_jam_count;
 6526              		.loc 1 2180 0
 6527 03a6 FFF7FEFF 		bl	le_jam
 6528              	.LVL648:
2181:bluetooth_rxtx.c **** 		} else {
 6529              		.loc 1 2181 0
 6530 03aa F369     		ldr	r3, [r6, #28]
 6531 03ac 013B     		subs	r3, r3, #1
 6532 03ae F361     		str	r3, [r6, #28]
 6533 03b0 14E0     		b	.L689
ARM GAS  /tmp/ccCuKxzC.s 			page 179


 6534              	.L688:
2183:bluetooth_rxtx.c **** 			dio_ssp_start();
 6535              		.loc 1 2183 0
 6536 03b2 FFF7FEFF 		bl	dma_init_le
 6537              	.LVL649:
2184:bluetooth_rxtx.c **** 
 6538              		.loc 1 2184 0
 6539 03b6 FFF7FEFF 		bl	dio_ssp_start
 6540              	.LVL650:
2186:bluetooth_rxtx.c **** 				cc2400_rx_sync(rbit(le.access_address));
 6541              		.loc 1 2186 0
 6542 03ba 736B     		ldr	r3, [r6, #52]
 6543 03bc 3BB1     		cbz	r3, .L692
2187:bluetooth_rxtx.c **** 				restart_jamming = 0;
 6544              		.loc 1 2187 0
 6545 03be 6068     		ldr	r0, [r4, #4]
 6546 03c0 FFF7FEFF 		bl	rbit
 6547              	.LVL651:
 6548 03c4 FFF7FEFF 		bl	cc2400_rx_sync
 6549              	.LVL652:
2188:bluetooth_rxtx.c **** 			} else {
 6550              		.loc 1 2188 0
 6551 03c8 0023     		movs	r3, #0
 6552 03ca 7363     		str	r3, [r6, #52]
 6553 03cc 06E0     		b	.L689
 6554              	.L692:
2190:bluetooth_rxtx.c **** 				cc2400_strobe(SRX);
 6555              		.loc 1 2190 0
 6556 03ce FFF7FEFF 		bl	cc2400_status
 6557              	.LVL653:
 6558 03d2 4007     		lsls	r0, r0, #29
 6559 03d4 FBD5     		bpl	.L692
2191:bluetooth_rxtx.c **** 			}
 6560              		.loc 1 2191 0
 6561 03d6 6220     		movs	r0, #98
 6562 03d8 FFF7FEFF 		bl	cc2400_strobe
 6563              	.LVL654:
 6564              	.L689:
2195:bluetooth_rxtx.c **** 
 6565              		.loc 1 2195 0 discriminator 1
 6566 03dc 0F4A     		ldr	r2, .L715+24
2194:bluetooth_rxtx.c **** 		rx_err = 0;
 6567              		.loc 1 2194 0 discriminator 1
 6568 03de 0023     		movs	r3, #0
 6569 03e0 C9F80030 		str	r3, [r9]
2195:bluetooth_rxtx.c **** 
 6570              		.loc 1 2195 0 discriminator 1
 6571 03e4 1360     		str	r3, [r2]
 6572 03e6 2EE6     		b	.L650
 6573              	.L693:
 6574              	.LBE56:
2201:bluetooth_rxtx.c **** 	cc2400_idle();
 6575              		.loc 1 2201 0
 6576 03e8 0D4B     		ldr	r3, .L715+28
 6577 03ea 4FF08072 		mov	r2, #16777216
 6578 03ee 1A60     		str	r2, [r3]
2202:bluetooth_rxtx.c **** 	dio_ssp_stop ();
ARM GAS  /tmp/ccCuKxzC.s 			page 180


 6579              		.loc 1 2202 0
 6580 03f0 FFF7FEFF 		bl	cc2400_idle
 6581              	.LVL655:
2203:bluetooth_rxtx.c **** 	cs_trigger_disable();
 6582              		.loc 1 2203 0
 6583 03f4 FFF7FEFF 		bl	dio_ssp_stop
 6584              	.LVL656:
2204:bluetooth_rxtx.c **** }
 6585              		.loc 1 2204 0
 6586 03f8 FFF7FEFF 		bl	cs_trigger_disable
 6587              	.LVL657:
2205:bluetooth_rxtx.c **** 
 6588              		.loc 1 2205 0
 6589 03fc 1DB0     		add	sp, sp, #116
 6590              		@ sp needed
 6591 03fe BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 6592              	.L716:
 6593 0402 00BF     		.align	2
 6594              	.L715:
 6595 0404 00000000 		.word	clkn
 6596 0408 08400040 		.word	1073758216
 6597 040c 80F0FA02 		.word	50000000
 6598 0410 3CC00920 		.word	537509948
 6599 0414 00000000 		.word	.LANCHOR0
 6600 0418 00000000 		.word	.LANCHOR1
 6601 041c 00000000 		.word	rx_err
 6602 0420 80E100E0 		.word	-536813184
 6603              		.cfi_endproc
 6604              	.LFE25:
 6606              		.section	.text.bt_follow_le,"ax",%progbits
 6607              		.align	1
 6608              		.global	bt_follow_le
 6609              		.thumb
 6610              		.thumb_func
 6612              	bt_follow_le:
 6613              	.LFB28:
2368:bluetooth_rxtx.c **** 		}
2369:bluetooth_rxtx.c **** 	}
2370:bluetooth_rxtx.c **** }
2371:bluetooth_rxtx.c **** 
2372:bluetooth_rxtx.c **** void bt_follow_le() {
 6614              		.loc 1 2372 0
 6615              		.cfi_startproc
 6616              		@ args = 0, pretend = 0, frame = 0
 6617              		@ frame_needed = 0, uses_anonymous_args = 0
 6618 0000 10B5     		push	{r4, lr}
 6619              		.cfi_def_cfa_offset 8
 6620              		.cfi_offset 4, -8
 6621              		.cfi_offset 14, -4
2373:bluetooth_rxtx.c **** 	reset_le();
 6622              		.loc 1 2373 0
 6623 0002 FFF7FEFF 		bl	reset_le
 6624              	.LVL658:
2374:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 6625              		.loc 1 2374 0
 6626 0006 044C     		ldr	r4, .L718
 6627 0008 044B     		ldr	r3, .L718+4
ARM GAS  /tmp/ccCuKxzC.s 			page 181


2375:bluetooth_rxtx.c **** 	bt_le_sync(MODE_BT_FOLLOW_LE);
 6628              		.loc 1 2375 0
 6629 000a 0920     		movs	r0, #9
2374:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 6630              		.loc 1 2374 0
 6631 000c A361     		str	r3, [r4, #24]
 6632              		.loc 1 2375 0
 6633 000e FFF7FEFF 		bl	bt_le_sync
 6634              	.LVL659:
2376:bluetooth_rxtx.c **** 
2377:bluetooth_rxtx.c **** 	/* old non-sync mode
2378:bluetooth_rxtx.c **** 	data_cb = cb_follow_le;
2379:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
2380:bluetooth_rxtx.c **** 	bt_generic_le(MODE_BT_FOLLOW_LE);
2381:bluetooth_rxtx.c **** 	*/
2382:bluetooth_rxtx.c **** 
2383:bluetooth_rxtx.c **** 	mode = MODE_IDLE;
 6635              		.loc 1 2383 0
 6636 0012 0023     		movs	r3, #0
 6637 0014 6374     		strb	r3, [r4, #17]
 6638 0016 10BD     		pop	{r4, pc}
 6639              	.L719:
 6640              		.align	2
 6641              	.L718:
 6642 0018 00000000 		.word	.LANCHOR0
 6643 001c 00000000 		.word	connection_follow_cb
 6644              		.cfi_endproc
 6645              	.LFE28:
 6647              		.section	.text.bt_tracking_le,"ax",%progbits
 6648              		.align	1
 6649              		.global	bt_tracking_le
 6650              		.thumb
 6651              		.thumb_func
 6653              	bt_tracking_le:
 6654              	.LFB29:
2384:bluetooth_rxtx.c **** }
2385:bluetooth_rxtx.c **** 
2386:bluetooth_rxtx.c **** //JWHUR rssi estimation tracking
2387:bluetooth_rxtx.c **** void bt_tracking_le(uint8_t tracking_mode) {
 6655              		.loc 1 2387 0
 6656              		.cfi_startproc
 6657              		@ args = 0, pretend = 0, frame = 0
 6658              		@ frame_needed = 0, uses_anonymous_args = 0
 6659              	.LVL660:
 6660 0000 38B5     		push	{r3, r4, r5, lr}
 6661              		.cfi_def_cfa_offset 16
 6662              		.cfi_offset 3, -16
 6663              		.cfi_offset 4, -12
 6664              		.cfi_offset 5, -8
 6665              		.cfi_offset 14, -4
 6666              		.loc 1 2387 0
 6667 0002 0446     		mov	r4, r0
2388:bluetooth_rxtx.c **** 	reset_le();
 6668              		.loc 1 2388 0
 6669 0004 FFF7FEFF 		bl	reset_le
 6670              	.LVL661:
2389:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
ARM GAS  /tmp/ccCuKxzC.s 			page 182


 6671              		.loc 1 2389 0
 6672 0008 084B     		ldr	r3, .L723
 6673 000a 094A     		ldr	r2, .L723+4
2390:bluetooth_rxtx.c **** 	if (tracking_mode == MODE_BT_CFO_LE) bt_le_sync_cfo(MODE_BT_CFO_LE);
 6674              		.loc 1 2390 0
 6675 000c 112C     		cmp	r4, #17
2389:bluetooth_rxtx.c **** 	packet_cb = connection_follow_cb;
 6676              		.loc 1 2389 0
 6677 000e 9A61     		str	r2, [r3, #24]
 6678 0010 1D46     		mov	r5, r3
 6679              		.loc 1 2390 0
 6680 0012 03D1     		bne	.L721
 6681              		.loc 1 2390 0 is_stmt 0 discriminator 1
 6682 0014 2046     		mov	r0, r4
 6683 0016 FFF7FEFF 		bl	bt_le_sync_cfo
 6684              	.LVL662:
 6685 001a 04E0     		b	.L722
 6686              	.L721:
2391:bluetooth_rxtx.c **** 	if (tracking_mode == MODE_BT_RSSI_LE) bt_le_sync_rssi(MODE_BT_RSSI_LE);
 6687              		.loc 1 2391 0 is_stmt 1
 6688 001c 122C     		cmp	r4, #18
 6689 001e 02D1     		bne	.L722
 6690              		.loc 1 2391 0 is_stmt 0 discriminator 1
 6691 0020 2046     		mov	r0, r4
 6692 0022 FFF7FEFF 		bl	bt_le_sync_rssi
 6693              	.LVL663:
 6694              	.L722:
2392:bluetooth_rxtx.c **** 	requested_mode = MODE_IDLE;
 6695              		.loc 1 2392 0 is_stmt 1
 6696 0026 0023     		movs	r3, #0
 6697 0028 AB74     		strb	r3, [r5, #18]
 6698 002a 38BD     		pop	{r3, r4, r5, pc}
 6699              	.L724:
 6700              		.align	2
 6701              	.L723:
 6702 002c 00000000 		.word	.LANCHOR0
 6703 0030 00000000 		.word	connection_follow_cb
 6704              		.cfi_endproc
 6705              	.LFE29:
 6707              		.section	.text.le_promisc_state,"ax",%progbits
 6708              		.align	1
 6709              		.global	le_promisc_state
 6710              		.thumb
 6711              		.thumb_func
 6713              	le_promisc_state:
 6714              	.LFB30:
2393:bluetooth_rxtx.c **** }
2394:bluetooth_rxtx.c **** 
2395:bluetooth_rxtx.c **** // issue state change message
2396:bluetooth_rxtx.c **** void le_promisc_state(u8 type, void *data, unsigned len) {
 6715              		.loc 1 2396 0
 6716              		.cfi_startproc
 6717              		@ args = 0, pretend = 0, frame = 56
 6718              		@ frame_needed = 0, uses_anonymous_args = 0
 6719              	.LVL664:
 6720 0000 70B5     		push	{r4, r5, r6, lr}
 6721              		.cfi_def_cfa_offset 16
ARM GAS  /tmp/ccCuKxzC.s 			page 183


 6722              		.cfi_offset 4, -16
 6723              		.cfi_offset 5, -12
 6724              		.cfi_offset 6, -8
 6725              		.cfi_offset 14, -4
 6726 0002 8EB0     		sub	sp, sp, #56
 6727              		.cfi_def_cfa_offset 72
 6728              		.loc 1 2396 0
 6729 0004 0646     		mov	r6, r0
 6730 0006 0D46     		mov	r5, r1
 6731 0008 1446     		mov	r4, r2
2397:bluetooth_rxtx.c **** 	u8 buf[50] = { 0, };
 6732              		.loc 1 2397 0
 6733 000a 01A8     		add	r0, sp, #4
 6734              	.LVL665:
 6735 000c 0021     		movs	r1, #0
 6736              	.LVL666:
 6737 000e 3222     		movs	r2, #50
 6738              	.LVL667:
 6739 0010 FFF7FEFF 		bl	memset
 6740              	.LVL668:
2398:bluetooth_rxtx.c **** 	if (len > 49)
2399:bluetooth_rxtx.c **** 		len = 49;
2400:bluetooth_rxtx.c **** 
2401:bluetooth_rxtx.c **** 	buf[0] = type;
2402:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 6741              		.loc 1 2402 0
 6742 0014 2946     		mov	r1, r5
 6743 0016 312C     		cmp	r4, #49
 6744 0018 34BF     		ite	cc
 6745 001a 2246     		movcc	r2, r4
 6746 001c 3122     		movcs	r2, #49
 6747              	.LVL669:
 6748 001e 0DF10500 		add	r0, sp, #5
2401:bluetooth_rxtx.c **** 	memcpy(&buf[1], data, len);
 6749              		.loc 1 2401 0
 6750 0022 8DF80460 		strb	r6, [sp, #4]
 6751              		.loc 1 2402 0
 6752 0026 FFF7FEFF 		bl	memcpy
 6753              	.LVL670:
2403:bluetooth_rxtx.c **** 	enqueue(LE_PROMISC, (uint8_t*)buf);
 6754              		.loc 1 2403 0
 6755 002a 01A9     		add	r1, sp, #4
 6756 002c 0520     		movs	r0, #5
 6757 002e FFF7FEFF 		bl	enqueue
 6758              	.LVL671:
2404:bluetooth_rxtx.c **** }
 6759              		.loc 1 2404 0
 6760 0032 0EB0     		add	sp, sp, #56
 6761              		@ sp needed
 6762 0034 70BD     		pop	{r4, r5, r6, pc}
 6763              		.cfi_endproc
 6764              	.LFE30:
 6766              		.section	.text.promisc_recover_hop_increment,"ax",%progbits
 6767              		.align	1
 6768              		.global	promisc_recover_hop_increment
 6769              		.thumb
 6770              		.thumb_func
ARM GAS  /tmp/ccCuKxzC.s 			page 184


 6772              	promisc_recover_hop_increment:
 6773              	.LFB31:
2405:bluetooth_rxtx.c **** 
2406:bluetooth_rxtx.c **** // divide, rounding to the nearest integer: round up at 0.5.
2407:bluetooth_rxtx.c **** #define DIVIDE_ROUND(N, D) ((N) + (D)/2) / (D)
2408:bluetooth_rxtx.c **** 
2409:bluetooth_rxtx.c **** void promisc_recover_hop_increment(u8 *packet) {
 6774              		.loc 1 2409 0
 6775              		.cfi_startproc
 6776              		@ args = 0, pretend = 0, frame = 0
 6777              		@ frame_needed = 0, uses_anonymous_args = 0
 6778              	.LVL672:
 6779 0000 38B5     		push	{r3, r4, r5, lr}
 6780              		.cfi_def_cfa_offset 16
 6781              		.cfi_offset 3, -16
 6782              		.cfi_offset 4, -12
 6783              		.cfi_offset 5, -8
 6784              		.cfi_offset 14, -4
2410:bluetooth_rxtx.c **** 	static u32 first_ts = 0;
2411:bluetooth_rxtx.c **** 	if (channel == 2404) {
 6785              		.loc 1 2411 0
 6786 0002 314A     		ldr	r2, .L735
 6787 0004 40F66413 		movw	r3, #2404
 6788 0008 1188     		ldrh	r1, [r2]
 6789 000a 304C     		ldr	r4, .L735+4
 6790 000c 89B2     		uxth	r1, r1
 6791 000e 9942     		cmp	r1, r3
 6792 0010 0DD1     		bne	.L727
2412:bluetooth_rxtx.c **** 		first_ts = CLK100NS;
 6793              		.loc 1 2412 0
 6794 0012 2F4B     		ldr	r3, .L735+8
 6795 0014 2F4A     		ldr	r2, .L735+12
 6796 0016 1B68     		ldr	r3, [r3]
 6797 0018 1268     		ldr	r2, [r2]
 6798 001a C3F31303 		ubfx	r3, r3, #0, #20
 6799 001e 40F63541 		movw	r1, #3125
 6800 0022 01FB0323 		mla	r3, r1, r3, r2
 6801 0026 A363     		str	r3, [r4, #56]
2413:bluetooth_rxtx.c **** 		hop_direct_channel = 2406;
 6802              		.loc 1 2413 0
 6803 0028 40F66613 		movw	r3, #2406
 6804 002c 48E0     		b	.L729
 6805              	.L727:
2414:bluetooth_rxtx.c **** 		do_hop = 1;
2415:bluetooth_rxtx.c **** 	} else if (channel == 2406) {
 6806              		.loc 1 2415 0
 6807 002e 1088     		ldrh	r0, [r2]
 6808              	.LVL673:
 6809 0030 40F66611 		movw	r1, #2406
 6810 0034 80B2     		uxth	r0, r0
 6811 0036 8842     		cmp	r0, r1
 6812 0038 42D1     		bne	.L729
 6813              	.LVL674:
 6814              	.LBB71:
 6815              	.LBB72:
 6816              	.LBB73:
2416:bluetooth_rxtx.c **** 		u32 second_ts = CLK100NS;
ARM GAS  /tmp/ccCuKxzC.s 			page 185


 6817              		.loc 1 2416 0
 6818 003a 254B     		ldr	r3, .L735+8
 6819 003c 2549     		ldr	r1, .L735+12
 6820 003e 1B68     		ldr	r3, [r3]
 6821 0040 0968     		ldr	r1, [r1]
 6822 0042 40F63540 		movw	r0, #3125
 6823 0046 C3F31303 		ubfx	r3, r3, #0, #20
 6824 004a 00FB0313 		mla	r3, r0, r3, r1
 6825              	.LVL675:
2417:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
 6826              		.loc 1 2417 0
 6827 004e A06B     		ldr	r0, [r4, #56]
2418:bluetooth_rxtx.c **** 			second_ts += 3276800000; // handle rollover
2419:bluetooth_rxtx.c **** 		// Number of channels hopped between previous and current timestamp.
2420:bluetooth_rxtx.c **** 		u32 channels_hopped = DIVIDE_ROUND(second_ts - first_ts,
 6828              		.loc 1 2420 0
 6829 0050 528C     		ldrh	r2, [r2, #34]
2417:bluetooth_rxtx.c **** 		if (second_ts < first_ts)
 6830              		.loc 1 2417 0
 6831 0052 8342     		cmp	r3, r0
2418:bluetooth_rxtx.c **** 			second_ts += 3276800000; // handle rollover
 6832              		.loc 1 2418 0
 6833 0054 3CBF     		itt	cc
 6834 0056 03F14343 		addcc	r3, r3, #-1023410176
 6835              	.LVL676:
 6836 005a 03F5A003 		addcc	r3, r3, #5242880
 6837              	.LVL677:
 6838              		.loc 1 2420 0
 6839 005e 1B1A     		subs	r3, r3, r0
 6840              	.LVL678:
 6841 0060 43F2D405 		movw	r5, #12500
 6842 0064 41F66A00 		movw	r0, #6250
 6843 0068 00FB0233 		mla	r3, r0, r2, r3
 6844 006c 5543     		muls	r5, r2, r5
 6845 006e B3FBF5F3 		udiv	r3, r3, r5
 6846              	.LVL679:
2421:bluetooth_rxtx.c **** 										   le.conn_interval * LE_BASECLK);
2422:bluetooth_rxtx.c **** 		if (channels_hopped < 37) {
 6847              		.loc 1 2422 0
 6848 0072 242B     		cmp	r3, #36
2420:bluetooth_rxtx.c **** 										   le.conn_interval * LE_BASECLK);
 6849              		.loc 1 2420 0
 6850 0074 1449     		ldr	r1, .L735
 6851              		.loc 1 2422 0
 6852 0076 21D8     		bhi	.L731
2423:bluetooth_rxtx.c **** 			// Get the hop increment based on the number of channels hopped.
2424:bluetooth_rxtx.c **** 			le.channel_increment = hop_interval_lut[channels_hopped];
 6853              		.loc 1 2424 0
 6854 0078 1748     		ldr	r0, .L735+16
2425:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 6855              		.loc 1 2425 0
 6856 007a 5208     		lsrs	r2, r2, #1
2424:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 6857              		.loc 1 2424 0
 6858 007c 0344     		add	r3, r3, r0
 6859              	.LVL680:
 6860 007e 93F87008 		ldrb	r0, [r3, #2160]	@ zero_extendqisi2
ARM GAS  /tmp/ccCuKxzC.s 			page 186


 6861              		.loc 1 2425 0
 6862 0082 0A84     		strh	r2, [r1, #32]	@ movhi
2424:bluetooth_rxtx.c **** 			le.interval_timer = le.conn_interval / 2;
 6863              		.loc 1 2424 0
 6864 0084 8876     		strb	r0, [r1, #26]
2426:bluetooth_rxtx.c **** 			le.conn_count = 0;
2427:bluetooth_rxtx.c **** 			le.conn_epoch = 0;
2428:bluetooth_rxtx.c **** 			do_hop = 0;
2429:bluetooth_rxtx.c **** 			// Move on to regular connection following.
2430:bluetooth_rxtx.c **** 			le.channel_idx = (1 + le.channel_increment) % 37;
 6865              		.loc 1 2430 0
 6866 0086 2522     		movs	r2, #37
 6867 0088 0130     		adds	r0, r0, #1
 6868 008a 90FBF2F5 		sdiv	r5, r0, r2
 6869 008e 02FB1502 		mls	r2, r2, r5, r0
2426:bluetooth_rxtx.c **** 			le.conn_count = 0;
 6870              		.loc 1 2426 0
 6871 0092 0023     		movs	r3, #0
 6872              	.LVL681:
 6873 0094 8B84     		strh	r3, [r1, #36]	@ movhi
2427:bluetooth_rxtx.c **** 			do_hop = 0;
 6874              		.loc 1 2427 0
 6875 0096 CB61     		str	r3, [r1, #28]
2428:bluetooth_rxtx.c **** 			// Move on to regular connection following.
 6876              		.loc 1 2428 0
 6877 0098 E372     		strb	r3, [r4, #11]
2431:bluetooth_rxtx.c **** 			le.link_state = LINK_CONNECTED;
 6878              		.loc 1 2431 0
 6879 009a 0320     		movs	r0, #3
2432:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 6880              		.loc 1 2432 0
 6881 009c 4B61     		str	r3, [r1, #20]
2433:bluetooth_rxtx.c **** 			hop_mode = HOP_BTLE;
2434:bluetooth_rxtx.c **** 			packet_cb = connection_follow_cb;
 6882              		.loc 1 2434 0
 6883 009e 0F4B     		ldr	r3, .L735+20
2430:bluetooth_rxtx.c **** 			le.link_state = LINK_CONNECTED;
 6884              		.loc 1 2430 0
 6885 00a0 4A76     		strb	r2, [r1, #25]
2431:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 6886              		.loc 1 2431 0
 6887 00a2 0876     		strb	r0, [r1, #24]
2435:bluetooth_rxtx.c **** 			le_promisc_state(3, &le.channel_increment, 1);
 6888              		.loc 1 2435 0
 6889 00a4 0122     		movs	r2, #1
 6890 00a6 1A31     		adds	r1, r1, #26
2434:bluetooth_rxtx.c **** 			le_promisc_state(3, &le.channel_increment, 1);
 6891              		.loc 1 2434 0
 6892 00a8 A361     		str	r3, [r4, #24]
2433:bluetooth_rxtx.c **** 			packet_cb = connection_follow_cb;
 6893              		.loc 1 2433 0
 6894 00aa A072     		strb	r0, [r4, #10]
 6895              		.loc 1 2435 0
 6896 00ac FFF7FEFF 		bl	le_promisc_state
 6897              	.LVL682:
2436:bluetooth_rxtx.c **** 
2437:bluetooth_rxtx.c **** 			if (jam_mode != JAM_NONE)
ARM GAS  /tmp/ccCuKxzC.s 			page 187


 6898              		.loc 1 2437 0
 6899 00b0 E37C     		ldrb	r3, [r4, #19]	@ zero_extendqisi2
 6900 00b2 43B1     		cbz	r3, .L726
2438:bluetooth_rxtx.c **** 				le_jam_count = JAM_COUNT_DEFAULT;
 6901              		.loc 1 2438 0
 6902 00b4 054B     		ldr	r3, .L735+4
 6903 00b6 2822     		movs	r2, #40
 6904 00b8 DA61     		str	r2, [r3, #28]
 6905 00ba 38BD     		pop	{r3, r4, r5, pc}
 6906              	.LVL683:
 6907              	.L731:
2439:bluetooth_rxtx.c **** 
2440:bluetooth_rxtx.c **** 			return;
2441:bluetooth_rxtx.c **** 		}
2442:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 6908              		.loc 1 2442 0
 6909 00bc 40F66413 		movw	r3, #2404
 6910              	.LVL684:
 6911              	.L729:
 6912              	.LBE73:
 6913              	.LBE72:
 6914              	.LBE71:
2443:bluetooth_rxtx.c **** 		do_hop = 1;
2444:bluetooth_rxtx.c **** 	}
2445:bluetooth_rxtx.c **** 	else {
2446:bluetooth_rxtx.c **** 		hop_direct_channel = 2404;
 6915              		.loc 1 2446 0
 6916 00c0 A381     		strh	r3, [r4, #12]	@ movhi
2447:bluetooth_rxtx.c **** 		do_hop = 1;
 6917              		.loc 1 2447 0
 6918 00c2 0123     		movs	r3, #1
 6919 00c4 E372     		strb	r3, [r4, #11]
 6920              	.L726:
 6921 00c6 38BD     		pop	{r3, r4, r5, pc}
 6922              	.L736:
 6923              		.align	2
 6924              	.L735:
 6925 00c8 00000000 		.word	.LANCHOR1
 6926 00cc 00000000 		.word	.LANCHOR0
 6927 00d0 00000000 		.word	clkn
 6928 00d4 08400040 		.word	1073758216
 6929 00d8 00000000 		.word	.LANCHOR2
 6930 00dc 00000000 		.word	connection_follow_cb
 6931              		.cfi_endproc
 6932              	.LFE31:
 6934              		.section	.text.promisc_recover_hop_interval,"ax",%progbits
 6935              		.align	1
 6936              		.global	promisc_recover_hop_interval
 6937              		.thumb
 6938              		.thumb_func
 6940              	promisc_recover_hop_interval:
 6941              	.LFB32:
2448:bluetooth_rxtx.c **** 	}
2449:bluetooth_rxtx.c **** }
2450:bluetooth_rxtx.c **** 
2451:bluetooth_rxtx.c **** void promisc_recover_hop_interval(u8 *packet) {
 6942              		.loc 1 2451 0
ARM GAS  /tmp/ccCuKxzC.s 			page 188


 6943              		.cfi_startproc
 6944              		@ args = 0, pretend = 0, frame = 0
 6945              		@ frame_needed = 0, uses_anonymous_args = 0
 6946              	.LVL685:
 6947 0000 38B5     		push	{r3, r4, r5, lr}
 6948              		.cfi_def_cfa_offset 16
 6949              		.cfi_offset 3, -16
 6950              		.cfi_offset 4, -12
 6951              		.cfi_offset 5, -8
 6952              		.cfi_offset 14, -4
2452:bluetooth_rxtx.c **** 	static u32 prev_clk = 0;
2453:bluetooth_rxtx.c **** 
2454:bluetooth_rxtx.c **** 	u32 cur_clk = CLK100NS;
 6953              		.loc 1 2454 0
 6954 0002 254B     		ldr	r3, .L743
 6955 0004 40F63542 		movw	r2, #3125
 6956 0008 1C68     		ldr	r4, [r3]
 6957 000a 244B     		ldr	r3, .L743+4
 6958 000c C4F31304 		ubfx	r4, r4, #0, #20
 6959 0010 1B68     		ldr	r3, [r3]
2455:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
 6960              		.loc 1 2455 0
 6961 0012 234D     		ldr	r5, .L743+8
2454:bluetooth_rxtx.c **** 	if (cur_clk < prev_clk)
 6962              		.loc 1 2454 0
 6963 0014 02FB0434 		mla	r4, r2, r4, r3
 6964              	.LVL686:
 6965              		.loc 1 2455 0
 6966 0018 EB6B     		ldr	r3, [r5, #60]
 6967 001a 9C42     		cmp	r4, r3
 6968 001c 05D2     		bcs	.L738
2456:bluetooth_rxtx.c **** 		cur_clk += 3267800000; // handle rollover
 6969              		.loc 1 2456 0
 6970 001e 04F14344 		add	r4, r4, #-1023410176
 6971              	.LVL687:
 6972 0022 A4F56514 		sub	r4, r4, #3751936
 6973              	.LVL688:
 6974 0026 A4F5A254 		sub	r4, r4, #5184
 6975              	.LVL689:
 6976              	.L738:
2457:bluetooth_rxtx.c **** 	u32 clk_diff = cur_clk - prev_clk;
 6977              		.loc 1 2457 0
 6978 002a E31A     		subs	r3, r4, r3
 6979              	.LVL690:
2458:bluetooth_rxtx.c **** 	u16 obsv_hop_interval; // observed hop interval
2459:bluetooth_rxtx.c **** 
2460:bluetooth_rxtx.c **** 	// probably consecutive data packets on the same channel
2461:bluetooth_rxtx.c **** 	if (clk_diff < 2 * LE_BASECLK)
 6980              		.loc 1 2461 0
 6981 002c 46F2A712 		movw	r2, #24999
 6982 0030 9342     		cmp	r3, r2
 6983 0032 30D9     		bls	.L737
2462:bluetooth_rxtx.c **** 		return;
2463:bluetooth_rxtx.c **** 
2464:bluetooth_rxtx.c **** 	if (clk_diff < le_promisc.smallest_hop_interval)
 6984              		.loc 1 2464 0
 6985 0034 1B4A     		ldr	r2, .L743+12
ARM GAS  /tmp/ccCuKxzC.s 			page 189


 6986 0036 D2F80011 		ldr	r1, [r2, #256]
 6987 003a 8B42     		cmp	r3, r1
2465:bluetooth_rxtx.c **** 		le_promisc.smallest_hop_interval = clk_diff;
 6988              		.loc 1 2465 0
 6989 003c 38BF     		it	cc
 6990 003e C2F80031 		strcc	r3, [r2, #256]
2466:bluetooth_rxtx.c **** 
2467:bluetooth_rxtx.c **** 	obsv_hop_interval = DIVIDE_ROUND(le_promisc.smallest_hop_interval, 37 * LE_BASECLK);
 6991              		.loc 1 2467 0
 6992 0042 D2F80021 		ldr	r2, [r2, #256]
 6993 0046 1849     		ldr	r1, .L743+16
 6994 0048 02F56132 		add	r2, r2, #230400
 6995 004c 02F25232 		addw	r2, r2, #850
 6996 0050 B2FBF1F2 		udiv	r2, r2, r1
2468:bluetooth_rxtx.c **** 
2469:bluetooth_rxtx.c **** 	if (le.conn_interval == obsv_hop_interval) {
 6997              		.loc 1 2469 0
 6998 0054 1549     		ldr	r1, .L743+20
2467:bluetooth_rxtx.c **** 
 6999              		.loc 1 2467 0
 7000 0056 92B2     		uxth	r2, r2
 7001              	.LVL691:
 7002              		.loc 1 2469 0
 7003 0058 488C     		ldrh	r0, [r1, #34]
 7004              	.LVL692:
2467:bluetooth_rxtx.c **** 
 7005              		.loc 1 2467 0
 7006 005a 124B     		ldr	r3, .L743+12
 7007              	.LVL693:
 7008              		.loc 1 2469 0
 7009 005c 9042     		cmp	r0, r2
 7010 005e 15D1     		bne	.L741
2470:bluetooth_rxtx.c **** 		// 5 consecutive hop intervals: consider it legit and move on
2471:bluetooth_rxtx.c **** 		++le_promisc.consec_intervals;
 7011              		.loc 1 2471 0
 7012 0060 D3F80421 		ldr	r2, [r3, #260]
 7013              	.LVL694:
 7014 0064 0132     		adds	r2, r2, #1
2472:bluetooth_rxtx.c **** 		if (le_promisc.consec_intervals == 5) {
 7015              		.loc 1 2472 0
 7016 0066 052A     		cmp	r2, #5
2471:bluetooth_rxtx.c **** 		if (le_promisc.consec_intervals == 5) {
 7017              		.loc 1 2471 0
 7018 0068 C3F80421 		str	r2, [r3, #260]
 7019              		.loc 1 2472 0
 7020 006c 12D1     		bne	.L742
2473:bluetooth_rxtx.c **** 			packet_cb = promisc_recover_hop_increment;
 7021              		.loc 1 2473 0
 7022 006e 104B     		ldr	r3, .L743+24
2474:bluetooth_rxtx.c **** 			hop_direct_channel = 2404;
2475:bluetooth_rxtx.c **** 			hop_mode = HOP_DIRECT;
2476:bluetooth_rxtx.c **** 			do_hop = 1;
2477:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 7023              		.loc 1 2477 0
 7024 0070 0220     		movs	r0, #2
2473:bluetooth_rxtx.c **** 			packet_cb = promisc_recover_hop_increment;
 7025              		.loc 1 2473 0
ARM GAS  /tmp/ccCuKxzC.s 			page 190


 7026 0072 AB61     		str	r3, [r5, #24]
2474:bluetooth_rxtx.c **** 			hop_direct_channel = 2404;
 7027              		.loc 1 2474 0
 7028 0074 40F66413 		movw	r3, #2404
 7029 0078 AB81     		strh	r3, [r5, #12]	@ movhi
2475:bluetooth_rxtx.c **** 			do_hop = 1;
 7030              		.loc 1 2475 0
 7031 007a 0423     		movs	r3, #4
 7032 007c AB72     		strb	r3, [r5, #10]
 7033              		.loc 1 2477 0
 7034 007e 2231     		adds	r1, r1, #34
2476:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 7035              		.loc 1 2476 0
 7036 0080 0123     		movs	r3, #1
 7037              		.loc 1 2477 0
 7038 0082 0246     		mov	r2, r0
2476:bluetooth_rxtx.c **** 			le_promisc_state(2, &le.conn_interval, 2);
 7039              		.loc 1 2476 0
 7040 0084 EB72     		strb	r3, [r5, #11]
 7041              		.loc 1 2477 0
 7042 0086 FFF7FEFF 		bl	le_promisc_state
 7043              	.LVL695:
 7044 008a 03E0     		b	.L742
 7045              	.LVL696:
 7046              	.L741:
2478:bluetooth_rxtx.c **** 		}
2479:bluetooth_rxtx.c **** 	} else {
2480:bluetooth_rxtx.c **** 		le.conn_interval = obsv_hop_interval;
 7047              		.loc 1 2480 0
 7048 008c 4A84     		strh	r2, [r1, #34]	@ movhi
2481:bluetooth_rxtx.c **** 		le_promisc.consec_intervals = 0;
 7049              		.loc 1 2481 0
 7050 008e 0022     		movs	r2, #0
 7051              	.LVL697:
 7052 0090 C3F80421 		str	r2, [r3, #260]
 7053              	.LVL698:
 7054              	.L742:
2482:bluetooth_rxtx.c **** 	}
2483:bluetooth_rxtx.c **** 
2484:bluetooth_rxtx.c **** 	prev_clk = cur_clk;
 7055              		.loc 1 2484 0
 7056 0094 EC63     		str	r4, [r5, #60]
 7057              	.L737:
 7058 0096 38BD     		pop	{r3, r4, r5, pc}
 7059              	.LVL699:
 7060              	.L744:
 7061              		.align	2
 7062              	.L743:
 7063 0098 00000000 		.word	clkn
 7064 009c 08400040 		.word	1073758216
 7065 00a0 00000000 		.word	.LANCHOR0
 7066 00a4 00000000 		.word	le_promisc
 7067 00a8 A40E0700 		.word	462500
 7068 00ac 00000000 		.word	.LANCHOR1
 7069 00b0 00000000 		.word	promisc_recover_hop_increment
 7070              		.cfi_endproc
 7071              	.LFE32:
ARM GAS  /tmp/ccCuKxzC.s 			page 191


 7073              		.section	.text.promisc_follow_cb,"ax",%progbits
 7074              		.align	1
 7075              		.global	promisc_follow_cb
 7076              		.thumb
 7077              		.thumb_func
 7079              	promisc_follow_cb:
 7080              	.LFB33:
2485:bluetooth_rxtx.c **** }
2486:bluetooth_rxtx.c **** 
2487:bluetooth_rxtx.c **** void promisc_follow_cb(u8 *packet) {
 7081              		.loc 1 2487 0
 7082              		.cfi_startproc
 7083              		@ args = 0, pretend = 0, frame = 0
 7084              		@ frame_needed = 0, uses_anonymous_args = 0
 7085              	.LVL700:
 7086 0000 38B5     		push	{r3, r4, r5, lr}
 7087              		.cfi_def_cfa_offset 16
 7088              		.cfi_offset 3, -16
 7089              		.cfi_offset 4, -12
 7090              		.cfi_offset 5, -8
 7091              		.cfi_offset 14, -4
2488:bluetooth_rxtx.c **** 	int i;
2489:bluetooth_rxtx.c **** 
2490:bluetooth_rxtx.c **** 	// get the CRCInit
2491:bluetooth_rxtx.c **** 	if (!le.crc_verify && packet[4] == 0x01 && packet[5] == 0x00) {
 7092              		.loc 1 2491 0
 7093 0002 184C     		ldr	r4, .L750
2487:bluetooth_rxtx.c **** 	int i;
 7094              		.loc 1 2487 0
 7095 0004 0146     		mov	r1, r0
 7096              		.loc 1 2491 0
 7097 0006 6369     		ldr	r3, [r4, #20]
 7098 0008 53BB     		cbnz	r3, .L745
 7099              		.loc 1 2491 0 is_stmt 0 discriminator 1
 7100 000a 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 7101 000c 012B     		cmp	r3, #1
 7102 000e 27D1     		bne	.L745
 7103 0010 4579     		ldrb	r5, [r0, #5]	@ zero_extendqisi2
 7104 0012 2DBB     		cbnz	r5, .L745
 7105              	.LVL701:
 7106              	.LBB77:
 7107              	.LBB78:
 7108              	.LBB79:
2492:bluetooth_rxtx.c **** 		u32 crc = (packet[8] << 16) | (packet[7] << 8) | packet[6];
 7109              		.loc 1 2492 0 is_stmt 1
 7110 0014 037A     		ldrb	r3, [r0, #8]	@ zero_extendqisi2
 7111 0016 C079     		ldrb	r0, [r0, #7]	@ zero_extendqisi2
 7112              	.LVL702:
2493:bluetooth_rxtx.c **** 
2494:bluetooth_rxtx.c **** 		le.crc_init = btle_reverse_crc(crc, packet + 4, 2);
 7113              		.loc 1 2494 0
 7114 0018 0222     		movs	r2, #2
2492:bluetooth_rxtx.c **** 		u32 crc = (packet[8] << 16) | (packet[7] << 8) | packet[6];
 7115              		.loc 1 2492 0
 7116 001a 0002     		lsls	r0, r0, #8
 7117 001c 40EA0340 		orr	r0, r0, r3, lsl #16
 7118 0020 8B79     		ldrb	r3, [r1, #6]	@ zero_extendqisi2
ARM GAS  /tmp/ccCuKxzC.s 			page 192


 7119              		.loc 1 2494 0
 7120 0022 0431     		adds	r1, r1, #4
 7121              	.LVL703:
 7122 0024 1843     		orrs	r0, r0, r3
 7123 0026 FFF7FEFF 		bl	btle_reverse_crc
 7124              	.LVL704:
 7125 002a 2A46     		mov	r2, r5
 7126 002c E060     		str	r0, [r4, #12]
 7127              	.LVL705:
2495:bluetooth_rxtx.c **** 		le.crc_init_reversed = 0;
2496:bluetooth_rxtx.c **** 		for (i = 0; i < 24; ++i)
 7128              		.loc 1 2496 0
 7129 002e 2B46     		mov	r3, r5
 7130              	.LVL706:
 7131              	.L748:
2497:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 7132              		.loc 1 2497 0
 7133 0030 20FA03F1 		lsr	r1, r0, r3
 7134 0034 C3F11705 		rsb	r5, r3, #23
 7135 0038 01F00101 		and	r1, r1, #1
 7136 003c A940     		lsls	r1, r1, r5
2496:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 7137              		.loc 1 2496 0
 7138 003e 0133     		adds	r3, r3, #1
 7139              	.LVL707:
 7140 0040 182B     		cmp	r3, #24
 7141              		.loc 1 2497 0
 7142 0042 42EA0102 		orr	r2, r2, r1
2496:bluetooth_rxtx.c **** 			le.crc_init_reversed |= ((le.crc_init >> i) & 1) << (23 - i);
 7143              		.loc 1 2496 0
 7144 0046 F3D1     		bne	.L748
 7145 0048 2261     		str	r2, [r4, #16]
2498:bluetooth_rxtx.c **** 
2499:bluetooth_rxtx.c **** 		le.crc_verify = 1;
2500:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 7146              		.loc 1 2500 0
 7147 004a 074B     		ldr	r3, .L750+4
 7148              	.LVL708:
 7149 004c 074A     		ldr	r2, .L750+8
2499:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 7150              		.loc 1 2499 0
 7151 004e 0120     		movs	r0, #1
 7152              		.loc 1 2500 0
 7153 0050 9A61     		str	r2, [r3, #24]
2499:bluetooth_rxtx.c **** 		packet_cb = promisc_recover_hop_interval;
 7154              		.loc 1 2499 0
 7155 0052 6061     		str	r0, [r4, #20]
2501:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 7156              		.loc 1 2501 0
 7157 0054 0649     		ldr	r1, .L750+12
 7158 0056 0322     		movs	r2, #3
 7159              	.LBE79:
 7160              	.LBE78:
 7161              	.LBE77:
2502:bluetooth_rxtx.c **** 	}
2503:bluetooth_rxtx.c **** }
 7162              		.loc 1 2503 0
ARM GAS  /tmp/ccCuKxzC.s 			page 193


 7163 0058 BDE83840 		pop	{r3, r4, r5, lr}
 7164              	.LBB82:
 7165              	.LBB81:
 7166              	.LBB80:
2501:bluetooth_rxtx.c **** 		le_promisc_state(1, &le.crc_init, 3);
 7167              		.loc 1 2501 0
 7168 005c FFF7FEBF 		b	le_promisc_state
 7169              	.LVL709:
 7170              	.L745:
 7171 0060 38BD     		pop	{r3, r4, r5, pc}
 7172              	.L751:
 7173 0062 00BF     		.align	2
 7174              	.L750:
 7175 0064 00000000 		.word	.LANCHOR1
 7176 0068 00000000 		.word	.LANCHOR0
 7177 006c 00000000 		.word	promisc_recover_hop_interval
 7178 0070 0C000000 		.word	.LANCHOR1+12
 7179              	.LBE80:
 7180              	.LBE81:
 7181              	.LBE82:
 7182              		.cfi_endproc
 7183              	.LFE33:
 7185              		.section	.text.see_aa,"ax",%progbits
 7186              		.align	1
 7187              		.global	see_aa
 7188              		.thumb
 7189              		.thumb_func
 7191              	see_aa:
 7192              	.LFB34:
2504:bluetooth_rxtx.c **** 
2505:bluetooth_rxtx.c **** // called when we see an AA, add it to the list
2506:bluetooth_rxtx.c **** void see_aa(u32 aa) {
 7193              		.loc 1 2506 0
 7194              		.cfi_startproc
 7195              		@ args = 0, pretend = 0, frame = 0
 7196              		@ frame_needed = 0, uses_anonymous_args = 0
 7197              	.LVL710:
 7198 0000 30B5     		push	{r4, r5, lr}
 7199              		.cfi_def_cfa_offset 12
 7200              		.cfi_offset 4, -12
 7201              		.cfi_offset 5, -8
 7202              		.cfi_offset 14, -4
 7203              	.LVL711:
2507:bluetooth_rxtx.c **** 	int i, max = -1, killme = -1;
2508:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
 7204              		.loc 1 2508 0
 7205 0002 0022     		movs	r2, #0
 7206              	.LVL712:
 7207              	.L756:
2509:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 7208              		.loc 1 2509 0
 7209 0004 144D     		ldr	r5, .L765
 7210 0006 55F83210 		ldr	r1, [r5, r2, lsl #3]
 7211 000a 05EBC203 		add	r3, r5, r2, lsl #3
 7212 000e 8142     		cmp	r1, r0
 7213 0010 02D1     		bne	.L753
2510:bluetooth_rxtx.c **** 			++le_promisc.active_aa[i].count;
ARM GAS  /tmp/ccCuKxzC.s 			page 194


 7214              		.loc 1 2510 0
 7215 0012 5A68     		ldr	r2, [r3, #4]
 7216              	.LVL713:
 7217 0014 0132     		adds	r2, r2, #1
 7218 0016 1CE0     		b	.L764
 7219              	.LVL714:
 7220              	.L753:
2508:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].aa == aa) {
 7221              		.loc 1 2508 0
 7222 0018 0132     		adds	r2, r2, #1
 7223              	.LVL715:
 7224 001a 202A     		cmp	r2, #32
 7225 001c F2D1     		bne	.L756
 7226 001e 4FF0FF33 		mov	r3, #-1
 7227 0022 1946     		mov	r1, r3
 7228 0024 0022     		movs	r2, #0
 7229              	.LVL716:
 7230              	.L759:
 7231 0026 05EBC204 		add	r4, r5, r2, lsl #3
2511:bluetooth_rxtx.c **** 			return;
2512:bluetooth_rxtx.c **** 		}
2513:bluetooth_rxtx.c **** 
2514:bluetooth_rxtx.c **** 	// evict someone
2515:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i)
2516:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 7232              		.loc 1 2516 0
 7233 002a 6468     		ldr	r4, [r4, #4]
 7234 002c 8C42     		cmp	r4, r1
 7235 002e 05DB     		blt	.L760
 7236              		.loc 1 2516 0 is_stmt 0 discriminator 1
 7237 0030 0029     		cmp	r1, #0
 7238 0032 A8BF     		it	ge
 7239 0034 0C46     		movge	r4, r1
 7240 0036 B8BF     		it	lt
 7241 0038 1346     		movlt	r3, r2
 7242              	.LVL717:
 7243 003a 00E0     		b	.L757
 7244              	.LVL718:
 7245              	.L760:
 7246 003c 1346     		mov	r3, r2
 7247              	.LVL719:
 7248              	.L757:
2515:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count < max || max < 0) {
 7249              		.loc 1 2515 0 is_stmt 1
 7250 003e 0132     		adds	r2, r2, #1
 7251              	.LVL720:
 7252 0040 202A     		cmp	r2, #32
 7253 0042 01D0     		beq	.L758
 7254 0044 2146     		mov	r1, r4
 7255 0046 EEE7     		b	.L759
 7256              	.L758:
2517:bluetooth_rxtx.c **** 			killme = i;
2518:bluetooth_rxtx.c **** 			max = le_promisc.active_aa[i].count;
2519:bluetooth_rxtx.c **** 		}
2520:bluetooth_rxtx.c **** 
2521:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].aa = aa;
 7257              		.loc 1 2521 0
ARM GAS  /tmp/ccCuKxzC.s 			page 195


 7258 0048 45F83300 		str	r0, [r5, r3, lsl #3]
2522:bluetooth_rxtx.c **** 	le_promisc.active_aa[killme].count = 1;
 7259              		.loc 1 2522 0
 7260 004c 0122     		movs	r2, #1
 7261              	.LVL721:
 7262 004e 05EBC303 		add	r3, r5, r3, lsl #3
 7263              	.LVL722:
 7264              	.L764:
 7265 0052 5A60     		str	r2, [r3, #4]
 7266 0054 30BD     		pop	{r4, r5, pc}
 7267              	.L766:
 7268 0056 00BF     		.align	2
 7269              	.L765:
 7270 0058 00000000 		.word	le_promisc
 7271              		.cfi_endproc
 7272              	.LFE34:
 7274              		.section	.text.cb_le_promisc,"ax",%progbits
 7275              		.align	1
 7276              		.global	cb_le_promisc
 7277              		.thumb
 7278              		.thumb_func
 7280              	cb_le_promisc:
 7281              	.LFB35:
2523:bluetooth_rxtx.c **** }
2524:bluetooth_rxtx.c **** 
2525:bluetooth_rxtx.c **** /* le promiscuous mode */
2526:bluetooth_rxtx.c **** int cb_le_promisc(char *unpacked) {
 7282              		.loc 1 2526 0
 7283              		.cfi_startproc
 7284              		@ args = 0, pretend = 0, frame = 80
 7285              		@ frame_needed = 0, uses_anonymous_args = 0
 7286              	.LVL723:
 7287 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 7288              		.cfi_def_cfa_offset 28
 7289              		.cfi_offset 4, -28
 7290              		.cfi_offset 5, -24
 7291              		.cfi_offset 6, -20
 7292              		.cfi_offset 7, -16
 7293              		.cfi_offset 8, -12
 7294              		.cfi_offset 9, -8
 7295              		.cfi_offset 14, -4
 7296 0004 95B0     		sub	sp, sp, #84
 7297              		.cfi_def_cfa_offset 112
2527:bluetooth_rxtx.c **** 	int i, j, k;
2528:bluetooth_rxtx.c **** 	int idx;
2529:bluetooth_rxtx.c **** 
2530:bluetooth_rxtx.c **** 	// empty data PDU: 01 00
2531:bluetooth_rxtx.c **** 	char desired[4][16] = {
 7298              		.loc 1 2531 0
 7299 0006 0021     		movs	r1, #0
2526:bluetooth_rxtx.c **** 	int i, j, k;
 7300              		.loc 1 2526 0
 7301 0008 8046     		mov	r8, r0
 7302              		.loc 1 2531 0
 7303 000a 4022     		movs	r2, #64
 7304 000c 04A8     		add	r0, sp, #16
 7305              	.LVL724:
ARM GAS  /tmp/ccCuKxzC.s 			page 196


 7306 000e FFF7FEFF 		bl	memset
 7307              	.LVL725:
 7308 0012 0123     		movs	r3, #1
 7309 0014 8DF81030 		strb	r3, [sp, #16]
 7310 0018 8DF82030 		strb	r3, [sp, #32]
 7311 001c 8DF82330 		strb	r3, [sp, #35]
 7312 0020 8DF83030 		strb	r3, [sp, #48]
 7313 0024 8DF83230 		strb	r3, [sp, #50]
 7314 0028 8DF84030 		strb	r3, [sp, #64]
 7315 002c 8DF84230 		strb	r3, [sp, #66]
 7316 0030 8DF84330 		strb	r3, [sp, #67]
 7317              	.LVL726:
 7318 0034 14AD     		add	r5, sp, #80
 7319 0036 04AC     		add	r4, sp, #16
 7320              	.LVL727:
 7321              	.L771:
2532:bluetooth_rxtx.c **** 		{ 1, 0, 0, 0, 0, 0, 0, 0,
2533:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2534:bluetooth_rxtx.c **** 		{ 1, 0, 0, 1, 0, 0, 0, 0,
2535:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2536:bluetooth_rxtx.c **** 		{ 1, 0, 1, 0, 0, 0, 0, 0,
2537:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2538:bluetooth_rxtx.c **** 		{ 1, 0, 1, 1, 0, 0, 0, 0,
2539:bluetooth_rxtx.c **** 		  0, 0, 0, 0, 0, 0, 0, 0, },
2540:bluetooth_rxtx.c **** 	};
2541:bluetooth_rxtx.c **** 
2542:bluetooth_rxtx.c **** 	for (i = 0; i < 4; ++i) {
2543:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 7322              		.loc 1 2543 0
 7323 0038 504E     		ldr	r6, .L803
 7324 003a 514F     		ldr	r7, .L803+4
 7325 003c 3088     		ldrh	r0, [r6]
 7326 003e 80B2     		uxth	r0, r0
 7327 0040 6238     		subs	r0, r0, #98
 7328 0042 C0B2     		uxtb	r0, r0
 7329 0044 FFF7FEFF 		bl	btle_channel_index
 7330              	.LVL728:
 7331 0048 3A5C     		ldrb	r2, [r7, r0]	@ zero_extendqisi2
 7332              	.LVL729:
2544:bluetooth_rxtx.c **** 
2545:bluetooth_rxtx.c **** 		// whiten the desired data
2546:bluetooth_rxtx.c **** 		for (j = 0; j < (int)sizeof(desired[i]); ++j) {
 7333              		.loc 1 2546 0
 7334 004a 0023     		movs	r3, #0
 7335              	.LVL730:
 7336              	.L769:
2547:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7337              		.loc 1 2547 0 discriminator 2
 7338 004c B918     		adds	r1, r7, r2
 7339 004e E05C     		ldrb	r0, [r4, r3]	@ zero_extendqisi2
 7340 0050 91F82810 		ldrb	r1, [r1, #40]	@ zero_extendqisi2
2548:bluetooth_rxtx.c **** 			idx = (idx + 1) % sizeof(whitening);
 7341              		.loc 1 2548 0 discriminator 2
 7342 0054 0132     		adds	r2, r2, #1
 7343              	.LVL731:
2547:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7344              		.loc 1 2547 0 discriminator 2
ARM GAS  /tmp/ccCuKxzC.s 			page 197


 7345 0056 4140     		eors	r1, r1, r0
 7346 0058 E154     		strb	r1, [r4, r3]
 7347              		.loc 1 2548 0 discriminator 2
 7348 005a 7F21     		movs	r1, #127
2546:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7349              		.loc 1 2546 0 discriminator 2
 7350 005c 0133     		adds	r3, r3, #1
 7351              	.LVL732:
 7352              		.loc 1 2548 0 discriminator 2
 7353 005e B2FBF1F0 		udiv	r0, r2, r1
2546:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7354              		.loc 1 2546 0 discriminator 2
 7355 0062 102B     		cmp	r3, #16
 7356              		.loc 1 2548 0 discriminator 2
 7357 0064 01FB1022 		mls	r2, r1, r0, r2
 7358              	.LVL733:
2546:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7359              		.loc 1 2546 0 discriminator 2
 7360 0068 F0D1     		bne	.L769
 7361 006a 1034     		adds	r4, r4, #16
2542:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 7362              		.loc 1 2542 0
 7363 006c AC42     		cmp	r4, r5
 7364 006e E3D1     		bne	.L771
 7365 0070 08F12005 		add	r5, r8, #32
 7366 0074 08F53C78 		add	r8, r8, #752
 7367              	.LVL734:
 7368              	.L787:
 7369              	.LBB83:
2549:bluetooth_rxtx.c **** 		}
2550:bluetooth_rxtx.c **** 	}
2551:bluetooth_rxtx.c **** 
2552:bluetooth_rxtx.c **** 	// then look for that bitsream in our receive buffer
2553:bluetooth_rxtx.c **** 	for (i = 32; i < (DMA_SIZE*8*2 - 32 - 16); i++) {
2554:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 7370              		.loc 1 2554 0
 7371 0078 424B     		ldr	r3, .L803+8
 7372 007a 6C46     		mov	r4, sp
 7373 007c 0FCB     		ldmia	r3, {r0, r1, r2, r3}
 7374 007e 8DE80F00 		stmia	sp, {r0, r1, r2, r3}
 7375              	.LVL735:
 7376 0082 0022     		movs	r2, #0
 7377              	.LVL736:
 7378              	.L772:
 7379 0084 04AB     		add	r3, sp, #16
 7380 0086 03EB8201 		add	r1, r3, r2, lsl #2
 7381              	.LBE83:
2546:bluetooth_rxtx.c **** 			desired[i][j] ^= whitening[idx];
 7382              		.loc 1 2546 0 discriminator 1
 7383 008a 0023     		movs	r3, #0
 7384              	.LVL737:
 7385              	.L777:
 7386              	.LBB88:
2555:bluetooth_rxtx.c **** 		int matching = -1;
2556:bluetooth_rxtx.c **** 
2557:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
2558:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
ARM GAS  /tmp/ccCuKxzC.s 			page 198


2559:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 7387              		.loc 1 2559 0
 7388 008c 15F803C0 		ldrb	ip, [r5, r3]	@ zero_extendqisi2
 7389 0090 C85C     		ldrb	r0, [r1, r3]	@ zero_extendqisi2
 7390 0092 8445     		cmp	ip, r0
 7391 0094 02D0     		beq	.L773
2560:bluetooth_rxtx.c **** 					ok[j] = 0;
 7392              		.loc 1 2560 0
 7393 0096 0023     		movs	r3, #0
 7394              	.LVL738:
 7395 0098 A350     		str	r3, [r4, r2]
2561:bluetooth_rxtx.c **** 					break;
 7396              		.loc 1 2561 0
 7397 009a 02E0     		b	.L774
 7398              	.LVL739:
 7399              	.L773:
2558:bluetooth_rxtx.c **** 				if (unpacked[i+k] != desired[j][k]) {
 7400              		.loc 1 2558 0
 7401 009c 0133     		adds	r3, r3, #1
 7402              	.LVL740:
 7403 009e 102B     		cmp	r3, #16
 7404 00a0 F4D1     		bne	.L777
 7405              	.LVL741:
 7406              	.L774:
 7407 00a2 0432     		adds	r2, r2, #4
2557:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 7408              		.loc 1 2557 0
 7409 00a4 102A     		cmp	r2, #16
 7410 00a6 EDD1     		bne	.L772
 7411 00a8 0023     		movs	r3, #0
 7412              	.L780:
2562:bluetooth_rxtx.c **** 				}
2563:bluetooth_rxtx.c **** 			}
2564:bluetooth_rxtx.c **** 		}
2565:bluetooth_rxtx.c **** 
2566:bluetooth_rxtx.c **** 		// see if any match
2567:bluetooth_rxtx.c **** 		for (j = 0; j < 4; ++j) {
2568:bluetooth_rxtx.c **** 			if (ok[j]) {
 7413              		.loc 1 2568 0
 7414 00aa E258     		ldr	r2, [r4, r3]
 7415 00ac 1AB9     		cbnz	r2, .L778
 7416 00ae 0433     		adds	r3, r3, #4
2567:bluetooth_rxtx.c **** 			if (ok[j]) {
 7417              		.loc 1 2567 0
 7418 00b0 102B     		cmp	r3, #16
 7419 00b2 FAD1     		bne	.L780
 7420 00b4 3EE0     		b	.L791
 7421              	.L778:
 7422              	.LVL742:
2569:bluetooth_rxtx.c **** 				matching = j;
2570:bluetooth_rxtx.c **** 				break;
2571:bluetooth_rxtx.c **** 			}
2572:bluetooth_rxtx.c **** 		}
2573:bluetooth_rxtx.c **** 
2574:bluetooth_rxtx.c **** 		// skip if no match
2575:bluetooth_rxtx.c **** 		if (matching < 0)
2576:bluetooth_rxtx.c **** 			continue;
ARM GAS  /tmp/ccCuKxzC.s 			page 199


2577:bluetooth_rxtx.c **** 
2578:bluetooth_rxtx.c **** 		// found a match! unwhiten it and send it home
2579:bluetooth_rxtx.c **** 		idx = whitening_index[btle_channel_index(channel-2402)];
 7423              		.loc 1 2579 0
 7424 00b6 3088     		ldrh	r0, [r6]
 7425 00b8 80B2     		uxth	r0, r0
 7426 00ba 6238     		subs	r0, r0, #98
 7427 00bc C0B2     		uxtb	r0, r0
 7428 00be FFF7FEFF 		bl	btle_channel_index
 7429              	.LVL743:
 7430 00c2 385C     		ldrb	r0, [r7, r0]	@ zero_extendqisi2
 7431              	.LVL744:
2580:bluetooth_rxtx.c **** 		for (j = 0; j < 4+3+3; ++j) {
 7432              		.loc 1 2580 0
 7433 00c4 0023     		movs	r3, #0
 7434              	.LVL745:
 7435              	.L792:
2557:bluetooth_rxtx.c **** 			for (k = 0; k < (int)sizeof(desired[j]); ++k) {
 7436              		.loc 1 2557 0 discriminator 1
 7437 00c6 0021     		movs	r1, #0
 7438 00c8 05EBC30C 		add	ip, r5, r3, lsl #3
 7439 00cc 0A46     		mov	r2, r1
 7440              	.LVL746:
 7441              	.L785:
 7442 00ce 0CEB0204 		add	r4, ip, r2
 7443              	.LBB84:
 7444              	.LBB85:
2581:bluetooth_rxtx.c **** 			u8 byte = 0;
2582:bluetooth_rxtx.c **** 			for (k = 0; k < 8; k++) {
2583:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
2584:bluetooth_rxtx.c **** 				if (offset >= DMA_SIZE*8*2) break;
2585:bluetooth_rxtx.c **** 				int bit = unpacked[offset];
2586:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 7445              		.loc 1 2586 0
 7446 00d2 032B     		cmp	r3, #3
2585:bluetooth_rxtx.c **** 				if (j >= 4) { // unwhiten data bytes
 7447              		.loc 1 2585 0
 7448 00d4 14F8204C 		ldrb	r4, [r4, #-32]	@ zero_extendqisi2
 7449              	.LVL747:
 7450              		.loc 1 2586 0
 7451 00d8 0CDD     		ble	.L782
2587:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 7452              		.loc 1 2587 0
 7453 00da 07EB000E 		add	lr, r7, r0
 7454 00de 9EF828E0 		ldrb	lr, [lr, #40]	@ zero_extendqisi2
2588:bluetooth_rxtx.c **** 					idx = (idx + 1) % sizeof(whitening);
 7455              		.loc 1 2588 0
 7456 00e2 0130     		adds	r0, r0, #1
 7457              	.LVL748:
2587:bluetooth_rxtx.c **** 					bit ^= whitening[idx];
 7458              		.loc 1 2587 0
 7459 00e4 84EA0E04 		eor	r4, r4, lr
 7460              	.LVL749:
 7461              		.loc 1 2588 0
 7462 00e8 4FF07F0E 		mov	lr, #127
 7463 00ec B0FBFEF9 		udiv	r9, r0, lr
 7464 00f0 0EFB1900 		mls	r0, lr, r9, r0
ARM GAS  /tmp/ccCuKxzC.s 			page 200


 7465              	.LVL750:
 7466              	.L782:
2589:bluetooth_rxtx.c **** 				}
2590:bluetooth_rxtx.c **** 				byte |= bit << k;
 7467              		.loc 1 2590 0
 7468 00f4 9440     		lsls	r4, r4, r2
 7469              	.LVL751:
 7470              	.LBE85:
2582:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 7471              		.loc 1 2582 0
 7472 00f6 0132     		adds	r2, r2, #1
 7473              	.LVL752:
 7474              	.LBB86:
 7475              		.loc 1 2590 0
 7476 00f8 2143     		orrs	r1, r1, r4
 7477              	.LVL753:
 7478              	.LBE86:
2582:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 7479              		.loc 1 2582 0
 7480 00fa 082A     		cmp	r2, #8
 7481              	.LBB87:
 7482              		.loc 1 2590 0
 7483 00fc C9B2     		uxtb	r1, r1
 7484              	.LVL754:
 7485              	.LBE87:
2582:bluetooth_rxtx.c **** 				int offset = k + (j * 8) + i - 32;
 7486              		.loc 1 2582 0
 7487 00fe E6D1     		bne	.L785
2591:bluetooth_rxtx.c **** 			}
2592:bluetooth_rxtx.c **** 			idle_rxbuf[j] = byte;
 7488              		.loc 1 2592 0
 7489 0100 214C     		ldr	r4, .L803+12
 7490 0102 2268     		ldr	r2, [r4]
 7491              	.LVL755:
 7492 0104 D154     		strb	r1, [r2, r3]
 7493              	.LBE84:
2580:bluetooth_rxtx.c **** 			u8 byte = 0;
 7494              		.loc 1 2580 0
 7495 0106 0133     		adds	r3, r3, #1
 7496              	.LVL756:
 7497 0108 0A2B     		cmp	r3, #10
 7498 010a DCD1     		bne	.L792
2593:bluetooth_rxtx.c **** 		}
2594:bluetooth_rxtx.c **** 
2595:bluetooth_rxtx.c **** 		u32 aa = (idle_rxbuf[3] << 24) |
 7499              		.loc 1 2595 0
 7500 010c 2368     		ldr	r3, [r4]
 7501              	.LVL757:
 7502 010e D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 7503              	.LVL758:
2596:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 7504              		.loc 1 2596 0
 7505 0110 2368     		ldr	r3, [r4]
 7506 0112 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
2597:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 7507              		.loc 1 2597 0
 7508 0114 2268     		ldr	r2, [r4]
ARM GAS  /tmp/ccCuKxzC.s 			page 201


2596:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 7509              		.loc 1 2596 0
 7510 0116 1B04     		lsls	r3, r3, #16
 7511              		.loc 1 2597 0
 7512 0118 5078     		ldrb	r0, [r2, #1]	@ zero_extendqisi2
 7513              	.LVL759:
2598:bluetooth_rxtx.c **** 				 (idle_rxbuf[0]);
 7514              		.loc 1 2598 0
 7515 011a 2268     		ldr	r2, [r4]
2595:bluetooth_rxtx.c **** 				 (idle_rxbuf[2] << 16) |
 7516              		.loc 1 2595 0
 7517 011c 43EA0163 		orr	r3, r3, r1, lsl #24
 7518              		.loc 1 2598 0
 7519 0120 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 7520              	.LVL760:
2596:bluetooth_rxtx.c **** 				 (idle_rxbuf[1] <<  8) |
 7521              		.loc 1 2596 0
 7522 0122 1343     		orrs	r3, r3, r2
2599:bluetooth_rxtx.c **** 		see_aa(aa);
 7523              		.loc 1 2599 0
 7524 0124 43EA0020 		orr	r0, r3, r0, lsl #8
 7525 0128 FFF7FEFF 		bl	see_aa
 7526              	.LVL761:
2600:bluetooth_rxtx.c **** 
2601:bluetooth_rxtx.c **** 		enqueue(LE_PACKET, (uint8_t*)idle_rxbuf);
 7527              		.loc 1 2601 0
 7528 012c 2168     		ldr	r1, [r4]
 7529 012e 0120     		movs	r0, #1
 7530 0130 FFF7FEFF 		bl	enqueue
 7531              	.LVL762:
 7532              	.L791:
 7533 0134 0135     		adds	r5, r5, #1
 7534              	.LVL763:
 7535              	.LBE88:
2553:bluetooth_rxtx.c **** 		int ok[4] = { 1, 1, 1, 1 };
 7536              		.loc 1 2553 0
 7537 0136 4545     		cmp	r5, r8
 7538 0138 9ED1     		bne	.L787
 7539 013a 0023     		movs	r3, #0
 7540              	.LVL764:
 7541              	.L790:
 7542 013c 134A     		ldr	r2, .L803+16
 7543 013e 02EBC301 		add	r1, r2, r3, lsl #3
2602:bluetooth_rxtx.c **** 
2603:bluetooth_rxtx.c **** 	}
2604:bluetooth_rxtx.c **** 
2605:bluetooth_rxtx.c **** 	// once we see an AA 5 times, start following it
2606:bluetooth_rxtx.c **** 	for (i = 0; i < AA_LIST_SIZE; ++i) {
2607:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 7544              		.loc 1 2607 0
 7545 0142 4968     		ldr	r1, [r1, #4]
 7546 0144 0329     		cmp	r1, #3
 7547 0146 11DD     		ble	.L788
2608:bluetooth_rxtx.c **** 			le_set_access_address(le_promisc.active_aa[i].aa);
 7548              		.loc 1 2608 0
 7549 0148 52F83300 		ldr	r0, [r2, r3, lsl #3]
 7550 014c FFF7FEFF 		bl	le_set_access_address
ARM GAS  /tmp/ccCuKxzC.s 			page 202


 7551              	.LVL765:
2609:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 7552              		.loc 1 2609 0
 7553 0150 0F4B     		ldr	r3, .L803+20
 7554 0152 104A     		ldr	r2, .L803+24
2610:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
2611:bluetooth_rxtx.c **** 			le.crc_verify = 0;
 7555              		.loc 1 2611 0
 7556 0154 0024     		movs	r4, #0
2609:bluetooth_rxtx.c **** 			data_cb = cb_follow_le;
 7557              		.loc 1 2609 0
 7558 0156 5A62     		str	r2, [r3, #36]
2610:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 7559              		.loc 1 2610 0
 7560 0158 0F4A     		ldr	r2, .L803+28
2612:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 7561              		.loc 1 2612 0
 7562 015a 2046     		mov	r0, r4
2610:bluetooth_rxtx.c **** 			packet_cb = promisc_follow_cb;
 7563              		.loc 1 2610 0
 7564 015c 9A61     		str	r2, [r3, #24]
 7565              		.loc 1 2612 0
 7566 015e 0F49     		ldr	r1, .L803+32
 7567 0160 0422     		movs	r2, #4
2611:bluetooth_rxtx.c **** 			le_promisc_state(0, &le.access_address, 4);
 7568              		.loc 1 2611 0
 7569 0162 7461     		str	r4, [r6, #20]
 7570              		.loc 1 2612 0
 7571 0164 FFF7FEFF 		bl	le_promisc_state
 7572              	.LVL766:
2613:bluetooth_rxtx.c **** 			// quit using the old stuff and switch to sync mode
2614:bluetooth_rxtx.c **** 			return 0;
 7573              		.loc 1 2614 0
 7574 0168 2046     		mov	r0, r4
 7575 016a 03E0     		b	.L802
 7576              	.LVL767:
 7577              	.L788:
2606:bluetooth_rxtx.c **** 		if (le_promisc.active_aa[i].count > 3) {
 7578              		.loc 1 2606 0
 7579 016c 0133     		adds	r3, r3, #1
 7580              	.LVL768:
 7581 016e 202B     		cmp	r3, #32
 7582 0170 E4D1     		bne	.L790
2615:bluetooth_rxtx.c **** 		}
2616:bluetooth_rxtx.c **** 	}
2617:bluetooth_rxtx.c **** 
2618:bluetooth_rxtx.c **** 	return 1;
 7583              		.loc 1 2618 0
 7584 0172 0120     		movs	r0, #1
 7585              	.LVL769:
 7586              	.L802:
2619:bluetooth_rxtx.c **** }
 7587              		.loc 1 2619 0
 7588 0174 15B0     		add	sp, sp, #84
 7589              		@ sp needed
 7590 0176 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 7591              	.LVL770:
ARM GAS  /tmp/ccCuKxzC.s 			page 203


 7592              	.L804:
 7593 017a 00BF     		.align	2
 7594              	.L803:
 7595 017c 00000000 		.word	.LANCHOR1
 7596 0180 00000000 		.word	.LANCHOR2
 7597 0184 98080000 		.word	.LANCHOR2+2200
 7598 0188 00000000 		.word	idle_rxbuf
 7599 018c 00000000 		.word	le_promisc
 7600 0190 00000000 		.word	.LANCHOR0
 7601 0194 00000000 		.word	cb_follow_le
 7602 0198 00000000 		.word	promisc_follow_cb
 7603 019c 04000000 		.word	.LANCHOR1+4
 7604              		.cfi_endproc
 7605              	.LFE35:
 7607              		.section	.text.bt_promisc_le,"ax",%progbits
 7608              		.align	1
 7609              		.global	bt_promisc_le
 7610              		.thumb
 7611              		.thumb_func
 7613              	bt_promisc_le:
 7614              	.LFB36:
2620:bluetooth_rxtx.c **** 
2621:bluetooth_rxtx.c **** void bt_promisc_le() {
 7615              		.loc 1 2621 0
 7616              		.cfi_startproc
 7617              		@ args = 0, pretend = 0, frame = 0
 7618              		@ frame_needed = 0, uses_anonymous_args = 0
 7619 0000 38B5     		push	{r3, r4, r5, lr}
 7620              		.cfi_def_cfa_offset 16
 7621              		.cfi_offset 3, -16
 7622              		.cfi_offset 4, -12
 7623              		.cfi_offset 5, -8
 7624              		.cfi_offset 14, -4
 7625              	.L806:
2622:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_PROMISC_LE) {
 7626              		.loc 1 2622 0 discriminator 1
 7627 0002 164D     		ldr	r5, .L815
 7628 0004 AB7C     		ldrb	r3, [r5, #18]	@ zero_extendqisi2
 7629 0006 0A2B     		cmp	r3, #10
 7630 0008 26D1     		bne	.L805
2623:bluetooth_rxtx.c **** 		reset_le_promisc();
2624:bluetooth_rxtx.c **** 
2625:bluetooth_rxtx.c **** 		// jump to a random data channel and turn up the squelch
2626:bluetooth_rxtx.c **** 		if ((channel & 1) == 1)
 7631              		.loc 1 2626 0
 7632 000a 154C     		ldr	r4, .L815+4
2623:bluetooth_rxtx.c **** 		reset_le_promisc();
 7633              		.loc 1 2623 0
 7634 000c FFF7FEFF 		bl	reset_le_promisc
 7635              	.LVL771:
 7636              		.loc 1 2626 0
 7637 0010 2388     		ldrh	r3, [r4]
 7638 0012 DB07     		lsls	r3, r3, #31
2627:bluetooth_rxtx.c **** 			channel = 2440;
 7639              		.loc 1 2627 0
 7640 0014 44BF     		itt	mi
 7641 0016 40F68813 		movwmi	r3, #2440
ARM GAS  /tmp/ccCuKxzC.s 			page 204


 7642 001a 2380     		strhmi	r3, [r4]	@ movhi
2628:bluetooth_rxtx.c **** 
2629:bluetooth_rxtx.c **** 		// if the PC hasn't given us AA, determine by listening
2630:bluetooth_rxtx.c **** 		if (!le.target_set) {
 7643              		.loc 1 2630 0
 7644 001c 236C     		ldr	r3, [r4, #64]
 7645 001e 4BB9     		cbnz	r3, .L808
2631:bluetooth_rxtx.c **** 			// cs_threshold_req = -80;
2632:bluetooth_rxtx.c **** 			cs_threshold_calc_and_set(channel);
 7646              		.loc 1 2632 0
 7647 0020 0F4B     		ldr	r3, .L815+4
 7648 0022 1888     		ldrh	r0, [r3]
 7649 0024 80B2     		uxth	r0, r0
 7650 0026 FFF7FEFF 		bl	cs_threshold_calc_and_set
 7651              	.LVL772:
2633:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 7652              		.loc 1 2633 0
 7653 002a 0E4B     		ldr	r3, .L815+8
2634:bluetooth_rxtx.c **** 			bt_generic_le(MODE_BT_PROMISC_LE);
 7654              		.loc 1 2634 0
 7655 002c 0A20     		movs	r0, #10
2633:bluetooth_rxtx.c **** 			data_cb = cb_le_promisc;
 7656              		.loc 1 2633 0
 7657 002e 6B62     		str	r3, [r5, #36]
 7658              		.loc 1 2634 0
 7659 0030 FFF7FEFF 		bl	bt_generic_le
 7660              	.LVL773:
 7661              	.L808:
2635:bluetooth_rxtx.c **** 		}
2636:bluetooth_rxtx.c **** 
2637:bluetooth_rxtx.c **** 		// could have got mode change in middle of above
2638:bluetooth_rxtx.c **** 		if (requested_mode != MODE_BT_PROMISC_LE)
 7662              		.loc 1 2638 0
 7663 0034 AD7C     		ldrb	r5, [r5, #18]	@ zero_extendqisi2
 7664 0036 EDB2     		uxtb	r5, r5
 7665 0038 0A2D     		cmp	r5, #10
 7666 003a 0DD1     		bne	.L805
2639:bluetooth_rxtx.c **** 			break;
2640:bluetooth_rxtx.c **** 
2641:bluetooth_rxtx.c **** 		le_promisc_state(0, &le.access_address, 4);
 7667              		.loc 1 2641 0
 7668 003c 0020     		movs	r0, #0
 7669 003e 0A49     		ldr	r1, .L815+12
 7670 0040 0422     		movs	r2, #4
 7671 0042 FFF7FEFF 		bl	le_promisc_state
 7672              	.LVL774:
2642:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 7673              		.loc 1 2642 0
 7674 0046 094A     		ldr	r2, .L815+16
 7675 0048 044B     		ldr	r3, .L815
2643:bluetooth_rxtx.c **** 		le.crc_verify = 0;
2644:bluetooth_rxtx.c **** 		bt_le_sync(MODE_BT_PROMISC_LE);
 7676              		.loc 1 2644 0
 7677 004a 2846     		mov	r0, r5
2642:bluetooth_rxtx.c **** 		packet_cb = promisc_follow_cb;
 7678              		.loc 1 2642 0
 7679 004c 9A61     		str	r2, [r3, #24]
ARM GAS  /tmp/ccCuKxzC.s 			page 205


2643:bluetooth_rxtx.c **** 		le.crc_verify = 0;
 7680              		.loc 1 2643 0
 7681 004e 0023     		movs	r3, #0
 7682 0050 6361     		str	r3, [r4, #20]
 7683              		.loc 1 2644 0
 7684 0052 FFF7FEFF 		bl	bt_le_sync
 7685              	.LVL775:
 7686 0056 D4E7     		b	.L806
 7687              	.L805:
 7688 0058 38BD     		pop	{r3, r4, r5, pc}
 7689              	.L816:
 7690 005a 00BF     		.align	2
 7691              	.L815:
 7692 005c 00000000 		.word	.LANCHOR0
 7693 0060 00000000 		.word	.LANCHOR1
 7694 0064 00000000 		.word	cb_le_promisc
 7695 0068 04000000 		.word	.LANCHOR1+4
 7696 006c 00000000 		.word	promisc_follow_cb
 7697              		.cfi_endproc
 7698              	.LFE36:
 7700              		.section	.text.bt_slave_le,"ax",%progbits
 7701              		.align	1
 7702              		.global	bt_slave_le
 7703              		.thumb
 7704              		.thumb_func
 7706              	bt_slave_le:
 7707              	.LFB37:
2645:bluetooth_rxtx.c **** 	}
2646:bluetooth_rxtx.c **** }
2647:bluetooth_rxtx.c **** 
2648:bluetooth_rxtx.c **** void bt_slave_le() {
 7708              		.loc 1 2648 0
 7709              		.cfi_startproc
 7710              		@ args = 0, pretend = 0, frame = 40
 7711              		@ frame_needed = 0, uses_anonymous_args = 0
 7712 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 7713              		.cfi_def_cfa_offset 36
 7714              		.cfi_offset 4, -36
 7715              		.cfi_offset 5, -32
 7716              		.cfi_offset 6, -28
 7717              		.cfi_offset 7, -24
 7718              		.cfi_offset 8, -20
 7719              		.cfi_offset 9, -16
 7720              		.cfi_offset 10, -12
 7721              		.cfi_offset 11, -8
 7722              		.cfi_offset 14, -4
 7723 0004 8BB0     		sub	sp, sp, #44
 7724              		.cfi_def_cfa_offset 80
 7725              	.LVL776:
2649:bluetooth_rxtx.c **** 	u32 calc_crc;
2650:bluetooth_rxtx.c **** 	int i, j;
2651:bluetooth_rxtx.c **** 	int num_adv_ind = 1;
2652:bluetooth_rxtx.c **** 	int fin_adv_len = 0;
2653:bluetooth_rxtx.c **** 	int plen = 11;
2654:bluetooth_rxtx.c **** 	u8 **adv_ind;
2655:bluetooth_rxtx.c **** 	u8 adv_ind_len;
2656:bluetooth_rxtx.c **** 	u16 ch[] = {2402, 2426, 2480};
ARM GAS  /tmp/ccCuKxzC.s 			page 206


 7726              		.loc 1 2656 0
 7727 0006 8649     		ldr	r1, .L858
2657:bluetooth_rxtx.c **** 
2658:bluetooth_rxtx.c **** 	u8 adv_overhead[20] = {0x42, 0x1d,	// adv_nonconn_ind, length 29 (0001 1101)
 7728              		.loc 1 2658 0
 7729 0008 05AA     		add	r2, sp, #20
2656:bluetooth_rxtx.c **** 
 7730              		.loc 1 2656 0
 7731 000a 8B88     		ldrh	r3, [r1, #4]	@ unaligned
 7732 000c 0868     		ldr	r0, [r1]	@ unaligned
 7733 000e ADF81030 		strh	r3, [sp, #16]	@ unaligned
 7734 0012 0390     		str	r0, [sp, #12]	@ unaligned
 7735              		.loc 1 2658 0
 7736 0014 8B1D     		adds	r3, r1, #6
 7737 0016 01F11605 		add	r5, r1, #22
 7738              	.L818:
 7739 001a 1868     		ldr	r0, [r3]	@ unaligned
 7740 001c 5968     		ldr	r1, [r3, #4]	@ unaligned
 7741 001e 1446     		mov	r4, r2
 7742 0020 03C4     		stmia	r4!, {r0, r1}
 7743 0022 0833     		adds	r3, r3, #8
 7744 0024 AB42     		cmp	r3, r5
 7745 0026 2246     		mov	r2, r4
 7746 0028 F7D1     		bne	.L818
 7747 002a 1868     		ldr	r0, [r3]	@ unaligned
2659:bluetooth_rxtx.c **** 						   0xff, 0xff, 0xff, 0xff, 0xff, 0xff, // adv mac address
2660:bluetooth_rxtx.c **** 						   0x03, 0x03, 0xaa, 0xfe, // service advertised - len, type, eddystone UUID
2661:bluetooth_rxtx.c **** 						   0x12, 0x16, 0xaa, 0xfe, // len(3 + URL frame + Eddystone URL), type, eddystone UUID
2662:bluetooth_rxtx.c **** 						   0x10, 0x00, 0x02, // URL frame - frametype(URL), tx power, URL scheme prefix (0x02: http:/
2663:bluetooth_rxtx.c **** 						   0xaa }; // preamble 0xaa
2664:bluetooth_rxtx.c **** 
2665:bluetooth_rxtx.c **** 	for (i = 0; i < 6; i++)
2666:bluetooth_rxtx.c **** 		slave_mac_address[i] = slave_mac_address_data[i];
 7748              		.loc 1 2666 0
 7749 002c 7D4A     		ldr	r2, .L858+4
2658:bluetooth_rxtx.c **** 						   0xff, 0xff, 0xff, 0xff, 0xff, 0xff, // adv mac address
 7750              		.loc 1 2658 0
 7751 002e 2060     		str	r0, [r4]	@ unaligned
 7752              	.LVL777:
 7753              		.loc 1 2666 0
 7754 0030 1468     		ldr	r4, [r2]
2665:bluetooth_rxtx.c **** 		slave_mac_address[i] = slave_mac_address_data[i];
 7755              		.loc 1 2665 0
 7756 0032 0023     		movs	r3, #0
 7757 0034 9246     		mov	r10, r2
 7758              	.LVL778:
 7759              	.L820:
 7760              		.loc 1 2666 0 discriminator 2
 7761 0036 7C49     		ldr	r1, .L858+8
 7762 0038 E05C     		ldrb	r0, [r4, r3]	@ zero_extendqisi2
 7763 003a 01F14002 		add	r2, r1, #64
 7764 003e 9854     		strb	r0, [r3, r2]
2665:bluetooth_rxtx.c **** 		slave_mac_address[i] = slave_mac_address_data[i];
 7765              		.loc 1 2665 0 discriminator 2
 7766 0040 0133     		adds	r3, r3, #1
 7767              	.LVL779:
 7768 0042 062B     		cmp	r3, #6
ARM GAS  /tmp/ccCuKxzC.s 			page 207


 7769 0044 8B46     		mov	fp, r1
 7770 0046 F6D1     		bne	.L820
2667:bluetooth_rxtx.c **** 
2668:bluetooth_rxtx.c **** 	// Standards said maximum advertising channel PDU length 39 bytes (adv payload 16 + 3 + 1 (preambl
2669:bluetooth_rxtx.c **** 	// There's a probem, actual maximum length 34 bytes (adv payload 11 + 3  + 1 (preamble)) in uberto
2670:bluetooth_rxtx.c **** 	fin_adv_len = (dlen-6) % plen;
 7771              		.loc 1 2670 0
 7772 0048 0A6A     		ldr	r2, [r1, #32]
 7773 004a 0B23     		movs	r3, #11
 7774              	.LVL780:
 7775 004c A2F10608 		sub	r8, r2, #6
 7776 0050 98FBF3F6 		sdiv	r6, r8, r3
2671:bluetooth_rxtx.c **** 	if (dlen >= plen + 6) {
 7777              		.loc 1 2671 0
 7778 0054 102A     		cmp	r2, #16
2670:bluetooth_rxtx.c **** 	if (dlen >= plen + 6) {
 7779              		.loc 1 2670 0
 7780 0056 03FB1688 		mls	r8, r3, r6, r8
 7781              	.LVL781:
 7782              		.loc 1 2671 0
 7783 005a 04DD     		ble	.L847
 7784              	.LVL782:
2672:bluetooth_rxtx.c **** 		num_adv_ind = (dlen-6)/plen + 1;
2673:bluetooth_rxtx.c **** 		fin_adv_len = (dlen-6) % plen;
2674:bluetooth_rxtx.c **** 		if (fin_adv_len == 0) {
 7785              		.loc 1 2674 0
 7786 005c B8F1000F 		cmp	r8, #0
 7787 0060 03D0     		beq	.L848
2672:bluetooth_rxtx.c **** 		num_adv_ind = (dlen-6)/plen + 1;
 7788              		.loc 1 2672 0
 7789 0062 0136     		adds	r6, r6, #1
 7790              	.LVL783:
 7791 0064 02E0     		b	.L821
 7792              	.LVL784:
 7793              	.L847:
2651:bluetooth_rxtx.c **** 	int fin_adv_len = 0;
 7794              		.loc 1 2651 0
 7795 0066 0126     		movs	r6, #1
 7796 0068 00E0     		b	.L821
 7797              	.LVL785:
 7798              	.L848:
2675:bluetooth_rxtx.c **** 			fin_adv_len = plen;
 7799              		.loc 1 2675 0
 7800 006a 9846     		mov	r8, r3
 7801              	.LVL786:
 7802              	.L821:
2676:bluetooth_rxtx.c **** 			num_adv_ind = num_adv_ind - 1;
2677:bluetooth_rxtx.c **** 		}
2678:bluetooth_rxtx.c **** 	}
2679:bluetooth_rxtx.c **** 
2680:bluetooth_rxtx.c **** 	adv_ind = (u8**) malloc(sizeof(u8*)*num_adv_ind);
 7803              		.loc 1 2680 0
 7804 006c B500     		lsls	r5, r6, #2
 7805 006e 2846     		mov	r0, r5
 7806 0070 FFF7FEFF 		bl	malloc
 7807              	.LVL787:
2681:bluetooth_rxtx.c **** 	for (i=0; i< num_adv_ind-1; i++) {
ARM GAS  /tmp/ccCuKxzC.s 			page 208


 7808              		.loc 1 2681 0
 7809 0074 0027     		movs	r7, #0
2680:bluetooth_rxtx.c **** 	for (i=0; i< num_adv_ind-1; i++) {
 7810              		.loc 1 2680 0
 7811 0076 0446     		mov	r4, r0
 7812              	.LVL788:
 7813              	.L822:
 7814              		.loc 1 2681 0 discriminator 1
 7815 0078 06F1FF39 		add	r9, r6, #-1
 7816 007c 4F45     		cmp	r7, r9
 7817 007e 06DA     		bge	.L854
2682:bluetooth_rxtx.c **** 		adv_ind[i] = (u8*) malloc(sizeof(u8)*(20 + plen + 3));
 7818              		.loc 1 2682 0 discriminator 2
 7819 0080 2220     		movs	r0, #34
 7820 0082 FFF7FEFF 		bl	malloc
 7821              	.LVL789:
 7822 0086 44F82700 		str	r0, [r4, r7, lsl #2]
2681:bluetooth_rxtx.c **** 	for (i=0; i< num_adv_ind-1; i++) {
 7823              		.loc 1 2681 0 discriminator 2
 7824 008a 0137     		adds	r7, r7, #1
 7825              	.LVL790:
 7826 008c F4E7     		b	.L822
 7827              	.L854:
2683:bluetooth_rxtx.c **** 	}
2684:bluetooth_rxtx.c **** 	adv_ind[num_adv_ind-1] = (u8*) malloc(sizeof(u8)*(fin_adv_len + 1 + 3 + 4 + 4 + 3 + 6 + 2));
 7828              		.loc 1 2684 0
 7829 008e 08F11700 		add	r0, r8, #23
 7830 0092 FFF7FEFF 		bl	malloc
 7831              	.LVL791:
 7832 0096 043D     		subs	r5, r5, #4
 7833 0098 6051     		str	r0, [r4, r5]
 7834              	.LVL792:
2685:bluetooth_rxtx.c **** 
2686:bluetooth_rxtx.c **** 	for (i=0; i< num_adv_ind; i++) {
 7835              		.loc 1 2686 0
 7836 009a 0025     		movs	r5, #0
 7837 009c 2F46     		mov	r7, r5
 7838              	.LVL793:
 7839              	.L824:
 7840              		.loc 1 2686 0 is_stmt 0 discriminator 1
 7841 009e B742     		cmp	r7, r6
 7842 00a0 66DA     		bge	.L834
 7843              		.loc 1 2686 0
 7844 00a2 0023     		movs	r3, #0
 7845              	.L835:
 7846              	.LVL794:
2687:bluetooth_rxtx.c **** 		for (j=0; j<20; j++) adv_ind[i][j] = adv_overhead[j];
 7847              		.loc 1 2687 0 is_stmt 1 discriminator 2
 7848 00a4 05A8     		add	r0, sp, #20
 7849 00a6 C15C     		ldrb	r1, [r0, r3]	@ zero_extendqisi2
 7850 00a8 6259     		ldr	r2, [r4, r5]
 7851 00aa D154     		strb	r1, [r2, r3]
 7852 00ac 0133     		adds	r3, r3, #1
 7853              	.LVL795:
 7854 00ae 142B     		cmp	r3, #20
 7855 00b0 F8D1     		bne	.L835
 7856              		.loc 1 2687 0 is_stmt 0
ARM GAS  /tmp/ccCuKxzC.s 			page 209


 7857 00b2 0523     		movs	r3, #5
 7858              	.LVL796:
 7859              	.L827:
2688:bluetooth_rxtx.c **** 		for (j=0; j<6; j++) adv_ind[i][j+2] = slave_mac_address[5-j];
 7860              		.loc 1 2688 0 is_stmt 1 discriminator 2
 7861 00b4 5D49     		ldr	r1, .L858+12
 7862 00b6 6259     		ldr	r2, [r4, r5]
 7863 00b8 C85C     		ldrb	r0, [r1, r3]	@ zero_extendqisi2
 7864 00ba C3F10701 		rsb	r1, r3, #7
 7865 00be 13F1FF33 		adds	r3, r3, #-1
 7866              	.LVL797:
 7867 00c2 5054     		strb	r0, [r2, r1]
 7868              	.LVL798:
 7869 00c4 F6D2     		bcs	.L827
2689:bluetooth_rxtx.c **** 		adv_ind[i][17] = (u8) num_adv_ind;
 7870              		.loc 1 2689 0
 7871 00c6 6359     		ldr	r3, [r4, r5]
2690:bluetooth_rxtx.c **** 		adv_ind[i][19] = adv_overhead[19] + (u8) i;
 7872              		.loc 1 2690 0
 7873 00c8 9DF82720 		ldrb	r2, [sp, #39]	@ zero_extendqisi2
2689:bluetooth_rxtx.c **** 		adv_ind[i][17] = (u8) num_adv_ind;
 7874              		.loc 1 2689 0
 7875 00cc 5E74     		strb	r6, [r3, #17]
 7876              		.loc 1 2690 0
 7877 00ce 6359     		ldr	r3, [r4, r5]
 7878 00d0 3A44     		add	r2, r2, r7
2691:bluetooth_rxtx.c **** 		if (i < num_adv_ind -1) {
 7879              		.loc 1 2691 0
 7880 00d2 4F45     		cmp	r7, r9
2690:bluetooth_rxtx.c **** 		adv_ind[i][19] = adv_overhead[19] + (u8) i;
 7881              		.loc 1 2690 0
 7882 00d4 DA74     		strb	r2, [r3, #19]
 7883              		.loc 1 2691 0
 7884 00d6 14DA     		bge	.L828
 7885 00d8 0B21     		movs	r1, #11
 7886 00da 7943     		muls	r1, r7, r1
 7887 00dc 1423     		movs	r3, #20
 7888              	.L830:
 7889              	.LVL799:
 7890              	.LBB89:
2692:bluetooth_rxtx.c **** 			for (j=0; j<plen; j++) adv_ind[i][j+20] = slave_mac_address_data[6+plen*i+j];
 7891              		.loc 1 2692 0 discriminator 2
 7892 00de DAF80020 		ldr	r2, [r10]
 7893 00e2 0A44     		add	r2, r2, r1
 7894 00e4 1A44     		add	r2, r2, r3
 7895 00e6 12F80E0C 		ldrb	r0, [r2, #-14]	@ zero_extendqisi2
 7896 00ea 6259     		ldr	r2, [r4, r5]
 7897 00ec D054     		strb	r0, [r2, r3]
 7898              	.LVL800:
 7899 00ee 0133     		adds	r3, r3, #1
 7900              	.LVL801:
 7901 00f0 1F2B     		cmp	r3, #31
 7902 00f2 F4D1     		bne	.L830
 7903              	.LVL802:
2693:bluetooth_rxtx.c **** 			u8 tot_len = (u8)(plen + 18);
2694:bluetooth_rxtx.c **** 			u8 adv_len = (u8)(plen + 7);
2695:bluetooth_rxtx.c **** 			adv_ind[i][1] = tot_len;
ARM GAS  /tmp/ccCuKxzC.s 			page 210


 7904              		.loc 1 2695 0
 7905 00f4 6259     		ldr	r2, [r4, r5]
 7906 00f6 1D21     		movs	r1, #29
 7907 00f8 5170     		strb	r1, [r2, #1]
2696:bluetooth_rxtx.c **** 			adv_ind[i][12] = adv_len;
 7908              		.loc 1 2696 0
 7909 00fa 6259     		ldr	r2, [r4, r5]
 7910 00fc 1221     		movs	r1, #18
 7911 00fe 1173     		strb	r1, [r2, #12]
 7912              	.LVL803:
 7913              	.LBE89:
 7914 0100 21E0     		b	.L831
 7915              	.LVL804:
 7916              	.L828:
 7917 0102 4FF00B0E 		mov	lr, #11
 7918              	.LBB90:
2697:bluetooth_rxtx.c **** 			adv_ind_len = (u8) (20 + plen);
2698:bluetooth_rxtx.c **** 		} else {
2699:bluetooth_rxtx.c **** 			u8 tot_len = (u8)(fin_adv_len + 18);
 7919              		.loc 1 2699 0
 7920 0106 5FFA88F2 		uxtb	r2, r8
 7921 010a 0EFB07FE 		mul	lr, lr, r7
2700:bluetooth_rxtx.c **** 			u8 adv_len = (u8)(fin_adv_len + 7);
 7922              		.loc 1 2700 0
 7923 010e D31D     		adds	r3, r2, #7
 7924 0110 DBB2     		uxtb	r3, r3
2699:bluetooth_rxtx.c **** 			u8 adv_len = (u8)(fin_adv_len + 7);
 7925              		.loc 1 2699 0
 7926 0112 02F11200 		add	r0, r2, #18
 7927              		.loc 1 2700 0
 7928 0116 0193     		str	r3, [sp, #4]
2699:bluetooth_rxtx.c **** 			u8 adv_len = (u8)(fin_adv_len + 7);
 7929              		.loc 1 2699 0
 7930 0118 C0B2     		uxtb	r0, r0
 7931              	.LVL805:
2701:bluetooth_rxtx.c **** 			for (j=0; j<fin_adv_len; j++) adv_ind[i][j+20] = slave_mac_address_data[6+plen*i+j];
 7932              		.loc 1 2701 0
 7933 011a 0023     		movs	r3, #0
 7934              	.LVL806:
 7935              	.L832:
 7936              		.loc 1 2701 0 is_stmt 0 discriminator 1
 7937 011c 4345     		cmp	r3, r8
 7938 011e 0BDA     		bge	.L855
 7939              		.loc 1 2701 0 discriminator 2
 7940 0120 4049     		ldr	r1, .L858+4
 7941 0122 0968     		ldr	r1, [r1]
 7942 0124 1944     		add	r1, r1, r3
 7943 0126 7144     		add	r1, r1, lr
 7944 0128 91F806C0 		ldrb	ip, [r1, #6]	@ zero_extendqisi2
 7945 012c 6159     		ldr	r1, [r4, r5]
 7946 012e 1944     		add	r1, r1, r3
 7947 0130 81F814C0 		strb	ip, [r1, #20]
 7948 0134 0133     		adds	r3, r3, #1
 7949              	.LVL807:
 7950 0136 F1E7     		b	.L832
 7951              	.L855:
2702:bluetooth_rxtx.c **** 			adv_ind[i][1] = tot_len;
ARM GAS  /tmp/ccCuKxzC.s 			page 211


 7952              		.loc 1 2702 0 is_stmt 1
 7953 0138 6359     		ldr	r3, [r4, r5]
 7954              	.LVL808:
2703:bluetooth_rxtx.c **** 			adv_ind[i][12] = adv_len;
2704:bluetooth_rxtx.c **** 			adv_ind_len = (u8) (fin_adv_len + 20);
 7955              		.loc 1 2704 0
 7956 013a 1432     		adds	r2, r2, #20
2702:bluetooth_rxtx.c **** 			adv_ind[i][1] = tot_len;
 7957              		.loc 1 2702 0
 7958 013c 5870     		strb	r0, [r3, #1]
2703:bluetooth_rxtx.c **** 			adv_ind[i][12] = adv_len;
 7959              		.loc 1 2703 0
 7960 013e 6359     		ldr	r3, [r4, r5]
 7961 0140 0198     		ldr	r0, [sp, #4]
 7962              	.LVL809:
 7963 0142 1873     		strb	r0, [r3, #12]
 7964              		.loc 1 2704 0
 7965 0144 D3B2     		uxtb	r3, r2
 7966              	.LVL810:
 7967              	.L831:
 7968              	.LBE90:
2705:bluetooth_rxtx.c **** 		}
2706:bluetooth_rxtx.c **** 
2707:bluetooth_rxtx.c **** 		calc_crc = btle_calc_crc(le.crc_init_reversed, adv_ind[i], adv_ind_len);
 7969              		.loc 1 2707 0
 7970 0146 3A4A     		ldr	r2, .L858+16
 7971 0148 6159     		ldr	r1, [r4, r5]
 7972 014a 1069     		ldr	r0, [r2, #16]
 7973 014c 1A46     		mov	r2, r3
 7974 014e 0093     		str	r3, [sp]
 7975 0150 FFF7FEFF 		bl	btle_calc_crc
 7976              	.LVL811:
2708:bluetooth_rxtx.c **** 		adv_ind_len = (int) adv_ind_len;
2709:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len] = (calc_crc >> 0) & 0xff;
 7977              		.loc 1 2709 0
 7978 0154 6259     		ldr	r2, [r4, r5]
 7979 0156 009B     		ldr	r3, [sp]
2710:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+1] = (calc_crc >> 8) & 0xff;
 7980              		.loc 1 2710 0
 7981 0158 010A     		lsrs	r1, r0, #8
2709:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+1] = (calc_crc >> 8) & 0xff;
 7982              		.loc 1 2709 0
 7983 015a D054     		strb	r0, [r2, r3]
 7984              	.LVL812:
 7985              		.loc 1 2710 0
 7986 015c 6259     		ldr	r2, [r4, r5]
2711:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+2] = (calc_crc >> 16) & 0xff;
 7987              		.loc 1 2711 0
 7988 015e 000C     		lsrs	r0, r0, #16
 7989              	.LVL813:
2710:bluetooth_rxtx.c **** 		adv_ind[i][adv_ind_len+1] = (calc_crc >> 8) & 0xff;
 7990              		.loc 1 2710 0
 7991 0160 1A44     		add	r2, r2, r3
 7992 0162 5170     		strb	r1, [r2, #1]
 7993              		.loc 1 2711 0
 7994 0164 6259     		ldr	r2, [r4, r5]
2686:bluetooth_rxtx.c **** 		for (j=0; j<20; j++) adv_ind[i][j] = adv_overhead[j];
ARM GAS  /tmp/ccCuKxzC.s 			page 212


 7995              		.loc 1 2686 0
 7996 0166 0137     		adds	r7, r7, #1
 7997              	.LVL814:
 7998              		.loc 1 2711 0
 7999 0168 1344     		add	r3, r3, r2
 8000 016a 9870     		strb	r0, [r3, #2]
 8001 016c 0435     		adds	r5, r5, #4
 8002 016e 96E7     		b	.L824
 8003              	.L834:
2712:bluetooth_rxtx.c **** 	}
2713:bluetooth_rxtx.c **** 
2714:bluetooth_rxtx.c **** 	clkn_start();
 8004              		.loc 1 2714 0
 8005 0170 FFF7FEFF 		bl	clkn_start
 8006              	.LVL815:
 8007              	.L836:
2715:bluetooth_rxtx.c **** 
2716:bluetooth_rxtx.c **** 	// spam advertising packets
2717:bluetooth_rxtx.c **** 	while (requested_mode == MODE_BT_SLAVE_LE) {
 8008              		.loc 1 2717 0 discriminator 1
 8009 0174 9BF81220 		ldrb	r2, [fp, #18]	@ zero_extendqisi2
 8010 0178 2B4B     		ldr	r3, .L858+8
 8011 017a 0C2A     		cmp	r2, #12
 8012 017c 33D1     		bne	.L837
2718:bluetooth_rxtx.c **** 		if (requested_mode != mode) break;
 8013              		.loc 1 2718 0
 8014 017e 9A7C     		ldrb	r2, [r3, #18]	@ zero_extendqisi2
 8015 0180 5B7C     		ldrb	r3, [r3, #17]	@ zero_extendqisi2
 8016 0182 9A42     		cmp	r2, r3
 8017 0184 2FD1     		bne	.L837
2719:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_USB;
 8018              		.loc 1 2719 0
 8019 0186 2B4B     		ldr	r3, .L858+20
 8020 0188 4FF08072 		mov	r2, #16777216
 8021 018c 1A60     		str	r2, [r3]
2720:bluetooth_rxtx.c **** 		ICER0 = ICER0_ICE_DMA;
 8022              		.loc 1 2720 0
 8023 018e 4FF08062 		mov	r2, #67108864
 8024 0192 1A60     		str	r2, [r3]
 8025              	.LVL816:
 8026 0194 0027     		movs	r7, #0
 8027              	.LVL817:
 8028              	.L838:
2686:bluetooth_rxtx.c **** 		for (j=0; j<20; j++) adv_ind[i][j] = adv_overhead[j];
 8029              		.loc 1 2686 0 discriminator 1
 8030 0196 0025     		movs	r5, #0
 8031              	.L843:
 8032              	.LVL818:
2721:bluetooth_rxtx.c **** 		for(i=0; i<3; i++) {
2722:bluetooth_rxtx.c **** 			for(j=0; j<num_adv_ind; j++) {
 8033              		.loc 1 2722 0 discriminator 1
 8034 0198 B542     		cmp	r5, r6
 8035 019a 13DA     		bge	.L856
2723:bluetooth_rxtx.c **** 				if (j < num_adv_ind -1) {
 8036              		.loc 1 2723 0
 8037 019c 4D45     		cmp	r5, r9
 8038 019e 03AB     		add	r3, sp, #12
ARM GAS  /tmp/ccCuKxzC.s 			page 213


 8039 01a0 02DA     		bge	.L839
 8040              	.LVL819:
2724:bluetooth_rxtx.c **** 					adv_ind_len = (u8) (20 + plen + 3);
2725:bluetooth_rxtx.c **** 					le_transmit(0x8e89bed6, adv_ind_len, adv_ind[j], ch[i]);
 8041              		.loc 1 2725 0
 8042 01a2 2548     		ldr	r0, .L858+24
 8043 01a4 2221     		movs	r1, #34
 8044 01a6 03E0     		b	.L853
 8045              	.LVL820:
 8046              	.L839:
2726:bluetooth_rxtx.c **** 				} else {
2727:bluetooth_rxtx.c **** 					adv_ind_len = (u8) (fin_adv_len + 20 + 3);
 8047              		.loc 1 2727 0
 8048 01a8 08F11701 		add	r1, r8, #23
2728:bluetooth_rxtx.c **** 					le_transmit(0x8e89bed6, adv_ind_len, adv_ind[j], ch[i]);
 8049              		.loc 1 2728 0
 8050 01ac 2248     		ldr	r0, .L858+24
 8051 01ae C9B2     		uxtb	r1, r1
 8052              	.LVL821:
 8053              	.L853:
 8054 01b0 54F82520 		ldr	r2, [r4, r5, lsl #2]
 8055 01b4 DB5B     		ldrh	r3, [r3, r7]
 8056 01b6 FFF7FEFF 		bl	le_transmit
 8057              	.LVL822:
2729:bluetooth_rxtx.c **** 				}
2730:bluetooth_rxtx.c **** 				msleep(10);
 8058              		.loc 1 2730 0
 8059 01ba 0A20     		movs	r0, #10
 8060 01bc FFF7FEFF 		bl	msleep
 8061              	.LVL823:
2722:bluetooth_rxtx.c **** 				if (j < num_adv_ind -1) {
 8062              		.loc 1 2722 0
 8063 01c0 0135     		adds	r5, r5, #1
 8064              	.LVL824:
 8065 01c2 E9E7     		b	.L843
 8066              	.L856:
2731:bluetooth_rxtx.c **** 			}
2732:bluetooth_rxtx.c **** 			msleep(5);
 8067              		.loc 1 2732 0
 8068 01c4 0520     		movs	r0, #5
 8069 01c6 0237     		adds	r7, r7, #2
 8070 01c8 FFF7FEFF 		bl	msleep
 8071              	.LVL825:
2721:bluetooth_rxtx.c **** 			for(j=0; j<num_adv_ind; j++) {
 8072              		.loc 1 2721 0
 8073 01cc 062F     		cmp	r7, #6
 8074 01ce E2D1     		bne	.L838
2733:bluetooth_rxtx.c **** 		}
2734:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_USB;
 8075              		.loc 1 2734 0
 8076 01d0 1A4B     		ldr	r3, .L858+28
 8077 01d2 4FF08072 		mov	r2, #16777216
 8078 01d6 1A60     		str	r2, [r3]
2735:bluetooth_rxtx.c **** 		ISER0 = ISER0_ISE_DMA;
 8079              		.loc 1 2735 0
 8080 01d8 4FF08062 		mov	r2, #67108864
 8081 01dc 1A60     		str	r2, [r3]
ARM GAS  /tmp/ccCuKxzC.s 			page 214


2736:bluetooth_rxtx.c **** 		msleep(10);
 8082              		.loc 1 2736 0
 8083 01de 0A20     		movs	r0, #10
 8084 01e0 FFF7FEFF 		bl	msleep
 8085              	.LVL826:
 8086 01e4 C6E7     		b	.L836
 8087              	.LVL827:
 8088              	.L837:
2737:bluetooth_rxtx.c **** 	}
2738:bluetooth_rxtx.c **** 	free(slave_mac_address_data);	
 8089              		.loc 1 2738 0
 8090 01e6 DAF80000 		ldr	r0, [r10]
 8091 01ea FFF7FEFF 		bl	free
 8092              	.LVL828:
2739:bluetooth_rxtx.c **** 	free(adv_ind);
 8093              		.loc 1 2739 0
 8094 01ee 2046     		mov	r0, r4
 8095 01f0 FFF7FEFF 		bl	free
 8096              	.LVL829:
2740:bluetooth_rxtx.c **** 	for(i=0; i<num_adv_ind; i++)
 8097              		.loc 1 2740 0
 8098 01f4 0025     		movs	r5, #0
 8099              	.LVL830:
 8100              	.L845:
 8101              		.loc 1 2740 0 is_stmt 0 discriminator 1
 8102 01f6 B542     		cmp	r5, r6
 8103 01f8 05DA     		bge	.L857
2741:bluetooth_rxtx.c **** 		free(adv_ind[i]);
 8104              		.loc 1 2741 0 is_stmt 1 discriminator 2
 8105 01fa 54F82500 		ldr	r0, [r4, r5, lsl #2]
 8106 01fe FFF7FEFF 		bl	free
 8107              	.LVL831:
2740:bluetooth_rxtx.c **** 	for(i=0; i<num_adv_ind; i++)
 8108              		.loc 1 2740 0 discriminator 2
 8109 0202 0135     		adds	r5, r5, #1
 8110              	.LVL832:
 8111 0204 F7E7     		b	.L845
 8112              	.L857:
2742:bluetooth_rxtx.c **** 	
2743:bluetooth_rxtx.c **** 	//JWHUR test
2744:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
 8113              		.loc 1 2744 0
 8114 0206 0B4B     		ldr	r3, .L858+20
 8115 0208 4FF08072 		mov	r2, #16777216
 8116 020c 1A60     		str	r2, [r3]
2745:bluetooth_rxtx.c **** 	cc2400_idle();
 8117              		.loc 1 2745 0
 8118 020e FFF7FEFF 		bl	cc2400_idle
 8119              	.LVL833:
2746:bluetooth_rxtx.c **** 	dio_ssp_stop ();
 8120              		.loc 1 2746 0
 8121 0212 FFF7FEFF 		bl	dio_ssp_stop
 8122              	.LVL834:
2747:bluetooth_rxtx.c **** 	cs_trigger_disable();
2748:bluetooth_rxtx.c **** }
 8123              		.loc 1 2748 0
 8124 0216 0BB0     		add	sp, sp, #44
ARM GAS  /tmp/ccCuKxzC.s 			page 215


 8125              		@ sp needed
 8126 0218 BDE8F04F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 8127              	.LVL835:
2747:bluetooth_rxtx.c **** 	cs_trigger_disable();
 8128              		.loc 1 2747 0
 8129 021c FFF7FEBF 		b	cs_trigger_disable
 8130              	.LVL836:
 8131              	.L859:
 8132              		.align	2
 8133              	.L858:
 8134 0220 A8080000 		.word	.LANCHOR2+2216
 8135 0224 00000000 		.word	slave_mac_address_data
 8136 0228 00000000 		.word	.LANCHOR0
 8137 022c 40000000 		.word	.LANCHOR0+64
 8138 0230 00000000 		.word	.LANCHOR1
 8139 0234 80E100E0 		.word	-536813184
 8140 0238 D6BE898E 		.word	-1903575338
 8141 023c 00E100E0 		.word	-536813312
 8142              		.cfi_endproc
 8143              	.LFE37:
 8145              		.section	.text.bt_sync_le,"ax",%progbits
 8146              		.align	1
 8147              		.global	bt_sync_le
 8148              		.thumb
 8149              		.thumb_func
 8151              	bt_sync_le:
 8152              	.LFB38:
2749:bluetooth_rxtx.c **** 
2750:bluetooth_rxtx.c **** void bt_sync_le() {
 8153              		.loc 1 2750 0
 8154              		.cfi_startproc
 8155              		@ args = 0, pretend = 0, frame = 24
 8156              		@ frame_needed = 0, uses_anonymous_args = 0
 8157 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 8158              		.cfi_def_cfa_offset 28
 8159              		.cfi_offset 4, -28
 8160              		.cfi_offset 5, -24
 8161              		.cfi_offset 6, -20
 8162              		.cfi_offset 7, -16
 8163              		.cfi_offset 8, -12
 8164              		.cfi_offset 9, -8
 8165              		.cfi_offset 14, -4
 8166 0004 87B0     		sub	sp, sp, #28
 8167              		.cfi_def_cfa_offset 56
 8168              	.LVL837:
2751:bluetooth_rxtx.c **** 	u32 calc_crc;
2752:bluetooth_rxtx.c **** 	int i, j;
2753:bluetooth_rxtx.c **** 	int num_adv_ind = 1;
2754:bluetooth_rxtx.c **** 	u8 adv_ind_len;
2755:bluetooth_rxtx.c **** 	u8 *adv_ind;
2756:bluetooth_rxtx.c **** 	u16 ch[] = {2402, 2426, 2480};
2757:bluetooth_rxtx.c **** 
2758:bluetooth_rxtx.c **** 	u8 adv_sync[24] = {0x42, 0x16,	// adv_nonconn_ind, length 22 (0001 0110)
 8169              		.loc 1 2758 0
 8170 0006 314B     		ldr	r3, .L869
 8171 0008 6A46     		mov	r2, sp
 8172 000a 03F11806 		add	r6, r3, #24
ARM GAS  /tmp/ccCuKxzC.s 			page 216


 8173 000e 6D46     		mov	r5, sp
 8174              	.L861:
 8175 0010 1868     		ldr	r0, [r3]	@ unaligned
 8176 0012 5968     		ldr	r1, [r3, #4]	@ unaligned
 8177 0014 1446     		mov	r4, r2
 8178 0016 03C4     		stmia	r4!, {r0, r1}
 8179 0018 0833     		adds	r3, r3, #8
 8180 001a B342     		cmp	r3, r6
 8181 001c 2246     		mov	r2, r4
 8182 001e F7D1     		bne	.L861
 8183              	.LVL838:
2759:bluetooth_rxtx.c **** 					  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, // adv mac address
2760:bluetooth_rxtx.c **** 					  0x03, 0x03, 0xaa, 0xfe, // service advertised - len, type, eddystone UUID
2761:bluetooth_rxtx.c **** 					  0x0b, 0x16, 0xaa, 0xfe, // len(3 + URL frame + Eddystone URL), type, eddystone UUID
2762:bluetooth_rxtx.c **** 					  0x10, 0x00, 0x02, // URL frame - frametype(URL), tx power, URL scheme prefix (0x02: http://)
2763:bluetooth_rxtx.c **** 					  0xff, 0x53, 0x59, 0x4e, 0x43}; // preamble 0xff, S, Y, N, C
2764:bluetooth_rxtx.c **** 
2765:bluetooth_rxtx.c **** 	// Standards said maximum advertising channel PDU length 39 bytes (adv payload 19 + 1 (preamble))
2766:bluetooth_rxtx.c **** 	// There's a probem, actual maximum length 34 bytes (adv payload 14 + 1 (preamble)) in ubertooth
2767:bluetooth_rxtx.c **** 	// Nexsus 5 smartphone can not receive BLE packet which has length over 31 bytes (adv payload 11 +
2768:bluetooth_rxtx.c **** 	adv_ind_len = 24; 
2769:bluetooth_rxtx.c **** 	adv_ind = (u8*) malloc(sizeof(u8)*24);
 8184              		.loc 1 2769 0
 8185 0020 1820     		movs	r0, #24
 8186 0022 FFF7FEFF 		bl	malloc
 8187              	.LVL839:
2770:bluetooth_rxtx.c **** 
2771:bluetooth_rxtx.c **** 	for (i=0; i<24; i++)
 8188              		.loc 1 2771 0
 8189 0026 0023     		movs	r3, #0
2769:bluetooth_rxtx.c **** 
 8190              		.loc 1 2769 0
 8191 0028 0446     		mov	r4, r0
 8192              	.LVL840:
 8193              	.L863:
2772:bluetooth_rxtx.c **** 		adv_ind[i] = adv_sync[i];
 8194              		.loc 1 2772 0 discriminator 2
 8195 002a EA5C     		ldrb	r2, [r5, r3]	@ zero_extendqisi2
 8196 002c E254     		strb	r2, [r4, r3]
2771:bluetooth_rxtx.c **** 		adv_ind[i] = adv_sync[i];
 8197              		.loc 1 2771 0 discriminator 2
 8198 002e 0133     		adds	r3, r3, #1
 8199              	.LVL841:
 8200 0030 182B     		cmp	r3, #24
 8201 0032 FAD1     		bne	.L863
2771:bluetooth_rxtx.c **** 		adv_ind[i] = adv_sync[i];
 8202              		.loc 1 2771 0 is_stmt 0
 8203 0034 0023     		movs	r3, #0
 8204              	.LVL842:
 8205              	.L865:
2773:bluetooth_rxtx.c **** 	for (i=0; i<6; i++) 
2774:bluetooth_rxtx.c **** 		adv_ind[i+2] = slave_mac_address_data[5-i];
 8206              		.loc 1 2774 0 is_stmt 1 discriminator 2
 8207 0036 DFF8B080 		ldr	r8, .L869+28
 8208 003a C3F10501 		rsb	r1, r3, #5
 8209 003e D8F80020 		ldr	r2, [r8]
 8210 0042 515C     		ldrb	r1, [r2, r1]	@ zero_extendqisi2
ARM GAS  /tmp/ccCuKxzC.s 			page 217


 8211 0044 E218     		adds	r2, r4, r3
2773:bluetooth_rxtx.c **** 	for (i=0; i<6; i++) 
 8212              		.loc 1 2773 0 discriminator 2
 8213 0046 0133     		adds	r3, r3, #1
 8214              	.LVL843:
 8215 0048 062B     		cmp	r3, #6
 8216              		.loc 1 2774 0 discriminator 2
 8217 004a 9170     		strb	r1, [r2, #2]
2773:bluetooth_rxtx.c **** 	for (i=0; i<6; i++) 
 8218              		.loc 1 2773 0 discriminator 2
 8219 004c F3D1     		bne	.L865
2775:bluetooth_rxtx.c **** 
2776:bluetooth_rxtx.c **** 	calc_crc = btle_calc_crc(le.crc_init_reversed, adv_ind, adv_ind_len);
 8220              		.loc 1 2776 0
 8221 004e 204B     		ldr	r3, .L869+4
 8222              	.LVL844:
 8223 0050 2146     		mov	r1, r4
 8224 0052 1822     		movs	r2, #24
 8225 0054 1869     		ldr	r0, [r3, #16]
 8226              	.LVL845:
 8227 0056 FFF7FEFF 		bl	btle_calc_crc
 8228              	.LVL846:
2777:bluetooth_rxtx.c **** 	adv_ind_len = (int) adv_ind_len;
2778:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+0] = (calc_crc >> 0) & 0xff;
2779:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+1] = (calc_crc >> 8) & 0xff;
2780:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+2] = (calc_crc >> 16) & 0xff;
2781:bluetooth_rxtx.c **** 
2782:bluetooth_rxtx.c **** 	clkn_start();
2783:bluetooth_rxtx.c **** 
2784:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
 8229              		.loc 1 2784 0
 8230 005a 1E4E     		ldr	r6, .L869+8
2779:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+2] = (calc_crc >> 16) & 0xff;
 8231              		.loc 1 2779 0
 8232 005c 030A     		lsrs	r3, r0, #8
2778:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+1] = (calc_crc >> 8) & 0xff;
 8233              		.loc 1 2778 0
 8234 005e 2076     		strb	r0, [r4, #24]
2780:bluetooth_rxtx.c **** 
 8235              		.loc 1 2780 0
 8236 0060 000C     		lsrs	r0, r0, #16
 8237              	.LVL847:
 8238              		.loc 1 2784 0
 8239 0062 4FF08075 		mov	r5, #16777216
2779:bluetooth_rxtx.c **** 	adv_ind[adv_ind_len+2] = (calc_crc >> 16) & 0xff;
 8240              		.loc 1 2779 0
 8241 0066 6376     		strb	r3, [r4, #25]
2780:bluetooth_rxtx.c **** 
 8242              		.loc 1 2780 0
 8243 0068 A076     		strb	r0, [r4, #26]
2785:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_DMA;
 8244              		.loc 1 2785 0
 8245 006a 4FF08069 		mov	r9, #67108864
2782:bluetooth_rxtx.c **** 
 8246              		.loc 1 2782 0
 8247 006e FFF7FEFF 		bl	clkn_start
 8248              	.LVL848:
ARM GAS  /tmp/ccCuKxzC.s 			page 218


2786:bluetooth_rxtx.c **** 	adv_ind_len = (u8) (adv_ind_len + 3);
2787:bluetooth_rxtx.c **** 	le_transmit(0x8e89bed6, adv_ind_len, adv_ind, ch[0]);
 8249              		.loc 1 2787 0
 8250 0072 1B21     		movs	r1, #27
 8251 0074 2246     		mov	r2, r4
2784:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_DMA;
 8252              		.loc 1 2784 0
 8253 0076 3560     		str	r5, [r6]
 8254              		.loc 1 2787 0
 8255 0078 1748     		ldr	r0, .L869+12
2785:bluetooth_rxtx.c **** 	adv_ind_len = (u8) (adv_ind_len + 3);
 8256              		.loc 1 2785 0
 8257 007a C6F80090 		str	r9, [r6]
 8258              	.LVL849:
 8259              		.loc 1 2787 0
 8260 007e 40F66213 		movw	r3, #2402
 8261 0082 FFF7FEFF 		bl	le_transmit
 8262              	.LVL850:
2788:bluetooth_rxtx.c **** 	now_sync = (clkn & 0xffffff);
 8263              		.loc 1 2788 0
 8264 0086 154B     		ldr	r3, .L869+16
 8265 0088 154F     		ldr	r7, .L869+20
 8266 008a 1B68     		ldr	r3, [r3]
2789:bluetooth_rxtx.c **** 	start_sync = now_sync + 100 * 10000 / 3125; // wait for 99.8 ms
2790:bluetooth_rxtx.c **** 
2791:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_USB;
2792:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_DMA;
2793:bluetooth_rxtx.c **** 
2794:bluetooth_rxtx.c **** 	free(adv_ind);
 8267              		.loc 1 2794 0
 8268 008c 2046     		mov	r0, r4
2788:bluetooth_rxtx.c **** 	now_sync = (clkn & 0xffffff);
 8269              		.loc 1 2788 0
 8270 008e 23F07F43 		bic	r3, r3, #-16777216
 8271 0092 FB62     		str	r3, [r7, #44]
2789:bluetooth_rxtx.c **** 	start_sync = now_sync + 100 * 10000 / 3125; // wait for 99.8 ms
 8272              		.loc 1 2789 0
 8273 0094 03F5A073 		add	r3, r3, #320
 8274 0098 BB62     		str	r3, [r7, #40]
2791:bluetooth_rxtx.c **** 	ISER0 = ISER0_ISE_DMA;
 8275              		.loc 1 2791 0
 8276 009a 124B     		ldr	r3, .L869+24
 8277 009c 1D60     		str	r5, [r3]
2792:bluetooth_rxtx.c **** 
 8278              		.loc 1 2792 0
 8279 009e C3F80090 		str	r9, [r3]
 8280              		.loc 1 2794 0
 8281 00a2 FFF7FEFF 		bl	free
 8282              	.LVL851:
2795:bluetooth_rxtx.c **** 	free(slave_mac_address_data);
 8283              		.loc 1 2795 0
 8284 00a6 D8F80000 		ldr	r0, [r8]
 8285 00aa FFF7FEFF 		bl	free
 8286              	.LVL852:
2796:bluetooth_rxtx.c **** 	requested_mode = MODE_BT_RSSI_LE;
 8287              		.loc 1 2796 0
 8288 00ae 1220     		movs	r0, #18
ARM GAS  /tmp/ccCuKxzC.s 			page 219


 8289 00b0 B874     		strb	r0, [r7, #18]
2797:bluetooth_rxtx.c **** 	bt_tracking_le(MODE_BT_RSSI_LE);
 8290              		.loc 1 2797 0
 8291 00b2 FFF7FEFF 		bl	bt_tracking_le
 8292              	.LVL853:
2798:bluetooth_rxtx.c **** 	
2799:bluetooth_rxtx.c **** 	ICER0 = ICER0_ICE_USB;
 8293              		.loc 1 2799 0
 8294 00b6 3560     		str	r5, [r6]
2800:bluetooth_rxtx.c **** 	cc2400_idle();
 8295              		.loc 1 2800 0
 8296 00b8 FFF7FEFF 		bl	cc2400_idle
 8297              	.LVL854:
2801:bluetooth_rxtx.c **** 	dio_ssp_stop ();
 8298              		.loc 1 2801 0
 8299 00bc FFF7FEFF 		bl	dio_ssp_stop
 8300              	.LVL855:
2802:bluetooth_rxtx.c **** 	cs_trigger_disable();
2803:bluetooth_rxtx.c **** }
 8301              		.loc 1 2803 0
 8302 00c0 07B0     		add	sp, sp, #28
 8303              		@ sp needed
 8304 00c2 BDE8F043 		pop	{r4, r5, r6, r7, r8, r9, lr}
 8305              	.LVL856:
2802:bluetooth_rxtx.c **** 	cs_trigger_disable();
 8306              		.loc 1 2802 0
 8307 00c6 FFF7FEBF 		b	cs_trigger_disable
 8308              	.LVL857:
 8309              	.L870:
 8310 00ca 00BF     		.align	2
 8311              	.L869:
 8312 00cc C2080000 		.word	.LANCHOR2+2242
 8313 00d0 00000000 		.word	.LANCHOR1
 8314 00d4 80E100E0 		.word	-536813184
 8315 00d8 D6BE898E 		.word	-1903575338
 8316 00dc 00000000 		.word	clkn
 8317 00e0 00000000 		.word	.LANCHOR0
 8318 00e4 00E100E0 		.word	-536813312
 8319 00e8 00000000 		.word	slave_mac_address_data
 8320              		.cfi_endproc
 8321              	.LFE38:
 8323              		.section	.text.rx_generic_sync,"ax",%progbits
 8324              		.align	1
 8325              		.global	rx_generic_sync
 8326              		.thumb
 8327              		.thumb_func
 8329              	rx_generic_sync:
 8330              	.LFB39:
2804:bluetooth_rxtx.c **** 
2805:bluetooth_rxtx.c **** void rx_generic_sync(void) {
 8331              		.loc 1 2805 0
 8332              		.cfi_startproc
 8333              		@ args = 0, pretend = 0, frame = 40
 8334              		@ frame_needed = 0, uses_anonymous_args = 0
 8335 0000 00B5     		push	{lr}
 8336              		.cfi_def_cfa_offset 4
 8337              		.cfi_offset 14, -4
ARM GAS  /tmp/ccCuKxzC.s 			page 220


 8338 0002 8BB0     		sub	sp, sp, #44
 8339              		.cfi_def_cfa_offset 48
 8340              	.LVL858:
2806:bluetooth_rxtx.c **** 	u8 len = 32;
2807:bluetooth_rxtx.c **** 	u8 buf[len+4];
2808:bluetooth_rxtx.c **** 	u16 reg_val;
2809:bluetooth_rxtx.c **** 
2810:bluetooth_rxtx.c **** 	/* Put syncword at start of buffer
2811:bluetooth_rxtx.c **** 	 * DGS: fix this later, we don't know number of syncword bytes, etc
2812:bluetooth_rxtx.c **** 	 */
2813:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCH);
 8341              		.loc 1 2813 0
 8342 0004 2D20     		movs	r0, #45
 8343 0006 FFF7FEFF 		bl	cc2400_get
 8344              	.LVL859:
2814:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
 8345              		.loc 1 2814 0
 8346 000a 030A     		lsrs	r3, r0, #8
2815:bluetooth_rxtx.c **** 	buf[1] = reg_val & 0xFF;
 8347              		.loc 1 2815 0
 8348 000c 8DF80500 		strb	r0, [sp, #5]
2816:bluetooth_rxtx.c **** 	reg_val = cc2400_get(SYNCL);
 8349              		.loc 1 2816 0
 8350 0010 2C20     		movs	r0, #44
 8351              	.LVL860:
2814:bluetooth_rxtx.c **** 	buf[0] = (reg_val >> 8) & 0xFF;
 8352              		.loc 1 2814 0
 8353 0012 8DF80430 		strb	r3, [sp, #4]
 8354              		.loc 1 2816 0
 8355 0016 FFF7FEFF 		bl	cc2400_get
 8356              	.LVL861:
2817:bluetooth_rxtx.c **** 	buf[2] = (reg_val >> 8) & 0xFF;
 8357              		.loc 1 2817 0
 8358 001a 030A     		lsrs	r3, r0, #8
 8359 001c 8DF80630 		strb	r3, [sp, #6]
2818:bluetooth_rxtx.c **** 	buf[3] = reg_val & 0xFF;
 8360              		.loc 1 2818 0
 8361 0020 8DF80700 		strb	r0, [sp, #7]
2819:bluetooth_rxtx.c **** 
2820:bluetooth_rxtx.c **** 	queue_init();
 8362              		.loc 1 2820 0
 8363 0024 FFF7FEFF 		bl	queue_init
 8364              	.LVL862:
2821:bluetooth_rxtx.c **** 	clkn_start();
 8365              		.loc 1 2821 0
 8366 0028 FFF7FEFF 		bl	clkn_start
 8367              	.LVL863:
 8368              	.L873:
2822:bluetooth_rxtx.c **** 
2823:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 8369              		.loc 1 2823 0 discriminator 1
 8370 002c FFF7FEFF 		bl	cc2400_status
 8371              	.LVL864:
 8372 0030 4006     		lsls	r0, r0, #25
 8373 0032 FBD5     		bpl	.L873
2824:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 8374              		.loc 1 2824 0
ARM GAS  /tmp/ccCuKxzC.s 			page 221


 8375 0034 6120     		movs	r0, #97
 8376 0036 FFF7FEFF 		bl	cc2400_strobe
 8377              	.LVL865:
 8378              	.L875:
2825:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 8379              		.loc 1 2825 0 discriminator 1
 8380 003a FFF7FEFF 		bl	cc2400_status
 8381              	.LVL866:
 8382 003e 4107     		lsls	r1, r0, #29
 8383 0040 FBD5     		bpl	.L875
2826:bluetooth_rxtx.c **** 	RXLED_SET;
 8384              		.loc 1 2826 0
 8385 0042 144B     		ldr	r3, .L881
 8386 0044 1022     		movs	r2, #16
 8387 0046 1A60     		str	r2, [r3]
2827:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2828:bluetooth_rxtx.c **** 		PAEN_SET;
 8388              		.loc 1 2828 0
 8389 0048 8022     		movs	r2, #128
 8390 004a 1A62     		str	r2, [r3, #32]
2829:bluetooth_rxtx.c **** 		HGM_SET;
 8391              		.loc 1 2829 0
 8392 004c 4FF48072 		mov	r2, #256
 8393 0050 1A62     		str	r2, [r3, #32]
 8394              	.L877:
2830:bluetooth_rxtx.c **** #endif
2831:bluetooth_rxtx.c **** 	while (1) {
2832:bluetooth_rxtx.c **** 		while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 8395              		.loc 1 2832 0 discriminator 1
 8396 0052 0E20     		movs	r0, #14
 8397 0054 FFF7FEFF 		bl	cc2400_get
 8398              	.LVL867:
 8399 0058 00F01F00 		and	r0, r0, #31
 8400 005c 0F28     		cmp	r0, #15
 8401 005e F8D1     		bne	.L877
2833:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 8402              		.loc 1 2833 0
 8403 0060 6220     		movs	r0, #98
 8404 0062 FFF7FEFF 		bl	cc2400_strobe
 8405              	.LVL868:
2834:bluetooth_rxtx.c **** 		USRLED_CLR;
 8406              		.loc 1 2834 0
 8407 0066 0C4B     		ldr	r3, .L881+4
 8408 0068 0222     		movs	r2, #2
 8409 006a 1A60     		str	r2, [r3]
 8410              	.L879:
2835:bluetooth_rxtx.c **** 		while (!(cc2400_status() & SYNC_RECEIVED));
 8411              		.loc 1 2835 0 discriminator 1
 8412 006c FFF7FEFF 		bl	cc2400_status
 8413              	.LVL869:
 8414 0070 C206     		lsls	r2, r0, #27
 8415 0072 FBD5     		bpl	.L879
2836:bluetooth_rxtx.c **** 		USRLED_SET;
 8416              		.loc 1 2836 0
 8417 0074 074B     		ldr	r3, .L881
 8418 0076 0222     		movs	r2, #2
 8419 0078 1A60     		str	r2, [r3]
ARM GAS  /tmp/ccCuKxzC.s 			page 222


2837:bluetooth_rxtx.c **** 
2838:bluetooth_rxtx.c **** 		cc2400_fifo_read(len, buf+4);
 8420              		.loc 1 2838 0
 8421 007a 02A9     		add	r1, sp, #8
 8422 007c 2020     		movs	r0, #32
 8423 007e FFF7FEFF 		bl	cc2400_fifo_read
 8424              	.LVL870:
2839:bluetooth_rxtx.c **** 		enqueue(BR_PACKET, buf);
 8425              		.loc 1 2839 0
 8426 0082 01A9     		add	r1, sp, #4
 8427              	.LVL871:
 8428 0084 0020     		movs	r0, #0
 8429 0086 FFF7FEFF 		bl	enqueue
 8430              	.LVL872:
2840:bluetooth_rxtx.c **** 		handle_usb(clkn);
 8431              		.loc 1 2840 0
 8432 008a 044B     		ldr	r3, .L881+8
 8433 008c 1868     		ldr	r0, [r3]
 8434 008e FFF7FEFF 		bl	handle_usb
 8435              	.LVL873:
2841:bluetooth_rxtx.c **** 	}
 8436              		.loc 1 2841 0
 8437 0092 DEE7     		b	.L877
 8438              	.L882:
 8439              		.align	2
 8440              	.L881:
 8441 0094 38C00920 		.word	537509944
 8442 0098 3CC00920 		.word	537509948
 8443 009c 00000000 		.word	clkn
 8444              		.cfi_endproc
 8445              	.LFE39:
 8447              		.section	.text.rx_generic,"ax",%progbits
 8448              		.align	1
 8449              		.global	rx_generic
 8450              		.thumb
 8451              		.thumb_func
 8453              	rx_generic:
 8454              	.LFB40:
2842:bluetooth_rxtx.c **** }
2843:bluetooth_rxtx.c **** 
2844:bluetooth_rxtx.c **** void rx_generic(void) {
 8455              		.loc 1 2844 0
 8456              		.cfi_startproc
 8457              		@ args = 0, pretend = 0, frame = 0
 8458              		@ frame_needed = 0, uses_anonymous_args = 0
 8459 0000 08B5     		push	{r3, lr}
 8460              		.cfi_def_cfa_offset 8
 8461              		.cfi_offset 3, -8
 8462              		.cfi_offset 14, -4
2845:bluetooth_rxtx.c **** 	// Check for packet mode
2846:bluetooth_rxtx.c **** 	if(cc2400_get(GRMDM) && 0x0400) {
 8463              		.loc 1 2846 0
 8464 0002 2020     		movs	r0, #32
 8465 0004 FFF7FEFF 		bl	cc2400_get
 8466              	.LVL874:
 8467 0008 08B1     		cbz	r0, .L884
2847:bluetooth_rxtx.c **** 		rx_generic_sync();
ARM GAS  /tmp/ccCuKxzC.s 			page 223


 8468              		.loc 1 2847 0
 8469 000a FFF7FEFF 		bl	rx_generic_sync
 8470              	.LVL875:
 8471              	.L884:
2848:bluetooth_rxtx.c **** 	} else {
2849:bluetooth_rxtx.c **** 		modulation = MOD_NONE;
 8472              		.loc 1 2849 0
 8473 000e 034B     		ldr	r3, .L885
 8474 0010 0322     		movs	r2, #3
 8475 0012 1A70     		strb	r2, [r3]
2850:bluetooth_rxtx.c **** 		bt_stream_rx();
2851:bluetooth_rxtx.c **** 	}
2852:bluetooth_rxtx.c **** }
 8476              		.loc 1 2852 0
 8477 0014 BDE80840 		pop	{r3, lr}
2850:bluetooth_rxtx.c **** 		bt_stream_rx();
 8478              		.loc 1 2850 0
 8479 0018 FFF7FEBF 		b	bt_stream_rx
 8480              	.LVL876:
 8481              	.L886:
 8482              		.align	2
 8483              	.L885:
 8484 001c 00000000 		.word	.LANCHOR0
 8485              		.cfi_endproc
 8486              	.LFE40:
 8488              		.section	.text.tx_generic,"ax",%progbits
 8489              		.align	1
 8490              		.global	tx_generic
 8491              		.thumb
 8492              		.thumb_func
 8494              	tx_generic:
 8495              	.LFB41:
2853:bluetooth_rxtx.c **** 
2854:bluetooth_rxtx.c **** void tx_generic(void) {
 8496              		.loc 1 2854 0
 8497              		.cfi_startproc
 8498              		@ args = 0, pretend = 0, frame = 0
 8499              		@ frame_needed = 0, uses_anonymous_args = 0
 8500 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 8501              		.cfi_def_cfa_offset 24
 8502              		.cfi_offset 4, -24
 8503              		.cfi_offset 5, -20
 8504              		.cfi_offset 6, -16
 8505              		.cfi_offset 7, -12
 8506              		.cfi_offset 8, -8
 8507              		.cfi_offset 14, -4
2855:bluetooth_rxtx.c **** 	u16 synch, syncl;
2856:bluetooth_rxtx.c **** 	u8 prev_mode = mode;
 8508              		.loc 1 2856 0
 8509 0004 354D     		ldr	r5, .L898
2857:bluetooth_rxtx.c **** 
2858:bluetooth_rxtx.c **** 	mode = MODE_TX_GENERIC;
 8510              		.loc 1 2858 0
 8511 0006 1023     		movs	r3, #16
2859:bluetooth_rxtx.c **** 
2860:bluetooth_rxtx.c **** 	// Save existing syncword
2861:bluetooth_rxtx.c **** 	synch = cc2400_get(SYNCH);
ARM GAS  /tmp/ccCuKxzC.s 			page 224


 8512              		.loc 1 2861 0
 8513 0008 2D20     		movs	r0, #45
2856:bluetooth_rxtx.c **** 
 8514              		.loc 1 2856 0
 8515 000a 6E7C     		ldrb	r6, [r5, #17]	@ zero_extendqisi2
2858:bluetooth_rxtx.c **** 
 8516              		.loc 1 2858 0
 8517 000c 6B74     		strb	r3, [r5, #17]
 8518              		.loc 1 2861 0
 8519 000e FFF7FEFF 		bl	cc2400_get
 8520              	.LVL877:
 8521 0012 8046     		mov	r8, r0
2862:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 8522              		.loc 1 2862 0
 8523 0014 2C20     		movs	r0, #44
 8524 0016 FFF7FEFF 		bl	cc2400_get
 8525              	.LVL878:
2863:bluetooth_rxtx.c **** 
2864:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, tx_pkt.synch);
 8526              		.loc 1 2864 0
 8527 001a 314C     		ldr	r4, .L898+4
2862:bluetooth_rxtx.c **** 	syncl = cc2400_get(SYNCL);
 8528              		.loc 1 2862 0
 8529 001c 0746     		mov	r7, r0
 8530              		.loc 1 2864 0
 8531 001e 2188     		ldrh	r1, [r4]
 8532 0020 2D20     		movs	r0, #45
 8533 0022 FFF7FEFF 		bl	cc2400_set
 8534              	.LVL879:
2865:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, tx_pkt.syncl);
 8535              		.loc 1 2865 0
 8536 0026 2C20     		movs	r0, #44
 8537 0028 6188     		ldrh	r1, [r4, #2]
 8538 002a FFF7FEFF 		bl	cc2400_set
 8539              	.LVL880:
2866:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0057);
 8540              		.loc 1 2866 0
 8541 002e 0320     		movs	r0, #3
 8542 0030 5721     		movs	r1, #87
 8543 0032 FFF7FEFF 		bl	cc2400_set
 8544              	.LVL881:
2867:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b);
 8545              		.loc 1 2867 0
 8546 0036 1420     		movs	r0, #20
 8547 0038 41F24B31 		movw	r1, #4939
 8548 003c FFF7FEFF 		bl	cc2400_set
 8549              	.LVL882:
2868:bluetooth_rxtx.c **** 	cc2400_set(GRMDM, 0x0f61);
 8550              		.loc 1 2868 0
 8551 0040 2020     		movs	r0, #32
 8552 0042 40F66171 		movw	r1, #3937
 8553 0046 FFF7FEFF 		bl	cc2400_set
 8554              	.LVL883:
2869:bluetooth_rxtx.c **** 	cc2400_set(FSDIV, tx_pkt.channel);
 8555              		.loc 1 2869 0
 8556 004a 0220     		movs	r0, #2
 8557 004c A188     		ldrh	r1, [r4, #4]
ARM GAS  /tmp/ccCuKxzC.s 			page 225


 8558 004e FFF7FEFF 		bl	cc2400_set
 8559              	.LVL884:
2870:bluetooth_rxtx.c **** 	cc2400_set(FREND, tx_pkt.pa_level);
 8560              		.loc 1 2870 0
 8561 0052 0520     		movs	r0, #5
 8562 0054 E179     		ldrb	r1, [r4, #7]	@ zero_extendqisi2
2856:bluetooth_rxtx.c **** 
 8563              		.loc 1 2856 0
 8564 0056 F6B2     		uxtb	r6, r6
 8565              	.LVL885:
 8566              		.loc 1 2870 0
 8567 0058 FFF7FEFF 		bl	cc2400_set
 8568              	.LVL886:
 8569              	.L889:
2871:bluetooth_rxtx.c **** 
2872:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 8570              		.loc 1 2872 0 discriminator 1
 8571 005c FFF7FEFF 		bl	cc2400_status
 8572              	.LVL887:
 8573 0060 4206     		lsls	r2, r0, #25
 8574 0062 FBD5     		bpl	.L889
2873:bluetooth_rxtx.c **** 	cc2400_strobe(SFSON);
 8575              		.loc 1 2873 0
 8576 0064 6120     		movs	r0, #97
 8577 0066 FFF7FEFF 		bl	cc2400_strobe
 8578              	.LVL888:
 8579              	.L891:
2874:bluetooth_rxtx.c **** 	while (!(cc2400_status() & FS_LOCK));
 8580              		.loc 1 2874 0 discriminator 1
 8581 006a FFF7FEFF 		bl	cc2400_status
 8582              	.LVL889:
 8583 006e 4307     		lsls	r3, r0, #29
 8584 0070 FBD5     		bpl	.L891
2875:bluetooth_rxtx.c **** 	TXLED_SET;
 8585              		.loc 1 2875 0
 8586 0072 1C4B     		ldr	r3, .L898+8
 8587 0074 4FF48072 		mov	r2, #256
 8588 0078 1A60     		str	r2, [r3]
2876:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2877:bluetooth_rxtx.c **** 		PAEN_SET;
 8589              		.loc 1 2877 0
 8590 007a 8022     		movs	r2, #128
 8591 007c 1A62     		str	r2, [r3, #32]
 8592              	.L893:
2878:bluetooth_rxtx.c **** #endif
2879:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 8593              		.loc 1 2879 0 discriminator 1
 8594 007e 0E20     		movs	r0, #14
 8595 0080 FFF7FEFF 		bl	cc2400_get
 8596              	.LVL890:
 8597 0084 00F01F00 		and	r0, r0, #31
 8598 0088 0F28     		cmp	r0, #15
 8599 008a F8D1     		bne	.L893
2880:bluetooth_rxtx.c **** 
2881:bluetooth_rxtx.c **** 	cc2400_fifo_write(tx_pkt.length, tx_pkt.data);
 8600              		.loc 1 2881 0
 8601 008c A079     		ldrb	r0, [r4, #6]	@ zero_extendqisi2
ARM GAS  /tmp/ccCuKxzC.s 			page 226


 8602 008e 1649     		ldr	r1, .L898+12
 8603 0090 FFF7FEFF 		bl	cc2400_fifo_write
 8604              	.LVL891:
2882:bluetooth_rxtx.c **** 	cc2400_strobe(STX);
 8605              		.loc 1 2882 0
 8606 0094 6320     		movs	r0, #99
 8607 0096 FFF7FEFF 		bl	cc2400_strobe
 8608              	.LVL892:
 8609              	.L895:
2883:bluetooth_rxtx.c **** 
2884:bluetooth_rxtx.c **** 	while ((cc2400_get(FSMSTATE) & 0x1f) != STATE_STROBE_FS_ON);
 8610              		.loc 1 2884 0 discriminator 1
 8611 009a 0E20     		movs	r0, #14
 8612 009c FFF7FEFF 		bl	cc2400_get
 8613              	.LVL893:
 8614 00a0 00F01F00 		and	r0, r0, #31
 8615 00a4 0F28     		cmp	r0, #15
 8616 00a6 F8D1     		bne	.L895
2885:bluetooth_rxtx.c **** 	TXLED_CLR;
 8617              		.loc 1 2885 0
 8618 00a8 104B     		ldr	r3, .L898+16
 8619 00aa 4FF48072 		mov	r2, #256
 8620 00ae 1A60     		str	r2, [r3]
2886:bluetooth_rxtx.c **** 
2887:bluetooth_rxtx.c **** 	cc2400_strobe(SRFOFF);
 8621              		.loc 1 2887 0
 8622 00b0 6420     		movs	r0, #100
 8623 00b2 FFF7FEFF 		bl	cc2400_strobe
 8624              	.LVL894:
 8625              	.L897:
2888:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 8626              		.loc 1 2888 0 discriminator 1
 8627 00b6 FFF7FEFF 		bl	cc2400_status
 8628              	.LVL895:
 8629 00ba 4407     		lsls	r4, r0, #29
 8630 00bc FBD4     		bmi	.L897
2889:bluetooth_rxtx.c **** 
2890:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2891:bluetooth_rxtx.c **** 	PAEN_CLR;
 8631              		.loc 1 2891 0
 8632 00be 0C4B     		ldr	r3, .L898+20
 8633 00c0 8022     		movs	r2, #128
 8634 00c2 1A60     		str	r2, [r3]
2892:bluetooth_rxtx.c **** #endif
2893:bluetooth_rxtx.c **** 
2894:bluetooth_rxtx.c **** 	// Restore state
2895:bluetooth_rxtx.c **** 	cc2400_set(SYNCH, synch);
 8635              		.loc 1 2895 0
 8636 00c4 2D20     		movs	r0, #45
 8637 00c6 4146     		mov	r1, r8
 8638 00c8 FFF7FEFF 		bl	cc2400_set
 8639              	.LVL896:
2896:bluetooth_rxtx.c **** 	cc2400_set(SYNCL, syncl);
 8640              		.loc 1 2896 0
 8641 00cc 2C20     		movs	r0, #44
 8642 00ce 3946     		mov	r1, r7
 8643 00d0 FFF7FEFF 		bl	cc2400_set
ARM GAS  /tmp/ccCuKxzC.s 			page 227


 8644              	.LVL897:
2897:bluetooth_rxtx.c **** 	requested_mode = prev_mode;
 8645              		.loc 1 2897 0
 8646 00d4 AE74     		strb	r6, [r5, #18]
 8647 00d6 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 8648              	.LVL898:
 8649              	.L899:
 8650 00da 00BF     		.align	2
 8651              	.L898:
 8652 00dc 00000000 		.word	.LANCHOR0
 8653 00e0 00000000 		.word	tx_pkt
 8654 00e4 38C00920 		.word	537509944
 8655 00e8 08000000 		.word	tx_pkt+8
 8656 00ec 3CC00920 		.word	537509948
 8657 00f0 5CC00920 		.word	537509980
 8658              		.cfi_endproc
 8659              	.LFE41:
 8661              		.section	.text.specan,"ax",%progbits
 8662              		.align	1
 8663              		.global	specan
 8664              		.thumb
 8665              		.thumb_func
 8667              	specan:
 8668              	.LFB42:
2898:bluetooth_rxtx.c **** }
2899:bluetooth_rxtx.c **** 
2900:bluetooth_rxtx.c **** /* spectrum analysis */
2901:bluetooth_rxtx.c **** void specan()
2902:bluetooth_rxtx.c **** {
 8669              		.loc 1 2902 0
 8670              		.cfi_startproc
 8671              		@ args = 0, pretend = 0, frame = 56
 8672              		@ frame_needed = 0, uses_anonymous_args = 0
 8673 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 8674              		.cfi_def_cfa_offset 24
 8675              		.cfi_offset 4, -24
 8676              		.cfi_offset 5, -20
 8677              		.cfi_offset 6, -16
 8678              		.cfi_offset 7, -12
 8679              		.cfi_offset 8, -8
 8680              		.cfi_offset 14, -4
 8681 0004 8EB0     		sub	sp, sp, #56
 8682              		.cfi_def_cfa_offset 80
 8683              	.LVL899:
2903:bluetooth_rxtx.c **** 	u16 f;
2904:bluetooth_rxtx.c **** 	u8 i = 0;
2905:bluetooth_rxtx.c **** 	u8 buf[DMA_SIZE];
2906:bluetooth_rxtx.c **** 
2907:bluetooth_rxtx.c **** 	RXLED_SET;
 8684              		.loc 1 2907 0
 8685 0006 3D4B     		ldr	r3, .L917
 8686 0008 1022     		movs	r2, #16
 8687 000a 1A60     		str	r2, [r3]
2908:bluetooth_rxtx.c **** 
2909:bluetooth_rxtx.c **** 	queue_init();
 8688              		.loc 1 2909 0
 8689 000c FFF7FEFF 		bl	queue_init
ARM GAS  /tmp/ccCuKxzC.s 			page 228


 8690              	.LVL900:
2910:bluetooth_rxtx.c **** 	clkn_start();
 8691              		.loc 1 2910 0
 8692 0010 FFF7FEFF 		bl	clkn_start
 8693              	.LVL901:
2911:bluetooth_rxtx.c **** 
2912:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2913:bluetooth_rxtx.c **** 	PAEN_SET;
 8694              		.loc 1 2913 0
 8695 0014 3A4B     		ldr	r3, .L917+4
 8696 0016 8022     		movs	r2, #128
 8697 0018 1A60     		str	r2, [r3]
2914:bluetooth_rxtx.c **** 	//HGM_SET;
2915:bluetooth_rxtx.c **** #endif
2916:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 8698              		.loc 1 2916 0
 8699 001a 1220     		movs	r0, #18
 8700 001c 42F62231 		movw	r1, #11042
 8701 0020 FFF7FEFF 		bl	cc2400_set
 8702              	.LVL902:
2917:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 8703              		.loc 1 2917 0
 8704 0024 1420     		movs	r0, #20
 8705 0026 41F24B31 		movw	r1, #4939
 8706 002a FFF7FEFF 		bl	cc2400_set
 8707              	.LVL903:
2918:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 8708              		.loc 1 2918 0
 8709 002e 2020     		movs	r0, #32
 8710 0030 40F20111 		movw	r1, #257
 8711 0034 FFF7FEFF 		bl	cc2400_set
 8712              	.LVL904:
2919:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 8713              		.loc 1 2919 0
 8714 0038 0320     		movs	r0, #3
 8715 003a 2921     		movs	r1, #41
 8716 003c FFF7FEFF 		bl	cc2400_set
 8717              	.LVL905:
 8718              	.L902:
2920:bluetooth_rxtx.c **** 	//FIXME maybe set RSSI.RSSI_FILT
2921:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 8719              		.loc 1 2921 0 discriminator 1
 8720 0040 FFF7FEFF 		bl	cc2400_status
 8721              	.LVL906:
 8722 0044 4406     		lsls	r4, r0, #25
 8723 0046 FBD5     		bpl	.L902
 8724              	.L904:
2922:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 8725              		.loc 1 2922 0
 8726 0048 FFF7FEFF 		bl	cc2400_status
 8727              	.LVL907:
 8728 004c 00F00400 		and	r0, r0, #4
 8729 0050 00F0FF05 		and	r5, r0, #255
 8730 0054 0028     		cmp	r0, #0
 8731 0056 F7D1     		bne	.L904
 8732              	.LVL908:
 8733              	.L905:
ARM GAS  /tmp/ccCuKxzC.s 			page 229


2923:bluetooth_rxtx.c **** 
2924:bluetooth_rxtx.c **** 	while (requested_mode == MODE_SPECAN) {
 8734              		.loc 1 2924 0 discriminator 1
 8735 0058 2A4B     		ldr	r3, .L917+8
 8736 005a 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 8737 005c 042B     		cmp	r3, #4
 8738 005e 47D1     		bne	.L916
2925:bluetooth_rxtx.c **** 		for (f = low_freq; f < high_freq + 1; f++) {
 8739              		.loc 1 2925 0
 8740 0060 294B     		ldr	r3, .L917+12
 8741 0062 B3F84C40 		ldrh	r4, [r3, #76]
 8742 0066 9846     		mov	r8, r3
 8743 0068 A4B2     		uxth	r4, r4
 8744              	.LVL909:
 8745              	.L906:
 8746              		.loc 1 2925 0 is_stmt 0 discriminator 1
 8747 006a B8F84E30 		ldrh	r3, [r8, #78]
 8748 006e 9BB2     		uxth	r3, r3
 8749 0070 A342     		cmp	r3, r4
 8750 0072 F1DB     		blt	.L905
 8751 0074 611E     		subs	r1, r4, #1
 8752              	.LBB91:
2926:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 8753              		.loc 1 2926 0 is_stmt 1
 8754 0076 0220     		movs	r0, #2
 8755 0078 89B2     		uxth	r1, r1
 8756 007a FFF7FEFF 		bl	cc2400_set
 8757              	.LVL910:
2927:bluetooth_rxtx.c **** 			cc2400_strobe(SFSON);
 8758              		.loc 1 2927 0
 8759 007e 6120     		movs	r0, #97
 8760 0080 FFF7FEFF 		bl	cc2400_strobe
 8761              	.LVL911:
 8762              	.L908:
2928:bluetooth_rxtx.c **** 			while (!(cc2400_status() & FS_LOCK));
 8763              		.loc 1 2928 0 discriminator 1
 8764 0084 FFF7FEFF 		bl	cc2400_status
 8765              	.LVL912:
 8766 0088 4007     		lsls	r0, r0, #29
 8767 008a FBD5     		bpl	.L908
2929:bluetooth_rxtx.c **** 			cc2400_strobe(SRX);
 8768              		.loc 1 2929 0
 8769 008c 6220     		movs	r0, #98
 8770 008e FFF7FEFF 		bl	cc2400_strobe
 8771              	.LVL913:
2930:bluetooth_rxtx.c **** 
2931:bluetooth_rxtx.c **** 			/* give the CC2400 time to acquire RSSI reading */
2932:bluetooth_rxtx.c **** 			volatile u32 j = 500; while (--j); //FIXME crude delay
 8772              		.loc 1 2932 0
 8773 0092 4FF4FA73 		mov	r3, #500
 8774 0096 0093     		str	r3, [sp]
 8775              	.L910:
 8776              		.loc 1 2932 0 is_stmt 0 discriminator 1
 8777 0098 009E     		ldr	r6, [sp]
 8778 009a 013E     		subs	r6, r6, #1
 8779 009c 0096     		str	r6, [sp]
 8780 009e 002E     		cmp	r6, #0
ARM GAS  /tmp/ccCuKxzC.s 			page 230


 8781 00a0 FAD1     		bne	.L910
2933:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 8782              		.loc 1 2933 0 is_stmt 1
 8783 00a2 0EAB     		add	r3, sp, #56
 8784 00a4 0327     		movs	r7, #3
 8785 00a6 07FB0537 		mla	r7, r7, r5, r3
2934:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
2935:bluetooth_rxtx.c **** 			buf[(3 * i) + 2] = cc2400_get(RSSI) >> 8;
 8786              		.loc 1 2935 0
 8787 00aa 0620     		movs	r0, #6
2933:bluetooth_rxtx.c **** 			buf[3 * i] = (f >> 8) & 0xFF;
 8788              		.loc 1 2933 0
 8789 00ac 230A     		lsrs	r3, r4, #8
 8790 00ae 07F8343C 		strb	r3, [r7, #-52]
2934:bluetooth_rxtx.c **** 			buf[(3 * i) + 1] = f  & 0xFF;
 8791              		.loc 1 2934 0
 8792 00b2 07F8334C 		strb	r4, [r7, #-51]
 8793              		.loc 1 2935 0
 8794 00b6 FFF7FEFF 		bl	cc2400_get
 8795              	.LVL914:
2936:bluetooth_rxtx.c **** 			i++;
 8796              		.loc 1 2936 0
 8797 00ba 0135     		adds	r5, r5, #1
 8798              	.LVL915:
 8799 00bc EDB2     		uxtb	r5, r5
 8800              	.LVL916:
2935:bluetooth_rxtx.c **** 			i++;
 8801              		.loc 1 2935 0
 8802 00be 000A     		lsrs	r0, r0, #8
2937:bluetooth_rxtx.c **** 			if (i == 16) {
 8803              		.loc 1 2937 0
 8804 00c0 102D     		cmp	r5, #16
2935:bluetooth_rxtx.c **** 			i++;
 8805              		.loc 1 2935 0
 8806 00c2 07F8320C 		strb	r0, [r7, #-50]
 8807              		.loc 1 2937 0
 8808 00c6 09D1     		bne	.L911
2938:bluetooth_rxtx.c **** 				enqueue(SPECAN, buf);
 8809              		.loc 1 2938 0
 8810 00c8 0420     		movs	r0, #4
 8811 00ca 0DEB0001 		add	r1, sp, r0
 8812 00ce FFF7FEFF 		bl	enqueue
 8813              	.LVL917:
2939:bluetooth_rxtx.c **** 				i = 0;
2940:bluetooth_rxtx.c **** 
2941:bluetooth_rxtx.c **** 				handle_usb(clkn);
 8814              		.loc 1 2941 0
 8815 00d2 0E4B     		ldr	r3, .L917+16
2939:bluetooth_rxtx.c **** 				i = 0;
 8816              		.loc 1 2939 0
 8817 00d4 3546     		mov	r5, r6
 8818              		.loc 1 2941 0
 8819 00d6 1868     		ldr	r0, [r3]
 8820 00d8 FFF7FEFF 		bl	handle_usb
 8821              	.LVL918:
 8822              	.L911:
2942:bluetooth_rxtx.c **** 			}
ARM GAS  /tmp/ccCuKxzC.s 			page 231


2943:bluetooth_rxtx.c **** 
2944:bluetooth_rxtx.c **** 			cc2400_strobe(SRFOFF);
 8823              		.loc 1 2944 0
 8824 00dc 6420     		movs	r0, #100
 8825 00de FFF7FEFF 		bl	cc2400_strobe
 8826              	.LVL919:
 8827              	.L913:
2945:bluetooth_rxtx.c **** 			while ((cc2400_status() & FS_LOCK));
 8828              		.loc 1 2945 0 discriminator 1
 8829 00e2 FFF7FEFF 		bl	cc2400_status
 8830              	.LVL920:
 8831 00e6 4107     		lsls	r1, r0, #29
 8832 00e8 FBD4     		bmi	.L913
 8833              	.LBE91:
2925:bluetooth_rxtx.c **** 			cc2400_set(FSDIV, f - 1);
 8834              		.loc 1 2925 0
 8835 00ea 0134     		adds	r4, r4, #1
 8836              	.LVL921:
 8837 00ec A4B2     		uxth	r4, r4
 8838              	.LVL922:
 8839 00ee BCE7     		b	.L906
 8840              	.LVL923:
 8841              	.L916:
2946:bluetooth_rxtx.c **** 		}
2947:bluetooth_rxtx.c **** 	}
2948:bluetooth_rxtx.c **** 	RXLED_CLR;
 8842              		.loc 1 2948 0
 8843 00f0 074B     		ldr	r3, .L917+20
 8844 00f2 1022     		movs	r2, #16
 8845 00f4 1A60     		str	r2, [r3]
2949:bluetooth_rxtx.c **** }
 8846              		.loc 1 2949 0
 8847 00f6 0EB0     		add	sp, sp, #56
 8848              		@ sp needed
 8849 00f8 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 8850              	.LVL924:
 8851              	.L918:
 8852              		.align	2
 8853              	.L917:
 8854 00fc 38C00920 		.word	537509944
 8855 0100 58C00920 		.word	537509976
 8856 0104 00000000 		.word	.LANCHOR0
 8857 0108 00000000 		.word	.LANCHOR1
 8858 010c 00000000 		.word	clkn
 8859 0110 3CC00920 		.word	537509948
 8860              		.cfi_endproc
 8861              	.LFE42:
 8863              		.section	.text.led_specan,"ax",%progbits
 8864              		.align	1
 8865              		.global	led_specan
 8866              		.thumb
 8867              		.thumb_func
 8869              	led_specan:
 8870              	.LFB43:
2950:bluetooth_rxtx.c **** 
2951:bluetooth_rxtx.c **** /* LED based spectrum analysis */
2952:bluetooth_rxtx.c **** void led_specan()
ARM GAS  /tmp/ccCuKxzC.s 			page 232


2953:bluetooth_rxtx.c **** {
 8871              		.loc 1 2953 0
 8872              		.cfi_startproc
 8873              		@ args = 0, pretend = 0, frame = 16
 8874              		@ frame_needed = 0, uses_anonymous_args = 0
 8875 0000 1FB5     		push	{r0, r1, r2, r3, r4, lr}
 8876              		.cfi_def_cfa_offset 24
 8877              		.cfi_offset 0, -24
 8878              		.cfi_offset 1, -20
 8879              		.cfi_offset 2, -16
 8880              		.cfi_offset 3, -12
 8881              		.cfi_offset 4, -8
 8882              		.cfi_offset 14, -4
 8883              	.LVL925:
2954:bluetooth_rxtx.c **** 	int8_t lvl;
2955:bluetooth_rxtx.c **** 	u8 i = 0;
2956:bluetooth_rxtx.c **** 	u16 channels[3] = {2412, 2437, 2462};
 8884              		.loc 1 2956 0
 8885 0002 444B     		ldr	r3, .L946
2957:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
2958:bluetooth_rxtx.c **** 	//void (*clr[3]) = {TXLED_CLR, RXLED_CLR, USRLED_CLR};
2959:bluetooth_rxtx.c **** 
2960:bluetooth_rxtx.c **** #ifdef UBERTOOTH_ONE
2961:bluetooth_rxtx.c **** 	PAEN_SET;
 8886              		.loc 1 2961 0
 8887 0004 8022     		movs	r2, #128
2956:bluetooth_rxtx.c **** 	//void (*set[3]) = {TXLED_SET, RXLED_SET, USRLED_SET};
 8888              		.loc 1 2956 0
 8889 0006 1868     		ldr	r0, [r3]	@ unaligned
 8890 0008 9B88     		ldrh	r3, [r3, #4]	@ unaligned
 8891 000a 0290     		str	r0, [sp, #8]	@ unaligned
 8892 000c ADF80C30 		strh	r3, [sp, #12]	@ unaligned
 8893              		.loc 1 2961 0
 8894 0010 414B     		ldr	r3, .L946+4
2962:bluetooth_rxtx.c **** 	//HGM_SET;
2963:bluetooth_rxtx.c **** #endif
2964:bluetooth_rxtx.c **** 	cc2400_set(LMTST,   0x2b22);
 8895              		.loc 1 2964 0
 8896 0012 1220     		movs	r0, #18
2961:bluetooth_rxtx.c **** 	//HGM_SET;
 8897              		.loc 1 2961 0
 8898 0014 1A60     		str	r2, [r3]
 8899              		.loc 1 2964 0
 8900 0016 42F62231 		movw	r1, #11042
 8901 001a FFF7FEFF 		bl	cc2400_set
 8902              	.LVL926:
2965:bluetooth_rxtx.c **** 	cc2400_set(MDMTST0, 0x134b); // without PRNG
 8903              		.loc 1 2965 0
 8904 001e 1420     		movs	r0, #20
 8905 0020 41F24B31 		movw	r1, #4939
 8906 0024 FFF7FEFF 		bl	cc2400_set
 8907              	.LVL927:
2966:bluetooth_rxtx.c **** 	cc2400_set(GRMDM,   0x0101); // un-buffered mode, GFSK
 8908              		.loc 1 2966 0
 8909 0028 2020     		movs	r0, #32
 8910 002a 40F20111 		movw	r1, #257
 8911 002e FFF7FEFF 		bl	cc2400_set
ARM GAS  /tmp/ccCuKxzC.s 			page 233


 8912              	.LVL928:
2967:bluetooth_rxtx.c **** 	cc2400_set(MDMCTRL, 0x0029); // 160 kHz frequency deviation
 8913              		.loc 1 2967 0
 8914 0032 0320     		movs	r0, #3
 8915 0034 2921     		movs	r1, #41
 8916 0036 FFF7FEFF 		bl	cc2400_set
 8917              	.LVL929:
2968:bluetooth_rxtx.c **** 	cc2400_set(RSSI,    0x00F1); // RSSI Sample over 2 symbols
 8918              		.loc 1 2968 0
 8919 003a 0620     		movs	r0, #6
 8920 003c F121     		movs	r1, #241
 8921 003e FFF7FEFF 		bl	cc2400_set
 8922              	.LVL930:
 8923              	.L921:
2969:bluetooth_rxtx.c **** 
2970:bluetooth_rxtx.c **** 	while (!(cc2400_status() & XOSC16M_STABLE));
 8924              		.loc 1 2970 0 discriminator 1
 8925 0042 FFF7FEFF 		bl	cc2400_status
 8926              	.LVL931:
 8927 0046 4106     		lsls	r1, r0, #25
 8928 0048 FBD5     		bpl	.L921
 8929              	.L923:
2971:bluetooth_rxtx.c **** 	while ((cc2400_status() & FS_LOCK));
 8930              		.loc 1 2971 0
 8931 004a FFF7FEFF 		bl	cc2400_status
 8932              	.LVL932:
 8933 004e 00F00400 		and	r0, r0, #4
 8934 0052 00F0FF04 		and	r4, r0, #255
 8935 0056 0028     		cmp	r0, #0
 8936 0058 F7D1     		bne	.L923
 8937              	.LVL933:
 8938              	.L924:
2972:bluetooth_rxtx.c **** 
2973:bluetooth_rxtx.c **** 	while (requested_mode == MODE_LED_SPECAN) {
 8939              		.loc 1 2973 0 discriminator 1
 8940 005a 304B     		ldr	r3, .L946+8
 8941 005c 9B7C     		ldrb	r3, [r3, #18]	@ zero_extendqisi2
 8942 005e 072B     		cmp	r3, #7
 8943 0060 55D1     		bne	.L945
 8944              	.LBB92:
2974:bluetooth_rxtx.c **** 		cc2400_set(FSDIV, channels[i] - 1);
 8945              		.loc 1 2974 0
 8946 0062 04AA     		add	r2, sp, #16
 8947 0064 02EB4403 		add	r3, r2, r4, lsl #1
 8948 0068 33F8081C 		ldrh	r1, [r3, #-8]
 8949 006c 0220     		movs	r0, #2
 8950 006e 0139     		subs	r1, r1, #1
 8951 0070 89B2     		uxth	r1, r1
 8952 0072 FFF7FEFF 		bl	cc2400_set
 8953              	.LVL934:
2975:bluetooth_rxtx.c **** 		cc2400_strobe(SFSON);
 8954              		.loc 1 2975 0
 8955 0076 6120     		movs	r0, #97
 8956 0078 FFF7FEFF 		bl	cc2400_strobe
 8957              	.LVL935:
 8958              	.L926:
2976:bluetooth_rxtx.c **** 		while (!(cc2400_status() & FS_LOCK));
ARM GAS  /tmp/ccCuKxzC.s 			page 234


 8959              		.loc 1 2976 0 discriminator 1
 8960 007c FFF7FEFF 		bl	cc2400_status
 8961              	.LVL936:
 8962 0080 4207     		lsls	r2, r0, #29
 8963 0082 FBD5     		bpl	.L926
2977:bluetooth_rxtx.c **** 		cc2400_strobe(SRX);
 8964              		.loc 1 2977 0
 8965 0084 6220     		movs	r0, #98
 8966 0086 FFF7FEFF 		bl	cc2400_strobe
 8967              	.LVL937:
2978:bluetooth_rxtx.c **** 
2979:bluetooth_rxtx.c **** 		/* give the CC2400 time to acquire RSSI reading */
2980:bluetooth_rxtx.c **** 		volatile u32 j = 500; while (--j); //FIXME crude delay
 8968              		.loc 1 2980 0
 8969 008a 4FF4FA73 		mov	r3, #500
 8970 008e 0193     		str	r3, [sp, #4]
 8971              	.L928:
 8972              		.loc 1 2980 0 is_stmt 0 discriminator 1
 8973 0090 019B     		ldr	r3, [sp, #4]
 8974 0092 013B     		subs	r3, r3, #1
 8975 0094 0193     		str	r3, [sp, #4]
 8976 0096 002B     		cmp	r3, #0
 8977 0098 FAD1     		bne	.L928
2981:bluetooth_rxtx.c **** 		lvl = (int8_t)((cc2400_get(RSSI) >> 8) & 0xff);
 8978              		.loc 1 2981 0 is_stmt 1
 8979 009a 0620     		movs	r0, #6
 8980 009c FFF7FEFF 		bl	cc2400_get
 8981              	.LVL938:
2982:bluetooth_rxtx.c **** 		if (lvl > rssi_threshold) {
 8982              		.loc 1 2982 0
 8983 00a0 1F4B     		ldr	r3, .L946+12
 8984 00a2 40F30720 		sbfx	r0, r0, #8, #8
 8985              	.LVL939:
 8986 00a6 93F85030 		ldrb	r3, [r3, #80]	@ zero_extendqisi2
 8987 00aa 5BB2     		sxtb	r3, r3
 8988 00ac 9842     		cmp	r0, r3
 8989 00ae 0CDD     		ble	.L929
2983:bluetooth_rxtx.c **** 			switch (i) {
 8990              		.loc 1 2983 0
 8991 00b0 012C     		cmp	r4, #1
 8992 00b2 07D0     		beq	.L931
 8993 00b4 03D3     		bcc	.L932
 8994 00b6 022C     		cmp	r4, #2
 8995 00b8 16D1     		bne	.L930
2984:bluetooth_rxtx.c **** 				case 0:
2985:bluetooth_rxtx.c **** 					TXLED_SET;
2986:bluetooth_rxtx.c **** 					break;
2987:bluetooth_rxtx.c **** 				case 1:
2988:bluetooth_rxtx.c **** 					RXLED_SET;
2989:bluetooth_rxtx.c **** 					break;
2990:bluetooth_rxtx.c **** 				case 2:
2991:bluetooth_rxtx.c **** 					USRLED_SET;
 8996              		.loc 1 2991 0
 8997 00ba 1A4B     		ldr	r3, .L946+16
 8998 00bc 13E0     		b	.L941
 8999              	.L932:
2985:bluetooth_rxtx.c **** 					break;
ARM GAS  /tmp/ccCuKxzC.s 			page 235


 9000              		.loc 1 2985 0
 9001 00be 4FF48072 		mov	r2, #256
 9002 00c2 00E0     		b	.L944
 9003              	.L931:
2988:bluetooth_rxtx.c **** 					break;
 9004              		.loc 1 2988 0
 9005 00c4 1022     		movs	r2, #16
 9006              	.L944:
 9007 00c6 174B     		ldr	r3, .L946+16
 9008 00c8 0BE0     		b	.L943
 9009              	.L929:
2992:bluetooth_rxtx.c **** 					break;
2993:bluetooth_rxtx.c **** 			}
2994:bluetooth_rxtx.c **** 		}
2995:bluetooth_rxtx.c **** 		else {
2996:bluetooth_rxtx.c **** 			switch (i) {
 9010              		.loc 1 2996 0
 9011 00ca 012C     		cmp	r4, #1
 9012 00cc 07D0     		beq	.L934
 9013 00ce 03D3     		bcc	.L935
 9014 00d0 022C     		cmp	r4, #2
 9015 00d2 09D1     		bne	.L930
2997:bluetooth_rxtx.c **** 				case 0:
2998:bluetooth_rxtx.c **** 					TXLED_CLR;
2999:bluetooth_rxtx.c **** 					break;
3000:bluetooth_rxtx.c **** 				case 1:
3001:bluetooth_rxtx.c **** 					RXLED_CLR;
3002:bluetooth_rxtx.c **** 					break;
3003:bluetooth_rxtx.c **** 				case 2:
3004:bluetooth_rxtx.c **** 					USRLED_CLR;
 9016              		.loc 1 3004 0
 9017 00d4 144B     		ldr	r3, .L946+20
 9018 00d6 06E0     		b	.L941
 9019              	.L935:
2998:bluetooth_rxtx.c **** 					break;
 9020              		.loc 1 2998 0
 9021 00d8 4FF48072 		mov	r2, #256
 9022 00dc 00E0     		b	.L942
 9023              	.L934:
3001:bluetooth_rxtx.c **** 					break;
 9024              		.loc 1 3001 0
 9025 00de 1022     		movs	r2, #16
 9026              	.L942:
 9027 00e0 114B     		ldr	r3, .L946+20
 9028              	.L943:
 9029 00e2 1A60     		str	r2, [r3]
3002:bluetooth_rxtx.c **** 				case 2:
 9030              		.loc 1 3002 0
 9031 00e4 00E0     		b	.L930
 9032              	.L941:
 9033              		.loc 1 3004 0
 9034 00e6 1C60     		str	r4, [r3]
 9035              	.L930:
3005:bluetooth_rxtx.c **** 					break;
3006:bluetooth_rxtx.c **** 			}
3007:bluetooth_rxtx.c **** 		}
3008:bluetooth_rxtx.c **** 
ARM GAS  /tmp/ccCuKxzC.s 			page 236


3009:bluetooth_rxtx.c **** 		i = (i+1) % 3;
 9036              		.loc 1 3009 0
 9037 00e8 0323     		movs	r3, #3
 9038 00ea 0134     		adds	r4, r4, #1
 9039              	.LVL940:
 9040 00ec 94FBF3F2 		sdiv	r2, r4, r3
 9041 00f0 03FB1244 		mls	r4, r3, r2, r4
 9042              	.LVL941:
3010:bluetooth_rxtx.c **** 
3011:bluetooth_rxtx.c **** 		handle_usb(clkn);
 9043              		.loc 1 3011 0
 9044 00f4 0D4B     		ldr	r3, .L946+24
3009:bluetooth_rxtx.c **** 
 9045              		.loc 1 3009 0
 9046 00f6 E4B2     		uxtb	r4, r4
 9047              	.LVL942:
 9048              		.loc 1 3011 0
 9049 00f8 1868     		ldr	r0, [r3]
 9050 00fa FFF7FEFF 		bl	handle_usb
 9051              	.LVL943:
3012:bluetooth_rxtx.c **** 
3013:bluetooth_rxtx.c **** 		cc2400_strobe(SRFOFF);
 9052              		.loc 1 3013 0
 9053 00fe 6420     		movs	r0, #100
 9054 0100 FFF7FEFF 		bl	cc2400_strobe
 9055              	.LVL944:
 9056              	.L938:
3014:bluetooth_rxtx.c **** 		while ((cc2400_status() & FS_LOCK));
 9057              		.loc 1 3014 0 discriminator 1
 9058 0104 FFF7FEFF 		bl	cc2400_status
 9059              	.LVL945:
 9060 0108 4307     		lsls	r3, r0, #29
 9061 010a FBD4     		bmi	.L938
 9062 010c A5E7     		b	.L924
 9063              	.L945:
 9064              	.LBE92:
3015:bluetooth_rxtx.c **** 	}
3016:bluetooth_rxtx.c **** }
 9065              		.loc 1 3016 0
 9066 010e 04B0     		add	sp, sp, #16
 9067              		@ sp needed
 9068 0110 10BD     		pop	{r4, pc}
 9069              	.LVL946:
 9070              	.L947:
 9071 0112 00BF     		.align	2
 9072              	.L946:
 9073 0114 DA080000 		.word	.LANCHOR2+2266
 9074 0118 58C00920 		.word	537509976
 9075 011c 00000000 		.word	.LANCHOR0
 9076 0120 00000000 		.word	.LANCHOR1
 9077 0124 38C00920 		.word	537509944
 9078 0128 3CC00920 		.word	537509948
 9079 012c 00000000 		.word	clkn
 9080              		.cfi_endproc
 9081              	.LFE43:
 9083              		.section	.text.startup.main,"ax",%progbits
 9084              		.align	1
ARM GAS  /tmp/ccCuKxzC.s 			page 237


 9085              		.global	main
 9086              		.thumb
 9087              		.thumb_func
 9089              	main:
 9090              	.LFB44:
3017:bluetooth_rxtx.c **** 
3018:bluetooth_rxtx.c **** int main()
3019:bluetooth_rxtx.c **** {
 9091              		.loc 1 3019 0
 9092              		.cfi_startproc
 9093              		@ args = 0, pretend = 0, frame = 0
 9094              		@ frame_needed = 0, uses_anonymous_args = 0
 9095 0000 10B5     		push	{r4, lr}
 9096              		.cfi_def_cfa_offset 8
 9097              		.cfi_offset 4, -8
 9098              		.cfi_offset 14, -4
3020:bluetooth_rxtx.c **** 	ubertooth_init();
 9099              		.loc 1 3020 0
 9100 0002 FFF7FEFF 		bl	ubertooth_init
 9101              	.LVL947:
3021:bluetooth_rxtx.c **** 	clkn_init();
 9102              		.loc 1 3021 0
 9103 0006 FFF7FEFF 		bl	clkn_init
 9104              	.LVL948:
3022:bluetooth_rxtx.c **** 	ubertooth_usb_init(vendor_request_handler);
 9105              		.loc 1 3022 0
 9106 000a 4848     		ldr	r0, .L975
 9107 000c FFF7FEFF 		bl	ubertooth_usb_init
 9108              	.LVL949:
 9109              	.L973:
3023:bluetooth_rxtx.c **** 	cc2400_idle();
 9110              		.loc 1 3023 0
 9111 0010 FFF7FEFF 		bl	cc2400_idle
 9112              	.LVL950:
 9113              	.L949:
3024:bluetooth_rxtx.c **** 
3025:bluetooth_rxtx.c **** 	while (1) {
3026:bluetooth_rxtx.c **** 		handle_usb(clkn);
 9114              		.loc 1 3026 0
 9115 0014 464B     		ldr	r3, .L975+4
3027:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 9116              		.loc 1 3027 0
 9117 0016 474C     		ldr	r4, .L975+8
3026:bluetooth_rxtx.c **** 		if(requested_mode != mode) {
 9118              		.loc 1 3026 0
 9119 0018 1868     		ldr	r0, [r3]
 9120 001a FFF7FEFF 		bl	handle_usb
 9121              	.LVL951:
 9122              		.loc 1 3027 0
 9123 001e A27C     		ldrb	r2, [r4, #18]	@ zero_extendqisi2
 9124 0020 637C     		ldrb	r3, [r4, #17]	@ zero_extendqisi2
 9125 0022 9A42     		cmp	r2, r3
 9126 0024 F6D0     		beq	.L949
3028:bluetooth_rxtx.c **** 			switch (requested_mode) {
 9127              		.loc 1 3028 0
 9128 0026 A37C     		ldrb	r3, [r4, #18]	@ zero_extendqisi2
 9129 0028 132B     		cmp	r3, #19
ARM GAS  /tmp/ccCuKxzC.s 			page 238


 9130 002a F3D8     		bhi	.L949
 9131 002c 01A2     		adr	r2, .L952
 9132 002e 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 9133 0032 00BF     		.p2align 2
 9134              	.L952:
 9135 0034 11000000 		.word	.L973+1
 9136 0038 95000000 		.word	.L953+1
 9137 003c 9F000000 		.word	.L954+1
 9138 0040 D9000000 		.word	.L955+1
 9139 0044 03010000 		.word	.L956+1
 9140 0048 E7000000 		.word	.L957+1
 9141 004c F7000000 		.word	.L958+1
 9142 0050 09010000 		.word	.L959+1
 9143 0054 A9000000 		.word	.L960+1
 9144 0058 AD000000 		.word	.L961+1
 9145 005c BF000000 		.word	.L962+1
 9146 0060 85000000 		.word	.L963+1
 9147 0064 C5000000 		.word	.L964+1
 9148 0068 0F010000 		.word	.L965+1
 9149 006c 91000000 		.word	.L966+1
 9150 0070 1B010000 		.word	.L967+1
 9151 0074 25010000 		.word	.L968+1
 9152 0078 B3000000 		.word	.L969+1
 9153 007c B7000000 		.word	.L970+1
 9154 0080 CF000000 		.word	.L971+1
 9155              	.L963:
3029:bluetooth_rxtx.c **** 				case MODE_RESET:
3030:bluetooth_rxtx.c **** 					/* Allow time for the USB command to return correctly */
3031:bluetooth_rxtx.c **** 					wait(1);
 9156              		.loc 1 3031 0
 9157 0084 0120     		movs	r0, #1
 9158 0086 FFF7FEFF 		bl	wait
 9159              	.LVL952:
3032:bluetooth_rxtx.c **** 					reset();
 9160              		.loc 1 3032 0
 9161 008a FFF7FEFF 		bl	reset
 9162              	.LVL953:
3033:bluetooth_rxtx.c **** 					break;
 9163              		.loc 1 3033 0
 9164 008e C1E7     		b	.L949
 9165              	.L966:
3034:bluetooth_rxtx.c **** 				case MODE_AFH:
3035:bluetooth_rxtx.c **** 					mode = MODE_AFH;
 9166              		.loc 1 3035 0
 9167 0090 0E23     		movs	r3, #14
 9168 0092 00E0     		b	.L972
 9169              	.L953:
3036:bluetooth_rxtx.c **** 					bt_stream_rx();
3037:bluetooth_rxtx.c **** 					break;
3038:bluetooth_rxtx.c **** 				case MODE_RX_SYMBOLS:
3039:bluetooth_rxtx.c **** 					mode = MODE_RX_SYMBOLS;
 9170              		.loc 1 3039 0
 9171 0094 0123     		movs	r3, #1
 9172              	.L972:
 9173 0096 6374     		strb	r3, [r4, #17]
3040:bluetooth_rxtx.c **** 					bt_stream_rx();
 9174              		.loc 1 3040 0
ARM GAS  /tmp/ccCuKxzC.s 			page 239


 9175 0098 FFF7FEFF 		bl	bt_stream_rx
 9176              	.LVL954:
3041:bluetooth_rxtx.c **** 					break;
 9177              		.loc 1 3041 0
 9178 009c BAE7     		b	.L949
 9179              	.L954:
3042:bluetooth_rxtx.c **** 				case MODE_TX_SYMBOLS:
3043:bluetooth_rxtx.c **** 					mode = MODE_TX_SYMBOLS;
 9180              		.loc 1 3043 0
 9181 009e 0223     		movs	r3, #2
 9182 00a0 6374     		strb	r3, [r4, #17]
3044:bluetooth_rxtx.c **** 					br_transmit();
 9183              		.loc 1 3044 0
 9184 00a2 FFF7FEFF 		bl	br_transmit
 9185              	.LVL955:
3045:bluetooth_rxtx.c **** 					break;
 9186              		.loc 1 3045 0
 9187 00a6 B5E7     		b	.L949
 9188              	.L960:
3046:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW:
3047:bluetooth_rxtx.c **** 					mode = MODE_BT_FOLLOW;
 9189              		.loc 1 3047 0
 9190 00a8 0823     		movs	r3, #8
 9191 00aa F4E7     		b	.L972
 9192              	.L961:
3048:bluetooth_rxtx.c **** 					bt_stream_rx();
3049:bluetooth_rxtx.c **** 					break;
3050:bluetooth_rxtx.c **** 				case MODE_BT_FOLLOW_LE:
3051:bluetooth_rxtx.c **** 					bt_follow_le();
 9193              		.loc 1 3051 0
 9194 00ac FFF7FEFF 		bl	bt_follow_le
 9195              	.LVL956:
3052:bluetooth_rxtx.c **** 					break;
 9196              		.loc 1 3052 0
 9197 00b0 B0E7     		b	.L949
 9198              	.L969:
3053:bluetooth_rxtx.c **** 				//JWHUR cfo estimation tracking
3054:bluetooth_rxtx.c **** 				case MODE_BT_CFO_LE:
3055:bluetooth_rxtx.c **** 					bt_tracking_le(MODE_BT_CFO_LE);
 9199              		.loc 1 3055 0
 9200 00b2 1120     		movs	r0, #17
 9201 00b4 00E0     		b	.L974
 9202              	.L970:
3056:bluetooth_rxtx.c **** 					break;
3057:bluetooth_rxtx.c **** 				case MODE_BT_RSSI_LE:
3058:bluetooth_rxtx.c **** 					bt_tracking_le(MODE_BT_RSSI_LE);
 9203              		.loc 1 3058 0
 9204 00b6 1220     		movs	r0, #18
 9205              	.L974:
 9206 00b8 FFF7FEFF 		bl	bt_tracking_le
 9207              	.LVL957:
3059:bluetooth_rxtx.c **** 					break;
 9208              		.loc 1 3059 0
 9209 00bc AAE7     		b	.L949
 9210              	.L962:
3060:bluetooth_rxtx.c **** 				case MODE_BT_PROMISC_LE:
3061:bluetooth_rxtx.c **** 					bt_promisc_le();
ARM GAS  /tmp/ccCuKxzC.s 			page 240


 9211              		.loc 1 3061 0
 9212 00be FFF7FEFF 		bl	bt_promisc_le
 9213              	.LVL958:
3062:bluetooth_rxtx.c **** 					break;
 9214              		.loc 1 3062 0
 9215 00c2 A7E7     		b	.L949
 9216              	.L964:
3063:bluetooth_rxtx.c **** 				case MODE_BT_SLAVE_LE:
3064:bluetooth_rxtx.c **** 					mode = MODE_BT_SLAVE_LE;
 9217              		.loc 1 3064 0
 9218 00c4 0C23     		movs	r3, #12
 9219 00c6 6374     		strb	r3, [r4, #17]
3065:bluetooth_rxtx.c **** 					bt_slave_le();
 9220              		.loc 1 3065 0
 9221 00c8 FFF7FEFF 		bl	bt_slave_le
 9222              	.LVL959:
3066:bluetooth_rxtx.c **** 					break;
 9223              		.loc 1 3066 0
 9224 00cc A2E7     		b	.L949
 9225              	.L971:
3067:bluetooth_rxtx.c **** 				case MODE_BT_SYNC_LE:
3068:bluetooth_rxtx.c **** 					mode = MODE_BT_SYNC_LE;
 9226              		.loc 1 3068 0
 9227 00ce 1323     		movs	r3, #19
 9228 00d0 6374     		strb	r3, [r4, #17]
3069:bluetooth_rxtx.c **** 					bt_sync_le();
 9229              		.loc 1 3069 0
 9230 00d2 FFF7FEFF 		bl	bt_sync_le
 9231              	.LVL960:
3070:bluetooth_rxtx.c **** 					break;
 9232              		.loc 1 3070 0
 9233 00d6 9DE7     		b	.L949
 9234              	.L955:
3071:bluetooth_rxtx.c **** 				case MODE_TX_TEST:
3072:bluetooth_rxtx.c **** 					mode = MODE_TX_TEST;
 9235              		.loc 1 3072 0
 9236 00d8 0323     		movs	r3, #3
3073:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 9237              		.loc 1 3073 0
 9238 00da 1648     		ldr	r0, .L975+8
 9239 00dc 1649     		ldr	r1, .L975+12
3072:bluetooth_rxtx.c **** 					cc2400_txtest(&modulation, &channel);
 9240              		.loc 1 3072 0
 9241 00de 6374     		strb	r3, [r4, #17]
 9242              		.loc 1 3073 0
 9243 00e0 FFF7FEFF 		bl	cc2400_txtest
 9244              	.LVL961:
3074:bluetooth_rxtx.c **** 					break;
 9245              		.loc 1 3074 0
 9246 00e4 96E7     		b	.L949
 9247              	.L957:
3075:bluetooth_rxtx.c **** 				case MODE_RANGE_TEST:
3076:bluetooth_rxtx.c **** 					mode = MODE_RANGE_TEST;
 9248              		.loc 1 3076 0
 9249 00e6 0523     		movs	r3, #5
3077:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 9250              		.loc 1 3077 0
ARM GAS  /tmp/ccCuKxzC.s 			page 241


 9251 00e8 1348     		ldr	r0, .L975+12
3076:bluetooth_rxtx.c **** 					cc2400_rangetest(&channel);
 9252              		.loc 1 3076 0
 9253 00ea 6374     		strb	r3, [r4, #17]
 9254              		.loc 1 3077 0
 9255 00ec FFF7FEFF 		bl	cc2400_rangetest
 9256              	.LVL962:
3078:bluetooth_rxtx.c **** 					requested_mode = MODE_IDLE;
 9257              		.loc 1 3078 0
 9258 00f0 0023     		movs	r3, #0
 9259 00f2 A374     		strb	r3, [r4, #18]
3079:bluetooth_rxtx.c **** 					break;
 9260              		.loc 1 3079 0
 9261 00f4 8EE7     		b	.L949
 9262              	.L958:
3080:bluetooth_rxtx.c **** 				case MODE_REPEATER:
3081:bluetooth_rxtx.c **** 					mode = MODE_REPEATER;
 9263              		.loc 1 3081 0
 9264 00f6 0623     		movs	r3, #6
3082:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 9265              		.loc 1 3082 0
 9266 00f8 0F48     		ldr	r0, .L975+12
3081:bluetooth_rxtx.c **** 					cc2400_repeater(&channel);
 9267              		.loc 1 3081 0
 9268 00fa 6374     		strb	r3, [r4, #17]
 9269              		.loc 1 3082 0
 9270 00fc FFF7FEFF 		bl	cc2400_repeater
 9271              	.LVL963:
3083:bluetooth_rxtx.c **** 					break;
 9272              		.loc 1 3083 0
 9273 0100 88E7     		b	.L949
 9274              	.L956:
3084:bluetooth_rxtx.c **** 				case MODE_SPECAN:
3085:bluetooth_rxtx.c **** 					specan();
 9275              		.loc 1 3085 0
 9276 0102 FFF7FEFF 		bl	specan
 9277              	.LVL964:
3086:bluetooth_rxtx.c **** 					break;
 9278              		.loc 1 3086 0
 9279 0106 85E7     		b	.L949
 9280              	.L959:
3087:bluetooth_rxtx.c **** 				case MODE_LED_SPECAN:
3088:bluetooth_rxtx.c **** 					led_specan();
 9281              		.loc 1 3088 0
 9282 0108 FFF7FEFF 		bl	led_specan
 9283              	.LVL965:
3089:bluetooth_rxtx.c **** 					break;
 9284              		.loc 1 3089 0
 9285 010c 82E7     		b	.L949
 9286              	.L965:
3090:bluetooth_rxtx.c **** 				case MODE_EGO:
3091:bluetooth_rxtx.c **** 					mode = MODE_EGO;
 9287              		.loc 1 3091 0
 9288 010e 0D23     		movs	r3, #13
 9289 0110 6374     		strb	r3, [r4, #17]
3092:bluetooth_rxtx.c **** 					ego_main(ego_mode);
 9290              		.loc 1 3092 0
ARM GAS  /tmp/ccCuKxzC.s 			page 242


 9291 0112 207D     		ldrb	r0, [r4, #20]	@ zero_extendqisi2
 9292 0114 FFF7FEFF 		bl	ego_main
 9293              	.LVL966:
3093:bluetooth_rxtx.c **** 					break;
 9294              		.loc 1 3093 0
 9295 0118 7CE7     		b	.L949
 9296              	.L967:
3094:bluetooth_rxtx.c **** 				case MODE_RX_GENERIC:
3095:bluetooth_rxtx.c **** 					mode = MODE_RX_GENERIC;
 9297              		.loc 1 3095 0
 9298 011a 0F23     		movs	r3, #15
 9299 011c 6374     		strb	r3, [r4, #17]
3096:bluetooth_rxtx.c **** 					rx_generic();
 9300              		.loc 1 3096 0
 9301 011e FFF7FEFF 		bl	rx_generic
 9302              	.LVL967:
3097:bluetooth_rxtx.c **** 					break;
 9303              		.loc 1 3097 0
 9304 0122 77E7     		b	.L949
 9305              	.L968:
3098:bluetooth_rxtx.c **** 				case MODE_TX_GENERIC:
3099:bluetooth_rxtx.c **** 					tx_generic();
 9306              		.loc 1 3099 0
 9307 0124 FFF7FEFF 		bl	tx_generic
 9308              	.LVL968:
3100:bluetooth_rxtx.c **** 					break;
 9309              		.loc 1 3100 0
 9310 0128 74E7     		b	.L949
 9311              	.L976:
 9312 012a 00BF     		.align	2
 9313              	.L975:
 9314 012c 00000000 		.word	vendor_request_handler
 9315 0130 00000000 		.word	clkn
 9316 0134 00000000 		.word	.LANCHOR0
 9317 0138 00000000 		.word	.LANCHOR1
 9318              		.cfi_endproc
 9319              	.LFE44:
 9321              		.comm	unpacked,800,1
 9322              		.global	packet_cb
 9323              		.global	data_cb
 9324              		.global	le_jam_count
 9325              		.comm	le_promisc,264,4
 9326              		.global	le
 9327              		.global	sync_channel
 9328              		.global	start_sync
 9329              		.global	now_sync
 9330              		.global	slave_mac_address
 9331              		.comm	slave_mac_address_data,4,4
 9332              		.global	dlen
 9333              		.comm	tx_pkt,58,2
 9334              		.global	rssi_threshold
 9335              		.global	high_freq
 9336              		.global	low_freq
 9337              		.global	modulation
 9338              		.global	ego_mode
 9339              		.global	jam_mode
 9340              		.global	requested_mode
ARM GAS  /tmp/ccCuKxzC.s 			page 243


 9341              		.global	mode
 9342              		.global	status
 9343              		.global	dma_discard
 9344              		.global	idle_buf_channel
 9345              		.global	idle_buf_clk100ns
 9346              		.global	idle_buf_clkn_high
 9347              		.global	le_adv_channel
 9348              		.global	requested_channel
 9349              		.global	hop_timeout
 9350              		.global	hop_direct_channel
 9351              		.global	channel
 9352              		.global	do_hop
 9353              		.global	hop_mode
 9354              		.global	compile_info
 9355              		.comm	rr,5,1
 9356              		.comm	used_channels,1,1
 9357              		.comm	afh_map,10,1
 9358              		.comm	afh_enabled,1,1
 9359              		.comm	syncword,8,8
 9360              		.comm	target,16,8
 9361              		.comm	clkn_next_drift_fix,4,4
 9362              		.comm	clkn_last_drift_fix,4,4
 9363              		.comm	clk_drift_correction,2,2
 9364              		.comm	clk_drift_ppm,2,2
 9365              		.comm	clk100ns_offset,2,2
 9366              		.comm	clkn_offset,4,4
 9367              		.comm	last_hop,4,4
 9368              		.comm	clkn,4,4
 9369              		.comm	rx_err,4,4
 9370              		.comm	rx_tc,4,4
 9371              		.comm	idle_rxbuf,4,4
 9372              		.comm	active_rxbuf,4,4
 9373              		.comm	rxbuf2,50,1
 9374              		.comm	rxbuf1,50,1
 9375              		.comm	cs_trigger,1,1
 9376              		.comm	cs_threshold_cur,1,1
 9377              		.comm	cs_threshold_req,1,1
 9378              		.comm	cs_no_squelch,1,1
 9379              		.comm	rssi_count,1,1
 9380              		.comm	rssi_min,1,1
 9381              		.comm	rssi_max,1,1
 9382              		.section	.rodata
 9383              		.align	2
 9384              		.set	.LANCHOR2,. + 0
 9387              	whitening_index:
 9388 0000 46       		.byte	70
 9389 0001 3E       		.byte	62
 9390 0002 78       		.byte	120
 9391 0003 6F       		.byte	111
 9392 0004 4D       		.byte	77
 9393 0005 2E       		.byte	46
 9394 0006 0F       		.byte	15
 9395 0007 65       		.byte	101
 9396 0008 42       		.byte	66
 9397 0009 27       		.byte	39
 9398 000a 1F       		.byte	31
 9399 000b 1A       		.byte	26
ARM GAS  /tmp/ccCuKxzC.s 			page 244


 9400 000c 50       		.byte	80
 9401 000d 53       		.byte	83
 9402 000e 7D       		.byte	125
 9403 000f 59       		.byte	89
 9404 0010 0A       		.byte	10
 9405 0011 23       		.byte	35
 9406 0012 08       		.byte	8
 9407 0013 36       		.byte	54
 9408 0014 7A       		.byte	122
 9409 0015 11       		.byte	17
 9410 0016 21       		.byte	33
 9411 0017 00       		.byte	0
 9412 0018 3A       		.byte	58
 9413 0019 73       		.byte	115
 9414 001a 06       		.byte	6
 9415 001b 5E       		.byte	94
 9416 001c 56       		.byte	86
 9417 001d 31       		.byte	49
 9418 001e 34       		.byte	52
 9419 001f 14       		.byte	20
 9420 0020 28       		.byte	40
 9421 0021 1B       		.byte	27
 9422 0022 54       		.byte	84
 9423 0023 5A       		.byte	90
 9424 0024 3F       		.byte	63
 9425 0025 70       		.byte	112
 9426 0026 2F       		.byte	47
 9427 0027 66       		.byte	102
 9430              	whitening:
 9431 0028 01       		.byte	1
 9432 0029 01       		.byte	1
 9433 002a 01       		.byte	1
 9434 002b 01       		.byte	1
 9435 002c 00       		.byte	0
 9436 002d 01       		.byte	1
 9437 002e 00       		.byte	0
 9438 002f 01       		.byte	1
 9439 0030 00       		.byte	0
 9440 0031 01       		.byte	1
 9441 0032 00       		.byte	0
 9442 0033 00       		.byte	0
 9443 0034 00       		.byte	0
 9444 0035 00       		.byte	0
 9445 0036 01       		.byte	1
 9446 0037 00       		.byte	0
 9447 0038 01       		.byte	1
 9448 0039 01       		.byte	1
 9449 003a 00       		.byte	0
 9450 003b 01       		.byte	1
 9451 003c 01       		.byte	1
 9452 003d 01       		.byte	1
 9453 003e 01       		.byte	1
 9454 003f 00       		.byte	0
 9455 0040 00       		.byte	0
 9456 0041 01       		.byte	1
 9457 0042 01       		.byte	1
 9458 0043 01       		.byte	1
ARM GAS  /tmp/ccCuKxzC.s 			page 245


 9459 0044 00       		.byte	0
 9460 0045 00       		.byte	0
 9461 0046 01       		.byte	1
 9462 0047 00       		.byte	0
 9463 0048 01       		.byte	1
 9464 0049 00       		.byte	0
 9465 004a 01       		.byte	1
 9466 004b 01       		.byte	1
 9467 004c 00       		.byte	0
 9468 004d 00       		.byte	0
 9469 004e 01       		.byte	1
 9470 004f 01       		.byte	1
 9471 0050 00       		.byte	0
 9472 0051 00       		.byte	0
 9473 0052 00       		.byte	0
 9474 0053 00       		.byte	0
 9475 0054 00       		.byte	0
 9476 0055 01       		.byte	1
 9477 0056 01       		.byte	1
 9478 0057 00       		.byte	0
 9479 0058 01       		.byte	1
 9480 0059 01       		.byte	1
 9481 005a 00       		.byte	0
 9482 005b 01       		.byte	1
 9483 005c 00       		.byte	0
 9484 005d 01       		.byte	1
 9485 005e 01       		.byte	1
 9486 005f 01       		.byte	1
 9487 0060 00       		.byte	0
 9488 0061 01       		.byte	1
 9489 0062 00       		.byte	0
 9490 0063 00       		.byte	0
 9491 0064 00       		.byte	0
 9492 0065 01       		.byte	1
 9493 0066 01       		.byte	1
 9494 0067 00       		.byte	0
 9495 0068 00       		.byte	0
 9496 0069 01       		.byte	1
 9497 006a 00       		.byte	0
 9498 006b 00       		.byte	0
 9499 006c 00       		.byte	0
 9500 006d 01       		.byte	1
 9501 006e 00       		.byte	0
 9502 006f 00       		.byte	0
 9503 0070 00       		.byte	0
 9504 0071 00       		.byte	0
 9505 0072 00       		.byte	0
 9506 0073 00       		.byte	0
 9507 0074 01       		.byte	1
 9508 0075 00       		.byte	0
 9509 0076 00       		.byte	0
 9510 0077 01       		.byte	1
 9511 0078 00       		.byte	0
 9512 0079 00       		.byte	0
 9513 007a 01       		.byte	1
 9514 007b 01       		.byte	1
 9515 007c 00       		.byte	0
ARM GAS  /tmp/ccCuKxzC.s 			page 246


 9516 007d 01       		.byte	1
 9517 007e 00       		.byte	0
 9518 007f 00       		.byte	0
 9519 0080 01       		.byte	1
 9520 0081 01       		.byte	1
 9521 0082 01       		.byte	1
 9522 0083 01       		.byte	1
 9523 0084 00       		.byte	0
 9524 0085 01       		.byte	1
 9525 0086 01       		.byte	1
 9526 0087 01       		.byte	1
 9527 0088 00       		.byte	0
 9528 0089 00       		.byte	0
 9529 008a 00       		.byte	0
 9530 008b 00       		.byte	0
 9531 008c 01       		.byte	1
 9532 008d 01       		.byte	1
 9533 008e 01       		.byte	1
 9534 008f 01       		.byte	1
 9535 0090 01       		.byte	1
 9536 0091 01       		.byte	1
 9537 0092 01       		.byte	1
 9538 0093 00       		.byte	0
 9539 0094 00       		.byte	0
 9540 0095 00       		.byte	0
 9541 0096 01       		.byte	1
 9542 0097 01       		.byte	1
 9543 0098 01       		.byte	1
 9544 0099 00       		.byte	0
 9545 009a 01       		.byte	1
 9546 009b 01       		.byte	1
 9547 009c 00       		.byte	0
 9548 009d 00       		.byte	0
 9549 009e 00       		.byte	0
 9550 009f 01       		.byte	1
 9551 00a0 00       		.byte	0
 9552 00a1 01       		.byte	1
 9553 00a2 00       		.byte	0
 9554 00a3 00       		.byte	0
 9555 00a4 01       		.byte	1
 9556 00a5 00       		.byte	0
 9557 00a6 01       		.byte	1
 9560              	compile_info:
 9561 00a7 75626572 		.ascii	"ubertooth 2017-03-R2 (mwnl@mwnl-lenovo) 2019. 01. 0"
 9561      746F6F74 
 9561      68203230 
 9561      31372D30 
 9561      332D5232 
 9562 00da 322E2028 		.ascii	"2. (\354\210\230) 15:08:41 KST\000"
 9562      EC889829 
 9562      2031353A 
 9562      30383A34 
 9562      31204B53 
 9565              	whitening_word:
 9566 00f0 40B2BCC3 		.word	-1011043776
 9567 00f4 1F374A5F 		.word	1598699295
 9568 00f8 85F69C9A 		.word	-1700989307
ARM GAS  /tmp/ccCuKxzC.s 			page 247


 9569 00fc C1D6C544 		.word	1153816257
 9570 0100 2059DEE1 		.word	-505521888
 9571 0104 8F1BA5AF 		.word	-1348134001
 9572 0108 427B4ECD 		.word	-850494654
 9573 010c 60EB6222 		.word	576908128
 9574 0110 902CEFF0 		.word	-252760944
 9575 0114 C78DD257 		.word	1473416647
 9576 0118 A13DA766 		.word	1722236321
 9577 011c B0753111 		.word	288454064
 9578 0120 8940B2BC 		.word	-1129168759
 9579 0124 C31F374A 		.word	1245126595
 9580 0128 5F85F69C 		.word	-1661565601
 9581 012c 9AC1D6C5 		.word	-975781478
 9582 0130 442059DE 		.word	-564584380
 9583 0134 E18F1BA5 		.word	-1524920351
 9584 0138 AF427B4E 		.word	1316700847
 9585 013c CD60EB62 		.word	1659592909
 9586 0140 22902CEF 		.word	-282292190
 9587 0144 F0C78DD2 		.word	-762460176
 9588 0148 57A13DA7 		.word	-1489133225
 9589 014c 66B07531 		.word	829796454
 9590 0150 D257A13D 		.word	1033983954
 9591 0154 A766B075 		.word	1974494887
 9592 0158 31114896 		.word	-1773661903
 9593 015c 77F8E346 		.word	1189345399
 9594 0160 E9ABD09E 		.word	-1630491671
 9595 0164 5333D8BA 		.word	-1160236205
 9596 0168 980824CB 		.word	-886830952
 9597 016c 3BFC71A3 		.word	-1552810949
 9598 0170 F45568CF 		.word	-815245836
 9599 0174 A9196C5D 		.word	1567365545
 9600 0178 4C0492E5 		.word	-443415476
 9601 017c 1DFEB851 		.word	1371078173
 9602 0180 1BA5AF42 		.word	1118807323
 9603 0184 7B4ECD60 		.word	1624067707
 9604 0188 EB622290 		.word	-1876794645
 9605 018c 2CEFF0C7 		.word	-940511444
 9606 0190 8DD257A1 		.word	-1588079987
 9607 0194 3DA766B0 		.word	-1335449795
 9608 0198 75311148 		.word	1209086325
 9609 019c 9677F8E3 		.word	-470255722
 9610 01a0 46E9ABD0 		.word	-794039994
 9611 01a4 9E5333D8 		.word	-667724898
 9612 01a8 BA980824 		.word	604543162
 9613 01ac CB3BFC71 		.word	1912355787
 9614 01b0 6479873F 		.word	1065843044
 9615 01b4 6E94BE0A 		.word	180261998
 9616 01b8 ED393583 		.word	-2093663763
 9617 01bc AD8B8940 		.word	1082756013
 9618 01c0 B2BCC31F 		.word	532921522
 9619 01c4 374A5F85 		.word	-2057352649
 9620 01c8 F69C9AC1 		.word	-1046831882
 9621 01cc D6C54420 		.word	541378006
 9622 01d0 59DEE18F 		.word	-1881022887
 9623 01d4 1BA5AF42 		.word	1118807323
 9624 01d8 7B4ECD60 		.word	1624067707
 9625 01dc EB622290 		.word	-1876794645
ARM GAS  /tmp/ccCuKxzC.s 			page 248


 9626 01e0 AD8B8940 		.word	1082756013
 9627 01e4 B2BCC31F 		.word	532921522
 9628 01e8 374A5F85 		.word	-2057352649
 9629 01ec F69C9AC1 		.word	-1046831882
 9630 01f0 D6C54420 		.word	541378006
 9631 01f4 59DEE18F 		.word	-1881022887
 9632 01f8 1BA5AF42 		.word	1118807323
 9633 01fc 7B4ECD60 		.word	1624067707
 9634 0200 EB622290 		.word	-1876794645
 9635 0204 2CEFF0C7 		.word	-940511444
 9636 0208 8DD257A1 		.word	-1588079987
 9637 020c 3DA766B0 		.word	-1335449795
 9638 0210 F69C9AC1 		.word	-1046831882
 9639 0214 D6C54420 		.word	541378006
 9640 0218 59DEE18F 		.word	-1881022887
 9641 021c 1BA5AF42 		.word	1118807323
 9642 0220 7B4ECD60 		.word	1624067707
 9643 0224 EB622290 		.word	-1876794645
 9644 0228 2CEFF0C7 		.word	-940511444
 9645 022c 8DD257A1 		.word	-1588079987
 9646 0230 3DA766B0 		.word	-1335449795
 9647 0234 75311148 		.word	1209086325
 9648 0238 9677F8E3 		.word	-470255722
 9649 023c 46E9ABD0 		.word	-794039994
 9650 0240 3F6E94BE 		.word	-1097568705
 9651 0244 0AED3935 		.word	892988682
 9652 0248 83AD8B89 		.word	-1987334781
 9653 024c 40B2BCC3 		.word	-1011043776
 9654 0250 1F374A5F 		.word	1598699295
 9655 0254 85F69C9A 		.word	-1700989307
 9656 0258 C1D6C544 		.word	1153816257
 9657 025c 2059DEE1 		.word	-505521888
 9658 0260 8F1BA5AF 		.word	-1348134001
 9659 0264 427B4ECD 		.word	-850494654
 9660 0268 60EB6222 		.word	576908128
 9661 026c 902CEFF0 		.word	-252760944
 9662 0270 0824CB3B 		.word	1003168776
 9663 0274 FC71A3F4 		.word	-190615044
 9664 0278 5568CFA9 		.word	-1446025131
 9665 027c 196C5D4C 		.word	1281190937
 9666 0280 0492E51D 		.word	501584388
 9667 0284 FEB851FA 		.word	-95307522
 9668 0288 2AB4E7D4 		.word	-723012566
 9669 028c 0CB62E26 		.word	640595468
 9670 0290 02C9F20E 		.word	250792194
 9671 0294 7FDC287D 		.word	2099829887
 9672 0298 15DA736A 		.word	1785977365
 9673 029c 065B1713 		.word	320297734
 9674 02a0 C1D6C544 		.word	1153816257
 9675 02a4 2059DEE1 		.word	-505521888
 9676 02a8 8F1BA5AF 		.word	-1348134001
 9677 02ac 427B4ECD 		.word	-850494654
 9678 02b0 60EB6222 		.word	576908128
 9679 02b4 902CEFF0 		.word	-252760944
 9680 02b8 C78DD257 		.word	1473416647
 9681 02bc A13DA766 		.word	1722236321
 9682 02c0 B0753111 		.word	288454064
ARM GAS  /tmp/ccCuKxzC.s 			page 249


 9683 02c4 489677F8 		.word	-126380472
 9684 02c8 E346E9AB 		.word	-1410775325
 9685 02cc D09E5333 		.word	861118160
 9686 02d0 9AC1D6C5 		.word	-975781478
 9687 02d4 442059DE 		.word	-564584380
 9688 02d8 E18F1BA5 		.word	-1524920351
 9689 02dc AF427B4E 		.word	1316700847
 9690 02e0 CD60EB62 		.word	1659592909
 9691 02e4 22902CEF 		.word	-282292190
 9692 02e8 F0C78DD2 		.word	-762460176
 9693 02ec 57A13DA7 		.word	-1489133225
 9694 02f0 66B07531 		.word	829796454
 9695 02f4 11489677 		.word	2006337553
 9696 02f8 F8E346E9 		.word	-381230088
 9697 02fc ABD09E53 		.word	1402917035
 9698 0300 5333D8BA 		.word	-1160236205
 9699 0304 980824CB 		.word	-886830952
 9700 0308 3BFC71A3 		.word	-1552810949
 9701 030c F45568CF 		.word	-815245836
 9702 0310 A9196C5D 		.word	1567365545
 9703 0314 4C0492E5 		.word	-443415476
 9704 0318 1DFEB851 		.word	1371078173
 9705 031c FA2AB4E7 		.word	-407622918
 9706 0320 D40CB62E 		.word	783682772
 9707 0324 2602C9F2 		.word	-221707738
 9708 0328 0E7FDC28 		.word	685539086
 9709 032c 7D15DA73 		.word	1943672189
 9710 0330 2CEFF0C7 		.word	-940511444
 9711 0334 8DD257A1 		.word	-1588079987
 9712 0338 3DA766B0 		.word	-1335449795
 9713 033c 75311148 		.word	1209086325
 9714 0340 9677F8E3 		.word	-470255722
 9715 0344 46E9ABD0 		.word	-794039994
 9716 0348 9E5333D8 		.word	-667724898
 9717 034c BA980824 		.word	604543162
 9718 0350 CB3BFC71 		.word	1912355787
 9719 0354 A3F45568 		.word	1750463651
 9720 0358 CFA9196C 		.word	1813621199
 9721 035c 5D4C0492 		.word	-1845212067
 9722 0360 E51DFEB8 		.word	-1191305755
 9723 0364 51FA2AB4 		.word	-1272251823
 9724 0368 E7D40CB6 		.word	-1240673049
 9725 036c 2E2602C9 		.word	-922606034
 9726 0370 F20E7FDC 		.word	-595652878
 9727 0374 287D15DA 		.word	-636125912
 9728 0378 736A065B 		.word	1527147123
 9729 037c 17138164 		.word	1686180631
 9730 0380 79873F6E 		.word	1849657209
 9731 0384 94BE0AED 		.word	-318062956
 9732 0388 393583AD 		.word	-1383910087
 9733 038c 8B8940B2 		.word	-1304393333
 9734 0390 BE0AED39 		.word	971836094
 9735 0394 3583AD8B 		.word	-1951562955
 9736 0398 8940B2BC 		.word	-1129168759
 9737 039c C31F374A 		.word	1245126595
 9738 03a0 5F85F69C 		.word	-1661565601
 9739 03a4 9AC1D6C5 		.word	-975781478
ARM GAS  /tmp/ccCuKxzC.s 			page 250


 9740 03a8 442059DE 		.word	-564584380
 9741 03ac E18F1BA5 		.word	-1524920351
 9742 03b0 AF427B4E 		.word	1316700847
 9743 03b4 CD60EB62 		.word	1659592909
 9744 03b8 22902CEF 		.word	-282292190
 9745 03bc F0C78DD2 		.word	-762460176
 9746 03c0 77F8E346 		.word	1189345399
 9747 03c4 E9ABD09E 		.word	-1630491671
 9748 03c8 5333D8BA 		.word	-1160236205
 9749 03cc 980824CB 		.word	-886830952
 9750 03d0 3BFC71A3 		.word	-1552810949
 9751 03d4 F45568CF 		.word	-815245836
 9752 03d8 A9196C5D 		.word	1567365545
 9753 03dc 4C0492E5 		.word	-443415476
 9754 03e0 1DFEB851 		.word	1371078173
 9755 03e4 FA2AB4E7 		.word	-407622918
 9756 03e8 D40CB62E 		.word	783682772
 9757 03ec 2602C9F2 		.word	-221707738
 9758 03f0 D09E5333 		.word	861118160
 9759 03f4 D8BA9808 		.word	144227032
 9760 03f8 24CB3BFC 		.word	-63190236
 9761 03fc 71A3F455 		.word	1442095985
 9762 0400 68CFA919 		.word	430559080
 9763 0404 6C5D4C04 		.word	72113516
 9764 0408 92E51DFE 		.word	-31595118
 9765 040c B851FA2A 		.word	721047992
 9766 0410 B4E7D40C 		.word	215279540
 9767 0414 B62E2602 		.word	36056758
 9768 0418 C9F20E7F 		.word	2131686089
 9769 041c DC287D15 		.word	360523996
 9770 0420 196C5D4C 		.word	1281190937
 9771 0424 0492E51D 		.word	501584388
 9772 0428 FEB851FA 		.word	-95307522
 9773 042c 2AB4E7D4 		.word	-723012566
 9774 0430 0CB62E26 		.word	640595468
 9775 0434 02C9F20E 		.word	250792194
 9776 0438 7FDC287D 		.word	2099829887
 9777 043c 15DA736A 		.word	1785977365
 9778 0440 065B1713 		.word	320297734
 9779 0444 81647987 		.word	-2022087551
 9780 0448 3F6E94BE 		.word	-1097568705
 9781 044c 0AED3935 		.word	892988682
 9782 0450 427B4ECD 		.word	-850494654
 9783 0454 60EB6222 		.word	576908128
 9784 0458 902CEFF0 		.word	-252760944
 9785 045c C78DD257 		.word	1473416647
 9786 0460 A13DA766 		.word	1722236321
 9787 0464 B0753111 		.word	288454064
 9788 0468 489677F8 		.word	-126380472
 9789 046c E346E9AB 		.word	-1410775325
 9790 0470 D09E5333 		.word	861118160
 9791 0474 D8BA9808 		.word	144227032
 9792 0478 24CB3BFC 		.word	-63190236
 9793 047c 71A3F455 		.word	1442095985
 9794 0480 8B8940B2 		.word	-1304393333
 9795 0484 BCC31F37 		.word	924828604
 9796 0488 4A5F85F6 		.word	-159031478
ARM GAS  /tmp/ccCuKxzC.s 			page 251


 9797 048c 9C9AC1D6 		.word	-691955044
 9798 0490 C5442059 		.word	1495286981
 9799 0494 DEE18F1B 		.word	462414302
 9800 0498 A5AF427B 		.word	2067967909
 9801 049c 4ECD60EB 		.word	-345977522
 9802 04a0 6222902C 		.word	747643490
 9803 04a4 EFF0C78D 		.word	-1916276497
 9804 04a8 D257A13D 		.word	1033983954
 9805 04ac A766B075 		.word	1974494887
 9806 04b0 F45568CF 		.word	-815245836
 9807 04b4 A9196C5D 		.word	1567365545
 9808 04b8 4C0492E5 		.word	-443415476
 9809 04bc 1DFEB851 		.word	1371078173
 9810 04c0 FA2AB4E7 		.word	-407622918
 9811 04c4 D40CB62E 		.word	783682772
 9812 04c8 2602C9F2 		.word	-221707738
 9813 04cc 0E7FDC28 		.word	685539086
 9814 04d0 7D15DA73 		.word	1943672189
 9815 04d4 6A065B17 		.word	391841386
 9816 04d8 13816479 		.word	2036629779
 9817 04dc 873F6E94 		.word	-1804714105
 9818 04e0 3DA766B0 		.word	-1335449795
 9819 04e4 75311148 		.word	1209086325
 9820 04e8 9677F8E3 		.word	-470255722
 9821 04ec 46E9ABD0 		.word	-794039994
 9822 04f0 9E5333D8 		.word	-667724898
 9823 04f4 BA980824 		.word	604543162
 9824 04f8 CB3BFC71 		.word	1912355787
 9825 04fc A3F45568 		.word	1750463651
 9826 0500 CFA9196C 		.word	1813621199
 9827 0504 5D4C0492 		.word	-1845212067
 9828 0508 E51DFEB8 		.word	-1191305755
 9829 050c 51FA2AB4 		.word	-1272251823
 9830 0510 66B07531 		.word	829796454
 9831 0514 11489677 		.word	2006337553
 9832 0518 F8E346E9 		.word	-381230088
 9833 051c ABD09E53 		.word	1402917035
 9834 0520 33D8BA98 		.word	-1732585421
 9835 0524 0824CB3B 		.word	1003168776
 9836 0528 FC71A3F4 		.word	-190615044
 9837 052c 5568CFA9 		.word	-1446025131
 9838 0530 196C5D4C 		.word	1281190937
 9839 0534 0492E51D 		.word	501584388
 9840 0538 FEB851FA 		.word	-95307522
 9841 053c 2AB4E7D4 		.word	-723012566
 9842 0540 AF427B4E 		.word	1316700847
 9843 0544 CD60EB62 		.word	1659592909
 9844 0548 22902CEF 		.word	-282292190
 9845 054c F0C78DD2 		.word	-762460176
 9846 0550 57A13DA7 		.word	-1489133225
 9847 0554 66B07531 		.word	829796454
 9848 0558 11489677 		.word	2006337553
 9849 055c F8E346E9 		.word	-381230088
 9850 0560 ABD09E53 		.word	1402917035
 9851 0564 33D8BA98 		.word	-1732585421
 9852 0568 0824CB3B 		.word	1003168776
 9853 056c FC71A3F4 		.word	-190615044
ARM GAS  /tmp/ccCuKxzC.s 			page 252


 9854 0570 980824CB 		.word	-886830952
 9855 0574 3BFC71A3 		.word	-1552810949
 9856 0578 F45568CF 		.word	-815245836
 9857 057c A9196C5D 		.word	1567365545
 9858 0580 4C0492E5 		.word	-443415476
 9859 0584 1DFEB851 		.word	1371078173
 9860 0588 FA2AB4E7 		.word	-407622918
 9861 058c D40CB62E 		.word	783682772
 9862 0590 2602C9F2 		.word	-221707738
 9863 0594 0E7FDC28 		.word	685539086
 9864 0598 7D15DA73 		.word	1943672189
 9865 059c 6A065B17 		.word	391841386
 9866 05a0 51FA2AB4 		.word	-1272251823
 9867 05a4 E7D40CB6 		.word	-1240673049
 9868 05a8 2E2602C9 		.word	-922606034
 9869 05ac F20E7FDC 		.word	-595652878
 9870 05b0 287D15DA 		.word	-636125912
 9871 05b4 736A065B 		.word	1527147123
 9872 05b8 17138164 		.word	1686180631
 9873 05bc 79873F6E 		.word	1849657209
 9874 05c0 94BE0AED 		.word	-318062956
 9875 05c4 393583AD 		.word	-1383910087
 9876 05c8 8B8940B2 		.word	-1304393333
 9877 05cc BCC31F37 		.word	924828604
 9878 05d0 0AED3935 		.word	892988682
 9879 05d4 83AD8B89 		.word	-1987334781
 9880 05d8 40B2BCC3 		.word	-1011043776
 9881 05dc 1F374A5F 		.word	1598699295
 9882 05e0 85F69C9A 		.word	-1700989307
 9883 05e4 C1D6C544 		.word	1153816257
 9884 05e8 2059DEE1 		.word	-505521888
 9885 05ec 8F1BA5AF 		.word	-1348134001
 9886 05f0 427B4ECD 		.word	-850494654
 9887 05f4 60EB6222 		.word	576908128
 9888 05f8 902CEFF0 		.word	-252760944
 9889 05fc C78DD257 		.word	1473416647
 9890 0600 C31F374A 		.word	1245126595
 9891 0604 5F85F69C 		.word	-1661565601
 9892 0608 9AC1D6C5 		.word	-975781478
 9893 060c 442059DE 		.word	-564584380
 9894 0610 E18F1BA5 		.word	-1524920351
 9895 0614 AF427B4E 		.word	1316700847
 9896 0618 CD60EB62 		.word	1659592909
 9897 061c 22902CEF 		.word	-282292190
 9898 0620 F0C78DD2 		.word	-762460176
 9899 0624 57A13DA7 		.word	-1489133225
 9900 0628 66B07531 		.word	829796454
 9901 062c 11489677 		.word	2006337553
 9902 0630 BCC31F37 		.word	924828604
 9903 0634 4A5F85F6 		.word	-159031478
 9904 0638 9C9AC1D6 		.word	-691955044
 9905 063c C5442059 		.word	1495286981
 9906 0640 DEE18F1B 		.word	462414302
 9907 0644 A5AF427B 		.word	2067967909
 9908 0648 4ECD60EB 		.word	-345977522
 9909 064c 6222902C 		.word	747643490
 9910 0650 EFF0C78D 		.word	-1916276497
ARM GAS  /tmp/ccCuKxzC.s 			page 253


 9911 0654 D257A13D 		.word	1033983954
 9912 0658 A766B075 		.word	1974494887
 9913 065c 31114896 		.word	-1773661903
 9914 0660 75311148 		.word	1209086325
 9915 0664 9677F8E3 		.word	-470255722
 9916 0668 46E9ABD0 		.word	-794039994
 9917 066c 9E5333D8 		.word	-667724898
 9918 0670 BA980824 		.word	604543162
 9919 0674 CB3BFC71 		.word	1912355787
 9920 0678 A3F45568 		.word	1750463651
 9921 067c CFA9196C 		.word	1813621199
 9922 0680 5D4C0492 		.word	-1845212067
 9923 0684 E51DFEB8 		.word	-1191305755
 9924 0688 51FA2AB4 		.word	-1272251823
 9925 068c E7D40CB6 		.word	-1240673049
 9926 0690 2E2602C9 		.word	-922606034
 9927 0694 F20E7FDC 		.word	-595652878
 9928 0698 287D15DA 		.word	-636125912
 9929 069c 736A065B 		.word	1527147123
 9930 06a0 17138164 		.word	1686180631
 9931 06a4 79873F6E 		.word	1849657209
 9932 06a8 94BE0AED 		.word	-318062956
 9933 06ac 393583AD 		.word	-1383910087
 9934 06b0 8B8940B2 		.word	-1304393333
 9935 06b4 BCC31F37 		.word	924828604
 9936 06b8 4A5F85F6 		.word	-159031478
 9937 06bc 9C9AC1D6 		.word	-691955044
 9938 06c0 E7D40CB6 		.word	-1240673049
 9939 06c4 2E2602C9 		.word	-922606034
 9940 06c8 F20E7FDC 		.word	-595652878
 9941 06cc 287D15DA 		.word	-636125912
 9942 06d0 736A065B 		.word	1527147123
 9943 06d4 17138164 		.word	1686180631
 9944 06d8 79873F6E 		.word	1849657209
 9945 06dc 94BE0AED 		.word	-318062956
 9946 06e0 393583AD 		.word	-1383910087
 9947 06e4 8B8940B2 		.word	-1304393333
 9948 06e8 BCC31F37 		.word	924828604
 9949 06ec 4A5F85F6 		.word	-159031478
 9950 06f0 60EB6222 		.word	576908128
 9951 06f4 902CEFF0 		.word	-252760944
 9952 06f8 C78DD257 		.word	1473416647
 9953 06fc A13DA766 		.word	1722236321
 9954 0700 B0753111 		.word	288454064
 9955 0704 489677F8 		.word	-126380472
 9956 0708 E346E9AB 		.word	-1410775325
 9957 070c D09E5333 		.word	861118160
 9958 0710 D8BA9808 		.word	144227032
 9959 0714 24CB3BFC 		.word	-63190236
 9960 0718 71A3F455 		.word	1442095985
 9961 071c 68CFA919 		.word	430559080
 9962 0720 A9196C5D 		.word	1567365545
 9963 0724 4C0492E5 		.word	-443415476
 9964 0728 1DFEB851 		.word	1371078173
 9965 072c FA2AB4E7 		.word	-407622918
 9966 0730 D40CB62E 		.word	783682772
 9967 0734 2602C9F2 		.word	-221707738
ARM GAS  /tmp/ccCuKxzC.s 			page 254


 9968 0738 0E7FDC28 		.word	685539086
 9969 073c 7D15DA73 		.word	1943672189
 9970 0740 6A065B17 		.word	391841386
 9971 0744 13816479 		.word	2036629779
 9972 0748 873F6E94 		.word	-1804714105
 9973 074c BE0AED39 		.word	971836094
 9974 0750 F20E7FDC 		.word	-595652878
 9975 0754 287D15DA 		.word	-636125912
 9976 0758 736A065B 		.word	1527147123
 9977 075c 17138164 		.word	1686180631
 9978 0760 79873F6E 		.word	1849657209
 9979 0764 94BE0AED 		.word	-318062956
 9980 0768 393583AD 		.word	-1383910087
 9981 076c 8B8940B2 		.word	-1304393333
 9982 0770 BCC31F37 		.word	924828604
 9983 0774 4A5F85F6 		.word	-159031478
 9984 0778 9C9AC1D6 		.word	-691955044
 9985 077c C5442059 		.word	1495286981
 9986 0780 3BFC71A3 		.word	-1552810949
 9987 0784 F45568CF 		.word	-815245836
 9988 0788 A9196C5D 		.word	1567365545
 9989 078c 4C0492E5 		.word	-443415476
 9990 0790 1DFEB851 		.word	1371078173
 9991 0794 FA2AB4E7 		.word	-407622918
 9992 0798 D40CB62E 		.word	783682772
 9993 079c 2602C9F2 		.word	-221707738
 9994 07a0 0E7FDC28 		.word	685539086
 9995 07a4 7D15DA73 		.word	1943672189
 9996 07a8 6A065B17 		.word	391841386
 9997 07ac 13816479 		.word	2036629779
 9998 07b0 442059DE 		.word	-564584380
 9999 07b4 E18F1BA5 		.word	-1524920351
 10000 07b8 AF427B4E 		.word	1316700847
 10001 07bc CD60EB62 		.word	1659592909
 10002 07c0 22902CEF 		.word	-282292190
 10003 07c4 F0C78DD2 		.word	-762460176
 10004 07c8 57A13DA7 		.word	-1489133225
 10005 07cc 66B07531 		.word	829796454
 10006 07d0 11489677 		.word	2006337553
 10007 07d4 F8E346E9 		.word	-381230088
 10008 07d8 ABD09E53 		.word	1402917035
 10009 07dc 33D8BA98 		.word	-1732585421
 10010 07e0 8DD257A1 		.word	-1588079987
 10011 07e4 3DA766B0 		.word	-1335449795
 10012 07e8 75311148 		.word	1209086325
 10013 07ec 9677F8E3 		.word	-470255722
 10014 07f0 46E9ABD0 		.word	-794039994
 10015 07f4 9E5333D8 		.word	-667724898
 10016 07f8 BA980824 		.word	604543162
 10017 07fc CB3BFC71 		.word	1912355787
 10018 0800 A3F45568 		.word	1750463651
 10019 0804 CFA9196C 		.word	1813621199
 10020 0808 5D4C0492 		.word	-1845212067
 10021 080c E51DFEB8 		.word	-1191305755
 10022 0810 D6C54420 		.word	541378006
 10023 0814 59DEE18F 		.word	-1881022887
 10024 0818 1BA5AF42 		.word	1118807323
ARM GAS  /tmp/ccCuKxzC.s 			page 255


 10025 081c 7B4ECD60 		.word	1624067707
 10026 0820 EB622290 		.word	-1876794645
 10027 0824 2CEFF0C7 		.word	-940511444
 10028 0828 8DD257A1 		.word	-1588079987
 10029 082c 3DA766B0 		.word	-1335449795
 10030 0830 75311148 		.word	1209086325
 10031 0834 9677F8E3 		.word	-470255722
 10032 0838 46E9ABD0 		.word	-794039994
 10033 083c 9E5333D8 		.word	-667724898
 10034 0840 1F374A5F 		.word	1598699295
 10035 0844 85F69C9A 		.word	-1700989307
 10036 0848 C1D6C544 		.word	1153816257
 10037 084c 2059DEE1 		.word	-505521888
 10038 0850 8F1BA5AF 		.word	-1348134001
 10039 0854 427B4ECD 		.word	-850494654
 10040 0858 60EB6222 		.word	576908128
 10041 085c 902CEFF0 		.word	-252760944
 10042 0860 C78DD257 		.word	1473416647
 10043 0864 A13DA766 		.word	1722236321
 10044 0868 B0753111 		.word	288454064
 10045 086c 489677F8 		.word	-126380472
 10048              	hop_interval_lut:
 10049 0870 00       		.byte	0
 10050 0871 01       		.byte	1
 10051 0872 13       		.byte	19
 10052 0873 19       		.byte	25
 10053 0874 1C       		.byte	28
 10054 0875 0F       		.byte	15
 10055 0876 1F       		.byte	31
 10056 0877 10       		.byte	16
 10057 0878 0E       		.byte	14
 10058 0879 21       		.byte	33
 10059 087a 1A       		.byte	26
 10060 087b 1B       		.byte	27
 10061 087c 22       		.byte	34
 10062 087d 14       		.byte	20
 10063 087e 08       		.byte	8
 10064 087f 05       		.byte	5
 10065 0880 07       		.byte	7
 10066 0881 18       		.byte	24
 10067 0882 23       		.byte	35
 10068 0883 02       		.byte	2
 10069 0884 0D       		.byte	13
 10070 0885 1E       		.byte	30
 10071 0886 20       		.byte	32
 10072 0887 1D       		.byte	29
 10073 0888 11       		.byte	17
 10074 0889 03       		.byte	3
 10075 088a 0A       		.byte	10
 10076 088b 0B       		.byte	11
 10077 088c 04       		.byte	4
 10078 088d 17       		.byte	23
 10079 088e 15       		.byte	21
 10080 088f 06       		.byte	6
 10081 0890 16       		.byte	22
 10082 0891 09       		.byte	9
 10083 0892 0C       		.byte	12
ARM GAS  /tmp/ccCuKxzC.s 			page 256


 10084 0893 12       		.byte	18
 10085 0894 24       		.byte	36
 10086 0895 000000   		.space	3
 10087              	.LC0:
 10088 0898 01000000 		.word	1
 10089 089c 01000000 		.word	1
 10090 08a0 01000000 		.word	1
 10091 08a4 01000000 		.word	1
 10092              	.LC1:
 10093 08a8 6209     		.short	2402
 10094 08aa 7A09     		.short	2426
 10095 08ac B009     		.short	2480
 10096              	.LC2:
 10097 08ae 42       		.byte	66
 10098 08af 1D       		.byte	29
 10099 08b0 FF       		.byte	-1
 10100 08b1 FF       		.byte	-1
 10101 08b2 FF       		.byte	-1
 10102 08b3 FF       		.byte	-1
 10103 08b4 FF       		.byte	-1
 10104 08b5 FF       		.byte	-1
 10105 08b6 03       		.byte	3
 10106 08b7 03       		.byte	3
 10107 08b8 AA       		.byte	-86
 10108 08b9 FE       		.byte	-2
 10109 08ba 12       		.byte	18
 10110 08bb 16       		.byte	22
 10111 08bc AA       		.byte	-86
 10112 08bd FE       		.byte	-2
 10113 08be 10       		.byte	16
 10114 08bf 00       		.byte	0
 10115 08c0 02       		.byte	2
 10116 08c1 AA       		.byte	-86
 10117              	.LC3:
 10118 08c2 42       		.byte	66
 10119 08c3 16       		.byte	22
 10120 08c4 FF       		.byte	-1
 10121 08c5 FF       		.byte	-1
 10122 08c6 FF       		.byte	-1
 10123 08c7 FF       		.byte	-1
 10124 08c8 FF       		.byte	-1
 10125 08c9 FF       		.byte	-1
 10126 08ca 03       		.byte	3
 10127 08cb 03       		.byte	3
 10128 08cc AA       		.byte	-86
 10129 08cd FE       		.byte	-2
 10130 08ce 0B       		.byte	11
 10131 08cf 16       		.byte	22
 10132 08d0 AA       		.byte	-86
 10133 08d1 FE       		.byte	-2
 10134 08d2 10       		.byte	16
 10135 08d3 00       		.byte	0
 10136 08d4 02       		.byte	2
 10137 08d5 FF       		.byte	-1
 10138 08d6 53       		.byte	83
 10139 08d7 59       		.byte	89
 10140 08d8 4E       		.byte	78
ARM GAS  /tmp/ccCuKxzC.s 			page 257


 10141 08d9 43       		.byte	67
 10142              	.LC4:
 10143 08da 6C09     		.short	2412
 10144 08dc 8509     		.short	2437
 10145 08de 9E09     		.short	2462
 10146              		.section	.rodata.str1.1,"aMS",%progbits,1
 10147              	.LC5:
 10148 0000 32303137 		.ascii	"2017-03-R2\000"
 10148      2D30332D 
 10148      523200
 10149              		.data
 10150              		.align	2
 10151              		.set	.LANCHOR1,. + 0
 10154              	channel:
 10155 0000 8909     		.short	2441
 10156 0002 0000     		.space	2
 10159              	le:
 10160 0004 D6BE898E 		.word	-1903575338
 10161 0008 7D6B     		.short	27517
 10162 000a 7191     		.short	-28303
 10163 000c 55555500 		.word	5592405
 10164 0010 AAAAAA00 		.word	11184810
 10165 0014 00000000 		.word	0
 10166 0018 00       		.byte	0
 10167 0019 000000   		.space	3
 10168 001c 00000000 		.word	0
 10169 0020 00000000 		.space	32
 10169      00000000 
 10169      00000000 
 10169      00000000 
 10169      00000000 
 10170 0040 00000000 		.word	0
 10171 0044 00000000 		.word	0
 10174              	hop_timeout:
 10175 0048 9E00     		.short	158
 10178              	le_adv_channel:
 10179 004a 6209     		.short	2402
 10182              	low_freq:
 10183 004c 6009     		.short	2400
 10186              	high_freq:
 10187 004e B309     		.short	2483
 10190              	rssi_threshold:
 10191 0050 E2       		.byte	-30
 10192 0051 000000   		.bss
 10193              		.align	2
 10194              		.set	.LANCHOR0,. + 0
 10197              	modulation:
 10198 0000 00       		.space	1
 10201              	status:
 10202 0001 00       		.space	1
 10205              	idle_buf_clkn_high:
 10206 0002 00       		.space	1
 10207 0003 00       		.space	1
 10210              	idle_buf_clk100ns:
 10211 0004 00000000 		.space	4
 10214              	idle_buf_channel:
 10215 0008 0000     		.space	2
ARM GAS  /tmp/ccCuKxzC.s 			page 258


 10218              	hop_mode:
 10219 000a 00       		.space	1
 10222              	do_hop:
 10223 000b 00       		.space	1
 10226              	hop_direct_channel:
 10227 000c 0000     		.space	2
 10230              	requested_channel:
 10231 000e 0000     		.space	2
 10234              	dma_discard:
 10235 0010 00       		.space	1
 10238              	mode:
 10239 0011 00       		.space	1
 10242              	requested_mode:
 10243 0012 00       		.space	1
 10246              	jam_mode:
 10247 0013 00       		.space	1
 10250              	ego_mode:
 10251 0014 00       		.space	1
 10252 0015 000000   		.space	3
 10255              	packet_cb:
 10256 0018 00000000 		.space	4
 10259              	le_jam_count:
 10260 001c 00000000 		.space	4
 10263              	dlen:
 10264 0020 00000000 		.space	4
 10267              	data_cb:
 10268 0024 00000000 		.space	4
 10271              	start_sync:
 10272 0028 00000000 		.space	4
 10275              	now_sync:
 10276 002c 00000000 		.space	4
 10279              	restart_jamming.5236:
 10280 0030 00000000 		.space	4
 10283              	restart_jamming.5289:
 10284 0034 00000000 		.space	4
 10287              	first_ts.5394:
 10288 0038 00000000 		.space	4
 10291              	prev_clk.5400:
 10292 003c 00000000 		.space	4
 10295              	slave_mac_address:
 10296 0040 00000000 		.space	6
 10296      0000
 10299              	sync_channel:
 10300 0046 0000     		.space	2
 10301              		.text
 10302              	.Letext0:
 10303              		.file 2 "/usr/lib/gcc/arm-none-eabi/4.8.2/include/stddef.h"
 10304              		.file 3 "/usr/lib/gcc/arm-none-eabi/4.8.2/include/stdint-gcc.h"
 10305              		.file 4 "../../host/libubertooth/src/ubertooth_interface.h"
 10306              		.file 5 "../common/ubertooth.h"
 10307              		.file 6 "ubertooth_usb.h"
 10308              		.file 7 "bluetooth_le.h"
 10309              		.file 8 "ego.h"
 10310              		.file 9 "ubertooth_rssi.h"
 10311              		.file 10 "ubertooth_cs.h"
 10312              		.file 11 "ubertooth_dma.h"
 10313              		.file 12 "ubertooth_clock.h"
ARM GAS  /tmp/ccCuKxzC.s 			page 259


 10314              		.file 13 "bluetooth.h"
 10315              		.file 14 "cc2400_rangetest.h"
 10316              		.file 15 "/usr/include/newlib/string.h"
 10317              		.file 16 "/usr/include/newlib/stdlib.h"
ARM GAS  /tmp/ccCuKxzC.s 			page 260


DEFINED SYMBOLS
                            *ABS*:0000000000000000 bluetooth_rxtx.c
     /tmp/ccCuKxzC.s:19     .text.msleep:0000000000000000 $t
     /tmp/ccCuKxzC.s:23     .text.msleep:0000000000000000 msleep
     /tmp/ccCuKxzC.s:65     .text.msleep:0000000000000028 $d
                            *COM*:0000000000000004 clkn
     /tmp/ccCuKxzC.s:70     .text.reverse8:0000000000000000 $t
     /tmp/ccCuKxzC.s:74     .text.reverse8:0000000000000000 reverse8
     /tmp/ccCuKxzC.s:122    .text.cc2400_rx:0000000000000000 $t
     /tmp/ccCuKxzC.s:126    .text.cc2400_rx:0000000000000000 cc2400_rx
     /tmp/ccCuKxzC.s:239    .text.cc2400_rx:0000000000000098 $d
     /tmp/ccCuKxzC.s:246    .text.cc2400_rx_sync:0000000000000000 $t
     /tmp/ccCuKxzC.s:250    .text.cc2400_rx_sync:0000000000000000 cc2400_rx_sync
     /tmp/ccCuKxzC.s:380    .text.cc2400_rx_sync:00000000000000ac $d
     /tmp/ccCuKxzC.s:387    .text.enqueue:0000000000000000 $t
     /tmp/ccCuKxzC.s:391    .text.enqueue:0000000000000000 enqueue
     /tmp/ccCuKxzC.s:501    .text.enqueue:0000000000000084 $d
                            *COM*:0000000000000001 rssi_min
                            *COM*:0000000000000001 rssi_max
                            *COM*:0000000000000001 rssi_count
     /tmp/ccCuKxzC.s:511    .text.le_set_access_address:0000000000000000 $t
     /tmp/ccCuKxzC.s:515    .text.le_set_access_address:0000000000000000 le_set_access_address
     /tmp/ccCuKxzC.s:542    .text.le_set_access_address:0000000000000014 $d
     /tmp/ccCuKxzC.s:547    .text.cc2400_idle:0000000000000000 $t
     /tmp/ccCuKxzC.s:551    .text.cc2400_idle:0000000000000000 cc2400_idle
     /tmp/ccCuKxzC.s:665    .text.cc2400_idle:000000000000009c $d
                            *COM*:0000000000000010 target
     /tmp/ccCuKxzC.s:673    .text.cb_follow_le:0000000000000000 $t
     /tmp/ccCuKxzC.s:678    .text.cb_follow_le:0000000000000000 cb_follow_le
     /tmp/ccCuKxzC.s:892    .text.cb_follow_le:00000000000000ec $d
                            *COM*:0000000000000320 unpacked
                            *COM*:0000000000000004 idle_rxbuf
     /tmp/ccCuKxzC.s:902    .text.connection_follow_cb:0000000000000000 $t
     /tmp/ccCuKxzC.s:907    .text.connection_follow_cb:0000000000000000 connection_follow_cb
     /tmp/ccCuKxzC.s:1178   .text.connection_follow_cb:0000000000000164 $d
     /tmp/ccCuKxzC.s:1188   .text.vendor_request_handler:0000000000000000 $t
     /tmp/ccCuKxzC.s:1192   .text.vendor_request_handler:0000000000000000 vendor_request_handler
     /tmp/ccCuKxzC.s:1226   .text.vendor_request_handler:000000000000001a $d
     /tmp/ccCuKxzC.s:1300   .text.vendor_request_handler:00000000000000ac $t
     /tmp/ccCuKxzC.s:1621   .text.vendor_request_handler:0000000000000264 $d
                            *COM*:0000000000000005 rr
     /tmp/ccCuKxzC.s:1635   .text.vendor_request_handler:0000000000000290 $t
     /tmp/ccCuKxzC.s:2204   .text.vendor_request_handler:000000000000055c $d
                            *COM*:0000000000000001 cs_threshold_req
                            *COM*:0000000000000004 clkn_offset
                            *COM*:0000000000000002 clk100ns_offset
                            *COM*:000000000000000a afh_map
                            *COM*:0000000000000001 used_channels
                            *COM*:0000000000000001 afh_enabled
                            *COM*:0000000000000002 clk_drift_ppm
                            *COM*:0000000000000004 clkn_next_drift_fix
                            *COM*:0000000000000002 clk_drift_correction
                            *COM*:0000000000000004 clkn_last_drift_fix
     /tmp/ccCuKxzC.s:2223   .text.vendor_request_handler:000000000000059c $t
     /tmp/ccCuKxzC.s:2413   .text.vendor_request_handler:000000000000067c $d
                            *COM*:000000000000003a tx_pkt
                            *COM*:0000000000000004 slave_mac_address_data
ARM GAS  /tmp/ccCuKxzC.s 			page 261


     /tmp/ccCuKxzC.s:2420   .text.enqueue_time:0000000000000000 $t
     /tmp/ccCuKxzC.s:2424   .text.enqueue_time:0000000000000000 enqueue_time
     /tmp/ccCuKxzC.s:2468   .text.enqueue_time:0000000000000024 $d
     /tmp/ccCuKxzC.s:2473   .text.enqueue_with_ts:0000000000000000 $t
     /tmp/ccCuKxzC.s:2478   .text.enqueue_with_ts:0000000000000000 enqueue_with_ts
     /tmp/ccCuKxzC.s:2554   .text.enqueue_with_ts:0000000000000050 $d
     /tmp/ccCuKxzC.s:2560   .text.TIMER0_IRQHandler:0000000000000000 $t
     /tmp/ccCuKxzC.s:2565   .text.TIMER0_IRQHandler:0000000000000000 TIMER0_IRQHandler
     /tmp/ccCuKxzC.s:2764   .text.TIMER0_IRQHandler:0000000000000110 $d
                            *COM*:0000000000000004 last_hop
     /tmp/ccCuKxzC.s:2781   .text.EINT3_IRQHandler:0000000000000000 $t
     /tmp/ccCuKxzC.s:2786   .text.EINT3_IRQHandler:0000000000000000 EINT3_IRQHandler
     /tmp/ccCuKxzC.s:2817   .text.EINT3_IRQHandler:0000000000000024 $d
                            *COM*:0000000000000001 cs_trigger
     /tmp/ccCuKxzC.s:2825   .text.DMA_IRQHandler:0000000000000000 $t
     /tmp/ccCuKxzC.s:2830   .text.DMA_IRQHandler:0000000000000000 DMA_IRQHandler
     /tmp/ccCuKxzC.s:2963   .text.DMA_IRQHandler:00000000000000b8 $d
                            *COM*:0000000000000004 active_rxbuf
                            *COM*:0000000000000004 rx_tc
                            *COM*:0000000000000004 rx_err
     /tmp/ccCuKxzC.s:2981   .text.le_transmit:0000000000000000 $t
     /tmp/ccCuKxzC.s:2986   .text.le_transmit:0000000000000000 le_transmit
     /tmp/ccCuKxzC.s:3284   .text.le_transmit:00000000000001a0 $d
     /tmp/ccCuKxzC.s:3293   .text.le_jam:0000000000000000 $t
     /tmp/ccCuKxzC.s:3298   .text.le_jam:0000000000000000 le_jam
     /tmp/ccCuKxzC.s:3379   .text.le_jam:0000000000000074 $d
     /tmp/ccCuKxzC.s:3384   .text.hop:0000000000000000 $t
     /tmp/ccCuKxzC.s:3389   .text.hop:0000000000000000 hop
     /tmp/ccCuKxzC.s:3636   .text.hop:0000000000000180 $d
     /tmp/ccCuKxzC.s:3648   .text.bt_stream_rx:0000000000000000 $t
     /tmp/ccCuKxzC.s:3653   .text.bt_stream_rx:0000000000000000 bt_stream_rx
     /tmp/ccCuKxzC.s:3873   .text.bt_stream_rx:000000000000012c $d
                            *COM*:0000000000000001 cs_threshold_cur
                            *COM*:0000000000000001 cs_no_squelch
     /tmp/ccCuKxzC.s:3889   .text.br_transmit:0000000000000000 $t
     /tmp/ccCuKxzC.s:3894   .text.br_transmit:0000000000000000 br_transmit
     /tmp/ccCuKxzC.s:4317   .text.br_transmit:000000000000025c $d
     /tmp/ccCuKxzC.s:4330   .text.reset_le:0000000000000000 $t
     /tmp/ccCuKxzC.s:4335   .text.reset_le:0000000000000000 reset_le
     /tmp/ccCuKxzC.s:4398   .text.reset_le:0000000000000040 $d
     /tmp/ccCuKxzC.s:4407   .text.reset_le_promisc:0000000000000000 $t
     /tmp/ccCuKxzC.s:4412   .text.reset_le_promisc:0000000000000000 reset_le_promisc
     /tmp/ccCuKxzC.s:4436   .text.reset_le_promisc:000000000000001c $d
                            *COM*:0000000000000108 le_promisc
     /tmp/ccCuKxzC.s:4441   .text.bt_generic_le:0000000000000000 $t
     /tmp/ccCuKxzC.s:4446   .text.bt_generic_le:0000000000000000 bt_generic_le
     /tmp/ccCuKxzC.s:4785   .text.bt_generic_le:00000000000001ac $d
     /tmp/ccCuKxzC.s:4804   .text.bt_le_sync_rssi:0000000000000000 $t
     /tmp/ccCuKxzC.s:4809   .text.bt_le_sync_rssi:0000000000000000 bt_le_sync_rssi
     /tmp/ccCuKxzC.s:5174   .text.bt_le_sync_rssi:000000000000022c $d
     /tmp/ccCuKxzC.s:5186   .text.bt_le_sync:0000000000000000 $t
     /tmp/ccCuKxzC.s:5191   .text.bt_le_sync:0000000000000000 bt_le_sync
     /tmp/ccCuKxzC.s:5669   .text.bt_le_sync:00000000000002a4 $d
                            *COM*:0000000000000032 rxbuf1
     /tmp/ccCuKxzC.s:5691   .text.bt_le_sync:00000000000002f0 $t
     /tmp/ccCuKxzC.s:5886   .text.bt_le_sync:00000000000003fc $d
     /tmp/ccCuKxzC.s:5897   .text.bt_le_sync_cfo:0000000000000000 $t
ARM GAS  /tmp/ccCuKxzC.s 			page 262


     /tmp/ccCuKxzC.s:5902   .text.bt_le_sync_cfo:0000000000000000 bt_le_sync_cfo
     /tmp/ccCuKxzC.s:6380   .text.bt_le_sync_cfo:00000000000002b0 $d
     /tmp/ccCuKxzC.s:6402   .text.bt_le_sync_cfo:00000000000002fc $t
     /tmp/ccCuKxzC.s:6595   .text.bt_le_sync_cfo:0000000000000404 $d
     /tmp/ccCuKxzC.s:6607   .text.bt_follow_le:0000000000000000 $t
     /tmp/ccCuKxzC.s:6612   .text.bt_follow_le:0000000000000000 bt_follow_le
     /tmp/ccCuKxzC.s:6642   .text.bt_follow_le:0000000000000018 $d
     /tmp/ccCuKxzC.s:6648   .text.bt_tracking_le:0000000000000000 $t
     /tmp/ccCuKxzC.s:6653   .text.bt_tracking_le:0000000000000000 bt_tracking_le
     /tmp/ccCuKxzC.s:6702   .text.bt_tracking_le:000000000000002c $d
     /tmp/ccCuKxzC.s:6708   .text.le_promisc_state:0000000000000000 $t
     /tmp/ccCuKxzC.s:6713   .text.le_promisc_state:0000000000000000 le_promisc_state
     /tmp/ccCuKxzC.s:6767   .text.promisc_recover_hop_increment:0000000000000000 $t
     /tmp/ccCuKxzC.s:6772   .text.promisc_recover_hop_increment:0000000000000000 promisc_recover_hop_increment
     /tmp/ccCuKxzC.s:6925   .text.promisc_recover_hop_increment:00000000000000c8 $d
     /tmp/ccCuKxzC.s:6935   .text.promisc_recover_hop_interval:0000000000000000 $t
     /tmp/ccCuKxzC.s:6940   .text.promisc_recover_hop_interval:0000000000000000 promisc_recover_hop_interval
     /tmp/ccCuKxzC.s:7063   .text.promisc_recover_hop_interval:0000000000000098 $d
     /tmp/ccCuKxzC.s:7074   .text.promisc_follow_cb:0000000000000000 $t
     /tmp/ccCuKxzC.s:7079   .text.promisc_follow_cb:0000000000000000 promisc_follow_cb
     /tmp/ccCuKxzC.s:7175   .text.promisc_follow_cb:0000000000000064 $d
     /tmp/ccCuKxzC.s:7186   .text.see_aa:0000000000000000 $t
     /tmp/ccCuKxzC.s:7191   .text.see_aa:0000000000000000 see_aa
     /tmp/ccCuKxzC.s:7270   .text.see_aa:0000000000000058 $d
     /tmp/ccCuKxzC.s:7275   .text.cb_le_promisc:0000000000000000 $t
     /tmp/ccCuKxzC.s:7280   .text.cb_le_promisc:0000000000000000 cb_le_promisc
     /tmp/ccCuKxzC.s:7595   .text.cb_le_promisc:000000000000017c $d
     /tmp/ccCuKxzC.s:7608   .text.bt_promisc_le:0000000000000000 $t
     /tmp/ccCuKxzC.s:7613   .text.bt_promisc_le:0000000000000000 bt_promisc_le
     /tmp/ccCuKxzC.s:7692   .text.bt_promisc_le:000000000000005c $d
     /tmp/ccCuKxzC.s:7701   .text.bt_slave_le:0000000000000000 $t
     /tmp/ccCuKxzC.s:7706   .text.bt_slave_le:0000000000000000 bt_slave_le
     /tmp/ccCuKxzC.s:8134   .text.bt_slave_le:0000000000000220 $d
     /tmp/ccCuKxzC.s:8146   .text.bt_sync_le:0000000000000000 $t
     /tmp/ccCuKxzC.s:8151   .text.bt_sync_le:0000000000000000 bt_sync_le
     /tmp/ccCuKxzC.s:8312   .text.bt_sync_le:00000000000000cc $d
     /tmp/ccCuKxzC.s:8324   .text.rx_generic_sync:0000000000000000 $t
     /tmp/ccCuKxzC.s:8329   .text.rx_generic_sync:0000000000000000 rx_generic_sync
     /tmp/ccCuKxzC.s:8441   .text.rx_generic_sync:0000000000000094 $d
     /tmp/ccCuKxzC.s:8448   .text.rx_generic:0000000000000000 $t
     /tmp/ccCuKxzC.s:8453   .text.rx_generic:0000000000000000 rx_generic
     /tmp/ccCuKxzC.s:8484   .text.rx_generic:000000000000001c $d
     /tmp/ccCuKxzC.s:8489   .text.tx_generic:0000000000000000 $t
     /tmp/ccCuKxzC.s:8494   .text.tx_generic:0000000000000000 tx_generic
     /tmp/ccCuKxzC.s:8652   .text.tx_generic:00000000000000dc $d
     /tmp/ccCuKxzC.s:8662   .text.specan:0000000000000000 $t
     /tmp/ccCuKxzC.s:8667   .text.specan:0000000000000000 specan
     /tmp/ccCuKxzC.s:8854   .text.specan:00000000000000fc $d
     /tmp/ccCuKxzC.s:8864   .text.led_specan:0000000000000000 $t
     /tmp/ccCuKxzC.s:8869   .text.led_specan:0000000000000000 led_specan
     /tmp/ccCuKxzC.s:9073   .text.led_specan:0000000000000114 $d
     /tmp/ccCuKxzC.s:9084   .text.startup.main:0000000000000000 $t
     /tmp/ccCuKxzC.s:9089   .text.startup.main:0000000000000000 main
     /tmp/ccCuKxzC.s:9135   .text.startup.main:0000000000000034 $d
     /tmp/ccCuKxzC.s:9157   .text.startup.main:0000000000000084 $t
     /tmp/ccCuKxzC.s:9314   .text.startup.main:000000000000012c $d
     /tmp/ccCuKxzC.s:10255  .bss:0000000000000018 packet_cb
ARM GAS  /tmp/ccCuKxzC.s 			page 263


     /tmp/ccCuKxzC.s:10267  .bss:0000000000000024 data_cb
     /tmp/ccCuKxzC.s:10259  .bss:000000000000001c le_jam_count
     /tmp/ccCuKxzC.s:10159  .data:0000000000000004 le
     /tmp/ccCuKxzC.s:10299  .bss:0000000000000046 sync_channel
     /tmp/ccCuKxzC.s:10271  .bss:0000000000000028 start_sync
     /tmp/ccCuKxzC.s:10275  .bss:000000000000002c now_sync
     /tmp/ccCuKxzC.s:10295  .bss:0000000000000040 slave_mac_address
     /tmp/ccCuKxzC.s:10263  .bss:0000000000000020 dlen
     /tmp/ccCuKxzC.s:10190  .data:0000000000000050 rssi_threshold
     /tmp/ccCuKxzC.s:10186  .data:000000000000004e high_freq
     /tmp/ccCuKxzC.s:10182  .data:000000000000004c low_freq
     /tmp/ccCuKxzC.s:10197  .bss:0000000000000000 modulation
     /tmp/ccCuKxzC.s:10250  .bss:0000000000000014 ego_mode
     /tmp/ccCuKxzC.s:10246  .bss:0000000000000013 jam_mode
     /tmp/ccCuKxzC.s:10242  .bss:0000000000000012 requested_mode
     /tmp/ccCuKxzC.s:10238  .bss:0000000000000011 mode
     /tmp/ccCuKxzC.s:10201  .bss:0000000000000001 status
     /tmp/ccCuKxzC.s:10234  .bss:0000000000000010 dma_discard
     /tmp/ccCuKxzC.s:10214  .bss:0000000000000008 idle_buf_channel
     /tmp/ccCuKxzC.s:10210  .bss:0000000000000004 idle_buf_clk100ns
     /tmp/ccCuKxzC.s:10205  .bss:0000000000000002 idle_buf_clkn_high
     /tmp/ccCuKxzC.s:10178  .data:000000000000004a le_adv_channel
     /tmp/ccCuKxzC.s:10230  .bss:000000000000000e requested_channel
     /tmp/ccCuKxzC.s:10174  .data:0000000000000048 hop_timeout
     /tmp/ccCuKxzC.s:10226  .bss:000000000000000c hop_direct_channel
     /tmp/ccCuKxzC.s:10154  .data:0000000000000000 channel
     /tmp/ccCuKxzC.s:10222  .bss:000000000000000b do_hop
     /tmp/ccCuKxzC.s:10218  .bss:000000000000000a hop_mode
     /tmp/ccCuKxzC.s:9560   .rodata:00000000000000a7 compile_info
                            *COM*:0000000000000008 syncword
                            *COM*:0000000000000032 rxbuf2
     /tmp/ccCuKxzC.s:9383   .rodata:0000000000000000 $d
     /tmp/ccCuKxzC.s:9387   .rodata:0000000000000000 whitening_index
     /tmp/ccCuKxzC.s:9430   .rodata:0000000000000028 whitening
     /tmp/ccCuKxzC.s:9565   .rodata:00000000000000f0 whitening_word
     /tmp/ccCuKxzC.s:10048  .rodata:0000000000000870 hop_interval_lut
     /tmp/ccCuKxzC.s:10150  .data:0000000000000000 $d
     /tmp/ccCuKxzC.s:10193  .bss:0000000000000000 $d
     /tmp/ccCuKxzC.s:10279  .bss:0000000000000030 restart_jamming.5236
     /tmp/ccCuKxzC.s:10283  .bss:0000000000000034 restart_jamming.5289
     /tmp/ccCuKxzC.s:10287  .bss:0000000000000038 first_ts.5394
     /tmp/ccCuKxzC.s:10291  .bss:000000000000003c prev_clk.5400
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
cc2400_set
cs_threshold_calc_and_set
clkn_start
cc2400_status
cc2400_strobe
usb_enqueue
rssi_get_avg
memcpy
rbit
clkn_stop
dio_ssp_stop
cs_reset
ARM GAS  /tmp/ccCuKxzC.s 			page 264


rssi_reset
btle_channel_index
btle_crcgen_lut
memcmp
__aeabi_llsl
get_part_num
get_device_serial
cc2400_get
set_isp
bootloader_ctrl
strlen
precalc
dequeue
malloc
queue_init
usb_enqueue_time
memset
cc2400_fifo_write
next_hop
btle_next_hop
dio_ssp_init
dma_init
dio_ssp_start
cs_trigger_enable
rssi_add
handle_usb
rssi_iir_update
cs_trigger_disable
dma_init_le
cc2400_get_rev
btle_reverse_crc
btle_calc_crc
free
cc2400_fifo_read
ubertooth_init
clkn_init
ubertooth_usb_init
wait
reset
cc2400_txtest
cc2400_rangetest
cc2400_repeater
ego_main
